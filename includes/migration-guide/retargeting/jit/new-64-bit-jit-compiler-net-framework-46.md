---
ms.openlocfilehash: ddae1bfdd1a6f67bce111e0f97dd501c82022f36
ms.sourcegitcommit: 337bdc5a463875daf2cc6883e5a2da97d56f5000
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/24/2019
ms.locfileid: "72887753"
---
### <a name="new-64-bit-jit-compiler-in-the-net-framework-46"></a>Nový 64 kompilátor JIT v .NET Framework 4,6

|   |   |
|---|---|
|Podrobnosti|Počínaje .NET Framework 4,6 se k kompilaci za běhu používá nový 64 kompilátor JIT. V některých případech je vyvolána Neočekávaná výjimka nebo je zjištěno jiné chování než při spuštění aplikace pomocí kompilátoru 32 nebo staršího 64 kompilátoru JIT. Tato změna nemá vliv na 32 kompilátor JIT. Mezi známé rozdíly patří následující:<ul><li>Za určitých podmínek může rozbalení operace vyvolat <xref:System.NullReferenceException> v sestavení vydaných verzí s zapnutou optimalizací.</li><li>V některých případech může provádění produkčního kódu v těle velké metody vyvolat <xref:System.StackOverflowException>.</li><li>Za určitých podmínek jsou struktury předané metodě považovány za typy odkazů, nikoli jako typy hodnot v sestaveních vydaných verzí. Jedním z manifestů tohoto problému je, že jednotlivé položky v kolekci se zobrazí v neočekávaném pořadí.</li><li>Za určitých podmínek je porovnání hodnot <xref:System.UInt16> s jejich vysokou bitovou sadou nesprávné, pokud je povolena optimalizace.</li><li>Za určitých podmínek, zejména při inicializaci hodnot pole, může inicializace paměti pomocí instrukcí <xref:System.Reflection.Emit.OpCodes.Initblk?displayProperty=nameWithType> IL inicializovat paměť s nesprávnou hodnotou. Výsledkem může být Neošetřená výjimka nebo nesprávný výstup.</li><li>Za určitých vzácných podmínek může podmíněný bit test vracet nesprávnou <xref:System.Boolean> hodnotu nebo vyvolat výjimku, pokud jsou povoleny optimalizace kompilátoru.</li><li>Za určitých podmínek platí, že pokud se k otestování podmínky používá příkaz <code>if</code>, před vstupem do bloku <code>try</code> a při ukončení z bloku <code>try</code> se tato podmínka vyhodnocuje v <code>catch</code> nebo <code>finally</code> bloku. , nový 64 kompilátor JIT při optimalizaci kódu odstraní podmínku <code>if</code> z bloku <code>catch</code> nebo <code>finally</code>. V důsledku toho je kód v příkazu <code>if</code> v bloku <code>catch</code> nebo <code>finally</code> prováděn nepodmíněně.</li></ul>|
|Doporučení|**Zmírnění známých problémů** <br/> Pokud narazíte na výše uvedené problémy, můžete je vyřešit provedením následujících akcí:<ul><li>Upgradujte na .NET Framework 4.6.2. Nový 64 kompilátor zahrnutý do .NET Framework 4.6.2 řeší všechny tyto známé problémy.</li><li>Zajistěte, aby byla verze Windows aktuální, a to spuštěním web Windows Update. Aktualizace služby .NET Framework 4,6 a 4.6.1 řeší každý z těchto problémů s výjimkou <xref:System.NullReferenceException> v operaci rozbalení.</li><li>Zkompiluje se starším 64 kompilátorem JIT. Další informace o tom, jak to udělat, najdete v části **zmírnění problémů s dalšími problémy** .</li></ul>**Zmírnění jiných problémů** <br/> Pokud narazíte na jiné rozdíly v chování mezi kódem kompilovaným se starším 64 kompilátorem a novým 64 kompilátorem JIT, nebo mezi verzemi ladění a vydání vaší aplikace, které jsou zkompilovány pomocí nového 64-bitového kompilátoru JIT, můžete provést následující akce: pro zkompilování aplikace se starším 64 kompilátorem JIT:<ul><li>Na základě jednotlivých aplikací můžete přidat [<](~/docs/framework/configure-apps/file-schema/runtime/uselegacyjit-element.md) element do konfiguračního souboru aplikace. Následující zakáže kompilaci s novým 64 kompilátorem JIT a místo toho používá starší 64 kompilátor JIT.</li></ul><pre><code class="lang-xml">&lt;?xml version =&quot;1.0&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;useLegacyJit enabled=&quot;1&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><ul><li>Na základě jednotlivých uživatelů můžete do <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework</code> klíče registru přidat <code>REG_DWORD</code>ovou hodnotu s názvem <code>useLegacyJit</code>. Hodnota 1 povolí starší 64 kompilátor JIT; hodnota 0 ji zakáže a povolí nový 64 kompilátor JIT.</li><li>Na základě jednotlivých počítačů můžete do <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework</code> klíče registru přidat <code>REG_DWORD</code>ovou hodnotu s názvem <code>useLegacyJit</code>. Hodnota <code>1</code> povoluje starší 64 kompilátor JIT; hodnota <code>0</code> ji zakáže a povolí nový 64 kompilátor JIT.</li></ul>Můžete nám taky informovat o problému tím, že nahlásíte chybu na [Microsoft Connect](https://connect.microsoft.com/VisualStudio).|
|Rozsah|Edge|
|Version|4.6|
|Typ|Změna cílení|
