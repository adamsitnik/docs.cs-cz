---
ms.openlocfilehash: a9363750f8090434d0c304039330eff88e4748d7
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/18/2019
ms.locfileid: "59234404"
---
### <a name="new-64-bit-jit-compiler-in-the-net-framework-46"></a><span data-ttu-id="61283-101">Nový 64bitový kompilátor JIT v rozhraní .NET Framework 4.6</span><span class="sxs-lookup"><span data-stu-id="61283-101">New 64-bit JIT compiler in the .NET Framework 4.6</span></span>

|   |   |
|---|---|
|<span data-ttu-id="61283-102">Podrobnosti</span><span class="sxs-lookup"><span data-stu-id="61283-102">Details</span></span>|<span data-ttu-id="61283-103">Od verze rozhraní .NET Framework 4.6, se používá nový 64bitový kompilátor JIT kompilace just-in-time.</span><span class="sxs-lookup"><span data-stu-id="61283-103">Starting with the .NET Framework 4.6, a new 64-bit JIT compiler is used for just-in-time compilation.</span></span> <span data-ttu-id="61283-104">V některých případech dojde k neočekávané výjimce nebo než nezaznamenáme různé chování aplikace při spuštění pomocí 32bitové verze kompilátoru nebo starší 64bitovým kompilátorem JIT.</span><span class="sxs-lookup"><span data-stu-id="61283-104">In some cases, an unexpected exception is thrown or a different behavior is observed than if an app is run using the 32-bit compiler or the older 64-bit JIT compiler.</span></span> <span data-ttu-id="61283-105">Tato změna nemá vliv na 32-bit kompilátor JIT. Známé rozdíly patří následující:</span><span class="sxs-lookup"><span data-stu-id="61283-105">This change does not affect the 32-bit JIT compiler.The known differences include the following:</span></span><ul><li><span data-ttu-id="61283-106">Za určitých podmínek může vyvolat operace rozbalení <xref:System.NullReferenceException> v sestaveních pro vydání s optimalizací zapnuté.</span><span class="sxs-lookup"><span data-stu-id="61283-106">Under certain conditions, an unboxing operation may throw a <xref:System.NullReferenceException> in Release builds with optimization turned on.</span></span></li><li><span data-ttu-id="61283-107">V některých případech se může vyvolat provádění kódu v těle metody velké <xref:System.StackOverflowException>.</span><span class="sxs-lookup"><span data-stu-id="61283-107">In some cases, execution of production code in a large method body may throw a <xref:System.StackOverflowException>.</span></span></li><li><span data-ttu-id="61283-108">Za určitých podmínek struktury předáno metodě, jsou považovány za typy odkazů nikoli jako hodnota typy ve verzi sestavení.</span><span class="sxs-lookup"><span data-stu-id="61283-108">Under certain conditions, structures passed to a method are treated as reference types rather than as value types in Release builds.</span></span> <span data-ttu-id="61283-109">Jedním z projevy tento problém je, že jednotlivé položky v kolekci se zobrazí v neočekávaném pořadí.</span><span class="sxs-lookup"><span data-stu-id="61283-109">One of the manifestations of this issue is that the individual items in a collection appear in an unexpected order.</span></span></li><li><span data-ttu-id="61283-110">Za určitých podmínek, porovnání <xref:System.UInt16> hodnoty s jejich rozšířené nastavení je nesprávné v případě, že je povolena optimalizace.</span><span class="sxs-lookup"><span data-stu-id="61283-110">Under certain conditions, the comparison of <xref:System.UInt16> values with their high bit set is incorrect if optimization is enabled.</span></span></li><li><span data-ttu-id="61283-111">Za určitých podmínek, zejména při inicializaci pole hodnot, inicializace paměti <xref:System.Reflection.Emit.OpCodes.Initblk?displayProperty=nameWithType> instrukce IL může inicializovat paměť s nesprávnou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="61283-111">Under certain conditions, particularly when initializing array values, memory initialization by the <xref:System.Reflection.Emit.OpCodes.Initblk?displayProperty=nameWithType> IL instruction may initialize memory with an incorrect value.</span></span> <span data-ttu-id="61283-112">To může vést neošetřené výjimce nebo nesprávný výstup.</span><span class="sxs-lookup"><span data-stu-id="61283-112">This can result either in an unhandled exception or incorrect output.</span></span></li><li><span data-ttu-id="61283-113">Za určitých podmínek výjimečných bit podmíněný test může vrátit nesprávná <xref:System.Boolean> hodnotu nebo vyvolat výjimku, pokud jsou povolené optimalizace kompilátoru.</span><span class="sxs-lookup"><span data-stu-id="61283-113">Under certain rare conditions, a conditional bit test can return the incorrect <xref:System.Boolean> value or throw an exception if compiler optimizations are enabled.</span></span></li><li><span data-ttu-id="61283-114">Za určitých podmínek Pokud <code>if</code> příkaz slouží k otestování pro podmínku před vstupem <code>try</code> bloku a ve výstupu z <code>try</code> bloku a stejná podmínka je vyhodnocena v <code>catch</code> nebo <code>finally</code> bloku, nové Odebere 64bitového JIT kompilátoru <code>if</code> podmínky z <code>catch</code> nebo <code>finally</code> blokovat, pokud optimalizuje kód.</span><span class="sxs-lookup"><span data-stu-id="61283-114">Under certain conditions, if an <code>if</code> statement is used to test for a condition before entering  a <code>try</code> block and in the exit from the <code>try</code> block, and the same condition is evaluated in the <code>catch</code> or <code>finally</code> block, the new 64-bit JIT compiler removes the <code>if</code> condition from the <code>catch</code> or <code>finally</code> block when it optimizes code.</span></span> <span data-ttu-id="61283-115">V důsledku toho kód <code>if</code> příkaz v <code>catch</code> nebo <code>finally</code> bloku je bezpodmínečně provedeny.</span><span class="sxs-lookup"><span data-stu-id="61283-115">As a result, code inside the <code>if</code> statement in the <code>catch</code> or <code>finally</code> block is executed unconditionally.</span></span></li></ul>|
|<span data-ttu-id="61283-116">Doporučení</span><span class="sxs-lookup"><span data-stu-id="61283-116">Suggestion</span></span>|<span data-ttu-id="61283-117"><strong>Zmírnění dopadů známých problémů</strong></span><span class="sxs-lookup"><span data-stu-id="61283-117"><strong>Mitigation of known issues</strong></span></span> <br/> <span data-ttu-id="61283-118">Pokud narazíte na problémy uvedené výše, abyste mohli vyřešit pomocí některého z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="61283-118">If you encounter the issues listed above, you can address them by doing any of the following:</span></span><ul><li><span data-ttu-id="61283-119">Upgrade na rozhraní .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="61283-119">Upgrade to the .NET Framework 4.6.2.</span></span> <span data-ttu-id="61283-120">Nový 64bitový kompilátor rozhraní .NET Framework 4.6.2 je součástí adresy každé z těchto známých problémů.</span><span class="sxs-lookup"><span data-stu-id="61283-120">The new 64-bit compiler included with the .NET Framework 4.6.2 addresses each of these known issues.</span></span></li><li><span data-ttu-id="61283-121">Ujistěte se, že je vaše verze Windows aktuální spuštěním aktualizace Windows.</span><span class="sxs-lookup"><span data-stu-id="61283-121">Ensure that your version of Windows is up to date by running Windows Update.</span></span> <span data-ttu-id="61283-122">Aktualizace služeb rozhraní .NET Framework 4.6 a 4.6.1 se vztahují na všechny tyto problémy s výjimkou <xref:System.NullReferenceException> v operace rozbalení.</span><span class="sxs-lookup"><span data-stu-id="61283-122">Service updates to the .NET Framework 4.6 and 4.6.1 address each of these issues except the <xref:System.NullReferenceException> in an unboxing operation.</span></span></li><li><span data-ttu-id="61283-123">Kompilovat s starší 64bitovým kompilátorem JIT.</span><span class="sxs-lookup"><span data-stu-id="61283-123">Compile with the older 64-bit JIT compiler.</span></span> <span data-ttu-id="61283-124">Zobrazit <strong>zmírnění problémů s jinými problémy</strong> části Další informace o tom, jak to provést.</span><span class="sxs-lookup"><span data-stu-id="61283-124">See the <strong>Mitigation of other issues</strong> section for more information on how to do this.</span></span></li></ul><span data-ttu-id="61283-125"><strong>Zmírnění problémů s jinými problémy</strong></span><span class="sxs-lookup"><span data-stu-id="61283-125"><strong>Mitigation of other issues</strong></span></span> <br/> <span data-ttu-id="61283-126">Pokud narazíte na jakékoli další rozdíl v chování mezi kód zkompilovaný s starší 64bitovým kompilátorem a nového 64bitového kompilátoru JIT, nebo ladění a verze vydání aplikace, které jsou kompilovány pomocí nového 64bitového kompilátoru JIT, vám pomůžou následující aplikace s využitím starší 64bitového kompilátoru JIT kompilace:</span><span class="sxs-lookup"><span data-stu-id="61283-126">If you encounter any other difference in behavior between code compiled with the older 64-bit compiler and the new 64-bit JIT compiler, or between the debug and release versions of your app that are both compiled with the new 64-bit JIT compiler, you can do the following to compile your app with the older 64-bit JIT compiler:</span></span><ul><li><span data-ttu-id="61283-127">Na základě jednotlivých aplikací, můžete přidat [ < ](~/docs/framework/configure-apps/file-schema/runtime/uselegacyjit-element.md) prvku do konfiguračního souboru aplikace.</span><span class="sxs-lookup"><span data-stu-id="61283-127">On a per-application basis, you can add the [<](~/docs/framework/configure-apps/file-schema/runtime/uselegacyjit-element.md) element to your application's configuration file.</span></span> <span data-ttu-id="61283-128">Následující zakazuje kompilaci pomocí nového 64bitového kompilátoru JIT a místo toho používá starší verzi 64bitového kompilátoru JIT.</span><span class="sxs-lookup"><span data-stu-id="61283-128">The following disables compilation with the new 64-bit JIT compiler and instead uses the legacy 64-bit JIT compiler.</span></span></li></ul><pre><code class="lang-xml">&lt;?xml version =&quot;1.0&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;useLegacyJit enabled=&quot;1&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><ul><li><span data-ttu-id="61283-129">Na základě jednotlivých uživatelů můžete přidat <code>REG_DWORD</code> hodnotu s názvem <code>useLegacyJit</code> k <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework</code> klíče registru.</span><span class="sxs-lookup"><span data-stu-id="61283-129">On a per-user basis, you can add a <code>REG_DWORD</code> value named <code>useLegacyJit</code> to the <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework</code> key of the registry.</span></span> <span data-ttu-id="61283-130">Hodnota 1 povolí starší verzi kompilátoru JIT 64-bit; Hodnota 0 zakáže a umožňuje nové 64bitovým kompilátorem JIT.</span><span class="sxs-lookup"><span data-stu-id="61283-130">A value of 1 enables the legacy 64-bit JIT compiler; a value of 0 disables it and enables the new 64-bit JIT compiler.</span></span></li><li><span data-ttu-id="61283-131">Na základě vázaná na počítač, můžete přidat <code>REG_DWORD</code> hodnotu s názvem <code>useLegacyJit</code> k <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework</code> klíče registru.</span><span class="sxs-lookup"><span data-stu-id="61283-131">On a per-machine basis, you can add a <code>REG_DWORD</code> value named <code>useLegacyJit</code> to the <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework</code> key of the registry.</span></span> <span data-ttu-id="61283-132">Hodnota <code>1</code> kompilátor JIT umožňuje starší verze 64-bit; hodnota <code>0</code> zakáže a umožňuje nové 64bitovým kompilátorem JIT.</span><span class="sxs-lookup"><span data-stu-id="61283-132">A value of <code>1</code> enables the legacy 64-bit JIT compiler; a value of <code>0</code> disables it and enables the new 64-bit JIT compiler.</span></span></li></ul><span data-ttu-id="61283-133">Vám může také dejte nám vědět o problému pomocí hlášení chyby na [Microsoft Connect](https://connect.microsoft.com/VisualStudio).</span><span class="sxs-lookup"><span data-stu-id="61283-133">You can also let us know about the problem by reporting a bug on [Microsoft Connect](https://connect.microsoft.com/VisualStudio).</span></span>|
|<span data-ttu-id="61283-134">Rozsah</span><span class="sxs-lookup"><span data-stu-id="61283-134">Scope</span></span>|<span data-ttu-id="61283-135">Edge</span><span class="sxs-lookup"><span data-stu-id="61283-135">Edge</span></span>|
|<span data-ttu-id="61283-136">Version</span><span class="sxs-lookup"><span data-stu-id="61283-136">Version</span></span>|<span data-ttu-id="61283-137">4.6</span><span class="sxs-lookup"><span data-stu-id="61283-137">4.6</span></span>|
|<span data-ttu-id="61283-138">Type</span><span class="sxs-lookup"><span data-stu-id="61283-138">Type</span></span>|<span data-ttu-id="61283-139">Změna cílení</span><span class="sxs-lookup"><span data-stu-id="61283-139">Retargeting</span></span>|
