---
title: Bezpečně aktualizace pomocí výchozího členy rozhraní v rozhraníC#
description: Tento kurz pokročilé zkoumá, jak můžete bezpečně přidávat nové funkce do existující definice rozhraní bez narušení všechny třídy a struktury, které implementují rozhraní.
ms.date: 05/06/2019
ms.custom: mvc
ms.openlocfilehash: 2daa40ead5902454c6d45390233e1491fe6d369b
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/19/2019
ms.locfileid: "65877908"
---
# <a name="tutorial-update-interfaces-with-default-interface-members-in-c-80"></a><span data-ttu-id="56075-103">Kurz: Aktualizovat výchozí členy rozhraní v rozhraní C# 8.0</span><span class="sxs-lookup"><span data-stu-id="56075-103">Tutorial: Update interfaces with default interface members in C# 8.0</span></span>

<span data-ttu-id="56075-104">Počínaje C# 8.0 na .NET Core 3.0, můžete definovat implementaci při deklaraci člena rozhraní.</span><span class="sxs-lookup"><span data-stu-id="56075-104">Beginning with C# 8.0 on .NET Core 3.0, you can define an implementation when you declare a member of an interface.</span></span> <span data-ttu-id="56075-105">Nejběžnější scénář je bezpečně přidávat členy do rozhraní už vydali a používají klienti innumerable.</span><span class="sxs-lookup"><span data-stu-id="56075-105">The most common scenario is to safely add members to an interface already released and used by innumerable clients.</span></span>

<span data-ttu-id="56075-106">V tomto kurzu se dozvíte jak:</span><span class="sxs-lookup"><span data-stu-id="56075-106">In this tutorial, you'll learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="56075-107">Bezpečně rozšiřte rozhraní přidáním metod s implementací.</span><span class="sxs-lookup"><span data-stu-id="56075-107">Extend interfaces safely by adding methods with implementations.</span></span>
> * <span data-ttu-id="56075-108">Vytvoření parametrizovaných implementace poskytují větší flexibilitu.</span><span class="sxs-lookup"><span data-stu-id="56075-108">Create parameterized implementations to provide greater flexibility.</span></span>
> * <span data-ttu-id="56075-109">Umožňují implementátorům k dispozici konkrétnější implementace v podobě přepsání.</span><span class="sxs-lookup"><span data-stu-id="56075-109">Enable implementers to provide a more specific implementation in the form of an override.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="56075-110">Požadavky</span><span class="sxs-lookup"><span data-stu-id="56075-110">Prerequisites</span></span>

<span data-ttu-id="56075-111">Budete muset nastavit počítač pro spuštění .NET Core, včetně C# kompilátoru 8.0 ve verzi preview.</span><span class="sxs-lookup"><span data-stu-id="56075-111">You’ll need to set up your machine to run .NET Core, including the C# 8.0 preview compiler.</span></span> <span data-ttu-id="56075-112">C# 8.0 kompilátoru ve verzi preview je k dispozici počínaje [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019), nebo si prohlédnout nejnovější [.NET Core 3.0 ve verzi preview SDK](https://dotnet.microsoft.com/download/dotnet-core/3.0).</span><span class="sxs-lookup"><span data-stu-id="56075-112">The C# 8.0 preview compiler is available starting with [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019), or the latest [.NET Core 3.0 preview SDK](https://dotnet.microsoft.com/download/dotnet-core/3.0).</span></span> <span data-ttu-id="56075-113">Výchozí členy rozhraní jsou k dispozici od verze .NET Core 3.0 ve verzi preview 4.</span><span class="sxs-lookup"><span data-stu-id="56075-113">Default interface members are available beginning with .NET Core 3.0 preview 4.</span></span>

## <a name="scenario-overview"></a><span data-ttu-id="56075-114">Přehled scénářů</span><span class="sxs-lookup"><span data-stu-id="56075-114">Scenario overview</span></span>

<span data-ttu-id="56075-115">Tento kurz pracuje s verzí 1 knihovnu vztah zákazníků.</span><span class="sxs-lookup"><span data-stu-id="56075-115">This tutorial starts with version 1 of a customer relationship library.</span></span> <span data-ttu-id="56075-116">Startovní aplikace můžete získat naše [úložišti na Githubu ukázky](https://github.com/dotnet/samples/tree/master/csharp/tutorials/default-interface-members-versions/starter/customer-relationship).</span><span class="sxs-lookup"><span data-stu-id="56075-116">You can get the starter application on our [samples repo on GitHub](https://github.com/dotnet/samples/tree/master/csharp/tutorials/default-interface-members-versions/starter/customer-relationship).</span></span> <span data-ttu-id="56075-117">Společnost, která je vytvořená tuto knihovnu určené zákazníkům se stávajícími aplikacemi a přijmout jejich knihovny.</span><span class="sxs-lookup"><span data-stu-id="56075-117">The company that built this library intended customers with existing applications to adopt their library.</span></span> <span data-ttu-id="56075-118">Poskytnou definice minimální rozhraní pro uživatele jejich knihovny k implementaci.</span><span class="sxs-lookup"><span data-stu-id="56075-118">They provided minimal interface definitions for users of their library to implement.</span></span> <span data-ttu-id="56075-119">Tady je definice rozhraní pro zákazníka:</span><span class="sxs-lookup"><span data-stu-id="56075-119">Here's the interface definition for a customer:</span></span>

[!code-csharp[InitialCustomerInterface](~/samples/csharp/tutorials/default-interface-members-versions/starter/customer-relationship/ICustomer.cs?name=SnippetICustomerVersion1)]

<span data-ttu-id="56075-120">Jsou definovány druhé rozhraní, která představuje pořadí:</span><span class="sxs-lookup"><span data-stu-id="56075-120">They defined a second interface that represents an order:</span></span>

[!code-csharp[InitialOrderInterface](~/samples/csharp/tutorials/default-interface-members-versions/starter/customer-relationship/IOrder.cs?name=SnippetIorderVersion1)]

<span data-ttu-id="56075-121">Z těchto rozhraní může tým sestavení knihovny pro jejich uživatelům vytvářet lepší prostředí pro zákazníky.</span><span class="sxs-lookup"><span data-stu-id="56075-121">From those interfaces, the team could build a library for their users to create a better experience for their customers.</span></span> <span data-ttu-id="56075-122">Jeho cílem bylo vytvořit podrobnější relaci se stávající zákazníky a zvýšit jejich vztahy s novým zákazníkům.</span><span class="sxs-lookup"><span data-stu-id="56075-122">Their goal was to create a deeper relationship with existing customers and improve their relationships with new customers.</span></span>

<span data-ttu-id="56075-123">Nyní je doba pro upgrade knihovny pro další verzi.</span><span class="sxs-lookup"><span data-stu-id="56075-123">Now, it's time to upgrade the library for the next release.</span></span> <span data-ttu-id="56075-124">Mezi požadované funkce pro zákazníky, kteří mají velké množství objednávek umožňuje slevu věrnostních programů.</span><span class="sxs-lookup"><span data-stu-id="56075-124">One of the requested features enables a loyalty discount for customers that have lots of orders.</span></span> <span data-ttu-id="56075-125">Tento nový věrnostní získá sleva pokaždé, když zákazník zadá objednávku.</span><span class="sxs-lookup"><span data-stu-id="56075-125">This new loyalty discount gets applied whenever a customer makes an order.</span></span> <span data-ttu-id="56075-126">Konkrétní sleva je vlastnost pro každého zákazníka.</span><span class="sxs-lookup"><span data-stu-id="56075-126">The specific discount is a property of each individual customer.</span></span> <span data-ttu-id="56075-127">Každá implementace ICustomer můžete nastavit různá pravidla slevu věrnostních programů.</span><span class="sxs-lookup"><span data-stu-id="56075-127">Each implementation of ICustomer can set different rules for the loyalty discount.</span></span> 

<span data-ttu-id="56075-128">Většina přirozený způsob, jak přidat tato funkce je k vylepšení `ICustomer` rozhraní se způsob, jak použít případné slevy věrnostních programů.</span><span class="sxs-lookup"><span data-stu-id="56075-128">The most natural way to add this functionality is to enhance the `ICustomer` interface with a method to apply any loyalty discount.</span></span> <span data-ttu-id="56075-129">Tento návrh návrh způsobila problém mezi zkušené vývojáře: "Rozhraní jsou neměnné, když jsme vydali!</span><span class="sxs-lookup"><span data-stu-id="56075-129">This design suggestion caused concern among experienced developers: "Interfaces are immutable once they've been released!</span></span> <span data-ttu-id="56075-130">Toto je zásadní změnu."</span><span class="sxs-lookup"><span data-stu-id="56075-130">This is a breaking change!"</span></span> <span data-ttu-id="56075-131">C#Přidá 8.0 *výchozí implementace rozhraní* pro upgrade rozhraní.</span><span class="sxs-lookup"><span data-stu-id="56075-131">C# 8.0 adds *default interface implementations* for upgrading interfaces.</span></span> <span data-ttu-id="56075-132">Autoři knihovny můžete přidat nové členy rozhraní a poskytuje výchozí implementaci pro ty členy.</span><span class="sxs-lookup"><span data-stu-id="56075-132">The library authors can add new members to the interface and provide a default implementation for those members.</span></span>

<span data-ttu-id="56075-133">Výchozí implementace rozhraní umožňují vývojářům upgrade rozhraní ale žádné implementors pro tuto implementaci přepsat.</span><span class="sxs-lookup"><span data-stu-id="56075-133">Default interface implementations enable developers to upgrade an interface while still enabling any implementors to override that implementation.</span></span> <span data-ttu-id="56075-134">Uživatelé knihovny můžete přijmout výchozí implementace jako nevýznamných změn.</span><span class="sxs-lookup"><span data-stu-id="56075-134">Users of the library can accept the default implementation as a non-breaking change.</span></span> <span data-ttu-id="56075-135">Pokud se liší jejich obchodních pravidel, můžete přepsat.</span><span class="sxs-lookup"><span data-stu-id="56075-135">If their business rules are different, they can override.</span></span>

## <a name="upgrade-with-default-interface-members"></a><span data-ttu-id="56075-136">Upgrade s výchozí členy rozhraní</span><span class="sxs-lookup"><span data-stu-id="56075-136">Upgrade with default interface members</span></span>

<span data-ttu-id="56075-137">Tým dohodl na maximum pravděpodobně výchozí implementace: slevu loajalitu zákazníků.</span><span class="sxs-lookup"><span data-stu-id="56075-137">The team agreed on the most likely default implementation: a loyalty discount for customers.</span></span>

<span data-ttu-id="56075-138">Upgrade by zajišťovat funkce můžete nastavit dvě vlastnosti: počet objednávek, které jsou potřebné k dosažení nárok slevu a procento slevy.</span><span class="sxs-lookup"><span data-stu-id="56075-138">The upgrade should provide the functionality to set two properties: the number of orders needed to be eligible for the discount, and the percentage of the discount.</span></span> <span data-ttu-id="56075-139">Díky tomu je ideální scénář pro členy výchozí rozhraní.</span><span class="sxs-lookup"><span data-stu-id="56075-139">This makes it a perfect scenario for default interface members.</span></span> <span data-ttu-id="56075-140">Můžete přidat metodu rozhraní ICustomer a pravděpodobně implementaci.</span><span class="sxs-lookup"><span data-stu-id="56075-140">You can add a method to the ICustomer interface, and provide the most likely implementation.</span></span> <span data-ttu-id="56075-141">Všechny existující a všechny nové implementace můžete použít výchozí implementace nebo zadat vlastní.</span><span class="sxs-lookup"><span data-stu-id="56075-141">All existing, and any new implementations can use the default implementation, or provide their own.</span></span>

<span data-ttu-id="56075-142">Nejprve přidejte nové metody pro implementaci:</span><span class="sxs-lookup"><span data-stu-id="56075-142">First, add the new method to the implementation:</span></span>

[!code-csharp[InitialOrderInterface](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/ICustomer.cs?name=SnippetLoyaltyDiscountVersionOne)]

<span data-ttu-id="56075-143">Autor knihovny napsal prvního testu ke kontrole implementace:</span><span class="sxs-lookup"><span data-stu-id="56075-143">The library author wrote a first test to check the implementation:</span></span>

[!code-csharp[TestDefaultImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/Program.cs?name=SnippetTestDefaultImplementation)]

<span data-ttu-id="56075-144">Všimněte si následující část testu:</span><span class="sxs-lookup"><span data-stu-id="56075-144">Notice the following portion of the test:</span></span>

[!code-csharp[TestDefaultImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/Program.cs?name=SnippetHighlightCast)]

<span data-ttu-id="56075-145">Který přetypování z `SampleCustomer` k `ICustomer` je nezbytné.</span><span class="sxs-lookup"><span data-stu-id="56075-145">That cast from `SampleCustomer` to `ICustomer` is necessary.</span></span> <span data-ttu-id="56075-146">`SampleCustomer` Třídy nemusí poskytovat implementaci pro `ComputeLoyaltyDiscount`; který poskytuje `ICustomer` rozhraní.</span><span class="sxs-lookup"><span data-stu-id="56075-146">The `SampleCustomer` class doesn't need to provide an implementation for `ComputeLoyaltyDiscount`; that's provided by the `ICustomer` interface.</span></span> <span data-ttu-id="56075-147">Ale `SampleCustomer` Třída nedědí členy z jeho rozhraní.</span><span class="sxs-lookup"><span data-stu-id="56075-147">However, the `SampleCustomer` class doesn't inherit members from its interfaces.</span></span> <span data-ttu-id="56075-148">Toto pravidlo se nezměnil.</span><span class="sxs-lookup"><span data-stu-id="56075-148">That rule hasn't changed.</span></span> <span data-ttu-id="56075-149">Aby bylo možné volat jakékoli metodu deklarovat a implementovat rozhraní, musí být proměnná typu rozhraní, `ICustomer` v tomto příkladu.</span><span class="sxs-lookup"><span data-stu-id="56075-149">In order to call any method declared and implemented in the interface, the variable must be the type of the interface, `ICustomer` in this example.</span></span>

## <a name="provide-parameterization"></a><span data-ttu-id="56075-150">Zadejte Parametrizace</span><span class="sxs-lookup"><span data-stu-id="56075-150">Provide parameterization</span></span>

<span data-ttu-id="56075-151">To je dobrý začátek.</span><span class="sxs-lookup"><span data-stu-id="56075-151">That's a good start.</span></span> <span data-ttu-id="56075-152">Ale výchozí implementace je příliš omezující.</span><span class="sxs-lookup"><span data-stu-id="56075-152">But, the default implementation is too restrictive.</span></span> <span data-ttu-id="56075-153">Mnoho příjemci tohoto systému rozhodnout různé prahové hodnoty pro číslo nákupy, jinou délku členství nebo jiné procento slevy.</span><span class="sxs-lookup"><span data-stu-id="56075-153">Many consumers of this system may choose different thresholds for number of purchases, a different length of membership, or a different percentage discount.</span></span> <span data-ttu-id="56075-154">Pro větší počet zákazníků tím, že poskytuje způsob, jak nastavit tyto parametry můžete zadat lepší prostředí pro upgrade.</span><span class="sxs-lookup"><span data-stu-id="56075-154">You can provide a better upgrade experience for more customers by providing a way to set those parameters.</span></span> <span data-ttu-id="56075-155">Přidejme statická metoda, která nastaví tyto tři parametry řízení výchozí implementace:</span><span class="sxs-lookup"><span data-stu-id="56075-155">Let's add a static method that sets those three parameters controlling the default implementation:</span></span>

[!code-csharp[VersionTwoImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/ICustomer.cs?name=SnippetLoyaltyDiscountVersionTwo)]

<span data-ttu-id="56075-156">Existuje mnoho nových funkcí jazyka uvedené v tomto fragmentu malý kód.</span><span class="sxs-lookup"><span data-stu-id="56075-156">There's many new language capabilities shown in that small code fragment.</span></span> <span data-ttu-id="56075-157">Rozhraní teď může obsahovat statické členy, včetně polí a metod.</span><span class="sxs-lookup"><span data-stu-id="56075-157">Interfaces can now include static members, including fields and methods.</span></span> <span data-ttu-id="56075-158">Modifikátory přístupu různých jsou také povoleny.</span><span class="sxs-lookup"><span data-stu-id="56075-158">Different access modifiers are also enabled.</span></span> <span data-ttu-id="56075-159">Další pole jsou privátní, nová metoda je veřejná.</span><span class="sxs-lookup"><span data-stu-id="56075-159">The additional fields are private, the new method is public.</span></span> <span data-ttu-id="56075-160">Pro členy rozhraní jsou povoleny žádné modifikátory.</span><span class="sxs-lookup"><span data-stu-id="56075-160">Any of the modifiers are allowed on interface members.</span></span>

<span data-ttu-id="56075-161">Aplikace, které používají obecné vzorce pro výpočet věrnostní slevy, ale jiné parametry, není potřeba zadávat vlastní implementaci; argumenty, můžete nastavit pomocí statické metody.</span><span class="sxs-lookup"><span data-stu-id="56075-161">Applications that use the general formula for computing the loyalty discount, but different parameters, don't need to provide a custom implementation; they can set the arguments through a static method.</span></span> <span data-ttu-id="56075-162">Například následující kód nastaví "zákazník zhodnocení", který odměňuje každý zákazník s více než jeden měsíc členství:</span><span class="sxs-lookup"><span data-stu-id="56075-162">For example, the following code sets a "customer appreciation" that rewards any customer with more than one month's membership:</span></span>

[!code-csharp[SetLoyaltyThresholds](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/Program.cs?name=SnippetSetLoyaltyThresholds)]

## <a name="extend-the-default-implementation"></a><span data-ttu-id="56075-163">Rozšířit výchozí implementace</span><span class="sxs-lookup"><span data-stu-id="56075-163">Extend the default implementation</span></span>

<span data-ttu-id="56075-164">Kód, který jste přidali zatím poskytuje praktické implementace pro tyto scénáře, ve kterém uživatelé chtějí něco jako výchozí implementace nebo k poskytování nesouvisející sady pravidel.</span><span class="sxs-lookup"><span data-stu-id="56075-164">The code you've added so far has provided a convenient implementation for those scenarios where users want something like the default implementation, or to provide an unrelated set of rules.</span></span> <span data-ttu-id="56075-165">Poslední funkci Pojďme Refaktorovat kód o něco k povolení scénářů, kde mohou uživatelé chtějí na výchozí implementaci.</span><span class="sxs-lookup"><span data-stu-id="56075-165">For a final feature, let's refactor the code a bit to enable scenarios where users may want to build on the default implementation.</span></span> 

<span data-ttu-id="56075-166">Vezměte v úvahu při spuštění, který chce, aby se umožnilo přilákat nové zákazníky.</span><span class="sxs-lookup"><span data-stu-id="56075-166">Consider a startup that wants to attract new customers.</span></span> <span data-ttu-id="56075-167">Nabízejí 50 % slevu z první pořadí nového zákazníka.</span><span class="sxs-lookup"><span data-stu-id="56075-167">They offer a 50% discount off a new customer's first order.</span></span> <span data-ttu-id="56075-168">V opačném případě stávající zákazníci získat standardní slevy.</span><span class="sxs-lookup"><span data-stu-id="56075-168">Otherwise, existing customers get the standard discount.</span></span> <span data-ttu-id="56075-169">Autor knihovny se musí přesunout do výchozí implementace `protected static` metodu tak, že třída implementace tohoto rozhraní můžete opakovaně používat kód v jejich provádění.</span><span class="sxs-lookup"><span data-stu-id="56075-169">The library author needs to move the default implementation into a `protected static` method so that any class implementing this interface can reuse the code in their implementation.</span></span> <span data-ttu-id="56075-170">Výchozí implementace členů rozhraní volá tuto sdílenou metodu:</span><span class="sxs-lookup"><span data-stu-id="56075-170">The default implementation of the interface member calls this shared method as well:</span></span>

[!code-csharp[VersionTwoImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/ICustomer.cs?name=SnippetFinalVersion)]

<span data-ttu-id="56075-171">V implementaci třídy, která implementuje toto rozhraní, přepsání můžete volat metodu statické pomocné rutiny a rozšířit tuto logiku pro poskytování "nového zákazníka" slevy:</span><span class="sxs-lookup"><span data-stu-id="56075-171">In an implementation of a class that implements this interface, the override can call the static helper method, and extend that logic to provide the "new customer" discount:</span></span>

[!code-csharp[VersionTwoImplementation](~/samples/csharp/tutorials/default-interface-members-versions/finished/customer-relationship/SampleCustomer.cs?name=SnippetOverrideAndExtend)]

<span data-ttu-id="56075-172">Zobrazí celý Dokončený kód v našich [ukázky úložišti na Githubu] (Startovní aplikace můžete získat naše [úložišti na Githubu ukázky](https://github.com/dotnet/samples/tree/master/csharp/tutorials/default-interface-members-versions/finished/customer-relationship).</span><span class="sxs-lookup"><span data-stu-id="56075-172">You can see the entire finished code in our [samples repo on GitHub](You can get the starter application on our [samples repo on GitHub](https://github.com/dotnet/samples/tree/master/csharp/tutorials/default-interface-members-versions/finished/customer-relationship).</span></span>

<span data-ttu-id="56075-173">Tyto nové funkce znamená, že rozhraní můžete aktualizovat bezpečně po implementaci přiměřené výchozí hodnoty pro nové členy.</span><span class="sxs-lookup"><span data-stu-id="56075-173">These new features mean that interfaces can be updated safely when there's a reasonable default implementation for those new members.</span></span> <span data-ttu-id="56075-174">Pečlivě Navrhněte rozhraní express jeden funkční nápady, které může být implementována více tříd.</span><span class="sxs-lookup"><span data-stu-id="56075-174">Carefully design interfaces to express single functional ideas that can be implemented by multiple classes.</span></span> <span data-ttu-id="56075-175">Který usnadňuje upgradovat tyto definice rozhraní při zjištění nových požadavků pro tento stejný funkční nápad.</span><span class="sxs-lookup"><span data-stu-id="56075-175">That makes it easier to upgrade those interface definitions when new requirements are discovered for that same functional idea.</span></span>
