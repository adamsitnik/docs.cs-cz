---
title: Model asynchronního programování (APM)
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- ending asynchronous operations
- starting asynchronous operations
- beginning asynchronous operations
- asynchronous programming, ending operations
- asynchronous programming
- stopping asynchronous operations
- asynchronous programming, beginning operations
ms.assetid: c9b3501e-6bc6-40f9-8efd-4b6d9e39ccf0
ms.openlocfilehash: 0a9ea3c8c9c589bb5954fa9771ffd1bb095f6d73
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/30/2019
ms.locfileid: "73140139"
---
# <a name="asynchronous-programming-model-apm"></a><span data-ttu-id="2e54a-102">Model asynchronního programování (APM)</span><span class="sxs-lookup"><span data-stu-id="2e54a-102">Asynchronous Programming Model (APM)</span></span>
<span data-ttu-id="2e54a-103">Asynchronní operace, která používá model návrhu <xref:System.IAsyncResult>, je implementována jako dvě metody s názvem `BeginOperationName` a `EndOperationName`, které začínají a končí *operací* asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-103">An asynchronous operation that uses the <xref:System.IAsyncResult> design pattern is implemented as two methods named `BeginOperationName` and `EndOperationName` that begin and end the asynchronous operation *OperationName* respectively.</span></span> <span data-ttu-id="2e54a-104">Například třída <xref:System.IO.FileStream> poskytuje metody <xref:System.IO.FileStream.BeginRead%2A> a <xref:System.IO.FileStream.EndRead%2A> pro asynchronní čtení bajtů ze souboru.</span><span class="sxs-lookup"><span data-stu-id="2e54a-104">For example, the <xref:System.IO.FileStream> class provides the <xref:System.IO.FileStream.BeginRead%2A> and <xref:System.IO.FileStream.EndRead%2A> methods to asynchronously read bytes from a file.</span></span> <span data-ttu-id="2e54a-105">Tyto metody implementují asynchronní verzi metody <xref:System.IO.FileStream.Read%2A>.</span><span class="sxs-lookup"><span data-stu-id="2e54a-105">These methods implement the asynchronous version of the <xref:System.IO.FileStream.Read%2A> method.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2e54a-106">Počínaje .NET Framework 4 poskytuje úloha paralelní knihovna nový model pro asynchronní a paralelní programování.</span><span class="sxs-lookup"><span data-stu-id="2e54a-106">Starting with the .NET Framework 4, the Task Parallel Library provides a new model for asynchronous and parallel programming.</span></span> <span data-ttu-id="2e54a-107">Další informace naleznete v tématu [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) a [asynchronní vzor založený na úlohách (klepněte)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)).</span><span class="sxs-lookup"><span data-stu-id="2e54a-107">For more information, see [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) and [Task-based Asynchronous Pattern (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)).</span></span>  
  
 <span data-ttu-id="2e54a-108">Po volání `BeginOperationName`může aplikace pokračovat ve zpracování instrukcí volajícího vlákna, zatímco asynchronní operace probíhá v jiném vlákně.</span><span class="sxs-lookup"><span data-stu-id="2e54a-108">After calling `BeginOperationName`, an application can continue executing instructions on the calling thread while the asynchronous operation takes place on a different thread.</span></span> <span data-ttu-id="2e54a-109">Pro každé volání `BeginOperationName`by měla aplikace také volat `EndOperationName`, aby získala výsledky operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-109">For each call to `BeginOperationName`, the application should also call `EndOperationName` to get the results of the operation.</span></span>  
  
## <a name="beginning-an-asynchronous-operation"></a><span data-ttu-id="2e54a-110">Zahájení asynchronní operace</span><span class="sxs-lookup"><span data-stu-id="2e54a-110">Beginning an Asynchronous Operation</span></span>  
 <span data-ttu-id="2e54a-111">Metoda `BeginOperationName` zahájí asynchronní operaci *Operational a vrátí* objekt, který implementuje rozhraní <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="2e54a-111">The `BeginOperationName` method begins asynchronous operation *OperationName* and returns an object that implements the <xref:System.IAsyncResult> interface.</span></span> <span data-ttu-id="2e54a-112"><xref:System.IAsyncResult> objekty ukládají informace o asynchronní operaci.</span><span class="sxs-lookup"><span data-stu-id="2e54a-112"><xref:System.IAsyncResult> objects store information about an asynchronous operation.</span></span> <span data-ttu-id="2e54a-113">Následující tabulka obsahuje informace o asynchronní operaci.</span><span class="sxs-lookup"><span data-stu-id="2e54a-113">The following table shows information about an asynchronous operation.</span></span>  
  
|<span data-ttu-id="2e54a-114">Člen</span><span class="sxs-lookup"><span data-stu-id="2e54a-114">Member</span></span>|<span data-ttu-id="2e54a-115">Popis</span><span class="sxs-lookup"><span data-stu-id="2e54a-115">Description</span></span>|  
|------------|-----------------|  
|<xref:System.IAsyncResult.AsyncState%2A>|<span data-ttu-id="2e54a-116">Volitelný objekt specifický pro aplikaci, který obsahuje informace o asynchronní operaci.</span><span class="sxs-lookup"><span data-stu-id="2e54a-116">An optional application-specific object that contains information about the asynchronous operation.</span></span>|  
|<xref:System.IAsyncResult.AsyncWaitHandle%2A>|<span data-ttu-id="2e54a-117"><xref:System.Threading.WaitHandle>, které lze použít k blokování provádění aplikace, dokud se asynchronní operace nedokončí.</span><span class="sxs-lookup"><span data-stu-id="2e54a-117">A <xref:System.Threading.WaitHandle> that can be used to block application execution until the asynchronous operation completes.</span></span>|  
|<xref:System.IAsyncResult.CompletedSynchronously%2A>|<span data-ttu-id="2e54a-118">Hodnota, která označuje, zda byla asynchronní operace dokončena ve vlákně použitém pro volání `BeginOperationName` namísto dokončení na samostatném vlákně <xref:System.Threading.ThreadPool>.</span><span class="sxs-lookup"><span data-stu-id="2e54a-118">A value that indicates whether the asynchronous operation completed on the thread used to call `BeginOperationName` instead of completing on a separate <xref:System.Threading.ThreadPool> thread.</span></span>|  
|<xref:System.IAsyncResult.IsCompleted%2A>|<span data-ttu-id="2e54a-119">Hodnota, která označuje, zda byla asynchronní operace dokončena.</span><span class="sxs-lookup"><span data-stu-id="2e54a-119">A value that indicates whether the asynchronous operation has completed.</span></span>|  
  
 <span data-ttu-id="2e54a-120">Metoda `BeginOperationName` přebírá všechny parametry deklarované v signatuře synchronní verze metody, která je předána hodnotou nebo odkazem.</span><span class="sxs-lookup"><span data-stu-id="2e54a-120">A `BeginOperationName` method takes any parameters declared in the signature of the synchronous version of the method that are passed by value or by reference.</span></span> <span data-ttu-id="2e54a-121">Parametry out nejsou součástí signatury metody `BeginOperationName`.</span><span class="sxs-lookup"><span data-stu-id="2e54a-121">Any out parameters are not part of the `BeginOperationName` method signature.</span></span> <span data-ttu-id="2e54a-122">Signatura metody `BeginOperationName` také obsahuje dva další parametry.</span><span class="sxs-lookup"><span data-stu-id="2e54a-122">The `BeginOperationName` method signature also includes two additional parameters.</span></span> <span data-ttu-id="2e54a-123">První z nich definuje delegáta <xref:System.AsyncCallback>, který odkazuje na metodu, která je volána po dokončení asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-123">The first of these defines an <xref:System.AsyncCallback> delegate that references a method that is called when the asynchronous operation completes.</span></span> <span data-ttu-id="2e54a-124">Volající může určit `null` (`Nothing` v Visual Basic), pokud nechce, aby metoda vyvolala po dokončení operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-124">The caller can specify `null` (`Nothing` in Visual Basic) if it does not want a method invoked when the operation completes.</span></span> <span data-ttu-id="2e54a-125">Druhým dalším parametrem je objekt definovaný uživatelem.</span><span class="sxs-lookup"><span data-stu-id="2e54a-125">The second additional parameter is a user-defined object.</span></span> <span data-ttu-id="2e54a-126">Tento objekt lze použít k předání informací o stavu specifického pro aplikaci do metody vyvolané při dokončení asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-126">This object can be used to pass application-specific state information to the method invoked when the asynchronous operation completes.</span></span> <span data-ttu-id="2e54a-127">Pokud metoda `BeginOperationName` přebírá další parametry specifické pro operaci, jako je například bajtové pole pro uložení bajtů čtených ze souboru, objekt stavu <xref:System.AsyncCallback> a aplikace jsou poslední parametry v signatuře metody `BeginOperationName`.</span><span class="sxs-lookup"><span data-stu-id="2e54a-127">If a `BeginOperationName` method takes additional operation-specific parameters, such as a byte array to store bytes read from a file, the <xref:System.AsyncCallback> and application state object are the last parameters in the `BeginOperationName` method signature.</span></span>  
  
 <span data-ttu-id="2e54a-128">`BeginOperationName` vrátí řízení volajícímu vláknu okamžitě.</span><span class="sxs-lookup"><span data-stu-id="2e54a-128">`BeginOperationName` returns control to the calling thread immediately.</span></span> <span data-ttu-id="2e54a-129">Pokud metoda `BeginOperationName` vyvolá výjimky, výjimky jsou vyvolány před zahájením asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-129">If the `BeginOperationName` method throws exceptions, the exceptions are thrown before the asynchronous operation is started.</span></span> <span data-ttu-id="2e54a-130">Pokud metoda `BeginOperationName` vyvolá výjimky, metoda zpětného volání není vyvolána.</span><span class="sxs-lookup"><span data-stu-id="2e54a-130">If the `BeginOperationName` method throws exceptions, the callback method is not invoked.</span></span>  
  
## <a name="ending-an-asynchronous-operation"></a><span data-ttu-id="2e54a-131">Ukončení asynchronní operace</span><span class="sxs-lookup"><span data-stu-id="2e54a-131">Ending an Asynchronous Operation</span></span>  
 <span data-ttu-id="2e54a-132">Metoda `EndOperationName` ukončí *operaci operace*asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-132">The `EndOperationName` method ends asynchronous operation *OperationName*.</span></span> <span data-ttu-id="2e54a-133">Návratová hodnota metody `EndOperationName` je stejný typ vrácený jeho synchronním protějškem a je specifický pro asynchronní operaci.</span><span class="sxs-lookup"><span data-stu-id="2e54a-133">The return value of the `EndOperationName` method is the same type returned by its synchronous counterpart and is specific to the asynchronous operation.</span></span> <span data-ttu-id="2e54a-134">Například metoda <xref:System.IO.FileStream.EndRead%2A> vrátí počet přečtených bajtů z <xref:System.IO.FileStream> a metoda <xref:System.Net.Dns.EndGetHostByName%2A> vrátí objekt <xref:System.Net.IPHostEntry>, který obsahuje informace o hostitelském počítači.</span><span class="sxs-lookup"><span data-stu-id="2e54a-134">For example, the <xref:System.IO.FileStream.EndRead%2A> method returns the number of bytes read from a <xref:System.IO.FileStream> and the <xref:System.Net.Dns.EndGetHostByName%2A> method returns an <xref:System.Net.IPHostEntry> object that contains information about a host computer.</span></span> <span data-ttu-id="2e54a-135">Metoda `EndOperationName` přebírá jakékoli nebo ref parametry deklarované v signatuře synchronní verze metody.</span><span class="sxs-lookup"><span data-stu-id="2e54a-135">The `EndOperationName` method takes any out or ref parameters declared in the signature of the synchronous version of the method.</span></span> <span data-ttu-id="2e54a-136">Kromě parametrů z synchronní metody `EndOperationName` metoda také obsahuje parametr <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="2e54a-136">In addition to the parameters from the synchronous method, the `EndOperationName` method also includes an <xref:System.IAsyncResult> parameter.</span></span> <span data-ttu-id="2e54a-137">Volající musí předat instanci vrácenou odpovídajícím voláním `BeginOperationName`.</span><span class="sxs-lookup"><span data-stu-id="2e54a-137">Callers must pass the instance returned by the corresponding call to `BeginOperationName`.</span></span>  
  
 <span data-ttu-id="2e54a-138">Pokud asynchronní operace reprezentované objektem <xref:System.IAsyncResult> nebyla při volání `EndOperationName` dokončena, `EndOperationName` blokuje volající vlákno, dokud nebude dokončena asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-138">If the asynchronous operation represented by the <xref:System.IAsyncResult> object has not completed when `EndOperationName` is called, `EndOperationName` blocks the calling thread until the asynchronous operation is complete.</span></span> <span data-ttu-id="2e54a-139">Výjimky vyvolané asynchronní operací jsou vyvolány z metody `EndOperationName`.</span><span class="sxs-lookup"><span data-stu-id="2e54a-139">Exceptions thrown by the asynchronous operation are thrown from the `EndOperationName` method.</span></span> <span data-ttu-id="2e54a-140">Účinek volání metody `EndOperationName` několikrát se stejným <xref:System.IAsyncResult> není definován.</span><span class="sxs-lookup"><span data-stu-id="2e54a-140">The effect of calling the `EndOperationName` method multiple times with the same <xref:System.IAsyncResult> is not defined.</span></span> <span data-ttu-id="2e54a-141">Stejně tak volání metody `EndOperationName` s <xref:System.IAsyncResult>, která nebyla vrácena související metodou Begin, není definována také.</span><span class="sxs-lookup"><span data-stu-id="2e54a-141">Likewise, calling the `EndOperationName` method with an <xref:System.IAsyncResult> that was not returned by the related Begin method is also not defined.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2e54a-142">Pro některý z nedefinovaných scénářů by implementátor měli zvážit vyvolání <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="2e54a-142">For either of the undefined scenarios, implementers should consider throwing <xref:System.InvalidOperationException>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2e54a-143">Implementátori tohoto vzoru návrhu by měli oznámit volajícímu, že asynchronní operace byla dokončena, nastavením <xref:System.IAsyncResult.IsCompleted%2A> na hodnotu true, volání asynchronní metody zpětného volání (Pokud byla zadána) a signalizace <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span><span class="sxs-lookup"><span data-stu-id="2e54a-143">Implementers of this design pattern should notify the caller that the asynchronous operation completed by setting <xref:System.IAsyncResult.IsCompleted%2A> to true, calling the asynchronous callback method (if one was specified) and signaling the <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span></span>  
  
 <span data-ttu-id="2e54a-144">Vývojáři aplikací mají několik možností návrhu pro přístup k výsledkům asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-144">Application developers have several design choices for accessing the results of the asynchronous operation.</span></span> <span data-ttu-id="2e54a-145">Správná volba závisí na tom, zda má aplikace pokyny, které mohou být provedeny při dokončení operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-145">The correct choice depends on whether the application has instructions that can execute while the operation completes.</span></span> <span data-ttu-id="2e54a-146">Pokud aplikace nemůže provést žádnou další práci, dokud neobdrží výsledky asynchronní operace, aplikace musí blokovat, dokud nebudou k dispozici výsledky.</span><span class="sxs-lookup"><span data-stu-id="2e54a-146">If an application cannot perform any additional work until it receives the results of the asynchronous operation, the application must block until the results are available.</span></span> <span data-ttu-id="2e54a-147">Chcete-li zablokovat až po dokončení asynchronní operace, můžete použít jeden z následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="2e54a-147">To block until an asynchronous operation completes, you can use one of the following approaches:</span></span>  
  
- <span data-ttu-id="2e54a-148">Volání `EndOperationName` z hlavního vlákna aplikace, blokování spuštění aplikace až do dokončení operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-148">Call `EndOperationName` from the application’s main thread, blocking application execution until the operation is complete.</span></span> <span data-ttu-id="2e54a-149">Příklad, který znázorňuje tuto techniku, naleznete v tématu [blokování provádění aplikace ukončením asynchronní operace](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span><span class="sxs-lookup"><span data-stu-id="2e54a-149">For an example that illustrates this technique, see [Blocking Application Execution by Ending an Async Operation](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span></span>  
  
- <span data-ttu-id="2e54a-150">Použijte <xref:System.IAsyncResult.AsyncWaitHandle%2A> k blokování provádění aplikace, dokud nebude dokončena jedna nebo více operací.</span><span class="sxs-lookup"><span data-stu-id="2e54a-150">Use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> to block application execution until one or more operations are complete.</span></span> <span data-ttu-id="2e54a-151">Příklad, který znázorňuje tuto techniku, naleznete v tématu [blokování spuštění aplikace pomocí AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span><span class="sxs-lookup"><span data-stu-id="2e54a-151">For an example that illustrates this technique, see [Blocking Application Execution Using an AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span></span>  
  
 <span data-ttu-id="2e54a-152">Aplikace, které nepotřebují blokovat během dokončení asynchronní operace, mohou použít jeden z následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="2e54a-152">Applications that do not need to block while the asynchronous operation completes can use one of the following approaches:</span></span>  
  
- <span data-ttu-id="2e54a-153">Cyklické dotazování na stav dokončení operace zaškrtnutím vlastnosti <xref:System.IAsyncResult.IsCompleted%2A> pravidelně a volání `EndOperationName` po dokončení operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-153">Poll for operation completion status by checking the <xref:System.IAsyncResult.IsCompleted%2A> property periodically and calling `EndOperationName` when the operation is complete.</span></span> <span data-ttu-id="2e54a-154">Příklad, který znázorňuje tuto techniku, naleznete v tématu [cyklické dotazování na stav asynchronní operace](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="2e54a-154">For an example that illustrates this technique, see [Polling for the Status of an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span></span>  
  
- <span data-ttu-id="2e54a-155">Použijte delegáta <xref:System.AsyncCallback> k určení metody, která se má vyvolat po dokončení operace.</span><span class="sxs-lookup"><span data-stu-id="2e54a-155">Use an <xref:System.AsyncCallback> delegate to specify a method to be invoked when the operation is complete.</span></span> <span data-ttu-id="2e54a-156">Příklad, který znázorňuje tuto techniku, naleznete v tématu [použití delegáta AsyncCallback k ukončení asynchronní operace](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="2e54a-156">For an example that illustrates this technique, see [Using an AsyncCallback Delegate to End an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2e54a-157">Viz také:</span><span class="sxs-lookup"><span data-stu-id="2e54a-157">See also</span></span>

- [<span data-ttu-id="2e54a-158">Asynchronní vzor založený na událostech (EAP)</span><span class="sxs-lookup"><span data-stu-id="2e54a-158">Event-based Asynchronous Pattern (EAP)</span></span>](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)
- [<span data-ttu-id="2e54a-159">Asynchronní volání synchronních metod</span><span class="sxs-lookup"><span data-stu-id="2e54a-159">Calling Synchronous Methods Asynchronously</span></span>](../../../docs/standard/asynchronous-programming-patterns/calling-synchronous-methods-asynchronously.md)
- [<span data-ttu-id="2e54a-160">Použití delegáta AsyncCallback a stavového objektu</span><span class="sxs-lookup"><span data-stu-id="2e54a-160">Using an AsyncCallback Delegate and State Object</span></span>](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-and-state-object.md)
