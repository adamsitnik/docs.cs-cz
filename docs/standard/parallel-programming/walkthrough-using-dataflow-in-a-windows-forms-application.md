---
title: 'Návod: Použití toku dat ve formulářové aplikaci Windows'
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- TPL dataflow library, in Windows Forms
- Task Parallel Library, dataflows
- Windows Forms, and TPL
ms.assetid: 9c65cdf7-660c-409f-89ea-59d7ec8e127c
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: d0c9447e53a874da856eb59932ec3871a9a1371d
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/28/2019
ms.locfileid: "64654417"
---
# <a name="walkthrough-using-dataflow-in-a-windows-forms-application"></a><span data-ttu-id="41a1c-102">Návod: Použití toku dat ve formulářové aplikaci Windows</span><span class="sxs-lookup"><span data-stu-id="41a1c-102">Walkthrough: Using Dataflow in a Windows Forms Application</span></span>
<span data-ttu-id="41a1c-103">Tento dokument ukazuje, jak vytvořit síť bloků toku dat, které provádějí zpracování obrázků v aplikaci Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="41a1c-103">This document demonstrates how to create a network of dataflow blocks that perform image processing in a Windows Forms application.</span></span>  
  
 <span data-ttu-id="41a1c-104">Tento příklad načte soubory obrázků ve složce zadané, vytvoří bitovou kopii složené a zobrazí výsledek.</span><span class="sxs-lookup"><span data-stu-id="41a1c-104">This example loads image files from the specified folder, creates a composite image, and displays the result.</span></span> <span data-ttu-id="41a1c-105">V příkladu používá model toku dat pro trasu Image přes síť.</span><span class="sxs-lookup"><span data-stu-id="41a1c-105">The example uses the dataflow model to route images through the network.</span></span> <span data-ttu-id="41a1c-106">V toku dat modelu nezávislé komponenty aplikace mezi sebou komunikovat odesíláním zpráv.</span><span class="sxs-lookup"><span data-stu-id="41a1c-106">In the dataflow model, independent components of a program communicate with one another by sending messages.</span></span> <span data-ttu-id="41a1c-107">Když komponenta obdrží zprávu, provede určitou akci a jinou součást pak předá výsledek.</span><span class="sxs-lookup"><span data-stu-id="41a1c-107">When a component receives a message, it performs some action and then passes the result to another component.</span></span> <span data-ttu-id="41a1c-108">Porovnejte s model řízení toku, ve které aplikace používá řídicí struktury, například, podmíněné příkazy, smyčky a tak dále, k řízení pořadí operací v programu.</span><span class="sxs-lookup"><span data-stu-id="41a1c-108">Compare this with the control flow model, in which an application uses control structures, for example, conditional statements, loops, and so on, to control the order of operations in a program.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="41a1c-109">Požadavky</span><span class="sxs-lookup"><span data-stu-id="41a1c-109">Prerequisites</span></span>  
 <span data-ttu-id="41a1c-110">Čtení [toku dat](../../../docs/standard/parallel-programming/dataflow-task-parallel-library.md) před zahájením tohoto návodu.</span><span class="sxs-lookup"><span data-stu-id="41a1c-110">Read [Dataflow](../../../docs/standard/parallel-programming/dataflow-task-parallel-library.md) before you start this walkthrough.</span></span>  

[!INCLUDE [tpl-install-instructions](../../../includes/tpl-install-instructions.md)]

## <a name="sections"></a><span data-ttu-id="41a1c-111">Oddíly</span><span class="sxs-lookup"><span data-stu-id="41a1c-111">Sections</span></span>  
 <span data-ttu-id="41a1c-112">Tento návod obsahuje následující části:</span><span class="sxs-lookup"><span data-stu-id="41a1c-112">This walkthrough contains the following sections:</span></span>  
  
- [<span data-ttu-id="41a1c-113">Vytvoření aplikace Windows Forms</span><span class="sxs-lookup"><span data-stu-id="41a1c-113">Creating the Windows Forms Application</span></span>](#winforms)  
  
- [<span data-ttu-id="41a1c-114">Vytvoření sítě toku dat</span><span class="sxs-lookup"><span data-stu-id="41a1c-114">Creating the Dataflow Network</span></span>](#network)  
  
- [<span data-ttu-id="41a1c-115">Připojení sítě toku dat v uživatelském rozhraní</span><span class="sxs-lookup"><span data-stu-id="41a1c-115">Connecting the Dataflow Network to the User Interface</span></span>](#ui)  
  
- [<span data-ttu-id="41a1c-116">Kompletní příklad</span><span class="sxs-lookup"><span data-stu-id="41a1c-116">The Complete Example</span></span>](#complete)  
  
<a name="winforms"></a>   
## <a name="creating-the-windows-forms-application"></a><span data-ttu-id="41a1c-117">Vytvoření aplikace Windows Forms</span><span class="sxs-lookup"><span data-stu-id="41a1c-117">Creating the Windows Forms Application</span></span>  
 <span data-ttu-id="41a1c-118">Tato část popisuje, jak vytvořit základní aplikaci Windows Forms a přidání ovládacích prvků do hlavního formuláře.</span><span class="sxs-lookup"><span data-stu-id="41a1c-118">This section describes how to create the basic Windows Forms application and add controls to the main form.</span></span>  
  
#### <a name="to-create-the-windows-forms-application"></a><span data-ttu-id="41a1c-119">Chcete-li vytvořit Windows Forms aplikace</span><span class="sxs-lookup"><span data-stu-id="41a1c-119">To Create the Windows Forms Application</span></span>  
  
1. <span data-ttu-id="41a1c-120">V sadě Visual Studio, vytvořit Visual C# nebo Visual Basic **formulářová aplikace Windows** projektu.</span><span class="sxs-lookup"><span data-stu-id="41a1c-120">In Visual Studio, create a Visual C# or Visual Basic **Windows Forms Application** project.</span></span> <span data-ttu-id="41a1c-121">V tomto dokumentu má projekt název `CompositeImages`.</span><span class="sxs-lookup"><span data-stu-id="41a1c-121">In this document, the project is named `CompositeImages`.</span></span>  
  
2. <span data-ttu-id="41a1c-122">V návrháři formuláře pro hlavní formulář Form1.cs (Form1.vb pro jazyk Visual Basic), přidejte <xref:System.Windows.Forms.ToolStrip> ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="41a1c-122">On the form designer for the main form, Form1.cs (Form1.vb for Visual Basic), add a <xref:System.Windows.Forms.ToolStrip> control.</span></span>  
  
3. <span data-ttu-id="41a1c-123">Přidat <xref:System.Windows.Forms.ToolStripButton> ovládací prvek <xref:System.Windows.Forms.ToolStrip> ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="41a1c-123">Add a <xref:System.Windows.Forms.ToolStripButton> control to the <xref:System.Windows.Forms.ToolStrip> control.</span></span> <span data-ttu-id="41a1c-124">Nastavte <xref:System.Windows.Forms.ToolStripItem.DisplayStyle%2A> vlastnost <xref:System.Windows.Forms.ToolStripItemDisplayStyle.Text> a <xref:System.Windows.Forms.ToolStripItem.Text%2A> vlastnost **vybrat složku**.</span><span class="sxs-lookup"><span data-stu-id="41a1c-124">Set the <xref:System.Windows.Forms.ToolStripItem.DisplayStyle%2A> property to <xref:System.Windows.Forms.ToolStripItemDisplayStyle.Text> and the <xref:System.Windows.Forms.ToolStripItem.Text%2A> property to **Choose Folder**.</span></span>  
  
4. <span data-ttu-id="41a1c-125">Přidejte druhý <xref:System.Windows.Forms.ToolStripButton> ovládací prvek <xref:System.Windows.Forms.ToolStrip> ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="41a1c-125">Add a second <xref:System.Windows.Forms.ToolStripButton> control to the <xref:System.Windows.Forms.ToolStrip> control.</span></span> <span data-ttu-id="41a1c-126">Nastavte <xref:System.Windows.Forms.ToolStripItem.DisplayStyle%2A> vlastnost <xref:System.Windows.Forms.ToolStripItemDisplayStyle.Text>, <xref:System.Windows.Forms.ToolStripItem.Text%2A> vlastnost **zrušit**a <xref:System.Windows.Forms.ToolStripItem.Enabled%2A> vlastnost `False`.</span><span class="sxs-lookup"><span data-stu-id="41a1c-126">Set the <xref:System.Windows.Forms.ToolStripItem.DisplayStyle%2A> property to <xref:System.Windows.Forms.ToolStripItemDisplayStyle.Text>, the <xref:System.Windows.Forms.ToolStripItem.Text%2A> property to **Cancel**, and the <xref:System.Windows.Forms.ToolStripItem.Enabled%2A> property to `False`.</span></span>  
  
5. <span data-ttu-id="41a1c-127">Přidat <xref:System.Windows.Forms.PictureBox> objektu do hlavního formuláře.</span><span class="sxs-lookup"><span data-stu-id="41a1c-127">Add a <xref:System.Windows.Forms.PictureBox> object to the main form.</span></span> <span data-ttu-id="41a1c-128">Nastavte <xref:System.Windows.Forms.Control.Dock%2A> vlastnost <xref:System.Windows.Forms.DockStyle.Fill>.</span><span class="sxs-lookup"><span data-stu-id="41a1c-128">Set the <xref:System.Windows.Forms.Control.Dock%2A> property to <xref:System.Windows.Forms.DockStyle.Fill>.</span></span>  
  
<a name="network"></a>   
## <a name="creating-the-dataflow-network"></a><span data-ttu-id="41a1c-129">Vytvoření sítě toku dat</span><span class="sxs-lookup"><span data-stu-id="41a1c-129">Creating the Dataflow Network</span></span>  
 <span data-ttu-id="41a1c-130">Tato část popisuje postup vytvoření sítě toku dat, který provádí zpracování obrázků.</span><span class="sxs-lookup"><span data-stu-id="41a1c-130">This section describes how to create the dataflow network that performs image processing.</span></span>  
  
#### <a name="to-create-the-dataflow-network"></a><span data-ttu-id="41a1c-131">Pokud chcete vytvořit síť toku dat</span><span class="sxs-lookup"><span data-stu-id="41a1c-131">To Create the Dataflow Network</span></span>  
  
1. <span data-ttu-id="41a1c-132">Do projektu přidejte odkaz na System.Threading.Tasks.Dataflow.dll.</span><span class="sxs-lookup"><span data-stu-id="41a1c-132">Add a reference to System.Threading.Tasks.Dataflow.dll to your project.</span></span>  
  
2. <span data-ttu-id="41a1c-133">Ujistěte se, že Form1.cs (Form1.vb pro jazyk Visual Basic) obsahuje následující `using` (`Using` v jazyce Visual Basic) příkazy:</span><span class="sxs-lookup"><span data-stu-id="41a1c-133">Ensure that Form1.cs (Form1.vb for Visual Basic) contains the following `using` (`Using` in Visual Basic) statements:</span></span>  
  
     [!code-csharp[TPLDataflow_CompositeImages#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_compositeimages/cs/compositeimages/form1.cs#1)]  
  
3. <span data-ttu-id="41a1c-134">Přidejte následující datové členy do `Form1` třídy:</span><span class="sxs-lookup"><span data-stu-id="41a1c-134">Add the following data members to the `Form1` class:</span></span>  
  
     [!code-csharp[TPLDataflow_CompositeImages#2](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_compositeimages/cs/compositeimages/form1.cs#2)]  
  
4. <span data-ttu-id="41a1c-135">Přidejte následující metodu `CreateImageProcessingNetwork`, možnosti `Form1` třídy.</span><span class="sxs-lookup"><span data-stu-id="41a1c-135">Add the following method, `CreateImageProcessingNetwork`, to the `Form1` class.</span></span> <span data-ttu-id="41a1c-136">Tato metoda vytvoří sítě pro zpracování obrazu.</span><span class="sxs-lookup"><span data-stu-id="41a1c-136">This method creates the image processing network.</span></span>  
  
     [!code-csharp[TPLDataflow_CompositeImages#3](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_compositeimages/cs/compositeimages/form1.cs#3)]  
  
5. <span data-ttu-id="41a1c-137">Implementace `LoadBitmaps` metody.</span><span class="sxs-lookup"><span data-stu-id="41a1c-137">Implement the `LoadBitmaps` method.</span></span>  
  
     [!code-csharp[TPLDataflow_CompositeImages#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_compositeimages/cs/compositeimages/form1.cs#4)]  
  
6. <span data-ttu-id="41a1c-138">Implementace `CreateCompositeBitmap` metody.</span><span class="sxs-lookup"><span data-stu-id="41a1c-138">Implement the `CreateCompositeBitmap` method.</span></span>  
  
     [!code-csharp[TPLDataflow_CompositeImages#5](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_compositeimages/cs/compositeimages/form1.cs#5)]  
  
    > [!NOTE]
    >  <span data-ttu-id="41a1c-139">C# verze `CreateCompositeBitmap` metoda využívá k zajištění efektivní zpracování ukazatele <xref:System.Drawing.Bitmap?displayProperty=nameWithType> objekty.</span><span class="sxs-lookup"><span data-stu-id="41a1c-139">The C# version of the `CreateCompositeBitmap` method uses pointers to enable efficient processing of the <xref:System.Drawing.Bitmap?displayProperty=nameWithType> objects.</span></span> <span data-ttu-id="41a1c-140">Proto je nutné povolit **povolit nezabezpečený kód** možnost ve vašem projektu, aby bylo možné používat [nebezpečné](~/docs/csharp/language-reference/keywords/unsafe.md) – klíčové slovo.</span><span class="sxs-lookup"><span data-stu-id="41a1c-140">Therefore, you must enable the **Allow unsafe code** option in your project in order to use the [unsafe](~/docs/csharp/language-reference/keywords/unsafe.md) keyword.</span></span> <span data-ttu-id="41a1c-141">Další informace o tom, jak povolit nezabezpečený kód v projektu jazyka Visual C# najdete v tématu [stránku sestavení, Návrhář projektu (C#)](/visualstudio/ide/reference/build-page-project-designer-csharp).</span><span class="sxs-lookup"><span data-stu-id="41a1c-141">For more information about how to enable unsafe code in a Visual C# project, see [Build Page, Project Designer (C#)](/visualstudio/ide/reference/build-page-project-designer-csharp).</span></span>  
  
 <span data-ttu-id="41a1c-142">Následující tabulka popisuje členy v síti.</span><span class="sxs-lookup"><span data-stu-id="41a1c-142">The following table describes the members of the network.</span></span>  
  
|<span data-ttu-id="41a1c-143">Člen</span><span class="sxs-lookup"><span data-stu-id="41a1c-143">Member</span></span>|<span data-ttu-id="41a1c-144">Type</span><span class="sxs-lookup"><span data-stu-id="41a1c-144">Type</span></span>|<span data-ttu-id="41a1c-145">Popis</span><span class="sxs-lookup"><span data-stu-id="41a1c-145">Description</span></span>|  
|------------|----------|-----------------|  
|`loadBitmaps`|<xref:System.Threading.Tasks.Dataflow.TransformBlock%602>|<span data-ttu-id="41a1c-146">Přijímá jako vstup cestu ke složce a vytvoří kolekci <xref:System.Drawing.Bitmap> objekty jako výstup.</span><span class="sxs-lookup"><span data-stu-id="41a1c-146">Takes a folder path as input and produces a collection of <xref:System.Drawing.Bitmap> objects as output.</span></span>|  
|`createCompositeBitmap`|<xref:System.Threading.Tasks.Dataflow.TransformBlock%602>|<span data-ttu-id="41a1c-147">Vezme kolekci <xref:System.Drawing.Bitmap> objekty jako vstup a vytvoří složené rastrového obrázku jako výstup.</span><span class="sxs-lookup"><span data-stu-id="41a1c-147">Takes a collection of <xref:System.Drawing.Bitmap> objects as input and produces a composite bitmap as output.</span></span>|  
|`displayCompositeBitmap`|<xref:System.Threading.Tasks.Dataflow.ActionBlock%601>|<span data-ttu-id="41a1c-148">Složený rastrový obrázek se zobrazí ve formuláři.</span><span class="sxs-lookup"><span data-stu-id="41a1c-148">Displays the composite bitmap on the form.</span></span>|  
|`operationCancelled`|<xref:System.Threading.Tasks.Dataflow.ActionBlock%601>|<span data-ttu-id="41a1c-149">Zobrazí obrázek k označení, že operace je zrušena a umožňuje uživateli vybrat jinou složku.</span><span class="sxs-lookup"><span data-stu-id="41a1c-149">Displays an image to indicate that the operation is canceled and enables the user to select another folder.</span></span>|  
  
 <span data-ttu-id="41a1c-150">Pro připojení bloků toku dat pro formulář k síti, v tomto příkladu <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="41a1c-150">To connect the dataflow blocks to form a network, this example uses the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> method.</span></span> <span data-ttu-id="41a1c-151"><xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> Metoda obsahuje přetížené verze, která přijímá <xref:System.Predicate%601> objekt, který určuje, zda cílový blok přijme nebo odmítne zprávy.</span><span class="sxs-lookup"><span data-stu-id="41a1c-151">The <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> method contains an overloaded version that takes a <xref:System.Predicate%601> object that determines whether the target block accepts or rejects a message.</span></span> <span data-ttu-id="41a1c-152">Tento mechanismus filtrování umožňuje blokům zpráv přijímat jenom konkrétní hodnoty.</span><span class="sxs-lookup"><span data-stu-id="41a1c-152">This filtering mechanism enables message blocks to receive only certain values.</span></span> <span data-ttu-id="41a1c-153">V tomto příkladu můžete větvit sítě v jednom ze dvou způsobů.</span><span class="sxs-lookup"><span data-stu-id="41a1c-153">In this example, the network can branch in one of two ways.</span></span> <span data-ttu-id="41a1c-154">Hlavní větev načte obrázky z disku, vytvoří složené bitovou kopii a této bitové kopie se zobrazí ve formuláři.</span><span class="sxs-lookup"><span data-stu-id="41a1c-154">The main branch loads the images from disk, creates the composite image, and displays that image on the form.</span></span> <span data-ttu-id="41a1c-155">Alternativní větev zruší aktuální operaci.</span><span class="sxs-lookup"><span data-stu-id="41a1c-155">The alternate branch cancels the current operation.</span></span> <span data-ttu-id="41a1c-156"><xref:System.Predicate%601> Objekty povolit bloků toku dat podél hlavní větve, přepnout na větev alternativní odmítnutím některé zprávy.</span><span class="sxs-lookup"><span data-stu-id="41a1c-156">The <xref:System.Predicate%601> objects enable the dataflow blocks along the main branch to switch to the alternative branch by rejecting certain messages.</span></span> <span data-ttu-id="41a1c-157">Například, pokud uživatel zruší operaci bloku toku dat `createCompositeBitmap` vytváří `null` (`Nothing` v jazyce Visual Basic) jako výstup.</span><span class="sxs-lookup"><span data-stu-id="41a1c-157">For example, if the user cancels the operation, the dataflow block `createCompositeBitmap` produces `null` (`Nothing` in Visual Basic) as its output.</span></span> <span data-ttu-id="41a1c-158">Blok toku dat `displayCompositeBitmap` odmítne `null` vstupní hodnoty a proto zprávy se nabízí na `operationCancelled`.</span><span class="sxs-lookup"><span data-stu-id="41a1c-158">The dataflow block `displayCompositeBitmap` rejects `null` input values, and therefore, the message is offered to `operationCancelled`.</span></span> <span data-ttu-id="41a1c-159">Blok toku dat `operationCancelled` přijímá všechny zprávy a proto se zobrazí obrázek k označení, že operace je zrušená.</span><span class="sxs-lookup"><span data-stu-id="41a1c-159">The dataflow block `operationCancelled` accepts all messages and therefore, displays an image to indicate that the operation is canceled.</span></span>  
  
 <span data-ttu-id="41a1c-160">Následující ilustrace znázorňuje sítě pro zpracování obrazu:</span><span class="sxs-lookup"><span data-stu-id="41a1c-160">The following illustration shows the image processing network:</span></span>  
  
 ![Ilustrace znázorňující sítě pro zpracování obrazu.](./media/walkthrough-using-dataflow-in-a-windows-forms-application/dataflow-winforms-image-processing.png)  
  
 <span data-ttu-id="41a1c-162">Vzhledem k tomu, `displayCompositeBitmap` a `operationCancelled` toku dat bloky fungovat na uživatelské rozhraní, je důležité, že provedou tyto akce ve vlákně uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="41a1c-162">Because the `displayCompositeBitmap` and `operationCancelled` dataflow blocks act on the user interface, it is important that these actions occur on the user-interface thread.</span></span> <span data-ttu-id="41a1c-163">Provedete to, že během konstrukce tyto objekty každý poskytují <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions> objekt, který má <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.TaskScheduler%2A> vlastnost nastavena na <xref:System.Threading.Tasks.TaskScheduler.FromCurrentSynchronizationContext%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="41a1c-163">To accomplish this, during construction, these objects each provide a <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions> object that has the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.TaskScheduler%2A> property set to <xref:System.Threading.Tasks.TaskScheduler.FromCurrentSynchronizationContext%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="41a1c-164"><xref:System.Threading.Tasks.TaskScheduler.FromCurrentSynchronizationContext%2A?displayProperty=nameWithType> Metoda vytvoří <xref:System.Threading.Tasks.TaskScheduler> objekt, který provede práci na aktuálním kontextu synchronizace.</span><span class="sxs-lookup"><span data-stu-id="41a1c-164">The <xref:System.Threading.Tasks.TaskScheduler.FromCurrentSynchronizationContext%2A?displayProperty=nameWithType> method creates a <xref:System.Threading.Tasks.TaskScheduler> object that performs work on the current synchronization context.</span></span> <span data-ttu-id="41a1c-165">Protože `CreateImageProcessingNetwork` metoda je volána z obslužné rutiny **vybrat složku** tlačítko, které běží v uživatelském rozhraní vlákna, akce `displayCompositeBitmap` a `operationCancelled` bloků toku dat spustit také na vlákna uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="41a1c-165">Because the `CreateImageProcessingNetwork` method is called from the handler of the **Choose Folder** button, which runs on the user-interface thread, the actions for the `displayCompositeBitmap` and `operationCancelled` dataflow blocks also run on the user-interface thread.</span></span>  
  
 <span data-ttu-id="41a1c-166">Tento příklad používá token zrušení sdílené místo nastavení <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> vlastnost protože <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> vlastnost trvale zruší tok dat zablokovat spuštění.</span><span class="sxs-lookup"><span data-stu-id="41a1c-166">This example uses a shared cancellation token instead of setting the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> property because the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> property permanently cancels dataflow block execution.</span></span> <span data-ttu-id="41a1c-167">Token zrušení umožňuje znovu použít stejné síti toku dat více než jednou, i když uživatel zruší jednu nebo více operací v tomto příkladu.</span><span class="sxs-lookup"><span data-stu-id="41a1c-167">A cancellation token enables this example to reuse the same dataflow network multiple times, even when the user cancels one or more operations.</span></span> <span data-ttu-id="41a1c-168">Příklad, který používá <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> trvale zrušit provádění bloku toku dat, naleznete v tématu [jak: Zrušení bloku toku dat](../../../docs/standard/parallel-programming/how-to-cancel-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="41a1c-168">For an example that uses <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> to permanently cancel the execution of a dataflow block, see [How to: Cancel a Dataflow Block](../../../docs/standard/parallel-programming/how-to-cancel-a-dataflow-block.md).</span></span>  
  
<a name="ui"></a>   
## <a name="connecting-the-dataflow-network-to-the-user-interface"></a><span data-ttu-id="41a1c-169">Připojení sítě toku dat v uživatelském rozhraní</span><span class="sxs-lookup"><span data-stu-id="41a1c-169">Connecting the Dataflow Network to the User Interface</span></span>  
 <span data-ttu-id="41a1c-170">Tato část popisuje, jak připojit síť toku dat v uživatelském rozhraní.</span><span class="sxs-lookup"><span data-stu-id="41a1c-170">This section describes how to connect the dataflow network to the user interface.</span></span> <span data-ttu-id="41a1c-171">Vytvoření složeného image a zrušení operace inicializována z **vybrat složku** a **zrušit** tlačítka.</span><span class="sxs-lookup"><span data-stu-id="41a1c-171">The creation of the composite image and cancellation of the operation are initiated from the **Choose Folder** and **Cancel** buttons.</span></span> <span data-ttu-id="41a1c-172">Když uživatel zvolí jednu z těchto tlačítek, vyvolání příslušné akce v asynchronním režimu.</span><span class="sxs-lookup"><span data-stu-id="41a1c-172">When the user chooses either of these buttons, the appropriate action is initiated in an asynchronous manner.</span></span>  
  
#### <a name="to-connect-the-dataflow-network-to-the-user-interface"></a><span data-ttu-id="41a1c-173">K připojení sítě toku dat v uživatelském rozhraní</span><span class="sxs-lookup"><span data-stu-id="41a1c-173">To Connect the Dataflow Network to the User Interface</span></span>  
  
1. <span data-ttu-id="41a1c-174">V návrháři formuláře pro hlavní formulář, vytvořit obslužnou rutinu události pro <xref:System.Windows.Forms.ToolStripItem.Click> události **vybrat složku** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="41a1c-174">On the form designer for the main form, create an event handler for the <xref:System.Windows.Forms.ToolStripItem.Click> event for the **Choose Folder** button.</span></span>  
  
2. <span data-ttu-id="41a1c-175">Implementace <xref:System.Windows.Forms.ToolStripItem.Click> událost pro **vybrat složku** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="41a1c-175">Implement the <xref:System.Windows.Forms.ToolStripItem.Click> event for the **Choose Folder** button.</span></span>  
  
     [!code-csharp[TPLDataflow_CompositeImages#6](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_compositeimages/cs/compositeimages/form1.cs#6)]  
  
3. <span data-ttu-id="41a1c-176">V návrháři formuláře pro hlavní formulář, vytvořit obslužnou rutinu události pro <xref:System.Windows.Forms.ToolStripItem.Click> události **zrušit** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="41a1c-176">On the form designer for the main form, create an event handler for the <xref:System.Windows.Forms.ToolStripItem.Click> event for the **Cancel** button.</span></span>  
  
4. <span data-ttu-id="41a1c-177">Implementace <xref:System.Windows.Forms.ToolStripItem.Click> událost pro **zrušit** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="41a1c-177">Implement the <xref:System.Windows.Forms.ToolStripItem.Click> event for the **Cancel** button.</span></span>  
  
     [!code-csharp[TPLDataflow_CompositeImages#7](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_compositeimages/cs/compositeimages/form1.cs#7)]  
  
<a name="complete"></a>   
## <a name="the-complete-example"></a><span data-ttu-id="41a1c-178">Kompletní příklad</span><span class="sxs-lookup"><span data-stu-id="41a1c-178">The Complete Example</span></span>  
 <span data-ttu-id="41a1c-179">Následující příklad ukazuje kompletní kód v tomto návodu.</span><span class="sxs-lookup"><span data-stu-id="41a1c-179">The following example shows the complete code for this walkthrough.</span></span>  
  
 [!code-csharp[TPLDataflow_CompositeImages#100](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_compositeimages/cs/compositeimages/form1.cs#100)]  
  
 <span data-ttu-id="41a1c-180">Následující obrázek znázorňuje příklad typického výstupu pro běžné \Sample Pictures\ složku.</span><span class="sxs-lookup"><span data-stu-id="41a1c-180">The following illustration shows typical output for the common \Sample Pictures\ folder.</span></span>  
  
 <span data-ttu-id="41a1c-181">![Aplikaci Windows Forms](../../../docs/standard/parallel-programming/media/tpldataflow-compositeimages.gif "TPLDataflow_CompositeImages")</span><span class="sxs-lookup"><span data-stu-id="41a1c-181">![The Windows Forms Application](../../../docs/standard/parallel-programming/media/tpldataflow-compositeimages.gif "TPLDataflow_CompositeImages")</span></span>  

## <a name="see-also"></a><span data-ttu-id="41a1c-182">Viz také:</span><span class="sxs-lookup"><span data-stu-id="41a1c-182">See also</span></span>

- [<span data-ttu-id="41a1c-183">Tok dat</span><span class="sxs-lookup"><span data-stu-id="41a1c-183">Dataflow</span></span>](../../../docs/standard/parallel-programming/dataflow-task-parallel-library.md)
