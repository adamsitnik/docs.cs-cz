---
title: Možnosti sloučení v PLINQ
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- PLINQ queries, merge options
ms.assetid: e8f7be3b-88de-4f33-ab14-dc008e76c1ba
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 06f772b8d26ec87519efdaae7b621f3fd2d321c5
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "61946949"
---
# <a name="merge-options-in-plinq"></a><span data-ttu-id="49b3d-102">Možnosti sloučení v PLINQ</span><span class="sxs-lookup"><span data-stu-id="49b3d-102">Merge Options in PLINQ</span></span>
<span data-ttu-id="49b3d-103">Při provádění dotazu jako paralelně, PLINQ rozdělí zdrojovou sekvenci tak, aby více vláken může pracovat na různých částech souběžně, obvykle v samostatných vláknech.</span><span class="sxs-lookup"><span data-stu-id="49b3d-103">When a query is executing as parallel, PLINQ partitions the source sequence so that multiple threads can work on different parts concurrently, typically on separate threads.</span></span> <span data-ttu-id="49b3d-104">Výsledky jsou-li využívat v jednom vlákně, například v `foreach` (`For Each` v jazyce Visual Basic) smyčce, pak výsledky z každé vlákno musí být sloučeny zpět do jedné sekvence.</span><span class="sxs-lookup"><span data-stu-id="49b3d-104">If the results are to be consumed on one thread, for example, in a `foreach` (`For Each` in Visual Basic) loop, then the results from every thread must be merged back into one sequence.</span></span> <span data-ttu-id="49b3d-105">Druh sloučení, který provádí PLINQ závisí na subjekty, které se nacházejí v dotazu.</span><span class="sxs-lookup"><span data-stu-id="49b3d-105">The kind of merge that PLINQ performs depends on the operators that are present in the query.</span></span> <span data-ttu-id="49b3d-106">Například operátory, které zavádí novou objednávku na výsledcích musí uložit do vyrovnávací paměti všechny prvky ze všech vláken.</span><span class="sxs-lookup"><span data-stu-id="49b3d-106">For example, operators that impose a new order on the results must buffer all elements from all threads.</span></span> <span data-ttu-id="49b3d-107">Z pohledu konzumním vlákně (která je také, že uživatel aplikace) může plně ve vyrovnávací paměti dotaz spusťte znatelný dobu vypršení vytváří výsledek první.</span><span class="sxs-lookup"><span data-stu-id="49b3d-107">From the perspective of the consuming thread (which is also that of the application user) a fully buffered query might run for a noticeable period of time before it produces its first result.</span></span> <span data-ttu-id="49b3d-108">Ostatní operátory ve výchozím nastavení, se částečně uložená do vyrovnávací paměti; dávají výsledky v dávkách.</span><span class="sxs-lookup"><span data-stu-id="49b3d-108">Other operators, by default, are partially buffered; they yield their results in batches.</span></span> <span data-ttu-id="49b3d-109">Jeden operátor <xref:System.Linq.ParallelEnumerable.ForAll%2A> nemá vyrovnávací paměť ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="49b3d-109">One operator, <xref:System.Linq.ParallelEnumerable.ForAll%2A> is not buffered by default.</span></span> <span data-ttu-id="49b3d-110">Bude vrácen všechny prvky ze všech vláken okamžitě.</span><span class="sxs-lookup"><span data-stu-id="49b3d-110">It yields all elements from all threads immediately.</span></span>  
  
 <span data-ttu-id="49b3d-111">S použitím <xref:System.Linq.ParallelEnumerable.WithMergeOptions%2A> způsob, jak je znázorněno v následujícím příkladu, můžete poskytnout nápovědu PLINQ, který označuje, jaký druh sloučení provést.</span><span class="sxs-lookup"><span data-stu-id="49b3d-111">By using the <xref:System.Linq.ParallelEnumerable.WithMergeOptions%2A> method, as shown in the following example, you can provide a hint to PLINQ that indicates what kind of merging to perform.</span></span>  
  
 [!code-csharp[PLINQ#26](../../../samples/snippets/csharp/VS_Snippets_Misc/plinq/cs/plinqsamples.cs#26)]
 [!code-vb[PLINQ#26](../../../samples/snippets/visualbasic/VS_Snippets_Misc/plinq/vb/plinq2_vb.vb#26)]  
  
 <span data-ttu-id="49b3d-112">Kompletní příklad naleznete v tématu [jak: Určení možností sloučení v PLINQ](../../../docs/standard/parallel-programming/how-to-specify-merge-options-in-plinq.md).</span><span class="sxs-lookup"><span data-stu-id="49b3d-112">For the complete example, see [How to: Specify Merge Options in PLINQ](../../../docs/standard/parallel-programming/how-to-specify-merge-options-in-plinq.md).</span></span>  
  
 <span data-ttu-id="49b3d-113">Pokud konkrétní dotaz nepodporuje požadované možnosti, klikněte možnost bude ignorována.</span><span class="sxs-lookup"><span data-stu-id="49b3d-113">If the particular query cannot support the requested option, then the option will just be ignored.</span></span> <span data-ttu-id="49b3d-114">Ve většině případů není nutné zadat možnost sloučení pro PLINQ dotazu.</span><span class="sxs-lookup"><span data-stu-id="49b3d-114">In most cases, you do not have to specify a merge option for a PLINQ query.</span></span> <span data-ttu-id="49b3d-115">Nicméně v některých případech může být pro vás z testování a měření, které dotaz provádí nejlépe v jiné než výchozí režim.</span><span class="sxs-lookup"><span data-stu-id="49b3d-115">However, in some cases you may find by testing and measurement that a query executes best in a non-default mode.</span></span> <span data-ttu-id="49b3d-116">Běžné použití této možnosti je vynutit operátor sloučení bloků dat do datového proudu negace rychleji reagující uživatelské rozhraní.</span><span class="sxs-lookup"><span data-stu-id="49b3d-116">A common use of this option is to force a chunk-merging operator to stream its results in order to provide a more responsive user interface.</span></span>  
  
## <a name="parallelmergeoptions"></a><span data-ttu-id="49b3d-117">ParallelMergeOptions</span><span class="sxs-lookup"><span data-stu-id="49b3d-117">ParallelMergeOptions</span></span>  
 <span data-ttu-id="49b3d-118"><xref:System.Linq.ParallelMergeOptions> Výčet zahrnuje následující možnosti, které určují pro podporované tvary dotazu, jak je získán finální výstup z dotazu, když v jednom vlákně se spotřebuje výsledky:</span><span class="sxs-lookup"><span data-stu-id="49b3d-118">The <xref:System.Linq.ParallelMergeOptions> enumeration includes the following options that specify, for supported query shapes, how the final output of the query is yielded when the results are consumed on one thread:</span></span>  
  
- `Not Buffered`  
  
     <span data-ttu-id="49b3d-119"><xref:System.Linq.ParallelMergeOptions.NotBuffered> Možnost způsobí, že každý zpracovaných prvek má být vrácena z každé vlákno, jakmile je vytvořen.</span><span class="sxs-lookup"><span data-stu-id="49b3d-119">The <xref:System.Linq.ParallelMergeOptions.NotBuffered> option causes each processed element to be returned from each thread as soon as it is produced.</span></span> <span data-ttu-id="49b3d-120">Toto chování je obdobou "streaming" výstup.</span><span class="sxs-lookup"><span data-stu-id="49b3d-120">This behavior is analogous to "streaming" the output.</span></span> <span data-ttu-id="49b3d-121">Pokud <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> operátor je k dispozici v dotazu `NotBuffered` zachovává pořadí prvků zdroje.</span><span class="sxs-lookup"><span data-stu-id="49b3d-121">If the <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> operator is present in the query, `NotBuffered` preserves the order of the source elements.</span></span> <span data-ttu-id="49b3d-122">I když `NotBuffered` začne vracet výsledky, jako jsou k dispozici, celková doba nutná k vytvoření všechny výsledky, může stále dojít být delší než jedním z dalších možností sloučení.</span><span class="sxs-lookup"><span data-stu-id="49b3d-122">Although `NotBuffered` starts yielding results as soon as they're available,, the total time to produce all the results might still be longer than using one of the other merge options.</span></span>  
  
- `Auto Buffered`  
  
     <span data-ttu-id="49b3d-123"><xref:System.Linq.ParallelMergeOptions.AutoBuffered> Možnost způsobí, že dotaz, který shromáždí prvky do vyrovnávací paměti a pravidelně všechny najednou konzumním vlákně obsah vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="49b3d-123">The <xref:System.Linq.ParallelMergeOptions.AutoBuffered> option causes the query to collect elements into a buffer and then periodically yield the buffer contents all at once to the consuming thread.</span></span> <span data-ttu-id="49b3d-124">To je obdobou získávání zdrojová data v "bloky" místo "streaming" chování `NotBuffered`.</span><span class="sxs-lookup"><span data-stu-id="49b3d-124">This is analogous to yielding the source data in "chunks" instead of using the "streaming" behavior of `NotBuffered`.</span></span> <span data-ttu-id="49b3d-125">`AutoBuffered` může trvat déle než `NotBuffered` zpřístupnit první prvek v konzumním vlákně.</span><span class="sxs-lookup"><span data-stu-id="49b3d-125">`AutoBuffered` may take longer than `NotBuffered` to make the first element available on the consuming thread.</span></span> <span data-ttu-id="49b3d-126">Velikost vyrovnávací paměti a přesné získávání chování se nedají konfigurovat a může lišit v závislosti na různých faktorech, které se vztahují k dotazu.</span><span class="sxs-lookup"><span data-stu-id="49b3d-126">The size of the buffer and the exact yielding behavior are not configurable and may vary, depending on various factors that relate to the query.</span></span>  
  
- `FullyBuffered`  
  
     <span data-ttu-id="49b3d-127"><xref:System.Linq.ParallelMergeOptions.FullyBuffered> Možnost způsobí, že výstupní celého ukládány do vyrovnávací paměti, než všechny prvky jsou výsledkem dotazu.</span><span class="sxs-lookup"><span data-stu-id="49b3d-127">The <xref:System.Linq.ParallelMergeOptions.FullyBuffered> option causes the output of the whole query to be buffered before any of the elements are yielded.</span></span> <span data-ttu-id="49b3d-128">Když použijete tuto možnost, může trvat delší dobu před prvním prvkem je k dispozici v konzumním vlákně, ale může být stále vytváří úplné výsledky rychleji pomocí dalších možností.</span><span class="sxs-lookup"><span data-stu-id="49b3d-128">When you use this option, it can take longer before the first element is available on the consuming thread, but the complete results might still be produced faster than by using the other options.</span></span>  
  
## <a name="query-operators-that-support-merge-options"></a><span data-ttu-id="49b3d-129">Operátory dotazů, které podporují možnosti sloučení</span><span class="sxs-lookup"><span data-stu-id="49b3d-129">Query Operators that Support Merge Options</span></span>  
 <span data-ttu-id="49b3d-130">V následující tabulce jsou uvedeny operátory, které podporují všechny režimy možnost sloučení, zadané omezení.</span><span class="sxs-lookup"><span data-stu-id="49b3d-130">The following table lists the operators that support all merge option modes, subject to the specified restrictions.</span></span>  
  
|<span data-ttu-id="49b3d-131">Operátor</span><span class="sxs-lookup"><span data-stu-id="49b3d-131">Operator</span></span>|<span data-ttu-id="49b3d-132">Omezení</span><span class="sxs-lookup"><span data-stu-id="49b3d-132">Restrictions</span></span>|  
|--------------|------------------|  
|<xref:System.Linq.ParallelEnumerable.AsEnumerable%2A>|<span data-ttu-id="49b3d-133">Žádné</span><span class="sxs-lookup"><span data-stu-id="49b3d-133">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Cast%2A>|<span data-ttu-id="49b3d-134">Žádné</span><span class="sxs-lookup"><span data-stu-id="49b3d-134">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Concat%2A>|<span data-ttu-id="49b3d-135">Seřazené bez dotazy, které mají seznamu nebo pole pouze zdroj.</span><span class="sxs-lookup"><span data-stu-id="49b3d-135">Non-ordered queries that have an Array or List source only.</span></span>|  
|<xref:System.Linq.ParallelEnumerable.DefaultIfEmpty%2A>|<span data-ttu-id="49b3d-136">Žádné</span><span class="sxs-lookup"><span data-stu-id="49b3d-136">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.OfType%2A>|<span data-ttu-id="49b3d-137">Žádný</span><span class="sxs-lookup"><span data-stu-id="49b3d-137">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Reverse%2A>|<span data-ttu-id="49b3d-138">Seřazené bez dotazy, které mají seznamu nebo pole pouze zdroj.</span><span class="sxs-lookup"><span data-stu-id="49b3d-138">Non-ordered queries that have an Array or List source only.</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Select%2A>|<span data-ttu-id="49b3d-139">Žádný</span><span class="sxs-lookup"><span data-stu-id="49b3d-139">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.SelectMany%2A>|<span data-ttu-id="49b3d-140">Žádný</span><span class="sxs-lookup"><span data-stu-id="49b3d-140">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Skip%2A>|<span data-ttu-id="49b3d-141">Žádný</span><span class="sxs-lookup"><span data-stu-id="49b3d-141">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Take%2A>|<span data-ttu-id="49b3d-142">Žádný</span><span class="sxs-lookup"><span data-stu-id="49b3d-142">None</span></span>|  
|<xref:System.Linq.ParallelEnumerable.Where%2A>|<span data-ttu-id="49b3d-143">Žádný</span><span class="sxs-lookup"><span data-stu-id="49b3d-143">None</span></span>|  
  
 <span data-ttu-id="49b3d-144">Všechny ostatní operátory dotazu PLINQ může ignorovat zadané uživatelské možnosti sloučení.</span><span class="sxs-lookup"><span data-stu-id="49b3d-144">All other PLINQ query operators might ignore user-provided merge options.</span></span> <span data-ttu-id="49b3d-145">Některé operátory dotazů, třeba <xref:System.Linq.ParallelEnumerable.Reverse%2A> a <xref:System.Linq.ParallelEnumerable.OrderBy%2A>, žádné elementy nelze pozastavit, dokud všechny vytvořené a přeuspořádány.</span><span class="sxs-lookup"><span data-stu-id="49b3d-145">Some query operators, for example, <xref:System.Linq.ParallelEnumerable.Reverse%2A> and <xref:System.Linq.ParallelEnumerable.OrderBy%2A>, cannot yield any elements until all have been produced and reordered.</span></span> <span data-ttu-id="49b3d-146">Proto když <xref:System.Linq.ParallelMergeOptions> se používá v dotazu, který také obsahuje operátor <xref:System.Linq.ParallelEnumerable.Reverse%2A>, sloučení chování se neprojeví v dotazu, dokud po operátor vytvořil jeho výsledky.</span><span class="sxs-lookup"><span data-stu-id="49b3d-146">Therefore, when <xref:System.Linq.ParallelMergeOptions> is used in a query that also contains an operator such as <xref:System.Linq.ParallelEnumerable.Reverse%2A>, the merge behavior will not be applied in the query until after that operator has produced its results.</span></span>  
  
 <span data-ttu-id="49b3d-147">Schopnost některé operátory zpracování možností sloučení závisí na typu zdrojové sekvence a určuje, zda <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> dříve v dotazu byla použita operátor.</span><span class="sxs-lookup"><span data-stu-id="49b3d-147">The ability of some operators to handle merge options depends on the type of the source sequence, and whether the <xref:System.Linq.ParallelEnumerable.AsOrdered%2A> operator was used earlier in the query.</span></span> <span data-ttu-id="49b3d-148"><xref:System.Linq.ParallelEnumerable.ForAll%2A> je vždy <xref:System.Linq.ParallelMergeOptions.NotBuffered> ; okamžitě vrací elementy.</span><span class="sxs-lookup"><span data-stu-id="49b3d-148"><xref:System.Linq.ParallelEnumerable.ForAll%2A> is always <xref:System.Linq.ParallelMergeOptions.NotBuffered> ; it yields its elements immediately.</span></span> <span data-ttu-id="49b3d-149"><xref:System.Linq.ParallelEnumerable.OrderBy%2A> je vždy <xref:System.Linq.ParallelMergeOptions.FullyBuffered>; je nutné seřadit celý seznam předtím, než bude vrácen.</span><span class="sxs-lookup"><span data-stu-id="49b3d-149"><xref:System.Linq.ParallelEnumerable.OrderBy%2A> is always <xref:System.Linq.ParallelMergeOptions.FullyBuffered>; it must sort the whole list before it yields.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="49b3d-150">Viz také:</span><span class="sxs-lookup"><span data-stu-id="49b3d-150">See also</span></span>

- [<span data-ttu-id="49b3d-151">Paralelní LINQ (PLINQ)</span><span class="sxs-lookup"><span data-stu-id="49b3d-151">Parallel LINQ (PLINQ)</span></span>](../../../docs/standard/parallel-programming/parallel-linq-plinq.md)
- [<span data-ttu-id="49b3d-152">Postupy: Určení možností sloučení v PLINQ</span><span class="sxs-lookup"><span data-stu-id="49b3d-152">How to: Specify Merge Options in PLINQ</span></span>](../../../docs/standard/parallel-programming/how-to-specify-merge-options-in-plinq.md)
