---
title: Vzor brány rozhraní API a přímá komunikace klienta mikroslužeb
description: Pochopení rozdílů a používá model brány rozhraní API a přímá komunikace klienta mikroslužeb.
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 01/07/2019
ms.openlocfilehash: 7e81b46c2dbcee3b3658ab3c2e576644f0e7b372
ms.sourcegitcommit: dcc8feeff4718664087747529638ec9b47e65234
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/31/2019
ms.locfileid: "55479890"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="01ca7-103">Vzor brány rozhraní API a přímá komunikace klienta mikroslužeb</span><span class="sxs-lookup"><span data-stu-id="01ca7-103">The API gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="01ca7-104">V architektuře mikroslužeb jednotlivých mikroslužeb zveřejňuje sadu koncových bodů (obvykle) podrobné.</span><span class="sxs-lookup"><span data-stu-id="01ca7-104">In a microservices architecture, each microservice exposes a set of (typically) fine-grained endpoints.</span></span> <span data-ttu-id="01ca7-105">Tato skutečnost může mít vliv komunikace klienta mikroslužeb, jak je popsáno v této části.</span><span class="sxs-lookup"><span data-stu-id="01ca7-105">This fact can impact the client-to-microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="01ca7-106">Přímá komunikace klienta mikroslužeb</span><span class="sxs-lookup"><span data-stu-id="01ca7-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="01ca7-107">Možných způsobů je použít architekturu přímá komunikace klienta mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="01ca7-108">V takovém případě klientskou aplikaci mohli požadavků přímo na některé z mikroslužeb, jak ukazuje obrázek 4-12.</span><span class="sxs-lookup"><span data-stu-id="01ca7-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Diagram znázorňující architektury přímá komunikace klienta mikroslužeb, kde každé aplikaci, která komunikuje přímo s jednotlivých mikroslužeb.](./media/image12.png)

<span data-ttu-id="01ca7-110">**Obrázek 4-12**.</span><span class="sxs-lookup"><span data-stu-id="01ca7-110">**Figure 4-12**.</span></span> <span data-ttu-id="01ca7-111">Použití architektury přímá komunikace klienta mikroslužeb</span><span class="sxs-lookup"><span data-stu-id="01ca7-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="01ca7-112">V takovém případě jednotlivých mikroslužeb má veřejný koncový bod, někdy s jiným portem TCP u jednotlivých mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-112">In this approach, each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="01ca7-113">Příkladem adresy URL pro konkrétní službu, může být následující adresy URL v Azure:</span><span class="sxs-lookup"><span data-stu-id="01ca7-113">An example of a URL for a particular service could be the following URL in Azure:</span></span>

<http://eshoponcontainers.westus.cloudapp.azure.com:88/>

<span data-ttu-id="01ca7-114">V produkčním prostředí založené na clusteru, která umožní mapování adresy URL pro vyrovnávání zatížení používá v clusteru, který pak distribuuje požadavky mezi mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="01ca7-114">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="01ca7-115">V produkčním prostředí můžete mít Application Delivery Controller (ADC) jako [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) mezi mikroslužby a Internetem.</span><span class="sxs-lookup"><span data-stu-id="01ca7-115">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="01ca7-116">To slouží jako transparentní vrstvy, který nejen provede Vyrovnávání zatížení, ale chrání služby tím, že nabízí ukončení protokolu SSL.</span><span class="sxs-lookup"><span data-stu-id="01ca7-116">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="01ca7-117">To zvyšuje zatížení hostitelů přesměrováním ukončení protokolu SSL náročnou na procesor a další směrování úkoly ke službě Azure Application Gateway.</span><span class="sxs-lookup"><span data-stu-id="01ca7-117">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="01ca7-118">V každém případě jsou transparentní z hlediska of Architektura logické aplikační nástroje pro vyrovnávání zatížení a ADC.</span><span class="sxs-lookup"><span data-stu-id="01ca7-118">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="01ca7-119">Přímá komunikace klienta mikroslužeb architektury může být dostatečné pro malou aplikaci založených na mikroslužbách, zejména v případě, že je klientská aplikace na straně serveru webové aplikace, jako jsou aplikace ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="01ca7-119">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="01ca7-120">Při sestavování velkých a složitých aplikací využívajících mikroslužby (například při zpracování desítek mikroslužeb typy) a zejména v případě klientských aplikací jsou vzdálené mobilní aplikace nebo webové aplikace SPA čelí tento přístup však několik problémů.</span><span class="sxs-lookup"><span data-stu-id="01ca7-120">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="01ca7-121">Při vývoji rozsáhlé aplikace založené na mikroslužbách, zvažte následující otázky:</span><span class="sxs-lookup"><span data-stu-id="01ca7-121">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="01ca7-122">*Jak klientské aplikace minimalizovat počet požadavků na back-end a snížit košatá komunikace na více mikroslužby?*</span><span class="sxs-lookup"><span data-stu-id="01ca7-122">*How can client apps minimize the number of requests to the back end and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="01ca7-123">Interakce s různými mikroslužbami k sestavení na jedné obrazovce uživatelského rozhraní se zvyšuje počet zpátečních cest přes Internet.</span><span class="sxs-lookup"><span data-stu-id="01ca7-123">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="01ca7-124">Tím se zvyšuje latenci a složitostí na straně uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="01ca7-124">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="01ca7-125">V ideálním případě odpovědí efektivně agregace na straně serveru.</span><span class="sxs-lookup"><span data-stu-id="01ca7-125">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="01ca7-126">Tím se snižuje latence, protože více kusů data vrátit paralelně a některé uživatelského rozhraní můžete zobrazit data, jakmile to bude připravené.</span><span class="sxs-lookup"><span data-stu-id="01ca7-126">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it's ready.</span></span>

- <span data-ttu-id="01ca7-127">*Jak můžete zpracovávat vyskytující aspekty, jako je například autorizace, transformace dat a odesílání dynamické požadavku?*</span><span class="sxs-lookup"><span data-stu-id="01ca7-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="01ca7-128">Implementace zabezpečení a převeďte společné aspekty, jako je zabezpečení a autorizace v každé mikroslužbě může vyžadovat významné vývoj úsilí.</span><span class="sxs-lookup"><span data-stu-id="01ca7-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="01ca7-129">Možných způsobů je, aby tyto služby v rámci hostitele Docker nebo interní clusteru omezit přímý přístup k nim z vnějšku a k implementaci těchto vyskytující aspekty v centrálním umístění, jako jsou brány rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="01ca7-129">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="01ca7-130">*Jak může klientské aplikace komunikovat se službou, které používají protokoly sítě Internet vhodných?*</span><span class="sxs-lookup"><span data-stu-id="01ca7-130">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="01ca7-131">Klientské aplikace obvykle nepodporuje protokoly použité na straně serveru (jako je připojení přes AMQP nebo binární protokoly).</span><span class="sxs-lookup"><span data-stu-id="01ca7-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="01ca7-132">Proto musí být žádostí provádí prostřednictvím protokolů, jako jsou HTTP/HTTPS a poté převedeny na jiné protokoly.</span><span class="sxs-lookup"><span data-stu-id="01ca7-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="01ca7-133">A *man-in-the-middle* přístup může pomoct v této situaci.</span><span class="sxs-lookup"><span data-stu-id="01ca7-133">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="01ca7-134">*Jak můžete tvarovat průčelí zejména vytvořené pro mobilní aplikace?*</span><span class="sxs-lookup"><span data-stu-id="01ca7-134">*How can you shape a facade especially made for mobile apps?*</span></span>

<span data-ttu-id="01ca7-135">Rozhraní API z několika mikroslužeb nemusí být dobře navržený pro potřeby různých klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="01ca7-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="01ca7-136">Požadavky na mobilní aplikaci, může být jiný než potřebám webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="01ca7-137">Pro mobilní aplikace může být nutné ještě více optimalizovat tak, aby data odpovědi může být efektivnější.</span><span class="sxs-lookup"><span data-stu-id="01ca7-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="01ca7-138">Může to provedete tak, že agregace dat z několika mikroslužeb a vrací jednu sadu dat a někdy odstraněním všech dat v odpovědi, která není potřeba pro mobilní aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that isn't needed by the mobile app.</span></span> <span data-ttu-id="01ca7-139">A samozřejmě, může tato data komprimovat.</span><span class="sxs-lookup"><span data-stu-id="01ca7-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="01ca7-140">Opět "fasády" nebo rozhraní API mezi mikroslužby a mobilní aplikace může být vhodné pro tento scénář.</span><span class="sxs-lookup"><span data-stu-id="01ca7-140">Again, a facade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="01ca7-141">Proč místo přímé komunikace klienta mikroslužeb zvažte brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="01ca7-141">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="01ca7-142">V architektuře mikroslužeb klientské aplikace obvykle potřebují využívat funkce z více než jeden mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-142">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="01ca7-143">Pokud se tento spotřeby provádí přímo, klient musí zpracovat více volání koncových bodů mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-143">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="01ca7-144">Co se stane, když se aplikace vyvíjí a vydávají nové mikroslužby nebo aktualizaci existující mikroslužeb?</span><span class="sxs-lookup"><span data-stu-id="01ca7-144">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="01ca7-145">Pokud má vaše aplikace mnoha mikroslužeb, může být zpracování tolika koncových bodů z klientských aplikací připomínající.</span><span class="sxs-lookup"><span data-stu-id="01ca7-145">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="01ca7-146">Vzhledem k tomu, že klientská aplikace by spjat s těchto vnitřních koncových bodů, vyvíjejí mikroslužby v budoucnu může způsobit vysoký dopad pro klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-146">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="01ca7-147">Proto úrovní dereference (brány) nebo pokročilou úroveň může být velmi vhodné pro aplikace založené na mikroslužbách.</span><span class="sxs-lookup"><span data-stu-id="01ca7-147">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="01ca7-148">Pokud nemáte brány rozhraní API, klientské aplikace musíte odeslat požadavků přímo na mikroslužby a, která vyvolává problémy, jako je například následující problémy:</span><span class="sxs-lookup"><span data-stu-id="01ca7-148">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="01ca7-149">**Párování**: Bez vzor brány rozhraní API klientské aplikace jsou spojeny s interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-149">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="01ca7-150">Klientské aplikace potřebujete vědět, jak se více oblastí aplikace rozloží v mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-150">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="01ca7-151">Když se vyvíjejí a refaktoring interní mikroslužeb, tyto akce vliv údržby to je chybně protože mohou způsobit změny způsobující chyby do klientské aplikace z důvodu přímý odkaz na vnitřní mikroslužeb z klienta aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-151">When evolving and refactoring the internal microservices, those actions impact maintenance pretty badly because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="01ca7-152">Klientské aplikace potřeba aktualizovat často, což obtížnější vyvíjí řešení.</span><span class="sxs-lookup"><span data-stu-id="01ca7-152">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="01ca7-153">**Moc velký počet zpátečních cest**: Na jedné stránce/obrazovce v klientské aplikaci může vyžadovat několik volání více služeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-153">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="01ca7-154">Že výsledkem více síťových zaokrouhlit zkracuje dobu odezvy mezi klientem a serverem, přidání velkou latenci.</span><span class="sxs-lookup"><span data-stu-id="01ca7-154">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="01ca7-155">Agregace v pokročilou úroveň zpracovává může zlepšit výkon a uživatelské prostředí pro klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-155">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="01ca7-156">**Problémy se zabezpečením**: Bez brány musí být vystavené všechny mikroslužby "externí World", provedení útoku větší než-li skrýt interní mikroslužeb, které nejsou přímo používány klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-156">**Security issues**: Without a gateway, all the microservices must be exposed to the "external world", making the attack surface larger than if you hide internal microservices that aren't directly used by the client apps.</span></span> <span data-ttu-id="01ca7-157">Čím menší je útok, tím lépe zabezpečit vaše aplikace může být.</span><span class="sxs-lookup"><span data-stu-id="01ca7-157">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="01ca7-158">**Převeďte společné aspekty**: Každá mikroslužba veřejně publikovaného musí zpracovat aspekty jako je například autorizace, SSL atd. V mnoha situacích můžou tyto obavy zpracovat, v jedné vrstvě tak vnitřní mikroslužeb jsou zjednodušené.</span><span class="sxs-lookup"><span data-stu-id="01ca7-158">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization, SSL, etc. In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="01ca7-159">Co je vzor brány rozhraní API?</span><span class="sxs-lookup"><span data-stu-id="01ca7-159">What is the API Gateway pattern?</span></span>

<span data-ttu-id="01ca7-160">Při navrhování a vytváření rozsáhlých nebo složitých aplikací využívajících mikroslužby s více klientských aplikací, může být dobrý nápad vzít v úvahu [Brána rozhraní API](https://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="01ca7-160">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="01ca7-161">Jedná se o službu, která poskytuje jeden vstupní bod pro určité skupiny mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-161">This is a service that provides a single-entry point for certain groups of microservices.</span></span> <span data-ttu-id="01ca7-162">Se podobá [Facade vzor](https://en.wikipedia.org/wiki/Facade_pattern) z objektově orientovaný návrh, ale v tomto případě to je součástí distribuovaného systému.</span><span class="sxs-lookup"><span data-stu-id="01ca7-162">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object-oriented design, but in this case, it's part of a distributed system.</span></span> <span data-ttu-id="01ca7-163">Vzor brány rozhraní API se také někdy označuje jako "back-endu pro front-endu" ([BFF](https://samnewman.io/patterns/architectural/bff/)) vzhledem k tomu, že sestavení při přemýšlení o potřebách klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-163">The API Gateway pattern is also sometimes known as the "backend for frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="01ca7-164">Brána rozhraní API proto umístěná mezi klientské aplikace a mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-164">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="01ca7-165">Slouží jako reverzní proxy server, směrování požadavků od klientů ke službám.</span><span class="sxs-lookup"><span data-stu-id="01ca7-165">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="01ca7-166">Může také nabízet další společné funkce, jako je například ověřování, ukončování protokolu SSL a mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="01ca7-166">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="01ca7-167">Obrázek 4 – 13 ukazuje, jak je vlastní bránu rozhraní API můžete začlenit do zjednodušení architektury založené na mikroslužbách s několika mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-167">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Diagram znázorňující bránu rozhraní API implementované jako vlastní službu, tak připojení aplikací na jeden koncový bod brány rozhraní API, nakonfigurovaný tak, aby směrovala požadavky do jednotlivých mikroslužeb.](./media/image13.png)

<span data-ttu-id="01ca7-169">**Obrázek 4 – 13**.</span><span class="sxs-lookup"><span data-stu-id="01ca7-169">**Figure 4-13**.</span></span> <span data-ttu-id="01ca7-170">Použití brány rozhraní API implementované jako vlastní službu</span><span class="sxs-lookup"><span data-stu-id="01ca7-170">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="01ca7-171">V tomto příkladu by se Brána rozhraní API implementované jako vlastní služby hostitele ASP.NET Core spuštěné jako kontejner.</span><span class="sxs-lookup"><span data-stu-id="01ca7-171">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="01ca7-172">Je důležité, abyste měli na očích, který v tomto diagramu, budete používat jeden vlastní bránu rozhraní API služby směřující více a různých klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="01ca7-172">It's important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="01ca7-173">Fakt může být důležité riziko, protože vaše Brána rozhraní API služeb se rozrůstá a vyvíjejí podle mnoha různých požadavků z klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="01ca7-173">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="01ca7-174">Nakonec bude opakovaném kvůli tyto různé potřeby a efektivní může být poměrně podobný monolitické aplikace nebo monolitické služby.</span><span class="sxs-lookup"><span data-stu-id="01ca7-174">Eventually, it will be bloated because of those different needs and effectively it could be pretty similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="01ca7-175">To je důvod, proč velmi dobře se doporučuje Brána rozhraní API ve více službách nebo několik menších brány rozhraní API, jeden pro každý typ uspořádání formuláře aplikace klienta, například rozdělit.</span><span class="sxs-lookup"><span data-stu-id="01ca7-175">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="01ca7-176">Musíte být opatrní při implementaci vzor brány rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="01ca7-176">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="01ca7-177">Obvykle není vhodné mít jediné brány rozhraní API agregaci všechny mikroslužby interní vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-177">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="01ca7-178">Pokud ano, funguje jako monolitický agregátoru nebo nástroje orchestrator a porušuje autonomie mikroslužeb pomocí párování všechny mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="01ca7-178">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="01ca7-179">Proto brány rozhraní API by měly být oddělené na základě obchodní hranice a klientské aplikace a ne act jako jeden agregátor interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-179">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="01ca7-180">Při rozdělování úroveň rozhraní API brány do více bran rozhraní API, pokud aplikace obsahuje víc klientských aplikací, které mohou být primární kontingenční tabulku při identifikaci více typů brány rozhraní API, takže můžete mít různé fasáda pro potřeby každou klientskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="01ca7-180">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different facade for the needs of each client app.</span></span> <span data-ttu-id="01ca7-181">Tento případ je vzor s názvem "Back-endu pro front-endu" ([BFF](https://samnewman.io/patterns/architectural/bff/)) tam, kde každá brána rozhraní API můžete zadat jiné rozhraní API navržených pro jednotlivé typy aplikací klienta, případně i na základě provedení klientských implementací konkrétní adaptér kódu, které pod tím volá více interní mikroslužeb, jak je znázorněno na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="01ca7-181">This case is a pattern named "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Diagram znázorňující několik vlastních brány rozhraní API, kde jsou odděleni brány rozhraní API podle typu klienta; jeden pro mobilní klienty a jeden pro klienty webového.](./media/image13.1.png)

<span data-ttu-id="01ca7-184">**Obrázek 4 – 13.1**.</span><span class="sxs-lookup"><span data-stu-id="01ca7-184">**Figure 4-13.1**.</span></span> <span data-ttu-id="01ca7-185">Použití více bran vlastní rozhraní API</span><span class="sxs-lookup"><span data-stu-id="01ca7-185">Using multiple custom API Gateways</span></span>

<span data-ttu-id="01ca7-186">Předchozí obrázek znázorňuje zjednodušenou architektury s využitím více podrobných brány rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="01ca7-186">The previous image shows a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="01ca7-187">V tomto případě jsou hranice pro každou bránu rozhraní API založené výhradně na "Back-endu pro front-endu" ([BFF](https://samnewman.io/patterns/architectural/bff/)) vzor, proto založený na rozhraní API pro potřeby za klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-187">In this case, the boundaries identified for each API Gateway are based purely on the "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="01ca7-188">Ale ve větších aplikací by měl také dále a vytvořit další brány rozhraní API založené na obchodní hranice jako druhý návrh kontingenční tabulku.</span><span class="sxs-lookup"><span data-stu-id="01ca7-188">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="01ca7-189">Hlavní funkce v vzor brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="01ca7-189">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="01ca7-190">Brány rozhraní API nabízí více funkcí.</span><span class="sxs-lookup"><span data-stu-id="01ca7-190">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="01ca7-191">V závislosti na produktu mohou nabízet lepší nebo jednodušší funkce, ale nejdůležitější a základní funkce pro každou bránu, rozhraní API jsou následující vzory návrhu:</span><span class="sxs-lookup"><span data-stu-id="01ca7-191">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="01ca7-192">**Reverzní proxy server nebo směrování prostřednictvím brány.**</span><span class="sxs-lookup"><span data-stu-id="01ca7-192">**Reverse proxy or gateway routing.**</span></span> <span data-ttu-id="01ca7-193">Brána rozhraní API nabízí reverzní proxy k přesměrování nebo směrovat požadavky (směrování vrstvy 7, obvykle požadavků HTTP) ke koncovým bodům interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-193">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually HTTP requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="01ca7-194">Brána poskytuje jeden koncový bod nebo URL klienta aplikace a interně mapuje požadavky na skupinu interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-194">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="01ca7-195">Tato funkce směrování pomáhá oddělit klientské aplikace z mikroslužeb, ale je také poměrně vhodné při modernizaci monolitické rozhraní API podle sedí mezi monolitické rozhraní API a klientské aplikace pak můžete bránu rozhraní API můžete přidat nové rozhraní API jako nové mikroslužby nadále pomocí starší verze rozhraní API monolitické, dokud se rozdělí na mnoha mikroslužeb v budoucnu.</span><span class="sxs-lookup"><span data-stu-id="01ca7-195">This routing feature helps to decouple the client apps from the microservices but it's also pretty convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it's split into many microservices in the future.</span></span> <span data-ttu-id="01ca7-196">Z důvodu brány rozhraní API klientské aplikace nebude Všimněte si, že pokud rozhraní API používá jsou implementovány jako interní mikroslužby nebo monolitické rozhraní API a důležitější je, když vyvíjí a refaktoring monolitické rozhraní API do mikroslužeb, a díky směrování brány rozhraní API , klientské aplikace nebude mít vliv změny identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="01ca7-196">Because of the API Gateway, the client apps won't notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won't be impacted with any URI change.</span></span>

<span data-ttu-id="01ca7-197">Další informace najdete v tématu [model směrování prostřednictvím brány](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="01ca7-197">For more information, see [Gateway routing pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="01ca7-198">**Agregace požadavků.**</span><span class="sxs-lookup"><span data-stu-id="01ca7-198">**Requests aggregation.**</span></span> <span data-ttu-id="01ca7-199">Jako součást vzorku bránu můžete shromažďovat více požadavky klientů (obvykle požadavků HTTP) na jeden požadavek klienta cílení na více interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-199">As part of the gateway pattern you can aggregate multiple client requests (usually HTTP requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="01ca7-200">Tento model je zvlášť vhodné, pokud stránka/obrazovky klienta potřebuje informace z několika mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-200">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="01ca7-201">S tímto přístupem klientská aplikace odesílá jeden požadavek na bránu rozhraní API, která odešle několik interní mikroslužeb a pak agreguje výsledky a všechno, co odešle zpět do klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-201">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="01ca7-202">Hlavní výhodou a cílem tohoto vzoru návrhu je ke snížení nadměrné komunikace mezi back-end rozhraní API a klientské aplikace, který je obzvláště důležité pro vzdálené aplikace mimo datové centrum, kde mikroslužby za provozu, jako jsou mobilní aplikace nebo požadavky přicházející z aplikace SPA, který pocházejí z jazyka Javascript v prohlížečích klienta vzdálené.</span><span class="sxs-lookup"><span data-stu-id="01ca7-202">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from Javascript in client remote browsers.</span></span> <span data-ttu-id="01ca7-203">Tento model pro běžné webové aplikace provádění požadavků v serverovém prostředí (například webovou aplikaci ASP.NET Core MVC), není tak důležitý, protože latence je velmi mnohem menší, než klient služby Vzdálená aplikace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-203">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="01ca7-204">V závislosti na bránu rozhraní API produktu, který používáte může být schopen provést tato agregace.</span><span class="sxs-lookup"><span data-stu-id="01ca7-204">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="01ca7-205">V mnoha případech je ale flexibilnější k vytvoření agregace mikroslužeb v oboru bránu rozhraní API, takže v kódu definovat agregace (to znamená C# kód):</span><span class="sxs-lookup"><span data-stu-id="01ca7-205">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code):</span></span>

<span data-ttu-id="01ca7-206">Další informace najdete v tématu [model agregace pomocí brány](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="01ca7-206">For more information, see [Gateway aggregation pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="01ca7-207">**Převeďte společné aspekty nebo snižování zátěže pomocí brány.**</span><span class="sxs-lookup"><span data-stu-id="01ca7-207">**Cross-cutting concerns or gateway offloading.**</span></span> <span data-ttu-id="01ca7-208">V závislosti na funkcí, které nabízí jednotlivé produkty Brána rozhraní API může převzít funkci z jednotlivých mikroslužeb pro bránu, která zjednodušuje implementace jednotlivých mikroslužeb tím, že sloučení vyskytující aspekty do jedné vrstvy.</span><span class="sxs-lookup"><span data-stu-id="01ca7-208">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="01ca7-209">To je zvlášť vhodné pro specializované funkce, které můžou být složité implementovat správně v každé vnitřní mikroslužeb, jako jsou následující funkce:</span><span class="sxs-lookup"><span data-stu-id="01ca7-209">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="01ca7-210">Ověřování a autorizace</span><span class="sxs-lookup"><span data-stu-id="01ca7-210">Authentication and authorization</span></span>
- <span data-ttu-id="01ca7-211">Integrace služby zjišťování</span><span class="sxs-lookup"><span data-stu-id="01ca7-211">Service discovery integration</span></span>
- <span data-ttu-id="01ca7-212">Ukládání odpovědí do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="01ca7-212">Response caching</span></span>
- <span data-ttu-id="01ca7-213">Opakování zásady, jističe a QoS</span><span class="sxs-lookup"><span data-stu-id="01ca7-213">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="01ca7-214">Omezení rychlosti a omezování</span><span class="sxs-lookup"><span data-stu-id="01ca7-214">Rate limiting and throttling</span></span>
- <span data-ttu-id="01ca7-215">Vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="01ca7-215">Load balancing</span></span>
- <span data-ttu-id="01ca7-216">Protokolování trasování, korelace</span><span class="sxs-lookup"><span data-stu-id="01ca7-216">Logging, tracing, correlation</span></span>
- <span data-ttu-id="01ca7-217">Záhlaví, řetězce dotazu a transformace deklarací identity</span><span class="sxs-lookup"><span data-stu-id="01ca7-217">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="01ca7-218">Přidávání na seznam povolených IP</span><span class="sxs-lookup"><span data-stu-id="01ca7-218">IP whitelisting</span></span>

<span data-ttu-id="01ca7-219">Další informace najdete v tématu [brány snižování zátěže vzor](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="01ca7-219">For more information, see [Gateway offloading pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="01ca7-220">Používání produktů s funkcí brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="01ca7-220">Using products with API Gateway features</span></span>

<span data-ttu-id="01ca7-221">Může existovat mnoho další vyskytující aspekty nabízených produktů brány rozhraní API v závislosti na každé provedení.</span><span class="sxs-lookup"><span data-stu-id="01ca7-221">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="01ca7-222">Co budeme prozkoumávat tady:</span><span class="sxs-lookup"><span data-stu-id="01ca7-222">We'll explore here:</span></span>

- [<span data-ttu-id="01ca7-223">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="01ca7-223">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="01ca7-224">Ocelot</span><span class="sxs-lookup"><span data-stu-id="01ca7-224">Ocelot</span></span>](https://github.com/ThreeMammals/Ocelot)

### <a name="azure-api-management"></a><span data-ttu-id="01ca7-225">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="01ca7-225">Azure API Management</span></span>

<span data-ttu-id="01ca7-226">[Azure API Management](https://azure.microsoft.com/services/api-management/) (jak je znázorněno v obrázek 4 – 14) nejen řeší potřeby Brána rozhraní API, ale poskytuje funkce, jako je shromažďování přehledů z rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="01ca7-226">[Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="01ca7-227">Pokud používáte vytváří řešení pro správu rozhraní API, brány rozhraní API je pouze v rámci této kompletnímu řešení správy rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="01ca7-227">If you're using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Azure API Management řeší vaše Brána rozhraní API a správy potřeby jako je protokolování, zabezpečení, měření, atd.](./media/image14.png)

<span data-ttu-id="01ca7-229">**Obrázek 4 – 14**.</span><span class="sxs-lookup"><span data-stu-id="01ca7-229">**Figure 4-14**.</span></span> <span data-ttu-id="01ca7-230">Pomocí Azure API Management pro vaši bránu rozhraní API</span><span class="sxs-lookup"><span data-stu-id="01ca7-230">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="01ca7-231">V takovém případě při použití produktů, jako je Azure API Management, skutečnost, že může mít jednu bránu rozhraní API není tak rizikové, protože tyto druhy brány rozhraní API se "tenčí", což znamená, že nemusíte implementovat vlastní kód jazyka C#, který by mohl vyvíjet monolitické komponenta.</span><span class="sxs-lookup"><span data-stu-id="01ca7-231">In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span> 

<span data-ttu-id="01ca7-232">Brána rozhraní API produktů obvykle fungují jako reverzní proxy server pro příchozí komunikaci, kde můžete taky filtrovat rozhraní API z interní mikroslužeb získat autorizace publikovaných rozhraní API na této úrovni jednoho.</span><span class="sxs-lookup"><span data-stu-id="01ca7-232">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="01ca7-233">Insights, která je dostupná z nápovědy API Management systému pomůžou pochopit, jak se používají vaše rozhraní API a jaký je výkon.</span><span class="sxs-lookup"><span data-stu-id="01ca7-233">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="01ca7-234">Je to tak, že umožňuje zobrazit téměř v reálném čase analytické sestavy a identifikace trendů, které může mít vliv na vaši firmu.</span><span class="sxs-lookup"><span data-stu-id="01ca7-234">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="01ca7-235">Navíc můžete mít protokolů o činnosti žádostí a odpovědí pro další online i offline analýzu.</span><span class="sxs-lookup"><span data-stu-id="01ca7-235">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="01ca7-236">S Azure API Management můžete zabezpečit vaše rozhraní API pomocí klíče, tokenu a filtrování protokolu IP.</span><span class="sxs-lookup"><span data-stu-id="01ca7-236">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="01ca7-237">Tyto funkce umožňují vynucovat flexibilní a podrobné kvóty a omezení přenosové rychlosti, upravujte podobu a chování rozhraní API pomocí zásad a zlepšit výkon díky mezipaměti odpovědí.</span><span class="sxs-lookup"><span data-stu-id="01ca7-237">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="01ca7-238">V této příručce a odkaz na ukázkovou aplikaci (aplikaci eShopOnContainers) architektura je omezená na kontejnerizovaných architektura jednodušší a vlastních abychom se mohli zaměřit na prostý kontejnerů bez použití produktů PaaS, jako je Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="01ca7-238">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="01ca7-239">Ale pro velké aplikace založené na mikroslužbách, které jsou nasazené do Microsoft Azure, doporučujeme vyhodnotit Azure API Management jako základ pro vaše brány rozhraní API v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="01ca7-239">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

### <a name="ocelot"></a><span data-ttu-id="01ca7-240">Ocelot</span><span class="sxs-lookup"><span data-stu-id="01ca7-240">Ocelot</span></span>

<span data-ttu-id="01ca7-241">[Ocelot](https://github.com/ThreeMammals/Ocelot) je lightweight Gateway rozhraní API, doporučuje se pro jednodušší přístupy.</span><span class="sxs-lookup"><span data-stu-id="01ca7-241">[Ocelot](https://github.com/ThreeMammals/Ocelot) is a lightweight API Gateway, recommended for simpler approaches.</span></span> <span data-ttu-id="01ca7-242">Ocelot je zvláště vytvořené brány založené na rozhraní API pro architekturu mikroslužeb, potřebujete jednotné body vstupu v jejich systému otevřít zdroj .NET Core.</span><span class="sxs-lookup"><span data-stu-id="01ca7-242">Ocelot is an Open Source .NET Core based API Gateway especially made for microservices architecture that need unified points of entry into their system.</span></span> <span data-ttu-id="01ca7-243">Je jednoduchý, rychlý, škálovatelný a poskytuje směrování a ověřování mezi mnoho dalších funkcí.</span><span class="sxs-lookup"><span data-stu-id="01ca7-243">It's lightweight, fast, scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="01ca7-244">Hlavní důvod, proč zvolit Ocelot pro [aplikaci eShopOnContainers odkazovat aplikace](https://github.com/dotnet-architecture/eShopOnContainers) totiž Ocelot je .NET Core zjednodušené rozhraní API brány, kterou můžete nasadit ve stejném prostředí nasazení aplikace, pokud nasazujete mikroslužby a kontejnery, například hostitele Docker, Kubernetes, Service Fabric, atd. A protože je založen na .NET Core, je multiplatformní můžete nasadit v systému Linux nebo Windows.</span><span class="sxs-lookup"><span data-stu-id="01ca7-244">The main reason to choose Ocelot for the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, Service Fabric, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="01ca7-245">Předchozí diagramy zobrazující vlastní rozhraní API brány spouštěných v kontejnerech jsou přesně, jak můžete také spustit Ocelot v kontejneru a aplikací založených na mikroslužbách.</span><span class="sxs-lookup"><span data-stu-id="01ca7-245">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="01ca7-246">Kromě toho na trhu nabídky funkce brány rozhraní API, jako je například Apigee, Hongkongu, MuleSoft, WSO2, existuje mnoho dalších produktů a funkcí kontroleru příchozího přenosu dat sítě produkty, jako jsou Linkerd a Istio pro službu.</span><span class="sxs-lookup"><span data-stu-id="01ca7-246">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="01ca7-247">Po počáteční architektury a vysvětlení části vzorce, následující části popisují, jak implementovat brány rozhraní API s [Ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="01ca7-247">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="01ca7-248">Nevýhody vzor brány rozhraní API</span><span class="sxs-lookup"><span data-stu-id="01ca7-248">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="01ca7-249">Nejdůležitější nevýhodou je, že při implementaci bránu rozhraní API už párování tuto úroveň s využitím interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-249">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="01ca7-250">Párování tímto způsobem může způsobit obtížemi pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="01ca7-250">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="01ca7-251">Vaster Clemense Návrhář v týmu Azure Service Bus, odkazuje na tento potenciální problémy s dokončením jako "nové ESB" v "[zasílání zpráv a Mikroslužby](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" přednášky z konference GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="01ca7-251">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as "the new ESB" in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="01ca7-252">Použití brány rozhraní API mikroslužeb vytvoří další možné jediný bod selhání.</span><span class="sxs-lookup"><span data-stu-id="01ca7-252">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="01ca7-253">Brány rozhraní API můžete zavést prodloužení doby odezvy z důvodu další síťová volání.</span><span class="sxs-lookup"><span data-stu-id="01ca7-253">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="01ca7-254">Toto dodatečné volání má však obvykle menší dopad, než když klientské rozhraní, které je příliš přetížení přímého volání vnitřní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-254">However, this extra call usually has less impact than having a client interface that's too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="01ca7-255">Pokud ne horizontálně navýší, brána rozhraní API se může stát kritickým bodem.</span><span class="sxs-lookup"><span data-stu-id="01ca7-255">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="01ca7-256">Pokud obsahuje vlastní logiku a agregace dat vyžaduje náklady na další vývoj a údržbu na budoucí bránu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="01ca7-256">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="01ca7-257">Vývojáři musí aktualizovat bránu rozhraní API, aby zpřístupňují koncové body jednotlivých mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-257">Developers must update the API Gateway in order to expose each microservice's endpoints.</span></span> <span data-ttu-id="01ca7-258">Kromě toho provádění změn v interní mikroslužeb může způsobit změny kódu na úrovni rozhraní API brány.</span><span class="sxs-lookup"><span data-stu-id="01ca7-258">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="01ca7-259">Ale pokud brána rozhraní API je pouze použití zabezpečení, protokolování a správa verzí (stejně jako při použití služby Azure API Management), nemusí platit náklady na tento další vývoj.</span><span class="sxs-lookup"><span data-stu-id="01ca7-259">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="01ca7-260">Pokud brána rozhraní API je vyvinutý jeden tým, může být kritickým bodem vývoje.</span><span class="sxs-lookup"><span data-stu-id="01ca7-260">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="01ca7-261">To je další důvod, proč lepším řešením je, aby několik pokutu grained brány rozhraní API, které reagují na požadavky jiného klienta.</span><span class="sxs-lookup"><span data-stu-id="01ca7-261">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="01ca7-262">Brána rozhraní API byste mohli izolovat také interně do více oblastí nebo vrstvy, které jsou majetkem společnosti různé týmy pracující na interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="01ca7-262">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="01ca7-263">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="01ca7-263">Additional resources</span></span>

- <span data-ttu-id="01ca7-264">**Charles Richardson. Vzor: Brána rozhraní API a back-endu pro front-endu** \\</span><span class="sxs-lookup"><span data-stu-id="01ca7-264">**Charles Richardson. Pattern: API Gateway / Backend for Front-End** \\</span></span>
  [*https://microservices.io/patterns/apigateway.html*](https://microservices.io/patterns/apigateway.html)

- <span data-ttu-id="01ca7-265">**Vzor brány rozhraní API** \\</span><span class="sxs-lookup"><span data-stu-id="01ca7-265">**API Gateway pattern** \\</span></span>
  [*https://docs.microsoft.com/azure/architecture/microservices/gateway*](https://docs.microsoft.com/azure/architecture/microservices/gateway)

- <span data-ttu-id="01ca7-266">**Agregace a skládání modelu** \\</span><span class="sxs-lookup"><span data-stu-id="01ca7-266">**Aggregation and composition pattern** \\</span></span>
  [*https://microservices.io/patterns/data/api-composition.html*](https://microservices.io/patterns/data/api-composition.html)

- <span data-ttu-id="01ca7-267">**Azure API Management** \\</span><span class="sxs-lookup"><span data-stu-id="01ca7-267">**Azure API Management** \\</span></span>
  [*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)

- <span data-ttu-id="01ca7-268">**Udi Dahan. Služba orientovaný složení** \\</span><span class="sxs-lookup"><span data-stu-id="01ca7-268">**Udi Dahan. Service Oriented Composition** \\</span></span>
  [*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)

- <span data-ttu-id="01ca7-269">**Clemense Vasterse. Zasílání zpráv a Mikroslužby na 2016 GOTO (video)** \\</span><span class="sxs-lookup"><span data-stu-id="01ca7-269">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (video)** \\</span></span>
  [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)

- <span data-ttu-id="01ca7-270">**Brána rozhraní API v kostce** (série kurzů ASP.net Core Brána rozhraní API) \\</span><span class="sxs-lookup"><span data-stu-id="01ca7-270">**API Gateway in a Nutshell** (ASP.net Core API Gateway Tutorial Series) \\</span></span>
  [*https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html*](https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html)

>[!div class="step-by-step"]
><span data-ttu-id="01ca7-271">[Předchozí](identify-microservice-domain-model-boundaries.md)
>[další](communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="01ca7-271">[Previous](identify-microservice-domain-model-boundaries.md)
[Next](communication-in-microservice-architecture.md)</span></span>