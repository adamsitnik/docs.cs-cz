---
title: Vytváření, vývoj a správa verzí rozhraní API a kontraktů mikroslužeb
description: Vytváření mikroslužeb rozhraní API a kontraktů zvažujete vývoj a správu verzí, protože změní.
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 09/20/2018
ms.openlocfilehash: f42de3895f7f9affe09891fd89621fbb414313e9
ms.sourcegitcommit: 438919211260bb415fc8f96ca3eabc33cf2d681d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/16/2019
ms.locfileid: "59612105"
---
# <a name="creating-evolving-and-versioning-microservice-apis-and-contracts"></a><span data-ttu-id="9cd24-103">Vytváření, vývoj a správa verzí rozhraní API a kontraktů mikroslužeb</span><span class="sxs-lookup"><span data-stu-id="9cd24-103">Creating, evolving, and versioning microservice APIs and contracts</span></span>

<span data-ttu-id="9cd24-104">Mikroslužba rozhraní API je kontrakt mezi službou a klienty.</span><span class="sxs-lookup"><span data-stu-id="9cd24-104">A microservice API is a contract between the service and its clients.</span></span> <span data-ttu-id="9cd24-105">Budete moct vyvíjet mikroslužby nezávisle na sobě jenom v případě, že nedojde k narušení jeho kontrakt rozhraní API, který je důvod, proč je proto důležité kontrakt.</span><span class="sxs-lookup"><span data-stu-id="9cd24-105">You'll be able to evolve a microservice independently only if you do not break its API contract, which is why the contract is so important.</span></span> <span data-ttu-id="9cd24-106">Pokud změníte kontrakt, bude to mít vliv klientských aplikací nebo brány rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="9cd24-106">If you change the contract, it will impact your client applications or your API Gateway.</span></span>

<span data-ttu-id="9cd24-107">Druh definice rozhraní API závisí na protokol, který používáte.</span><span class="sxs-lookup"><span data-stu-id="9cd24-107">The nature of the API definition depends on which protocol you're using.</span></span> <span data-ttu-id="9cd24-108">Například pokud používáte zasílání zpráv (například [AMQP](https://www.amqp.org/)), rozhraní API se skládá z typy zpráv.</span><span class="sxs-lookup"><span data-stu-id="9cd24-108">For instance, if you're using messaging (like [AMQP](https://www.amqp.org/)), the API consists of the message types.</span></span> <span data-ttu-id="9cd24-109">Pokud používáte protokol HTTP a služby typu REST, se skládá z JSON formáty požadavků a odpovědí a adresy URL rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="9cd24-109">If you're using HTTP and RESTful services, the API consists of the URLs and the request and response JSON formats.</span></span>

<span data-ttu-id="9cd24-110">Nicméně i v případě, že je pro vás důkladné o počáteční smlouvy, rozhraní API služby muset v průběhu času měnit.</span><span class="sxs-lookup"><span data-stu-id="9cd24-110">However, even if you're thoughtful about your initial contract, a service API will need to change over time.</span></span> <span data-ttu-id="9cd24-111">Když se to stane – a zejména v případě, že vaše rozhraní API je veřejné rozhraní API používané více klientských aplikací – obvykle nemůžou vynutit všichni klienti k upgradu na nové smlouvy rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="9cd24-111">When that happens—and especially if your API is a public API consumed by multiple client applications — you typically can't force all clients to upgrade to your new API contract.</span></span> <span data-ttu-id="9cd24-112">Obvykle je nutné přírůstkově nasazovat nové verze služby tak, aby staré a nové verze kontraktu služby jsou spuštěny souběžně.</span><span class="sxs-lookup"><span data-stu-id="9cd24-112">You usually need to incrementally deploy new versions of a service in a way that both old and new versions of a service contract are running simultaneously.</span></span> <span data-ttu-id="9cd24-113">Proto je důležité mít strategii pro vaši službu správy verzí.</span><span class="sxs-lookup"><span data-stu-id="9cd24-113">Therefore, it's important to have a strategy for your service versioning.</span></span>

<span data-ttu-id="9cd24-114">Při změn rozhraní API jsou malé, například pokud můžete přidat atributy nebo parametry do vašeho rozhraní API, klienty, kteří používají starší rozhraní API by měla přepnutí a pracovat s novou verzi služby.</span><span class="sxs-lookup"><span data-stu-id="9cd24-114">When the API changes are small, like if you add attributes or parameters to your API, clients that use an older API should switch and work with the new version of the service.</span></span> <span data-ttu-id="9cd24-115">Je možné zadat výchozí hodnoty pro všechny chybějící atributy, které jsou požadovány, a klienti možná půjde ignorovat jakékoli další odpovědi atributy.</span><span class="sxs-lookup"><span data-stu-id="9cd24-115">You might be able to provide default values for any missing attributes that are required, and the clients might be able to ignore any extra response attributes.</span></span>

<span data-ttu-id="9cd24-116">Ale někdy potřebujete provádět změny hlavní a nekompatibilní rozhraní API služby.</span><span class="sxs-lookup"><span data-stu-id="9cd24-116">However, sometimes you need to make major and incompatible changes to a service API.</span></span> <span data-ttu-id="9cd24-117">Vzhledem k tomu, že nebudete moci vynutit klientských aplikací nebo služeb hned upgradovat na novou verzi, musí podporovat službu starší verze rozhraní API pro určitou dobu.</span><span class="sxs-lookup"><span data-stu-id="9cd24-117">Because you might not be able to force client applications or services to upgrade immediately to the new version, a service must support older versions of the API for some period.</span></span> <span data-ttu-id="9cd24-118">Pokud používáte mechanismus založený na protokolu HTTP, jako je REST, jedním z přístupů je vložit číslo verze rozhraní API v adrese URL, nebo do hlavičky protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="9cd24-118">If you're using an HTTP-based mechanism such as REST, one approach is to embed the API version number in the URL or into an HTTP header.</span></span> <span data-ttu-id="9cd24-119">Pak se můžete rozhodnout mezi implementace obě verze služby současně v rámci stejné instance služby nebo nasazení různých instancích, každý zpracovat verzi rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="9cd24-119">Then you can decide between implementing both versions of the service simultaneously within the same service instance, or deploying different instances that each handle a version of the API.</span></span> <span data-ttu-id="9cd24-120">Je dobrý přístup pro toto [zprostředkovatel vzor](https://en.wikipedia.org/wiki/Mediator_pattern) (například [MediatR knihovny](https://github.com/jbogard/MediatR)) oddělit různé implementace verze do nezávislé obslužné rutiny.</span><span class="sxs-lookup"><span data-stu-id="9cd24-120">A good approach for this is the [Mediator pattern](https://en.wikipedia.org/wiki/Mediator_pattern) (for example, [MediatR library](https://github.com/jbogard/MediatR)) to decouple the different implementation versions into independent handlers.</span></span>

<span data-ttu-id="9cd24-121">Nakonec, pokud používáte s architekturou REST [Hypermédia](https://www.infoq.com/articles/mark-baker-hypermedia) je nejlepší řešení pro správu verzí, služeb a umožní evolvable rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="9cd24-121">Finally, if you're using a REST architecture, [Hypermedia](https://www.infoq.com/articles/mark-baker-hypermedia) is the best solution for versioning your services and allowing evolvable APIs.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="9cd24-122">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="9cd24-122">Additional resources</span></span>

- <span data-ttu-id="9cd24-123">**Scott Hanselman. Správa verzí RESTful webového rozhraní API ASP.NET Core snadné** \\</span><span class="sxs-lookup"><span data-stu-id="9cd24-123">**Scott Hanselman. ASP.NET Core RESTful Web API versioning made easy** \\</span></span>
  <https://www.hanselman.com/blog/ASPNETCoreRESTfulWebAPIVersioningMadeEasy.aspx>

- <span data-ttu-id="9cd24-124">**Správa verzí RESTful webového rozhraní API** \\</span><span class="sxs-lookup"><span data-stu-id="9cd24-124">**Versioning a RESTful web API** \\</span></span>
  <https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api>

- <span data-ttu-id="9cd24-125">**Roy Fielding. Správa verzí, Hypermédia a REST** \\</span><span class="sxs-lookup"><span data-stu-id="9cd24-125">**Roy Fielding. Versioning, Hypermedia, and REST** \\</span></span>
  <https://www.infoq.com/articles/roy-fielding-on-versioning>

>[!div class="step-by-step"]
><span data-ttu-id="9cd24-126">[Předchozí](asynchronous-message-based-communication.md)
>[další](microservices-addressability-service-registry.md)</span><span class="sxs-lookup"><span data-stu-id="9cd24-126">[Previous](asynchronous-message-based-communication.md)
[Next](microservices-addressability-service-registry.md)</span></span>
