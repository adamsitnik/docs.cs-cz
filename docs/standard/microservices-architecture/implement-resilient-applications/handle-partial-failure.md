---
title: Zpracování částečného selhání
description: Zjistěte, jak pro zpracování částečného selhání bez výpadku. Mikroslužby nemusí být plně funkční, ale stále může být schopen provádět některé užitečné práce.
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/16/2018
ms.openlocfilehash: 16b6237f79d6b4bc2bc9152ba6eb023ffbd3899f
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "61977675"
---
# <a name="handle-partial-failure"></a><span data-ttu-id="09496-104">Zpracování částečného selhání</span><span class="sxs-lookup"><span data-stu-id="09496-104">Handle partial failure</span></span>

<span data-ttu-id="09496-105">V distribuovaných systémech, jako je aplikace založená na mikroslužbách je všudypřítomnou riziko částečného selhání.</span><span class="sxs-lookup"><span data-stu-id="09496-105">In distributed systems like microservices-based applications, there's an ever-present risk of partial failure.</span></span> <span data-ttu-id="09496-106">Například jeden mikroslužeb nebo kontejnerů může selhat nebo nemusí být možné reagovat na krátkou dobu, nebo jeden virtuální počítač nebo server může dojít k chybě.</span><span class="sxs-lookup"><span data-stu-id="09496-106">For instance, a single microservice/container can fail or might not be available to respond for a short time, or a single VM or server can crash.</span></span> <span data-ttu-id="09496-107">Od klientů a služeb jsou samostatné procesy, služba nemusí být schopné reagovat včas na žádost klienta.</span><span class="sxs-lookup"><span data-stu-id="09496-107">Since clients and services are separate processes, a service might not be able to respond in a timely way to a client’s request.</span></span> <span data-ttu-id="09496-108">Služba může být přetížená a odpovídá velmi pomalu do požadavků nebo nemusí být dostupný na krátkou dobu jednoduše z důvodu problémů se sítí.</span><span class="sxs-lookup"><span data-stu-id="09496-108">The service might be overloaded and responding very slowly to requests or might simply not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="09496-109">Představte si třeba stránka Podrobnosti objednávky z aplikaci eShopOnContainers ukázkovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="09496-109">For example, consider the Order details page from the eShopOnContainers sample application.</span></span> <span data-ttu-id="09496-110">Pokud řazení mikroslužba přestane reagovat při pokusu uživatele o odešlete odbejdnávku, chybnou implementací procesu klientů (webová aplikace MVC) – například, pokud kód klienta chtěli použít synchronní RPC bez časového limitu, bude blokovaná vlákna Čekání na odpověď.</span><span class="sxs-lookup"><span data-stu-id="09496-110">If the ordering microservice is unresponsive when the user tries to submit an order, a bad implementation of the client process (the MVC web application)—for example, if the client code were to use synchronous RPCs with no timeout—would block threads indefinitely waiting for a response.</span></span> <span data-ttu-id="09496-111">Kromě vytvoření nepříjemné zkušenosti, každý reagovat používá nebo blokuje vlákno a vlákna jsou extrémně cennou ve vysoce škálovatelných aplikací.</span><span class="sxs-lookup"><span data-stu-id="09496-111">Besides creating a bad user experience, every unresponsive wait consumes or blocks a thread, and threads are extremely valuable in highly scalable applications.</span></span> <span data-ttu-id="09496-112">Pokud existují mnoho blokovaná vlákna, nakonec modulu runtime aplikace můžete zjistit nedostatek podprocesů.</span><span class="sxs-lookup"><span data-stu-id="09496-112">If there are many blocked threads, eventually the application’s runtime can run out of threads.</span></span> <span data-ttu-id="09496-113">V takovém případě může přestat aplikace globálně reagovat místo jen částečně reagovat, jak ukazuje obrázek 8-1.</span><span class="sxs-lookup"><span data-stu-id="09496-113">In that case, the application can become globally unresponsive instead of just partially unresponsive, as shown in Figure 8-1.</span></span>

![Diagram znázorňující předchozím odstavci](./media/image1.png)

<span data-ttu-id="09496-115">**Obrázek 8-1**.</span><span class="sxs-lookup"><span data-stu-id="09496-115">**Figure 8-1**.</span></span> <span data-ttu-id="09496-116">Částečně neúspěšné z důvodu závislosti, které ovlivňují dostupnost služeb vlákna</span><span class="sxs-lookup"><span data-stu-id="09496-116">Partial failures because of dependencies that impact service thread availability</span></span>

<span data-ttu-id="09496-117">V případě velkých aplikací založených na mikroslužbách může být rozšířena jakékoli částečného selhání, zejména v případě, že většina interakce interní mikroslužeb je založen na synchronní volání HTTP (což se považuje za proti vzor).</span><span class="sxs-lookup"><span data-stu-id="09496-117">In a large microservices-based application, any partial failure can be amplified, especially if most of the internal microservices interaction is based on synchronous HTTP calls (which is considered an anti-pattern).</span></span> <span data-ttu-id="09496-118">Představte si systém, která bude přijímat miliony příchozí volání za den.</span><span class="sxs-lookup"><span data-stu-id="09496-118">Think about a system that receives millions of incoming calls per day.</span></span> <span data-ttu-id="09496-119">Pokud váš systém má chybný návrh, který je založen na dlouhé řetězce synchronní volání HTTP, může vést k mnoha milionů víc odchozích hovorů (Předpokládejme poměr 1:4) k desítkám interní mikroslužeb jako synchronní závislosti těchto příchozí volání.</span><span class="sxs-lookup"><span data-stu-id="09496-119">If your system has a bad design that's based on long chains of synchronous HTTP calls, these incoming calls might result in many more millions of outgoing calls (let’s suppose a ratio of 1:4) to dozens of internal microservices as synchronous dependencies.</span></span> <span data-ttu-id="09496-120">Tato situace se zobrazí v 8 obrázek-2, zejména závislost \#3.</span><span class="sxs-lookup"><span data-stu-id="09496-120">This situation is shown in Figure 8-2, especially dependency \#3.</span></span>

![Nesprávný návrhu pro webové aplikace mikroslužeb, který závisí na řetězci závislosti na jiných mikroslužeb](./media/image2.png)

<span data-ttu-id="09496-122">**Obrázek 8-2**.</span><span class="sxs-lookup"><span data-stu-id="09496-122">**Figure 8-2**.</span></span> <span data-ttu-id="09496-123">Dopad s při nesprávné návrhu s dlouhé řetězce požadavků protokolu HTTP</span><span class="sxs-lookup"><span data-stu-id="09496-123">The impact of having an incorrect design featuring long chains of HTTP requests</span></span>

<span data-ttu-id="09496-124">Občasné selhání je zaručeno, že v systému distribuované a založené na cloudu, i v případě, že všechny závislosti, samotný má skvělé dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="09496-124">Intermittent failure is guaranteed in a distributed and cloud-based system, even if every dependency itself has excellent availability.</span></span> <span data-ttu-id="09496-125">Je fakt, které je potřeba zvážit.</span><span class="sxs-lookup"><span data-stu-id="09496-125">It's a fact you need to consider.</span></span>

<span data-ttu-id="09496-126">Pokud není navrhovat a implementovat techniky k zajištění odolnosti proti chybám, může být rozšířena i malá výpadky.</span><span class="sxs-lookup"><span data-stu-id="09496-126">If you do not design and implement techniques to ensure fault tolerance, even small downtimes can be amplified.</span></span> <span data-ttu-id="09496-127">Jako příklad způsobí 50 závislosti každý s 99,99 % dostupnost několik hodin výpadků každý měsíc z důvodu tohoto efektu Zvlnění.</span><span class="sxs-lookup"><span data-stu-id="09496-127">As an example, 50 dependencies each with 99.99% of availability would result in several hours of downtime each month because of this ripple effect.</span></span> <span data-ttu-id="09496-128">Když závislost mikroslužeb selže při zpracovávání požadavků, které selhání můžete rychle saturate všechna vlákna žádosti k dispozici v jednotlivých služeb a chybách u aplikací celou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="09496-128">When a microservice dependency fails while handling a high volume of requests, that failure can quickly saturate all available request threads in each service and crash the whole application.</span></span>

![Částečné selhání může být přísně doplněné zřetězené závislosti](./media/image3.png)

<span data-ttu-id="09496-130">**Obrázek 8-3**.</span><span class="sxs-lookup"><span data-stu-id="09496-130">**Figure 8-3**.</span></span> <span data-ttu-id="09496-131">Pomocí mikroslužeb s dlouhé řetězce o synchronních voláních HTTP částečného selhání</span><span class="sxs-lookup"><span data-stu-id="09496-131">Partial failure amplified by microservices with long chains of synchronous HTTP calls</span></span>

<span data-ttu-id="09496-132">Chcete-li minimalizovat potíže, v části [asynchronní mikroslužeb integrace vynutit na mikroslužbách autonomie](../architect-microservice-container-applications/communication-in-microservice-architecture.md#asynchronous-microservice-integration-enforces-microservices-autonomy), tento průvodce doporučuje použít asynchronní komunikaci mezi interní mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="09496-132">To minimize this problem, in the section [Asynchronous microservice integration enforce microservice’s autonomy](../architect-microservice-container-applications/communication-in-microservice-architecture.md#asynchronous-microservice-integration-enforces-microservices-autonomy), this guide encourages you to use asynchronous communication across the internal microservices.</span></span>

<span data-ttu-id="09496-133">Kromě toho je nezbytné, navrhnout vaše mikroslužeb a klientských aplikací pro zpracování částečného selhání – to znamená, vytvářet odolné mikroslužeb a klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="09496-133">In addition, it's essential that you design your microservices and client applications to handle partial failures—that is, to build resilient microservices and client applications.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="09496-134">[Předchozí](index.md)
>[další](partial-failure-strategies.md)</span><span class="sxs-lookup"><span data-stu-id="09496-134">[Previous](index.md)
[Next](partial-failure-strategies.md)</span></span>