---
title: Programování serveru SQL Server a atributy ochrany hostitele
ms.date: 03/30/2017
helpviewer_keywords:
- SQL Server [.NET Framework]
- permission sets, SQL Server
- SQL Server Programming and Host Protection Attributes
- managed code, SQL Server
- reliability [.NET Framework]
- writing reliable code
- hosts, reliability
- host protection attributes
- HostProtectionAttribute class, reliability
ms.assetid: 7dfa36b4-e773-4c75-a3ff-ff1af3ce4c4f
author: mairaw
ms.author: mairaw
ms.openlocfilehash: f1049187dabbea64599617bb4372ed50515a51e3
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/08/2019
ms.locfileid: "59088716"
---
# <a name="sql-server-programming-and-host-protection-attributes"></a>Programování serveru SQL Server a atributy ochrany hostitele
Umožňuje načtení a spuštění spravovaného kódu v hostitelském systému SQL Server vyžaduje splnění požadavků hostitele pro zabezpečení přístupu kódu a Ochrana prostředků hostitele.  Požadavky na zabezpečení přístupu kódu jsou určena pomocí jedné ze tří sad oprávnění systému SQL Server: BEZPEČNĚ, vnější přístup nebo UNSAFE. Spouštěním kódu ve TREZORU nebo externí přístup sady oprávnění musí vyloučit určité typy nebo členy, které mají <xref:System.Security.Permissions.HostProtectionAttribute> atribut. <xref:System.Security.Permissions.HostProtectionAttribute> Není oprávnění zabezpečení tak, jak záruka spolehlivosti v identifikuje konkrétní kód vytvoří, typy a metody, mohou zakázat hostitele.  Použití <xref:System.Security.Permissions.HostProtectionAttribute> vynucuje programovací model, který pomáhá chránit stabilitu hostitele.  
  
## <a name="host-protection-attributes"></a>Atributy ochrany hostitele  
 Atributy ochrany hostitele identifikujte typy nebo členy, které nemají přizpůsobit programovací model hostitele a představují následující zvýšení úrovně hrozeb spolehlivosti:  
  
-   Jinak jsou neškodné.  
  
-   Může vést k destabilization server spravován uživatelského kódu.  
  
-   Může vést k destabilization samotného procesu serveru.  
  
 SQL Server nepovoluje použití typu nebo člena, který má <xref:System.Security.Permissions.HostProtectionAttribute> , který určuje <xref:System.Security.Permissions.HostProtectionResource> hodnotu <xref:System.Security.Permissions.HostProtectionResource.SharedState>, <xref:System.Security.Permissions.HostProtectionResource.Synchronization>, <xref:System.Security.Permissions.HostProtectionResource.MayLeakOnAbort>, nebo <xref:System.Security.Permissions.HostProtectionResource.ExternalProcessMgmt>. To zabraňuje sestavení z volání členy, které povolit sdílení stavu, provede synchronizaci, může způsobit, že prostředek na ukončení nebo vliv na celistvost procesu serveru SQL Server.  
  
### <a name="disallowed-types-and-members"></a>Nepovolené typy a členy  
 V následující tabulce jsou uvedeny typy a členy jehož <xref:System.Security.Permissions.HostProtectionResource> nejsou povoleny hodnoty systémem SQL Server.  
  
|Obor názvů|Typ nebo člen|  
|---------------|--------------------|  
|`Microsoft.Win32`|<xref:Microsoft.Win32.PowerModeChangedEventArgs> třída<br /><br /> <xref:Microsoft.Win32.PowerModeChangedEventHandler> delegát<br /><br /> <xref:Microsoft.Win32.SessionEndedEventArgs> třída<br /><br /> <xref:Microsoft.Win32.SessionEndedEventHandler> delegát<br /><br /> <xref:Microsoft.Win32.SessionEndingEventArgs> třída<br /><br /> <xref:Microsoft.Win32.SessionEndingEventHandler> delegát<br /><br /> <xref:Microsoft.Win32.SessionSwitchEventArgs> třída<br /><br /> <xref:Microsoft.Win32.SessionSwitchEventHandler> delegát<br /><br /> <xref:Microsoft.Win32.SystemEvents> třída<br /><br /> <xref:Microsoft.Win32.TimerElapsedEventArgs> třída<br /><br /> <xref:Microsoft.Win32.TimerElapsedEventHandler> delegát<br /><br /> <xref:Microsoft.Win32.UserPreferenceChangedEventArgs> třída<br /><br /> <xref:Microsoft.Win32.UserPreferenceChangingEventArgs> třída|  
|`System.Collections`|<xref:System.Collections.ArrayList.Synchronized%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Collections.Hashtable.Synchronized%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Collections.Queue.Synchronized%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Collections.SortedList.Synchronized%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Collections.Stack.Synchronized%2A?displayProperty=nameWithType> – metoda|  
|`System.ComponentModel`|<xref:System.ComponentModel.AddingNewEventArgs> třída<br /><br /> <xref:System.ComponentModel.AddingNewEventHandler> delegát<br /><br /> <xref:System.ComponentModel.ArrayConverter> třída<br /><br /> <xref:System.ComponentModel.AsyncCompletedEventArgs> třída<br /><br /> <xref:System.ComponentModel.AsyncCompletedEventHandler> delegát<br /><br /> <xref:System.ComponentModel.AsyncOperation> třída<br /><br /> <xref:System.ComponentModel.AsyncOperationManager> třída<br /><br /> <xref:System.ComponentModel.AttributeCollection> třída<br /><br /> <xref:System.ComponentModel.BackgroundWorker> třída<br /><br /> <xref:System.ComponentModel.BaseNumberConverter> třída<br /><br /> <xref:System.ComponentModel.BindingList%601> třída<br /><br /> <xref:System.ComponentModel.BooleanConverter> třída<br /><br /> <xref:System.ComponentModel.ByteConverter> třída<br /><br /> <xref:System.ComponentModel.CancelEventArgs> třída<br /><br /> <xref:System.ComponentModel.CancelEventHandler> delegát<br /><br /> <xref:System.ComponentModel.CharConverter> třída<br /><br /> <xref:System.ComponentModel.CollectionChangeEventArgs> třída<br /><br /> <xref:System.ComponentModel.CollectionChangeEventHandler> delegát<br /><br /> <xref:System.ComponentModel.CollectionConverter> třída<br /><br /> <xref:System.ComponentModel.ComponentCollection> třída<br /><br /> <xref:System.ComponentModel.ComponentConverter> třída<br /><br /> <xref:System.ComponentModel.ComponentEditor> třída<br /><br /> <xref:System.ComponentModel.ComponentResourceManager> třída<br /><br /> <xref:System.ComponentModel.Container> třída<br /><br /> <xref:System.ComponentModel.ContainerFilterService> třída<br /><br /> <xref:System.ComponentModel.CultureInfoConverter> třída<br /><br /> <xref:System.ComponentModel.CustomTypeDescriptor> třída<br /><br /> <xref:System.ComponentModel.DateTimeConverter> třída<br /><br /> <xref:System.ComponentModel.DecimalConverter> třída<br /><br /> <xref:System.ComponentModel.Design.ActiveDesignerEventArgs> třída<br /><br /> <xref:System.ComponentModel.Design.ActiveDesignerEventHandler> delegát<br /><br /> <xref:System.ComponentModel.Design.CheckoutException> třída<br /><br /> <xref:System.ComponentModel.Design.CommandID> třída<br /><br /> <xref:System.ComponentModel.Design.ComponentChangedEventArgs> třída<br /><br /> <xref:System.ComponentModel.Design.ComponentChangedEventHandler> delegát<br /><br /> <xref:System.ComponentModel.Design.ComponentChangingEventArgs> třída<br /><br /> <xref:System.ComponentModel.Design.ComponentChangingEventHandler> delegát<br /><br /> <xref:System.ComponentModel.Design.ComponentEventArgs> třída<br /><br /> <xref:System.ComponentModel.Design.ComponentEventHandler> delegát<br /><br /> <xref:System.ComponentModel.Design.ComponentRenameEventArgs> třída<br /><br /> <xref:System.ComponentModel.Design.ComponentRenameEventHandler> delegát<br /><br /> <xref:System.ComponentModel.Design.DesignerCollection> třída<br /><br /> <xref:System.ComponentModel.Design.DesignerEventArgs> třída<br /><br /> <xref:System.ComponentModel.Design.DesignerEventHandler> delegát<br /><br /> <xref:System.ComponentModel.Design.DesignerOptionService> třída<br /><br /> <xref:System.ComponentModel.Design.DesignerTransaction> třída<br /><br /> <xref:System.ComponentModel.Design.DesignerTransactionCloseEventArgs> třída<br /><br /> <xref:System.ComponentModel.Design.DesignerTransactionCloseEventHandler> delegát<br /><br /> <xref:System.ComponentModel.Design.DesignerVerb> třída<br /><br /> <xref:System.ComponentModel.Design.DesignerVerbCollection> třída<br /><br /> <xref:System.ComponentModel.Design.DesigntimeLicenseContext> třída<br /><br /> <xref:System.ComponentModel.Design.DesigntimeLicenseContextSerializer> třída<br /><br /> <xref:System.ComponentModel.Design.MenuCommand> třída<br /><br /> <xref:System.ComponentModel.Design.Serialization.ComponentSerializationService> třída<br /><br /> <xref:System.ComponentModel.Design.Serialization.ContextStack> třída<br /><br /> <xref:System.ComponentModel.Design.Serialization.DesignerLoader> třída<br /><br /> <xref:System.ComponentModel.Design.Serialization.InstanceDescriptor> třída<br /><br /> <xref:System.ComponentModel.Design.Serialization.MemberRelationshipService> třída<br /><br /> <xref:System.ComponentModel.Design.Serialization.ResolveNameEventArgs> třída<br /><br /> <xref:System.ComponentModel.Design.Serialization.ResolveNameEventHandler> delegát<br /><br /> <xref:System.ComponentModel.Design.Serialization.SerializationStore> třída<br /><br /> <xref:System.ComponentModel.Design.ServiceContainer> třída<br /><br /> <xref:System.ComponentModel.Design.ServiceCreatorCallback> delegát<br /><br /> <xref:System.ComponentModel.Design.StandardCommands> třída<br /><br /> <xref:System.ComponentModel.Design.StandardToolWindows> třída<br /><br /> <xref:System.ComponentModel.DoubleConverter> třída<br /><br /> <xref:System.ComponentModel.DoWorkEventArgs> třída<br /><br /> <xref:System.ComponentModel.DoWorkEventHandler> delegát<br /><br /> <xref:System.ComponentModel.EnumConverter> třída<br /><br /> <xref:System.ComponentModel.EventDescriptor> třída<br /><br /> <xref:System.ComponentModel.EventDescriptorCollection> třída<br /><br /> <xref:System.ComponentModel.EventHandlerList> třída<br /><br /> <xref:System.ComponentModel.ExpandableObjectConverter> třída<br /><br /> <xref:System.ComponentModel.HandledEventArgs> třída<br /><br /> <xref:System.ComponentModel.HandledEventHandler> delegát<br /><br /> <xref:System.ComponentModel.InstanceCreationEditor> třída<br /><br /> <xref:System.ComponentModel.Int16Converter> třída<br /><br /> <xref:System.ComponentModel.Int32Converter> třída<br /><br /> <xref:System.ComponentModel.Int64Converter> třída<br /><br /> <xref:System.ComponentModel.InvalidAsynchronousStateException> třída<br /><br /> <xref:System.ComponentModel.InvalidEnumArgumentException> třída<br /><br /> <xref:System.ComponentModel.ISynchronizeInvoke.BeginInvoke%2A> – metoda<br /><br /> <xref:System.ComponentModel.License> třída<br /><br /> <xref:System.ComponentModel.LicenseContext> třída<br /><br /> <xref:System.ComponentModel.LicenseException> třída<br /><br /> <xref:System.ComponentModel.LicenseManager> třída<br /><br /> <xref:System.ComponentModel.LicenseProvider> třída<br /><br /> <xref:System.ComponentModel.LicFileLicenseProvider> třída<br /><br /> <xref:System.ComponentModel.ListChangedEventArgs> třída<br /><br /> <xref:System.ComponentModel.ListChangedEventHandler> delegát<br /><br /> <xref:System.ComponentModel.ListSortDescription> třída<br /><br /> <xref:System.ComponentModel.ListSortDescriptionCollection> třída<br /><br /> <xref:System.ComponentModel.MaskedTextProvider> třída<br /><br /> <xref:System.ComponentModel.MemberDescriptor> třída<br /><br /> <xref:System.ComponentModel.MultilineStringConverter> třída<br /><br /> <xref:System.ComponentModel.NestedContainer> třída<br /><br /> <xref:System.ComponentModel.NullableConverter> třída<br /><br /> <xref:System.ComponentModel.ProgressChangedEventArgs> třída<br /><br /> <xref:System.ComponentModel.ProgressChangedEventHandler> delegát<br /><br /> <xref:System.ComponentModel.PropertyChangedEventArgs> třída<br /><br /> <xref:System.ComponentModel.PropertyChangedEventHandler> delegát<br /><br /> <xref:System.ComponentModel.PropertyDescriptor> třída<br /><br /> <xref:System.ComponentModel.PropertyDescriptorCollection> třída<br /><br /> <xref:System.ComponentModel.ReferenceConverter> třída<br /><br /> <xref:System.ComponentModel.RefreshEventArgs> třída<br /><br /> <xref:System.ComponentModel.RefreshEventHandler> delegát<br /><br /> <xref:System.ComponentModel.RunWorkerCompletedEventArgs> třída<br /><br /> <xref:System.ComponentModel.RunWorkerCompletedEventHandler> delegát<br /><br /> <xref:System.ComponentModel.SByteConverter> třída<br /><br /> <xref:System.ComponentModel.SingleConverter> třída<br /><br /> <xref:System.ComponentModel.StringConverter> třída<br /><br /> <xref:System.ComponentModel.SyntaxCheck> třída<br /><br /> <xref:System.ComponentModel.TimeSpanConverter> třída<br /><br /> <xref:System.ComponentModel.TypeConverter> třída<br /><br /> <xref:System.ComponentModel.TypeDescriptionProvider> třída<br /><br /> <xref:System.ComponentModel.TypeDescriptor> třída<br /><br /> <xref:System.ComponentModel.TypeListConverter> třída<br /><br /> <xref:System.ComponentModel.UInt16Converter> třída<br /><br /> <xref:System.ComponentModel.UInt32Converter> třída<br /><br /> <xref:System.ComponentModel.UInt64Converter> třída<br /><br /> <xref:System.ComponentModel.WarningException> třída<br /><br /> <xref:System.ComponentModel.Win32Exception> třída|  
|`System.Diagnostics`|<xref:System.Diagnostics.Debug.Listeners%2A?displayProperty=nameWithType> property<br /><br /> <xref:System.Diagnostics.Trace.Listeners%2A?displayProperty=nameWithType> property<br /><br /> <xref:System.Diagnostics.EventLog.SynchronizingObject%2A?displayProperty=nameWithType> property<br /><br /> <xref:System.Diagnostics.ConsoleTraceListener> třída<br /><br /> <xref:System.Diagnostics.DefaultTraceListener> třída<br /><br /> <xref:System.Diagnostics.DelimitedListTraceListener> třída<br /><br /> <xref:System.Diagnostics.EventLogTraceListener> třída<br /><br /> <xref:System.Diagnostics.PerformanceCounter> třída<br /><br /> <xref:System.Diagnostics.PerformanceCounterCategory> třída<br /><br /> <xref:System.Diagnostics.Process> třída<br /><br /> <xref:System.Diagnostics.ProcessStartInfo> třída<br /><br /> <xref:System.Diagnostics.TextWriterTraceListener> třída<br /><br /> <xref:System.Diagnostics.TraceListener> třída<br /><br /> <xref:System.Diagnostics.XmlWriterTraceListener> třída<br /><br /> <xref:System.Diagnostics.TraceSource.Listeners%2A?displayProperty=nameWithType> property|  
|`System.IO`|<xref:System.IO.Stream.Synchronized%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.IO.TextReader.Synchronized%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.IO.TextWriter.Synchronized%2A?displayProperty=nameWithType> – metoda|  
|`System.Reflection.Emit`|<xref:System.Reflection.Emit.ConstructorBuilder> třída<br /><br /> <xref:System.Reflection.Emit.EventBuilder> třída<br /><br /> <xref:System.Reflection.Emit.FieldBuilder> třída<br /><br /> <xref:System.Reflection.Emit.MethodBuilder> třída<br /><br /> <xref:System.Reflection.Emit.CustomAttributeBuilder> třída<br /><br /> <xref:System.Reflection.Emit.MethodRental> třída<br /><br /> <xref:System.Reflection.Emit.ModuleBuilder> třída<br /><br /> <xref:System.Reflection.Emit.PropertyBuilder> třída<br /><br /> <xref:System.Reflection.Emit.TypeBuilder> třída<br /><br /> <xref:System.Reflection.Emit.UnmanagedMarshal> třída|  
|`System.Text`|<xref:System.Text.RegularExpressions.Group.Synchronized%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Text.RegularExpressions.Match.Synchronized%2A?displayProperty=nameWithType> – metoda|  
|`System.Threading`|<xref:System.Threading.AutoResetEvent> třída<br /><br /> <xref:System.Threading.EventWaitHandle> třída<br /><br /> <xref:System.Threading.ManualResetEvent> třída<br /><br /> <xref:System.Threading.Monitor> třída<br /><br /> <xref:System.Threading.Mutex> třída<br /><br /> <xref:System.Threading.ReaderWriterLock> třída<br /><br /> <xref:System.Threading.Semaphore> třída<br /><br /> <xref:System.Threading.Thread.AllocateNamedDataSlot%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.BeginCriticalRegion%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.EndCriticalRegion%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.FreeNamedDataSlot%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.GetData%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.Join%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.SetApartmentState%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.SetData%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.SpinWait%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.Thread.TrySetApartmentState%2A?displayProperty=nameWithType> – metoda<br /><br /> <xref:System.Threading.ThreadPool> třída<br /><br /> <xref:System.Threading.Timer> třída|  
|`System.Timers`|<xref:System.Timers.Timer> třída|  
|`System.Web.Configuration`|<xref:System.Web.Configuration.MachineKeyValidationConverter> třída|  
|`System.Windows.Forms`|<xref:System.Windows.Forms.AutoCompleteStringCollection.SyncRoot%2A?displayProperty=nameWithType> property|  
  
## <a name="sql-server-permission-sets"></a>Sady oprávnění serveru SQL  
 SQL Server umožňuje uživatelům zadat požadavky na spolehlivost kód nasazen do databáze. Když sestavení se nahrají do databáze, Autor sestavení můžete určit jednu z tři sady oprávnění pro toto sestavení: BEZPEČNĚ, vnější přístup nebo UNSAFE.  
  
|Sada oprávnění|BEZPEČNÉ|EXTERNÍ PŘÍSTUP|UNSAFE|  
|--------------------|----------|----------------------|------------|  
|Zabezpečení přístupu kódu|Spustit pouze|Spuštění a přístupu k externím prostředkům|Neomezená|  
|Omezení model programování|Ano|Ano|Bez omezení|  
|Požadavek ověřitelnosti|Ano|Ano|Ne|  
|Možnost volat nativní kód|Ne|Ne|Ano|  
  
 BEZPEČNÉ je nejvíce spolehlivou a zabezpečenou režim přidružené omezení z hlediska povolené programovací model. NOUZOVÝ kód má vysokou spolehlivost a zabezpečení funkce. BEZPEČNÁ sestavení jsou uvedeny dostatečná oprávnění ke spuštění, provádět výpočty a mít přístup k místní databázi. BEZPEČNÁ sestavení musí být prokazatelně typově bezpečné a nejsou povoleny pro volání nespravovaného kódu.  
  
 EXTERNÍ přístup nabízí možnost zprostředkující zabezpečení, povolení kód pro přístup k prostředkům externí databáze, ale stále s spolehlivosti a bezpečnosti BEZPEČNÉ.  
  
 UNSAFE je pro vysoce důvěryhodným kódem, který lze vytvořit pouze správci databází. Tento důvěryhodný kód neplatí žádná omezení přístupu kódu a může volat nespravovaný (nativní) kód.  
  
 SQL Server používá k vytvoření hostitele zásadu, která uděluje jeden ze tří sad oprávnění podle principu sadu uložených v katalozích systému SQL Server oprávnění vrstva zásad zabezpečení přístupu kódu na úrovni hostitele. Získá spravovaném kódu běžícím uvnitř databáze vždy jeden z těchto sad oprávnění přístupu kódu.  
  
## <a name="programming-model-restrictions"></a>Omezení Model programování  
 Programovací model pro spravovaný kód v systému SQL Server vyžaduje funkce, postupy a typy, které nevyžadují použití stavu uchovávaného napříč několika vyvoláními nebo sdílení stavu mezi víc uživatelských relací. Dále jak je popsáno výše, přítomnost sdílený stav může způsobit kritické výjimky, které mají vliv škálovatelnost a spolehlivost aplikace.  
  
 Vyplývá, SQL Server nepovoluje použití statických proměnných a statických datových členů. Pro BEZPEČNÉ a externí přístup k sestavení SQL Server zkoumá metadata sestavení v době vytvoření sestavení a vytvoření těchto sestavení se nezdaří, pokud zjistí použití statické datové členy a proměnné.  
  
## <a name="see-also"></a>Viz také:

- <xref:System.Security.Permissions.HostProtectionAttribute>
- <xref:System.Security.Permissions.HostProtectionResource>
