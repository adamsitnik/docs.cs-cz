---
title: Chyby odesílání a přijímání
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- handling faults [WCF], sending
ms.assetid: 7be6fb96-ce2a-450b-aebe-f932c6a4bc5d
ms.openlocfilehash: 447928ec3e6c0eaab997f839ab1aab49c677ad44
ms.sourcegitcommit: 581ab03291e91983459e56e40ea8d97b5189227e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/27/2019
ms.locfileid: "70044472"
---
# <a name="sending-and-receiving-faults"></a><span data-ttu-id="e3f90-102">Chyby odesílání a přijímání</span><span class="sxs-lookup"><span data-stu-id="e3f90-102">Sending and Receiving Faults</span></span>

<span data-ttu-id="e3f90-103">Chyby protokolu SOAP vyjadřují informace chybové podmínky ze služby klientovi a v duplexovém případě od klienta ke službě v rámci interoperability.</span><span class="sxs-lookup"><span data-stu-id="e3f90-103">SOAP faults convey error condition information from a service to a client and in the duplex case from a client to a service in an interoperable way.</span></span> <span data-ttu-id="e3f90-104">Služba obvykle definuje vlastní obsah chyby a určuje, které operace se můžou vrátit.</span><span class="sxs-lookup"><span data-stu-id="e3f90-104">Typically a service defines custom fault content and specifies which operations can return them.</span></span> <span data-ttu-id="e3f90-105">(Další informace najdete v tématu [Definování a určení chyb](../../../docs/framework/wcf/defining-and-specifying-faults.md).) Toto téma popisuje, jak může služba nebo duplexní klient odesílat tyto chyby, když došlo k odpovídajícímu chybovému stavu a jak aplikace klienta nebo služby tyto chyby zpracovává.</span><span class="sxs-lookup"><span data-stu-id="e3f90-105">(For more information, see [Defining and Specifying Faults](../../../docs/framework/wcf/defining-and-specifying-faults.md).) This topic discusses how a service or duplex client can send those faults when the corresponding error condition has occurred and how a client or service application handles these faults.</span></span> <span data-ttu-id="e3f90-106">Přehled zpracování chyb v aplikacích Windows Communication Foundation (WCF) najdete v tématu [určení a zpracování chyb v kontraktech a službách](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md).</span><span class="sxs-lookup"><span data-stu-id="e3f90-106">For an overview of error handling in Windows Communication Foundation (WCF) applications, see [Specifying and Handling Faults in Contracts and Services](../../../docs/framework/wcf/specifying-and-handling-faults-in-contracts-and-services.md).</span></span>

## <a name="sending-soap-faults"></a><span data-ttu-id="e3f90-107">Odesílání chyb protokolu SOAP</span><span class="sxs-lookup"><span data-stu-id="e3f90-107">Sending SOAP Faults</span></span>

<span data-ttu-id="e3f90-108">Deklarované chyby protokolu SOAP jsou ty, ve kterých operace má a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> určuje vlastní typ chyby SOAP.</span><span class="sxs-lookup"><span data-stu-id="e3f90-108">Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> that specifies a custom SOAP fault type.</span></span> <span data-ttu-id="e3f90-109">Nedeklarované chyby protokolu SOAP jsou ty, které nejsou ve kontraktu pro operaci zadané.</span><span class="sxs-lookup"><span data-stu-id="e3f90-109">Undeclared SOAP faults are those that are not specified in the contract for an operation.</span></span>

### <a name="sending-declared-faults"></a><span data-ttu-id="e3f90-110">Odesílání deklarovaných chyb</span><span class="sxs-lookup"><span data-stu-id="e3f90-110">Sending Declared Faults</span></span>

<span data-ttu-id="e3f90-111">Chcete-li odeslat deklarovanou chybu protokolu SOAP, zjistěte chybový stav, pro který je chyba protokolu SOAP vhodná, <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> a vyvolejte nový, kde parametr typu je nový objekt typu určeného v <xref:System.ServiceModel.FaultContractAttribute> poli pro tuto operaci.</span><span class="sxs-lookup"><span data-stu-id="e3f90-111">To send a declared SOAP fault, detect the error condition for which the SOAP fault is appropriate and throw a new <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> where the type parameter is a new object of the type specified in the <xref:System.ServiceModel.FaultContractAttribute> for that operation.</span></span> <span data-ttu-id="e3f90-112">Následující příklad kódu ukazuje použití <xref:System.ServiceModel.FaultContractAttribute> pro určení `SampleMethod` , že operace může vracet chybu protokolu SOAP `GreetingFault`s typem podrobností.</span><span class="sxs-lookup"><span data-stu-id="e3f90-112">The following code example shows the use of <xref:System.ServiceModel.FaultContractAttribute> to specify that the `SampleMethod` operation can return a SOAP fault with the detail type of `GreetingFault`.</span></span>

[!code-csharp[FaultContractAttribute#4](../../../samples/snippets/csharp/VS_Snippets_CFX/faultcontractattribute/cs/services.cs#4)]
[!code-vb[FaultContractAttribute#4](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faultcontractattribute/vb/services.vb#4)]

<span data-ttu-id="e3f90-113">Chcete-li `GreetingFault` předat informace o chybě klientovi, Zachyťte příslušný chybový stav a vyvolejte <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> nový typ `GreetingFault` s novým `GreetingFault` objektem jako argument, jak je uvedeno v následujícím příkladu kódu.</span><span class="sxs-lookup"><span data-stu-id="e3f90-113">To convey the `GreetingFault` error information to the client, catch the appropriate error condition and throw a new <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> of type `GreetingFault` with a new `GreetingFault` object as the argument, as in the following code example.</span></span> <span data-ttu-id="e3f90-114">Pokud klient je klientská aplikace WCF, dojde k tomu jako spravovaná výjimka, kde typ je <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> typu. `GreetingFault`</span><span class="sxs-lookup"><span data-stu-id="e3f90-114">If the client is an WCF client application, it experiences this as a managed exception where the type is <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> of type `GreetingFault`.</span></span>

[!code-csharp[FaultContractAttribute#5](../../../samples/snippets/csharp/VS_Snippets_CFX/faultcontractattribute/cs/services.cs#5)]
[!code-vb[FaultContractAttribute#5](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faultcontractattribute/vb/services.vb#5)]

### <a name="sending-undeclared-faults"></a><span data-ttu-id="e3f90-115">Odesílání nedeklarovaných chyb</span><span class="sxs-lookup"><span data-stu-id="e3f90-115">Sending Undeclared Faults</span></span>

<span data-ttu-id="e3f90-116">Odesílání nedeklarovaných chyb může být velmi užitečné pro rychlé diagnostikování a ladění problémů v aplikacích WCF, ale jeho užitečnost jako ladicí nástroj je omezený.</span><span class="sxs-lookup"><span data-stu-id="e3f90-116">Sending undeclared faults can be very useful to quickly diagnose and debug problems in WCF applications, but its usefulness as a debugging tool is limited.</span></span> <span data-ttu-id="e3f90-117">Obecně platí, že při ladění doporučujeme použít <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="e3f90-117">More generally, when debugging it is recommended that you use the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="e3f90-118">Když nastavíte tuto hodnotu na true, klienti budou mít takové chyby jako <xref:System.ServiceModel.FaultException%601> výjimky typu. <xref:System.ServiceModel.ExceptionDetail></span><span class="sxs-lookup"><span data-stu-id="e3f90-118">When you set this value to true, clients experience such faults as <xref:System.ServiceModel.FaultException%601> exceptions of type <xref:System.ServiceModel.ExceptionDetail>.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e3f90-119">Vzhledem k tomu, že spravované výjimky můžou vystavovat <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> interní `true` informace o aplikaci, nastavení <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> nebo může povolit klientům WCF získávat informace o výjimkách interních operací služby, včetně osobních údajů. identifikovatelné nebo jiné citlivé informace.</span><span class="sxs-lookup"><span data-stu-id="e3f90-119">Because managed exceptions can expose internal application information, setting <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> to `true` can permit WCF clients to obtain information about internal service operation exceptions, including personally identifiable or other sensitive information.</span></span>
>
> <span data-ttu-id="e3f90-120">Proto se nastavení <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> nebo <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> na `true` dá doporučit jenom jako způsob dočasného ladění aplikace služby.</span><span class="sxs-lookup"><span data-stu-id="e3f90-120">Therefore, setting <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> to `true` is only recommended as a way of temporarily debugging a service application.</span></span> <span data-ttu-id="e3f90-121">Kromě toho WSDL pro metodu, která vrací neošetřené spravované výjimky tímto způsobem, neobsahuje kontrakt pro <xref:System.ServiceModel.FaultException%601> typ. <xref:System.ServiceModel.ExceptionDetail></span><span class="sxs-lookup"><span data-stu-id="e3f90-121">In addition, the WSDL for a method that returns unhandled managed exceptions in this way does not contain the contract for the <xref:System.ServiceModel.FaultException%601> of type <xref:System.ServiceModel.ExceptionDetail>.</span></span> <span data-ttu-id="e3f90-122">Aby klienti mohli správně získat informace o ladění, musí očekávat neznámou chybu SOAP <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> (vrácený klientům WCF jako objekty).</span><span class="sxs-lookup"><span data-stu-id="e3f90-122">Clients must expect the possibility of an unknown SOAP fault (returned to WCF clients as <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> objects) to obtain the debugging information properly.</span></span>

<span data-ttu-id="e3f90-123">Chcete-li odeslat nedeklarovanou chybu protokolu SOAP <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> , vyvolejte objekt (tj. ne obecný <xref:System.ServiceModel.FaultException%601>typ) a předejte řetězec konstruktoru.</span><span class="sxs-lookup"><span data-stu-id="e3f90-123">To send an undeclared SOAP fault, throw a <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> object (that is, not the generic type <xref:System.ServiceModel.FaultException%601>) and pass the string to the constructor.</span></span> <span data-ttu-id="e3f90-124">To je zpřístupněno klientským aplikacím WCF jako vyvolaná <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> výjimka, kde je řetězec k dispozici <xref:System.ServiceModel.FaultException%601.ToString%2A?displayProperty=nameWithType> voláním metody.</span><span class="sxs-lookup"><span data-stu-id="e3f90-124">This is exposed to the WCF client applications as a thrown <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> exception where the string is available by calling the <xref:System.ServiceModel.FaultException%601.ToString%2A?displayProperty=nameWithType> method.</span></span>

> [!NOTE]
> <span data-ttu-id="e3f90-125">Pokud deklarujete chybu SOAP typu String a potom ji vyvoláte ve <xref:System.ServiceModel.FaultException%601> vaší službě jako parametr typu <xref:System.String?displayProperty=nameWithType> je <xref:System.ServiceModel.FaultException%601.Detail%2A?displayProperty=nameWithType> hodnota řetězce přiřazena vlastnosti a není k dispozici z <xref:System.ServiceModel.FaultException%601.ToString%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e3f90-125">If you declare a SOAP fault of type string, and then throw this in your service as a <xref:System.ServiceModel.FaultException%601> where the type parameter is a <xref:System.String?displayProperty=nameWithType> the string value is assigned to the <xref:System.ServiceModel.FaultException%601.Detail%2A?displayProperty=nameWithType> property, and is not available from <xref:System.ServiceModel.FaultException%601.ToString%2A?displayProperty=nameWithType>.</span></span>

## <a name="handling-faults"></a><span data-ttu-id="e3f90-126">Zpracování chyb</span><span class="sxs-lookup"><span data-stu-id="e3f90-126">Handling Faults</span></span>

<span data-ttu-id="e3f90-127">V klientech WCF jsou chyby protokolu SOAP, ke kterým došlo během komunikace, které jsou důležité pro klientské aplikace, vyvolány jako spravované výjimky.</span><span class="sxs-lookup"><span data-stu-id="e3f90-127">In WCF clients, SOAP faults that occur during communication that are of interest to client applications are raised as managed exceptions.</span></span> <span data-ttu-id="e3f90-128">I když existuje mnoho výjimek, ke kterým může dojít při provádění libovolného programu, aplikace používající programovací model klienta WCF mohou v důsledku komunikace očekávat výjimky následujících dvou typů.</span><span class="sxs-lookup"><span data-stu-id="e3f90-128">While there are many exceptions that can occur during the execution of any program, applications using the WCF client programming model can expect to handle exceptions of the following two types as a result of communication.</span></span>

- <xref:System.TimeoutException>

- <xref:System.ServiceModel.CommunicationException>

<span data-ttu-id="e3f90-129"><xref:System.TimeoutException>objekty jsou vyvolány, když operace překročí zadané časové období.</span><span class="sxs-lookup"><span data-stu-id="e3f90-129"><xref:System.TimeoutException> objects are thrown when an operation exceeds the specified timeout period.</span></span>

<span data-ttu-id="e3f90-130"><xref:System.ServiceModel.CommunicationException>objekty jsou vyvolány v případě, že dojde k určité opravitelné chybě komunikace v rámci služby nebo klienta.</span><span class="sxs-lookup"><span data-stu-id="e3f90-130"><xref:System.ServiceModel.CommunicationException> objects are thrown when there is some recoverable communication error condition on either the service or the client.</span></span>

<span data-ttu-id="e3f90-131">Třída má dva důležité odvozené <xref:System.ServiceModel.FaultException> typy a obecný <xref:System.ServiceModel.FaultException%601> typ. <xref:System.ServiceModel.CommunicationException></span><span class="sxs-lookup"><span data-stu-id="e3f90-131">The <xref:System.ServiceModel.CommunicationException> class has two important derived types, <xref:System.ServiceModel.FaultException> and the generic <xref:System.ServiceModel.FaultException%601> type.</span></span>

<span data-ttu-id="e3f90-132"><xref:System.ServiceModel.FaultException>výjimky jsou vyvolány, když naslouchací proces obdrží chybu, která není očekávána nebo určena v kontraktu operace; obvykle k tomu dochází, když je aplikace Laděna a služba má <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> vlastnost nastavenou na. `true`</span><span class="sxs-lookup"><span data-stu-id="e3f90-132"><xref:System.ServiceModel.FaultException> exceptions are thrown when a listener receives a fault that is not expected or specified in the operation contract; usually this occurs when the application is being debugged and the service has the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property set to `true`.</span></span>

<span data-ttu-id="e3f90-133"><xref:System.ServiceModel.FaultException%601>výjimky jsou vyvolány v klientovi, pokud je v reakci na obousměrnou operaci přijata chyba, která je zadána v kontraktu operace (tj. metodou s <xref:System.ServiceModel.OperationContractAttribute> <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> atributem nastaveným na `false`hodnotu).</span><span class="sxs-lookup"><span data-stu-id="e3f90-133"><xref:System.ServiceModel.FaultException%601> exceptions are thrown on the client when a fault that is specified in the operation contract is received in response to a two-way operation (that is, a method with an <xref:System.ServiceModel.OperationContractAttribute> attribute with <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> set to `false`).</span></span>

> [!NOTE]
> <span data-ttu-id="e3f90-134">Pokud <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> má služba WCF vlastnost nebo <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> nastavenou na `true` klientské prostředí, jedná se o nedeklaraci <xref:System.ServiceModel.FaultException%601> typu <xref:System.ServiceModel.ExceptionDetail>.</span><span class="sxs-lookup"><span data-stu-id="e3f90-134">When an WCF service has the <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property set to `true` the client experiences this as an undeclared <xref:System.ServiceModel.FaultException%601> of type <xref:System.ServiceModel.ExceptionDetail>.</span></span> <span data-ttu-id="e3f90-135">Klienti mohou buď zachytit tuto konkrétní chybu, nebo zpracovat chybu v bloku catch pro <xref:System.ServiceModel.FaultException>.</span><span class="sxs-lookup"><span data-stu-id="e3f90-135">Clients can either catch this specific fault or handle the fault in a catch block for <xref:System.ServiceModel.FaultException>.</span></span>

<span data-ttu-id="e3f90-136">Pro klienty a <xref:System.ServiceModel.FaultException%601>služby <xref:System.TimeoutException>jsou typicky <xref:System.ServiceModel.CommunicationException> důležité pouze výjimky, a.</span><span class="sxs-lookup"><span data-stu-id="e3f90-136">Typically, only <xref:System.ServiceModel.FaultException%601>, <xref:System.TimeoutException>, and <xref:System.ServiceModel.CommunicationException> exceptions are of interest to clients and services.</span></span>

> [!NOTE]
> <span data-ttu-id="e3f90-137">K dalším výjimkám samozřejmě dochází.</span><span class="sxs-lookup"><span data-stu-id="e3f90-137">Other exceptions, of course, do occur.</span></span> <span data-ttu-id="e3f90-138">Neočekávané výjimky zahrnují závažná <xref:System.OutOfMemoryException?displayProperty=nameWithType>selhání, jako je, obvykle by aplikace neměly tyto metody zachytit.</span><span class="sxs-lookup"><span data-stu-id="e3f90-138">Unexpected exceptions include catastrophic failures like <xref:System.OutOfMemoryException?displayProperty=nameWithType>; typically applications should not catch such methods.</span></span>

### <a name="catch-fault-exceptions-in-the-correct-order"></a><span data-ttu-id="e3f90-139">Zachytit výjimky chyb ve správném pořadí</span><span class="sxs-lookup"><span data-stu-id="e3f90-139">Catch Fault Exceptions in the Correct Order</span></span>

<span data-ttu-id="e3f90-140">Vzhledem <xref:System.ServiceModel.FaultException%601> k tomu, <xref:System.ServiceModel.FaultException>že jsou <xref:System.ServiceModel.FaultException> odvozeny z <xref:System.ServiceModel.CommunicationException>a jsou odvozeny z, je důležité zachytit tyto výjimky ve správném pořadí.</span><span class="sxs-lookup"><span data-stu-id="e3f90-140">Because <xref:System.ServiceModel.FaultException%601> derives from <xref:System.ServiceModel.FaultException>, and <xref:System.ServiceModel.FaultException> derives from <xref:System.ServiceModel.CommunicationException>, it is important to catch these exceptions in the proper order.</span></span> <span data-ttu-id="e3f90-141">Pokud například máte blok try/catch, ve kterém jste nejprve zachytili <xref:System.ServiceModel.CommunicationException>, všechny zadané a nespecifikované chyby SOAP jsou zpracovávány. jakékoli následné bloky catch pro zpracování vlastní <xref:System.ServiceModel.FaultException%601> výjimky nejsou nikdy vyvolány.</span><span class="sxs-lookup"><span data-stu-id="e3f90-141">If, for example, you have a try/catch block in which you first catch <xref:System.ServiceModel.CommunicationException>, all specified and unspecified SOAP faults are handled there; any subsequent catch blocks to handle a custom <xref:System.ServiceModel.FaultException%601> exception are never invoked.</span></span>

<span data-ttu-id="e3f90-142">Pamatujte, že jedna operace může vracet libovolný počet zadaných chyb.</span><span class="sxs-lookup"><span data-stu-id="e3f90-142">Remember that one operation can return any number of specified faults.</span></span> <span data-ttu-id="e3f90-143">Každá chyba je jedinečného typu a musí se zpracovat samostatně.</span><span class="sxs-lookup"><span data-stu-id="e3f90-143">Each fault is a unique type and must be handled separately.</span></span>

### <a name="handle-exceptions-when-closing-the-channel"></a><span data-ttu-id="e3f90-144">Zpracování výjimek při uzavírání kanálu</span><span class="sxs-lookup"><span data-stu-id="e3f90-144">Handle Exceptions When Closing the Channel</span></span>

<span data-ttu-id="e3f90-145">Většinu předchozí diskuze je třeba provést s chybami odeslanými v průběhu zpracování zpráv aplikace, tedy zpráv, které jsou explicitně odesílány klientem, když klientská aplikace volá operace na objektu klienta služby WCF.</span><span class="sxs-lookup"><span data-stu-id="e3f90-145">Most of the preceding discussion has to do with faults sent in the course of processing application messages, that is, messages explicitly sent by the client when the client application calls operations on the WCF client object.</span></span>

<span data-ttu-id="e3f90-146">I když místní objekty vyřazuje objekt, mohou buď vyvolat nebo maskovat výjimky, ke kterým dojde během procesu recyklace.</span><span class="sxs-lookup"><span data-stu-id="e3f90-146">Even with local objects disposing the object can either raise or mask exceptions that occur during the recycling process.</span></span> <span data-ttu-id="e3f90-147">K podobnému problému může dojít, když používáte objekty klienta WCF.</span><span class="sxs-lookup"><span data-stu-id="e3f90-147">Something similar can occur when you use WCF client objects.</span></span> <span data-ttu-id="e3f90-148">Při volání operací, které odesíláte zprávy přes navázané připojení.</span><span class="sxs-lookup"><span data-stu-id="e3f90-148">When you call operations you are sending messages over an established connection.</span></span> <span data-ttu-id="e3f90-149">Zavření kanálu může vyvolat výjimky, pokud připojení nelze vyčistit nebo je již uzavřeno, i když všechny operace vráceny správně.</span><span class="sxs-lookup"><span data-stu-id="e3f90-149">Closing the channel can throw exceptions if the connection cannot be cleanly closed or is already closed, even if all the operations returned properly.</span></span>

<span data-ttu-id="e3f90-150">Kanály klientského objektu jsou obvykle uzavřeny jedním z následujících způsobů:</span><span class="sxs-lookup"><span data-stu-id="e3f90-150">Typically, client object channels are closed in one of the following ways:</span></span>

- <span data-ttu-id="e3f90-151">Při recyklování objektu klienta služby WCF.</span><span class="sxs-lookup"><span data-stu-id="e3f90-151">When the WCF client object is recycled.</span></span>

- <span data-ttu-id="e3f90-152">Když klientská aplikace volá <xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e3f90-152">When the client application calls <xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="e3f90-153">Když klientská aplikace volá <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e3f90-153">When the client application calls <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="e3f90-154">Když klientská aplikace zavolá operaci, která je ukončující operací pro relaci.</span><span class="sxs-lookup"><span data-stu-id="e3f90-154">When the client application calls an operation that is a terminating operation for a session.</span></span>

<span data-ttu-id="e3f90-155">Ve všech případech uzavření kanálu instruuje kanál, aby začal uzavírat všechny základní kanály, které mohou odesílat zprávy pro podporu složitých funkcí na úrovni aplikace.</span><span class="sxs-lookup"><span data-stu-id="e3f90-155">In all cases, closing the channel instructs the channel to begin closing any underlying channels that may be sending messages to support complex functionality at the application level.</span></span> <span data-ttu-id="e3f90-156">Například Pokud kontrakt vyžaduje, aby se vazba pokusila vytvořit relaci výměnou zpráv s kanálem služby, dokud není vytvořena relace.</span><span class="sxs-lookup"><span data-stu-id="e3f90-156">For example, when a contract requires sessions a binding attempts to establish a session by exchanging messages with the service channel until a session is established.</span></span> <span data-ttu-id="e3f90-157">Když je kanál uzavřený, podkladový kanál relace tuto službu upozorní, že se relace ukončí.</span><span class="sxs-lookup"><span data-stu-id="e3f90-157">When the channel is closed, the underlying session channel notifies the service that the session is terminated.</span></span> <span data-ttu-id="e3f90-158">V takovém případě, pokud je kanál již přerušený, uzavřený nebo jinak nepoužitelný (například pokud je síťový kabel odpojený), kanál klienta nemůže informovat kanál služby o ukončení relace a může dojít k výjimce.</span><span class="sxs-lookup"><span data-stu-id="e3f90-158">In this case, if the channel has already aborted, closed, or is otherwise unusable (for example, when a network cable is unplugged), the client channel cannot inform the service channel that the session is terminated and an exception can result.</span></span>

### <a name="abort-the-channel-if-necessary"></a><span data-ttu-id="e3f90-159">V případě potřeby přerušit kanál</span><span class="sxs-lookup"><span data-stu-id="e3f90-159">Abort the Channel If Necessary</span></span>

<span data-ttu-id="e3f90-160">Vzhledem k tomu, že uzavírání kanálu může také vyvolat výjimky, doporučuje se, aby kromě zachycení výjimek chyb ve správném pořadí bylo důležité přerušit kanál, který byl použit při volání v bloku catch.</span><span class="sxs-lookup"><span data-stu-id="e3f90-160">Because closing the channel can also throw exceptions, then, it is recommended that in addition to catching fault exceptions in the correct order, it is important to abort the channel that was used in making the call in the catch block.</span></span>

<span data-ttu-id="e3f90-161">Pokud chyba předává informace o chybě specifické pro určitou operaci a je možné, že ji mohou používat i ostatní, nemusíte kanál přerušit (i když jsou tyto případy vzácné).</span><span class="sxs-lookup"><span data-stu-id="e3f90-161">If the fault conveys error information specific to an operation and it remains possible that others can use it, there is no need to abort the channel (although these cases are rare).</span></span> <span data-ttu-id="e3f90-162">Ve všech ostatních případech se doporučuje kanál přerušit.</span><span class="sxs-lookup"><span data-stu-id="e3f90-162">In all other cases, it is recommended that you abort the channel.</span></span> <span data-ttu-id="e3f90-163">Ukázku, která ukazuje všechny tyto body, naleznete v tématu [očekávané výjimky](../../../docs/framework/wcf/samples/expected-exceptions.md).</span><span class="sxs-lookup"><span data-stu-id="e3f90-163">For a sample that demonstrates all of these points, see [Expected Exceptions](../../../docs/framework/wcf/samples/expected-exceptions.md).</span></span>

<span data-ttu-id="e3f90-164">Následující příklad kódu ukazuje, jak zpracovat výjimky chyb protokolu SOAP v základní klientské aplikaci, včetně deklarované chyby a nedeklarované chyby.</span><span class="sxs-lookup"><span data-stu-id="e3f90-164">The following code example shows how to handle SOAP fault exceptions in a basic client application, including a declared fault and an undeclared fault.</span></span>

> [!NOTE]
> <span data-ttu-id="e3f90-165">Tento vzorový kód nepoužívá `using` konstrukci.</span><span class="sxs-lookup"><span data-stu-id="e3f90-165">This sample code does not use the `using` construct.</span></span> <span data-ttu-id="e3f90-166">Vzhledem k tomu, že uzavírací kanály můžou vyvolat výjimky, doporučuje se nejprve vytvořit klienta WCF a pak otevřít, použít a zavřít klienta WCF ve stejném bloku try.</span><span class="sxs-lookup"><span data-stu-id="e3f90-166">Because closing channels can throw exceptions, it is recommended that applications create a WCF client first, and then open, use, and close the WCF client in the same try block.</span></span> <span data-ttu-id="e3f90-167">Podrobnosti najdete v tématu [Přehled klientů WCF](../../../docs/framework/wcf/wcf-client-overview.md) a [použití funkcí zavřít a přerušit k vydání prostředků klienta WCF](../../../docs/framework/wcf/samples/use-close-abort-release-wcf-client-resources.md).</span><span class="sxs-lookup"><span data-stu-id="e3f90-167">For details, see [WCF Client Overview](../../../docs/framework/wcf/wcf-client-overview.md) and [Use Close and Abort to release WCF client resources](../../../docs/framework/wcf/samples/use-close-abort-release-wcf-client-resources.md).</span></span>

[!code-csharp[FaultContractAttribute#3](../../../samples/snippets/csharp/VS_Snippets_CFX/faultcontractattribute/cs/client.cs#3)]
[!code-vb[FaultContractAttribute#3](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faultcontractattribute/vb/client.vb#3)]

## <a name="see-also"></a><span data-ttu-id="e3f90-168">Viz také:</span><span class="sxs-lookup"><span data-stu-id="e3f90-168">See also</span></span>

- <xref:System.ServiceModel.FaultException>
- <xref:System.ServiceModel.FaultException%601>
- <xref:System.ServiceModel.CommunicationException?displayProperty=nameWithType>
- [<span data-ttu-id="e3f90-169">Očekávané výjimky</span><span class="sxs-lookup"><span data-stu-id="e3f90-169">Expected Exceptions</span></span>](../../../docs/framework/wcf/samples/expected-exceptions.md)
- [<span data-ttu-id="e3f90-170">Použití funkcí zavřít a přerušit k vydání prostředků klienta WCF</span><span class="sxs-lookup"><span data-stu-id="e3f90-170">Use Close and Abort to release WCF client resources</span></span>](../../../docs/framework/wcf/samples/use-close-abort-release-wcf-client-resources.md)
