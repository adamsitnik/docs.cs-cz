---
title: Trasování aktivit v zabezpečení zpráv
ms.date: 03/30/2017
ms.assetid: 68862534-3b2e-4270-b097-8121b12a2c97
ms.openlocfilehash: 65b2842c57da8e17c7280a2becd755ba2aae8364
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/28/2019
ms.locfileid: "64656443"
---
# <a name="activity-tracing-in-message-security"></a><span data-ttu-id="8f32b-102">Trasování aktivit v zabezpečení zpráv</span><span class="sxs-lookup"><span data-stu-id="8f32b-102">Activity Tracing in Message Security</span></span>
<span data-ttu-id="8f32b-103">Toto téma popisuje trasování aktivity pro zpracování zabezpečení, který se tyto tři fáze.</span><span class="sxs-lookup"><span data-stu-id="8f32b-103">This topic describes activity tracing for security processing, which happens in the following three phases.</span></span>  
  
- <span data-ttu-id="8f32b-104">Vyjednávání/SCT exchange.</span><span class="sxs-lookup"><span data-stu-id="8f32b-104">Negotiation/SCT exchange.</span></span> <span data-ttu-id="8f32b-105">To může nastat při přenosu později (prostřednictvím výměny binární data) nebo zpráva vrstvy (prostřednictvím výměny zpráv SOAP).</span><span class="sxs-lookup"><span data-stu-id="8f32b-105">This can happen at the transport later (through binary data exchange) or message layer (through SOAP message exchanges).</span></span>  
  
- <span data-ttu-id="8f32b-106">Zpráva šifrování a dešifrování, ověřování podpisů a ověřování.</span><span class="sxs-lookup"><span data-stu-id="8f32b-106">Message encryption/decryption, with signature verification and authentication.</span></span> <span data-ttu-id="8f32b-107">Trasování se zobrazí v okolí aktivity, obvykle "procesu akce."</span><span class="sxs-lookup"><span data-stu-id="8f32b-107">Traces appear in the ambient activity, typically "Process Action."</span></span>  
  
- <span data-ttu-id="8f32b-108">Autorizace a ověření.</span><span class="sxs-lookup"><span data-stu-id="8f32b-108">Authorization and verification.</span></span> <span data-ttu-id="8f32b-109">To může nastat, místně nebo při komunikaci mezi koncovými body.</span><span class="sxs-lookup"><span data-stu-id="8f32b-109">This can happen locally or when communicating between endpoints.</span></span>  
  
## <a name="negotiationsct-exchange"></a><span data-ttu-id="8f32b-110">Vyjednávání/SCT exchange</span><span class="sxs-lookup"><span data-stu-id="8f32b-110">Negotiation/SCT exchange</span></span>  
 <span data-ttu-id="8f32b-111">Ve fázi vyjednávání/SCT exchange na straně klienta vytvoří dva typy aktivit: "Nastavte zabezpečenou relaci" a "Zavřít zabezpečenou relaci."</span><span class="sxs-lookup"><span data-stu-id="8f32b-111">In the negotiation/SCT exchange phase, two activity types are created on the client: "Set up Secure Session" and "Close Secure Session."</span></span> <span data-ttu-id="8f32b-112">"Nastavte zabezpečenou relaci" zahrnuje trasování pro výměny zpráv RVNÍ/RSTR/SCT, sice "Ukončení relace Secure" zahrnuje trasování pro zprávu zrušit.</span><span class="sxs-lookup"><span data-stu-id="8f32b-112">"Set up Secure Session" encompasses traces for the RST/RSTR/SCT message exchanges, while "Close Secure Session" includes traces for the Cancel message.</span></span>  
  
 <span data-ttu-id="8f32b-113">Na serveru se zobrazí každý požadavek/odpověď pro RVNÍ/RSTR/SCT ve svých vlastních aktivit.</span><span class="sxs-lookup"><span data-stu-id="8f32b-113">On the server, each request/reply for the RST/RSTR/SCT appears in its own activity.</span></span> <span data-ttu-id="8f32b-114">Pokud `propagateActivity` = `true` na serveru a klienta, se stejným ID aktivity na serveru a společně se zobrazí v "Nastavení zabezpečené relaci" při zobrazit pomocí prohlížeče trasování služeb.</span><span class="sxs-lookup"><span data-stu-id="8f32b-114">If `propagateActivity`=`true` on both the server and client, activities on the server have the same ID, and appear together in the "Setup Secure Session" when viewed through Service Trace Viewer.</span></span>  
  
 <span data-ttu-id="8f32b-115">Tento model trasování aktivity je platné uživatelské jméno/heslo ověřování, ověřování certifikátů a ověřování protokolem NTLM.</span><span class="sxs-lookup"><span data-stu-id="8f32b-115">This activity tracing model is valid for user name/password authentication, certificate authentication, and NTLM authentication.</span></span>  
  
 <span data-ttu-id="8f32b-116">V následující tabulce jsou uvedeny aktivity a trasování pro vyjednávání a SCT exchange.</span><span class="sxs-lookup"><span data-stu-id="8f32b-116">The following table lists the activities and traces for negotiation and SCT exchange.</span></span>  
  
||<span data-ttu-id="8f32b-117">Čas, když se stane vyjednávání/SCT exchange</span><span class="sxs-lookup"><span data-stu-id="8f32b-117">Time when Negotiation/SCT exchange happens</span></span>|<span data-ttu-id="8f32b-118">Aktivity</span><span class="sxs-lookup"><span data-stu-id="8f32b-118">Activities</span></span>|<span data-ttu-id="8f32b-119">trasování</span><span class="sxs-lookup"><span data-stu-id="8f32b-119">Traces</span></span>|  
|-|-------------------------------------------------|----------------|------------|  
|<span data-ttu-id="8f32b-120">Zabezpečení přenosu</span><span class="sxs-lookup"><span data-stu-id="8f32b-120">Secure Transport</span></span><br /><br /> <span data-ttu-id="8f32b-121">(HTTPS, SSL)</span><span class="sxs-lookup"><span data-stu-id="8f32b-121">(HTTPS, SSL)</span></span>|<span data-ttu-id="8f32b-122">Na první byla přijata zpráva.</span><span class="sxs-lookup"><span data-stu-id="8f32b-122">On first message received.</span></span>|<span data-ttu-id="8f32b-123">Trasování jsou emitovány v okolí aktivity.</span><span class="sxs-lookup"><span data-stu-id="8f32b-123">Traces are emitted in the ambient activity.</span></span>|<span data-ttu-id="8f32b-124">– Trasování Exchange</span><span class="sxs-lookup"><span data-stu-id="8f32b-124">-   Exchange traces</span></span><br /><span data-ttu-id="8f32b-125">-Zabezpečený kanál vytvořeno</span><span class="sxs-lookup"><span data-stu-id="8f32b-125">-   Secure channel established</span></span><br /><span data-ttu-id="8f32b-126">-Sdílení získali tajných kódů.</span><span class="sxs-lookup"><span data-stu-id="8f32b-126">-   Share secrets obtained.</span></span>|  
|<span data-ttu-id="8f32b-127">Vrstva zabezpečenou zprávu</span><span class="sxs-lookup"><span data-stu-id="8f32b-127">Secure Message Layer</span></span><br /><br /> <span data-ttu-id="8f32b-128">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="8f32b-128">(WSHTTP)</span></span>|<span data-ttu-id="8f32b-129">Na první byla přijata zpráva.</span><span class="sxs-lookup"><span data-stu-id="8f32b-129">On first message received.</span></span>|<span data-ttu-id="8f32b-130">Na straně klienta:</span><span class="sxs-lookup"><span data-stu-id="8f32b-130">On the client:</span></span><br /><br /> <span data-ttu-id="8f32b-131">-"Nastavení zabezpečenou relaci" z "Proces Action" první zprávy, pro každý požadavek nebo odpověď pro RVNÍ/RSTR/SCT.</span><span class="sxs-lookup"><span data-stu-id="8f32b-131">-   "Setup Secure Session" out of "Process Action" of that first message, for each request/reply for RST/RSTR/SCT.</span></span><br /><span data-ttu-id="8f32b-132">-"Zavřít zabezpečenou relaci" Storno výměny "Zavřít Proxy aktivita."</span><span class="sxs-lookup"><span data-stu-id="8f32b-132">-   "Close Secure Session" for the CANCEL exchange, out of the "Close Proxy activity."</span></span> <span data-ttu-id="8f32b-133">Tato aktivita se může stát některé další okolí aktivita, v závislosti na tom, kdy je uzavřena zabezpečenou relaci.</span><span class="sxs-lookup"><span data-stu-id="8f32b-133">This activity may happen out of some other ambient activity, depending on when the secure session is closed.</span></span><br /><br /> <span data-ttu-id="8f32b-134">Na serveru:</span><span class="sxs-lookup"><span data-stu-id="8f32b-134">On the server:</span></span><br /><br /> <span data-ttu-id="8f32b-135">-"Procesu" aktivit akcí pro každý požadavek/odpověď pro RVNÍ/SCT/zrušit na serveru.</span><span class="sxs-lookup"><span data-stu-id="8f32b-135">-   One "Process Action" activity for each request/reply for RST/SCT/Cancel on the server.</span></span> <span data-ttu-id="8f32b-136">Pokud `propagateActivity` = `true`RVNÍ/RSTR/SCT aktivity jsou sloučeny s "Nastavit až relace zabezpečení" a zrušit je sloučen s "Zavřít" aktivitu z klienta.</span><span class="sxs-lookup"><span data-stu-id="8f32b-136">If `propagateActivity`=`true`, RST/RSTR/SCT activities are merged with "Set up Security Session", and Cancel is merged with the "Close" activity from the client.</span></span><br /><br /> <span data-ttu-id="8f32b-137">Existují dvě fáze pro "Nastavit až zabezpečenou relaci":</span><span class="sxs-lookup"><span data-stu-id="8f32b-137">There are two stages for "Set up Secure Session":</span></span><br /><br /> <span data-ttu-id="8f32b-138">1.  Ověřování vyjednávání.</span><span class="sxs-lookup"><span data-stu-id="8f32b-138">1.  Authentication negotiation.</span></span> <span data-ttu-id="8f32b-139">Tato položka je nepovinná, pokud klient již má správné přihlašovací údaje.</span><span class="sxs-lookup"><span data-stu-id="8f32b-139">This is optional if the client already has the proper credentials.</span></span> <span data-ttu-id="8f32b-140">Tato fáze lze provést prostřednictvím zabezpečeného přenosu, nebo výměny zpráv.</span><span class="sxs-lookup"><span data-stu-id="8f32b-140">This phase can be done through secure transport, or through message exchanges.</span></span> <span data-ttu-id="8f32b-141">V takovém případě může dojít, 1 nebo 2 RVNÍ/RSTR výměny.</span><span class="sxs-lookup"><span data-stu-id="8f32b-141">In the latter case, 1 or 2 RST/RSTR exchanges can happen.</span></span> <span data-ttu-id="8f32b-142">Pro tyto výměny zpracovávají jsou emitovány trasování v nové aktivity požadavek/odpověď navržena jako dříve.</span><span class="sxs-lookup"><span data-stu-id="8f32b-142">For these exchanges, traces are emitted in new request/reply activities as previously designed.</span></span><br /><span data-ttu-id="8f32b-143">2.  Zabezpečte vytvoření relace (SCT), ve kterém jeden RVNÍ/RSTR exchange se tady děje.</span><span class="sxs-lookup"><span data-stu-id="8f32b-143">2.  Secure session establishment (SCT), in which one RST/RSTR exchange happens here.</span></span> <span data-ttu-id="8f32b-144">To má stejné okolí aktivity, jak je popsáno výše.</span><span class="sxs-lookup"><span data-stu-id="8f32b-144">This has the same ambient activities as described previously.</span></span>|<span data-ttu-id="8f32b-145">– Trasování Exchange</span><span class="sxs-lookup"><span data-stu-id="8f32b-145">-   Exchange traces</span></span><br /><span data-ttu-id="8f32b-146">-Zabezpečený kanál vytvořeno</span><span class="sxs-lookup"><span data-stu-id="8f32b-146">-   Secure channel established</span></span><br /><span data-ttu-id="8f32b-147">-Sdílení získali tajných kódů.</span><span class="sxs-lookup"><span data-stu-id="8f32b-147">-   Share secrets obtained.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="8f32b-148">V režimu smíšených zabezpečení vyjednávání ověřování probíhá výměna binární, ale SCT probíhá výměna zpráv.</span><span class="sxs-lookup"><span data-stu-id="8f32b-148">In mixed security mode, negotiation authentication happens in binary exchanges, but SCT happens in message exchange.</span></span> <span data-ttu-id="8f32b-149">V režimu čistě přenosu vyjednávání dochází pouze v přenosu se žádné další aktivity.</span><span class="sxs-lookup"><span data-stu-id="8f32b-149">In pure transport mode, negotiation happens only in transport with no additional activities.</span></span>  
  
## <a name="message-encryption-and-decryption"></a><span data-ttu-id="8f32b-150">Šifrování a dešifrování</span><span class="sxs-lookup"><span data-stu-id="8f32b-150">Message Encryption and Decryption</span></span>  
 <span data-ttu-id="8f32b-151">V následující tabulce jsou uvedeny aktivity a trasování pro šifrování a dešifrování zprávy, jakož i ověřování podpisu.</span><span class="sxs-lookup"><span data-stu-id="8f32b-151">The following table lists the activities and traces for message encryption/decryption, as well as signature authentication.</span></span>  
  
||<span data-ttu-id="8f32b-152">Zabezpečení přenosu</span><span class="sxs-lookup"><span data-stu-id="8f32b-152">Secure Transport</span></span><br /><br /> <span data-ttu-id="8f32b-153">(Protokol HTTPS, SSL) a zabezpečení vrstvy zprávy</span><span class="sxs-lookup"><span data-stu-id="8f32b-153">(HTTPS, SSL) and Secure Message Layer</span></span><br /><br /> <span data-ttu-id="8f32b-154">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="8f32b-154">(WSHTTP)</span></span>|  
|-|---------------------------------------------------------------------------------|  
|<span data-ttu-id="8f32b-155">Čas, kdy zprávy šifrování a dešifrování, stejně jako využíváno ověření podpisu</span><span class="sxs-lookup"><span data-stu-id="8f32b-155">Time when message encryption/decryption, as well as signature authentication happens</span></span>|<span data-ttu-id="8f32b-156">Na byla přijata zpráva</span><span class="sxs-lookup"><span data-stu-id="8f32b-156">On message received</span></span>|  
|<span data-ttu-id="8f32b-157">Aktivity</span><span class="sxs-lookup"><span data-stu-id="8f32b-157">Activities</span></span>|<span data-ttu-id="8f32b-158">Trasování jsou zaznamenávány do ProcessAction aktivitu na klienta a serveru.</span><span class="sxs-lookup"><span data-stu-id="8f32b-158">Traces are emitted in the ProcessAction activity on the client and server.</span></span>|  
|<span data-ttu-id="8f32b-159">trasování</span><span class="sxs-lookup"><span data-stu-id="8f32b-159">Traces</span></span>|<span data-ttu-id="8f32b-160">-sendSecurityHeader (odesílatel):</span><span class="sxs-lookup"><span data-stu-id="8f32b-160">-   sendSecurityHeader (sender):</span></span><br /><span data-ttu-id="8f32b-161">– Sign zpráva</span><span class="sxs-lookup"><span data-stu-id="8f32b-161">-   Sign message</span></span><br /><span data-ttu-id="8f32b-162">-Šifrování dat požadavku</span><span class="sxs-lookup"><span data-stu-id="8f32b-162">-   Encrypt request data</span></span><br /><span data-ttu-id="8f32b-163">-receiveSecurityHeader (příjemce):</span><span class="sxs-lookup"><span data-stu-id="8f32b-163">-   receiveSecurityHeader (receiver):</span></span><br /><span data-ttu-id="8f32b-164">– Ověření podpisu</span><span class="sxs-lookup"><span data-stu-id="8f32b-164">-   Verify signature</span></span><br /><span data-ttu-id="8f32b-165">-Dešifrovat data odpovědi</span><span class="sxs-lookup"><span data-stu-id="8f32b-165">-   Decrypt response data</span></span><br /><span data-ttu-id="8f32b-166">-Ověřování</span><span class="sxs-lookup"><span data-stu-id="8f32b-166">-   Authentication</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="8f32b-167">V režimu čistě přenosu zprávy šifrování a dešifrování dochází pouze v přenosu se žádné další aktivity.</span><span class="sxs-lookup"><span data-stu-id="8f32b-167">In pure transport mode, message encryption/decryption happens only in transport with no additional activities.</span></span>  
  
## <a name="authorization-and-verification"></a><span data-ttu-id="8f32b-168">Autorizace a ověření</span><span class="sxs-lookup"><span data-stu-id="8f32b-168">Authorization and Verification</span></span>  
 <span data-ttu-id="8f32b-169">V následující tabulce jsou uvedeny aktivity a trasování pro autorizaci.</span><span class="sxs-lookup"><span data-stu-id="8f32b-169">The following table lists the activities and traces for authorization.</span></span>  
  
||<span data-ttu-id="8f32b-170">Čas, když se stane autorizace</span><span class="sxs-lookup"><span data-stu-id="8f32b-170">Time when authorization happens</span></span>|<span data-ttu-id="8f32b-171">Aktivity</span><span class="sxs-lookup"><span data-stu-id="8f32b-171">Activities</span></span>|<span data-ttu-id="8f32b-172">trasování</span><span class="sxs-lookup"><span data-stu-id="8f32b-172">Traces</span></span>|  
|-|-------------------------------------|----------------|------------|  
|<span data-ttu-id="8f32b-173">Místní (výchozí)</span><span class="sxs-lookup"><span data-stu-id="8f32b-173">Local (default)</span></span>|<span data-ttu-id="8f32b-174">Po zprávy se dešifrují na serveru</span><span class="sxs-lookup"><span data-stu-id="8f32b-174">After the message is decrypted on the server</span></span>|<span data-ttu-id="8f32b-175">Trasování jsou zaznamenávány do ProcessAction aktivity na serveru.</span><span class="sxs-lookup"><span data-stu-id="8f32b-175">Traces are emitted in the ProcessAction activity at the server.</span></span>|<span data-ttu-id="8f32b-176">Uživatel autorizován.</span><span class="sxs-lookup"><span data-stu-id="8f32b-176">User authorized.</span></span>|  
|<span data-ttu-id="8f32b-177">Vzdálený</span><span class="sxs-lookup"><span data-stu-id="8f32b-177">Remote</span></span>|<span data-ttu-id="8f32b-178">Po zprávy se dešifrují na serveru</span><span class="sxs-lookup"><span data-stu-id="8f32b-178">After the message is decrypted on the server</span></span>|<span data-ttu-id="8f32b-179">Trasování jsou zaznamenávány do vyvolané aktivitou ProcessAction novou aktivitu.</span><span class="sxs-lookup"><span data-stu-id="8f32b-179">Traces are emitted in a new activity invoked by the ProcessAction activity.</span></span>|<span data-ttu-id="8f32b-180">Uživatel autorizován.</span><span class="sxs-lookup"><span data-stu-id="8f32b-180">User authorized.</span></span>|
