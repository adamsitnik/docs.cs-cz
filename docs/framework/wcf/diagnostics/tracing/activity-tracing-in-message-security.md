---
title: Trasování aktivit v zabezpečení zpráv
ms.date: 03/30/2017
ms.assetid: 68862534-3b2e-4270-b097-8121b12a2c97
ms.openlocfilehash: bb8a4c6782cc52de393eacc2458e216d0f069866
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/22/2019
ms.locfileid: "69933518"
---
# <a name="activity-tracing-in-message-security"></a><span data-ttu-id="2270e-102">Trasování aktivit v zabezpečení zpráv</span><span class="sxs-lookup"><span data-stu-id="2270e-102">Activity Tracing in Message Security</span></span>
<span data-ttu-id="2270e-103">Toto téma popisuje trasování aktivit pro zpracování zabezpečení, ke kterému dochází v následujících třech fázích.</span><span class="sxs-lookup"><span data-stu-id="2270e-103">This topic describes activity tracing for security processing, which happens in the following three phases.</span></span>  
  
- <span data-ttu-id="2270e-104">Vyjednávání/SCT Exchange.</span><span class="sxs-lookup"><span data-stu-id="2270e-104">Negotiation/SCT exchange.</span></span> <span data-ttu-id="2270e-105">K tomu může dojít později při přenosu (prostřednictvím výměny binárních dat) nebo vrstvy zpráv (prostřednictvím výměn zpráv SOAP).</span><span class="sxs-lookup"><span data-stu-id="2270e-105">This can happen at the transport later (through binary data exchange) or message layer (through SOAP message exchanges).</span></span>  
  
- <span data-ttu-id="2270e-106">Šifrování a dešifrování zpráv pomocí ověřování podpisů a ověřování.</span><span class="sxs-lookup"><span data-stu-id="2270e-106">Message encryption/decryption, with signature verification and authentication.</span></span> <span data-ttu-id="2270e-107">Trasování se zobrazí v okolí aktivity, obvykle "akce zpracování".</span><span class="sxs-lookup"><span data-stu-id="2270e-107">Traces appear in the ambient activity, typically "Process Action."</span></span>  
  
- <span data-ttu-id="2270e-108">Autorizaci a ověření.</span><span class="sxs-lookup"><span data-stu-id="2270e-108">Authorization and verification.</span></span> <span data-ttu-id="2270e-109">K tomu může dojít místně nebo při komunikaci mezi koncovými body.</span><span class="sxs-lookup"><span data-stu-id="2270e-109">This can happen locally or when communicating between endpoints.</span></span>  
  
## <a name="negotiationsct-exchange"></a><span data-ttu-id="2270e-110">Vyjednávání/SCT Exchange</span><span class="sxs-lookup"><span data-stu-id="2270e-110">Negotiation/SCT exchange</span></span>  
 <span data-ttu-id="2270e-111">Ve fázi vyjednávání/SCT Exchange se na klientovi vytvoří dva typy aktivit: "Nastavte zabezpečenou relaci" a "Zavřít zabezpečenou relaci".</span><span class="sxs-lookup"><span data-stu-id="2270e-111">In the negotiation/SCT exchange phase, two activity types are created on the client: "Set up Secure Session" and "Close Secure Session."</span></span> <span data-ttu-id="2270e-112">Možnost nastavit zabezpečenou relaci zahrnuje trasování pro výměny zpráv RST/RSTR/SCT, zatímco možnost "uzavřít zabezpečenou relaci" zahrnuje trasování pro zprávu zrušení.</span><span class="sxs-lookup"><span data-stu-id="2270e-112">"Set up Secure Session" encompasses traces for the RST/RSTR/SCT message exchanges, while "Close Secure Session" includes traces for the Cancel message.</span></span>  
  
 <span data-ttu-id="2270e-113">Na serveru se každý požadavek nebo odpověď pro RST/RSTR/SCT zobrazí ve své vlastní aktivitě.</span><span class="sxs-lookup"><span data-stu-id="2270e-113">On the server, each request/reply for the RST/RSTR/SCT appears in its own activity.</span></span> <span data-ttu-id="2270e-114">Pokud `propagateActivity` naserverui`true` v klientovi, aktivity na serveru mají stejné ID a společně se zobrazí v části "zabezpečená relace" při zobrazení prostřednictvím prohlížeče trasování služby. =</span><span class="sxs-lookup"><span data-stu-id="2270e-114">If `propagateActivity`=`true` on both the server and client, activities on the server have the same ID, and appear together in the "Setup Secure Session" when viewed through Service Trace Viewer.</span></span>  
  
 <span data-ttu-id="2270e-115">Tento model trasování aktivit je platný pro ověřování uživatelského jména a hesla, ověřování certifikátů a ověřování NTLM.</span><span class="sxs-lookup"><span data-stu-id="2270e-115">This activity tracing model is valid for user name/password authentication, certificate authentication, and NTLM authentication.</span></span>  
  
 <span data-ttu-id="2270e-116">V následující tabulce jsou uvedeny aktivity a trasování pro vyjednávání a SCT Exchange.</span><span class="sxs-lookup"><span data-stu-id="2270e-116">The following table lists the activities and traces for negotiation and SCT exchange.</span></span>  
  
||<span data-ttu-id="2270e-117">Čas, kdy dojde k vyjednání/SCT výměně</span><span class="sxs-lookup"><span data-stu-id="2270e-117">Time when Negotiation/SCT exchange happens</span></span>|<span data-ttu-id="2270e-118">Aktivity</span><span class="sxs-lookup"><span data-stu-id="2270e-118">Activities</span></span>|<span data-ttu-id="2270e-119">Trasování</span><span class="sxs-lookup"><span data-stu-id="2270e-119">Traces</span></span>|  
|-|-------------------------------------------------|----------------|------------|  
|<span data-ttu-id="2270e-120">Zabezpečený přenos</span><span class="sxs-lookup"><span data-stu-id="2270e-120">Secure Transport</span></span><br /><br /> <span data-ttu-id="2270e-121">(HTTPS, SSL)</span><span class="sxs-lookup"><span data-stu-id="2270e-121">(HTTPS, SSL)</span></span>|<span data-ttu-id="2270e-122">První přijatá zpráva</span><span class="sxs-lookup"><span data-stu-id="2270e-122">On first message received.</span></span>|<span data-ttu-id="2270e-123">Trasování jsou vygenerována v okolí aktivity.</span><span class="sxs-lookup"><span data-stu-id="2270e-123">Traces are emitted in the ambient activity.</span></span>|<span data-ttu-id="2270e-124">– Trasování systému Exchange</span><span class="sxs-lookup"><span data-stu-id="2270e-124">-   Exchange traces</span></span><br /><span data-ttu-id="2270e-125">– Zavedený zabezpečený kanál</span><span class="sxs-lookup"><span data-stu-id="2270e-125">-   Secure channel established</span></span><br /><span data-ttu-id="2270e-126">-Bylo získáno sdílení tajných kódů.</span><span class="sxs-lookup"><span data-stu-id="2270e-126">-   Share secrets obtained.</span></span>|  
|<span data-ttu-id="2270e-127">Zabezpečená vrstva zprávy</span><span class="sxs-lookup"><span data-stu-id="2270e-127">Secure Message Layer</span></span><br /><br /> <span data-ttu-id="2270e-128">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="2270e-128">(WSHTTP)</span></span>|<span data-ttu-id="2270e-129">První přijatá zpráva</span><span class="sxs-lookup"><span data-stu-id="2270e-129">On first message received.</span></span>|<span data-ttu-id="2270e-130">Na klientovi:</span><span class="sxs-lookup"><span data-stu-id="2270e-130">On the client:</span></span><br /><br /> <span data-ttu-id="2270e-131">– "Nastavit zabezpečenou relaci" z "akce procesu" této první zprávy pro každý požadavek/odpověď pro RST/RSTR/SCT.</span><span class="sxs-lookup"><span data-stu-id="2270e-131">-   "Setup Secure Session" out of "Process Action" of that first message, for each request/reply for RST/RSTR/SCT.</span></span><br /><span data-ttu-id="2270e-132">-"Uzavřít zabezpečenou relaci" pro zrušení výměny z "aktivity zavřít proxy".</span><span class="sxs-lookup"><span data-stu-id="2270e-132">-   "Close Secure Session" for the CANCEL exchange, out of the "Close Proxy activity."</span></span> <span data-ttu-id="2270e-133">Tato aktivita se může vyskytnout z nějaké jiné aktivity okolí v závislosti na tom, kdy je zabezpečená relace uzavřená.</span><span class="sxs-lookup"><span data-stu-id="2270e-133">This activity may happen out of some other ambient activity, depending on when the secure session is closed.</span></span><br /><br /> <span data-ttu-id="2270e-134">Na serveru:</span><span class="sxs-lookup"><span data-stu-id="2270e-134">On the server:</span></span><br /><br /> <span data-ttu-id="2270e-135">-Jedna aktivita zpracovat akci pro každý požadavek nebo odpověď pro RST/SCT/Cancel na serveru.</span><span class="sxs-lookup"><span data-stu-id="2270e-135">-   One "Process Action" activity for each request/reply for RST/SCT/Cancel on the server.</span></span> <span data-ttu-id="2270e-136">Pokud `propagateActivity` jsouaktivityRST`true`/RSTR/SCT sloučeny s nastavením relace zabezpečení a zrušení je sloučeno s aktivitou "Zavřít" z klienta. =</span><span class="sxs-lookup"><span data-stu-id="2270e-136">If `propagateActivity`=`true`, RST/RSTR/SCT activities are merged with "Set up Security Session", and Cancel is merged with the "Close" activity from the client.</span></span><br /><br /> <span data-ttu-id="2270e-137">Pro nastavení zabezpečené relace jsou k dispozici dvě fáze:</span><span class="sxs-lookup"><span data-stu-id="2270e-137">There are two stages for "Set up Secure Session":</span></span><br /><br /> <span data-ttu-id="2270e-138">1.  Vyjednávání ověřování.</span><span class="sxs-lookup"><span data-stu-id="2270e-138">1.  Authentication negotiation.</span></span> <span data-ttu-id="2270e-139">To je volitelné, pokud již klient obsahuje správné přihlašovací údaje.</span><span class="sxs-lookup"><span data-stu-id="2270e-139">This is optional if the client already has the proper credentials.</span></span> <span data-ttu-id="2270e-140">Tuto fázi je možné provést prostřednictvím zabezpečeného přenosu nebo prostřednictvím výměny zpráv.</span><span class="sxs-lookup"><span data-stu-id="2270e-140">This phase can be done through secure transport, or through message exchanges.</span></span> <span data-ttu-id="2270e-141">V druhém případě může probíhat výměna 1 nebo 2 RSTR.</span><span class="sxs-lookup"><span data-stu-id="2270e-141">In the latter case, 1 or 2 RST/RSTR exchanges can happen.</span></span> <span data-ttu-id="2270e-142">Pro tyto výměny se trasování generují v nových aktivitách žádostí a odpovědí, jak už bylo navrženo dříve.</span><span class="sxs-lookup"><span data-stu-id="2270e-142">For these exchanges, traces are emitted in new request/reply activities as previously designed.</span></span><br /><span data-ttu-id="2270e-143">2.  Vytvoření zabezpečené relace (SCT), ve kterém se tady stane jedna RST/RSTR výměna.</span><span class="sxs-lookup"><span data-stu-id="2270e-143">2.  Secure session establishment (SCT), in which one RST/RSTR exchange happens here.</span></span> <span data-ttu-id="2270e-144">To má stejné okolní aktivity, jak je popsáno výše.</span><span class="sxs-lookup"><span data-stu-id="2270e-144">This has the same ambient activities as described previously.</span></span>|<span data-ttu-id="2270e-145">– Trasování systému Exchange</span><span class="sxs-lookup"><span data-stu-id="2270e-145">-   Exchange traces</span></span><br /><span data-ttu-id="2270e-146">– Zavedený zabezpečený kanál</span><span class="sxs-lookup"><span data-stu-id="2270e-146">-   Secure channel established</span></span><br /><span data-ttu-id="2270e-147">-Bylo získáno sdílení tajných kódů.</span><span class="sxs-lookup"><span data-stu-id="2270e-147">-   Share secrets obtained.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="2270e-148">V režimu smíšeného zabezpečení se ověřování vyjednávání provádí v binárních výměnách, ale SCT se děje ve výměně zpráv.</span><span class="sxs-lookup"><span data-stu-id="2270e-148">In mixed security mode, negotiation authentication happens in binary exchanges, but SCT happens in message exchange.</span></span> <span data-ttu-id="2270e-149">V režimu čistého přenosu probíhá vyjednávání pouze v přenosu bez dalších aktivit.</span><span class="sxs-lookup"><span data-stu-id="2270e-149">In pure transport mode, negotiation happens only in transport with no additional activities.</span></span>  
  
## <a name="message-encryption-and-decryption"></a><span data-ttu-id="2270e-150">Šifrování a dešifrování zpráv</span><span class="sxs-lookup"><span data-stu-id="2270e-150">Message Encryption and Decryption</span></span>  
 <span data-ttu-id="2270e-151">V následující tabulce jsou uvedeny aktivity a trasování pro šifrování a dešifrování zpráv a také ověřování podpisů.</span><span class="sxs-lookup"><span data-stu-id="2270e-151">The following table lists the activities and traces for message encryption/decryption, as well as signature authentication.</span></span>  
  
||<span data-ttu-id="2270e-152">Zabezpečený přenos</span><span class="sxs-lookup"><span data-stu-id="2270e-152">Secure Transport</span></span><br /><br /> <span data-ttu-id="2270e-153">(HTTPS, SSL) a vrstva zabezpečené zprávy</span><span class="sxs-lookup"><span data-stu-id="2270e-153">(HTTPS, SSL) and Secure Message Layer</span></span><br /><br /> <span data-ttu-id="2270e-154">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="2270e-154">(WSHTTP)</span></span>|  
|-|---------------------------------------------------------------------------------|  
|<span data-ttu-id="2270e-155">Čas, kdy dojde k šifrování a dešifrování zprávy, i k ověřování podpisů</span><span class="sxs-lookup"><span data-stu-id="2270e-155">Time when message encryption/decryption, as well as signature authentication happens</span></span>|<span data-ttu-id="2270e-156">Při přijetí zprávy</span><span class="sxs-lookup"><span data-stu-id="2270e-156">On message received</span></span>|  
|<span data-ttu-id="2270e-157">Aktivity</span><span class="sxs-lookup"><span data-stu-id="2270e-157">Activities</span></span>|<span data-ttu-id="2270e-158">Trasování jsou vydávána v aktivitě ProcessAction na klientovi a serveru.</span><span class="sxs-lookup"><span data-stu-id="2270e-158">Traces are emitted in the ProcessAction activity on the client and server.</span></span>|  
|<span data-ttu-id="2270e-159">Trasování</span><span class="sxs-lookup"><span data-stu-id="2270e-159">Traces</span></span>|<span data-ttu-id="2270e-160">-sendSecurityHeader (odesilatel):</span><span class="sxs-lookup"><span data-stu-id="2270e-160">-   sendSecurityHeader (sender):</span></span><br /><span data-ttu-id="2270e-161">– Podepsat zprávu</span><span class="sxs-lookup"><span data-stu-id="2270e-161">-   Sign message</span></span><br /><span data-ttu-id="2270e-162">-Šifrovat data požadavku</span><span class="sxs-lookup"><span data-stu-id="2270e-162">-   Encrypt request data</span></span><br /><span data-ttu-id="2270e-163">-receiveSecurityHeader (přijímač):</span><span class="sxs-lookup"><span data-stu-id="2270e-163">-   receiveSecurityHeader (receiver):</span></span><br /><span data-ttu-id="2270e-164">-Ověřit podpis</span><span class="sxs-lookup"><span data-stu-id="2270e-164">-   Verify signature</span></span><br /><span data-ttu-id="2270e-165">-Dešifrovat data odpovědi</span><span class="sxs-lookup"><span data-stu-id="2270e-165">-   Decrypt response data</span></span><br /><span data-ttu-id="2270e-166">– Ověřování</span><span class="sxs-lookup"><span data-stu-id="2270e-166">-   Authentication</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="2270e-167">V režimu čistého přenosu probíhá šifrování a dešifrování zpráv pouze v přenosu bez dalších aktivit.</span><span class="sxs-lookup"><span data-stu-id="2270e-167">In pure transport mode, message encryption/decryption happens only in transport with no additional activities.</span></span>  
  
## <a name="authorization-and-verification"></a><span data-ttu-id="2270e-168">Autorizace a ověřování</span><span class="sxs-lookup"><span data-stu-id="2270e-168">Authorization and Verification</span></span>  
 <span data-ttu-id="2270e-169">V následující tabulce jsou uvedeny aktivity a trasování pro autorizaci.</span><span class="sxs-lookup"><span data-stu-id="2270e-169">The following table lists the activities and traces for authorization.</span></span>  
  
||<span data-ttu-id="2270e-170">Čas, kdy dojde k autorizaci</span><span class="sxs-lookup"><span data-stu-id="2270e-170">Time when authorization happens</span></span>|<span data-ttu-id="2270e-171">Aktivity</span><span class="sxs-lookup"><span data-stu-id="2270e-171">Activities</span></span>|<span data-ttu-id="2270e-172">Trasování</span><span class="sxs-lookup"><span data-stu-id="2270e-172">Traces</span></span>|  
|-|-------------------------------------|----------------|------------|  
|<span data-ttu-id="2270e-173">Místní (výchozí)</span><span class="sxs-lookup"><span data-stu-id="2270e-173">Local (default)</span></span>|<span data-ttu-id="2270e-174">Po dešifrování zprávy na serveru</span><span class="sxs-lookup"><span data-stu-id="2270e-174">After the message is decrypted on the server</span></span>|<span data-ttu-id="2270e-175">Trasování jsou vydávána v aktivitě ProcessAction na serveru.</span><span class="sxs-lookup"><span data-stu-id="2270e-175">Traces are emitted in the ProcessAction activity at the server.</span></span>|<span data-ttu-id="2270e-176">Autorizován uživatelem.</span><span class="sxs-lookup"><span data-stu-id="2270e-176">User authorized.</span></span>|  
|<span data-ttu-id="2270e-177">Vzdálený</span><span class="sxs-lookup"><span data-stu-id="2270e-177">Remote</span></span>|<span data-ttu-id="2270e-178">Po dešifrování zprávy na serveru</span><span class="sxs-lookup"><span data-stu-id="2270e-178">After the message is decrypted on the server</span></span>|<span data-ttu-id="2270e-179">Trasování jsou generována v nové aktivitě vyvolané aktivitou ProcessAction.</span><span class="sxs-lookup"><span data-stu-id="2270e-179">Traces are emitted in a new activity invoked by the ProcessAction activity.</span></span>|<span data-ttu-id="2270e-180">Autorizován uživatelem.</span><span class="sxs-lookup"><span data-stu-id="2270e-180">User authorized.</span></span>|
