---
title: Konfigurace protokolování zpráv
ms.date: 03/30/2017
helpviewer_keywords:
- message logging [WCF]
ms.assetid: 0ff4c857-8f09-4b85-9dc0-89084706e4c9
ms.openlocfilehash: e1d4c91ee282233e862ae14bf8d650ab2a754462
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/08/2019
ms.locfileid: "59112083"
---
# <a name="configuring-message-logging"></a><span data-ttu-id="f3516-102">Konfigurace protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="f3516-102">Configuring Message Logging</span></span>
<span data-ttu-id="f3516-103">Toto téma popisuje, jak nakonfigurovat protokolování zpráv pro různé scénáře.</span><span class="sxs-lookup"><span data-stu-id="f3516-103">This topic describes how you can configure message logging for different scenarios.</span></span>  
  
## <a name="enabling-message-logging"></a><span data-ttu-id="f3516-104">Povolení protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="f3516-104">Enabling Message Logging</span></span>  
 <span data-ttu-id="f3516-105">Windows Communication Foundation (WCF) protokolu zpráv ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="f3516-105">Windows Communication Foundation (WCF) does not log messages by default.</span></span> <span data-ttu-id="f3516-106">K aktivaci protokolování zpráv, musíte přidat naslouchací proces trasování do `System.ServiceModel.MessageLogging` trasování a nastavte atributy `<messagelogging>` element v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="f3516-106">To activate message logging, you must add a trace listener to the `System.ServiceModel.MessageLogging` trace source and set attributes for the `<messagelogging>` element in the configuration file.</span></span>  
  
 <span data-ttu-id="f3516-107">Následující příklad ukazuje, jak povolit protokolování a určit další možnosti.</span><span class="sxs-lookup"><span data-stu-id="f3516-107">The following example shows how to enable logging and specify additional options.</span></span>  
  
```xml  
<system.diagnostics>  
  <sources>  
    <source name="System.ServiceModel.MessageLogging">  
      <listeners>  
         <add name="messages"  
              type="System.Diagnostics.XmlWriterTraceListener"  
              initializeData="c:\logs\messages.svclog" />  
        </listeners>  
    </source>  
  </sources>  
</system.diagnostics>  
  
<system.serviceModel>  
  <diagnostics>  
    <messageLogging   
         logEntireMessage="true"   
         logMalformedMessages="false"  
         logMessagesAtServiceLevel="true"   
         logMessagesAtTransportLevel="false"  
         maxMessagesToLog="3000"  
         maxSizeOfMessageToLog="2000"/>  
  </diagnostics>  
</system.serviceModel>  
```  
  
 <span data-ttu-id="f3516-108">Další informace o nastavení protokolování zpráv najdete v tématu [doporučené nastavení pro trasování a protokolování zpráv](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md).</span><span class="sxs-lookup"><span data-stu-id="f3516-108">For more information about message logging settings, see [Recommended Settings for Tracing and Message Logging](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md).</span></span>  
  
 <span data-ttu-id="f3516-109">Můžete použít `add` zadat název a typ naslouchací proces, který chcete použít.</span><span class="sxs-lookup"><span data-stu-id="f3516-109">You can use `add` to specify the name and type of the listener you want to use.</span></span> <span data-ttu-id="f3516-110">V konfiguraci příkladu naslouchací proces má název "zprávy" a přidá standardní naslouchací proces trasování rozhraní .NET Framework (`System.Diagnostics.XmlWriterTraceListener`) jako typ, který má použít.</span><span class="sxs-lookup"><span data-stu-id="f3516-110">In the example configuration, the Listener is named "messages" and adds the standard .NET Framework trace listener (`System.Diagnostics.XmlWriterTraceListener`) as the type to use.</span></span> <span data-ttu-id="f3516-111">Pokud používáte `System.Diagnostics.XmlWriterTraceListener`, musíte zadat název a umístění souboru výstupu v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="f3516-111">If you use `System.Diagnostics.XmlWriterTraceListener`, you must specify the output file location and name in the configuration file.</span></span> <span data-ttu-id="f3516-112">To se provádí nastavením `initializeData` k názvu souboru protokolu.</span><span class="sxs-lookup"><span data-stu-id="f3516-112">This is done by setting `initializeData` to the name of the log file.</span></span> <span data-ttu-id="f3516-113">Jinak systém vyvolá výjimku.</span><span class="sxs-lookup"><span data-stu-id="f3516-113">Otherwise, the system throws an exception.</span></span> <span data-ttu-id="f3516-114">Můžete také implementovat vlastní naslouchací proces, který vysílá protokoluje události do souboru výchozí.</span><span class="sxs-lookup"><span data-stu-id="f3516-114">You can also implement a custom listener that emits logs to a default file.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f3516-115">Protože protokolování zpráv přistupuje k místa na disku, byste měli omezit počet zpráv, které se zapisují na disk pro konkrétní službu.</span><span class="sxs-lookup"><span data-stu-id="f3516-115">Because message logging accesses disk space, you should limit the number of messages that are written to disk for a particular service.</span></span> <span data-ttu-id="f3516-116">Při dosažení limitu zprávy trasování na úrovni informace je vytvořen a zastavte všechny aktivity. protokolování zpráv.</span><span class="sxs-lookup"><span data-stu-id="f3516-116">When the message limit is reached, a trace at the Information level is produced and all message logging activities stop.</span></span>  
  
 <span data-ttu-id="f3516-117">Úroveň protokolování, jakož i další možnosti jsou popsány v části Možnosti a úrovně protokolování.</span><span class="sxs-lookup"><span data-stu-id="f3516-117">The logging level, as well as the additional options, are discussed in the Logging Level and Options section.</span></span>  
  
 <span data-ttu-id="f3516-118">`switchValue` Atribut `source` je platná pouze pro trasování.</span><span class="sxs-lookup"><span data-stu-id="f3516-118">The `switchValue` attribute of a `source` is only valid for tracing.</span></span> <span data-ttu-id="f3516-119">Pokud zadáte `switchValue` atribut pro `System.ServiceModel.MessageLogging` zdroj trasování jako následující, nemá žádný vliv.</span><span class="sxs-lookup"><span data-stu-id="f3516-119">If you specify a `switchValue` attribute for the `System.ServiceModel.MessageLogging` trace source as follows, it has no effect.</span></span>  
  
```xml  
<source name="System.ServiceModel.MessageLogging" switchValue="Verbose">  
```  
  
 <span data-ttu-id="f3516-120">Pokud chcete zakázat zdroj trasování, měli byste použít `logMessagesAtServiceLevel`, `logMalformedMessages`, a `logMessagesAtTransportLevel` atributy `messageLogging` element místo.</span><span class="sxs-lookup"><span data-stu-id="f3516-120">If you want to disable the trace source, you should use the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element instead.</span></span> <span data-ttu-id="f3516-121">Tyto atributy byste měli nastavit na `false`.</span><span class="sxs-lookup"><span data-stu-id="f3516-121">You should set all these attributes to `false`.</span></span> <span data-ttu-id="f3516-122">To můžete udělat pomocí konfiguračního souboru v předcházejícím příkladu, přes uživatelské rozhraní editoru konfigurace rozhraní nebo pomocí rozhraní WMI.</span><span class="sxs-lookup"><span data-stu-id="f3516-122">This can be done by using the configuration file in the previous code example, through the Configuration Editor UI interface, or using WMI.</span></span> <span data-ttu-id="f3516-123">Další informace o nástroji pro Editor konfigurace najdete v tématu [nástroj Configuration Editor (SvcConfigEditor.exe)](../../../../docs/framework/wcf/configuration-editor-tool-svcconfigeditor-exe.md).</span><span class="sxs-lookup"><span data-stu-id="f3516-123">For more information about the Configuration Editor tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](../../../../docs/framework/wcf/configuration-editor-tool-svcconfigeditor-exe.md).</span></span> <span data-ttu-id="f3516-124">Další informace o rozhraní WMI najdete v tématu [pomocí Windows Management Instrumentation k diagnostice](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="f3516-124">For more information about WMI, see [Using Windows Management Instrumentation for Diagnostics](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span></span>  
  
## <a name="logging-levels-and-options"></a><span data-ttu-id="f3516-125">Možnosti a úrovně protokolování</span><span class="sxs-lookup"><span data-stu-id="f3516-125">Logging Levels and Options</span></span>  
 <span data-ttu-id="f3516-126">Pro příchozí zprávy se stane protokolování ihned poté, co je vytvořen zprávy, okamžitě předtím, než získá zprávu do uživatelského kódu na úrovni služby, a když se zjistí špatně vytvořené zprávy.</span><span class="sxs-lookup"><span data-stu-id="f3516-126">For incoming messages, logging happens immediately after the message is formed, immediately before the message gets to user code in the service level, and when malformed messages are detected.</span></span>  
  
 <span data-ttu-id="f3516-127">Odchozí zprávy protokolování se stane hned po zpráva opustí uživatelský kód a bezprostředně před zprávy přejde na lince.</span><span class="sxs-lookup"><span data-stu-id="f3516-127">For outgoing messages, logging happens immediately after the message leaves user code and immediately before the message goes on the wire.</span></span>  
  
 <span data-ttu-id="f3516-128">Zprávy ve dvou různých úrovních, služby a přenosu protokolu WCF.</span><span class="sxs-lookup"><span data-stu-id="f3516-128">WCF logs messages at two different levels, service and transport.</span></span> <span data-ttu-id="f3516-129">Špatně vytvořené zprávy jsou také zaznamenána.</span><span class="sxs-lookup"><span data-stu-id="f3516-129">Malformed messages are also logged.</span></span> <span data-ttu-id="f3516-130">Tři kategorie jsou na sobě nezávislé a může být aktivováno zvlášť v konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="f3516-130">The three categories are independent from each other and can be activated separately in configuration.</span></span>  
  
 <span data-ttu-id="f3516-131">Úroveň protokolování můžete řídit tak, že nastavíte `logMessagesAtServiceLevel`, `logMalformedMessages`, a `logMessagesAtTransportLevel` atributy `messageLogging` elementu.</span><span class="sxs-lookup"><span data-stu-id="f3516-131">You can control the logging level by setting the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element.</span></span>  
  
### <a name="service-level"></a><span data-ttu-id="f3516-132">Úrovně služeb</span><span class="sxs-lookup"><span data-stu-id="f3516-132">Service Level</span></span>  
 <span data-ttu-id="f3516-133">Chystáte se aktivovalo (přijímání) nebo ponechat (odesílání) jsou zprávy zaprotokolované v této vrstvě uživatelského kódu.</span><span class="sxs-lookup"><span data-stu-id="f3516-133">Messages logged at this layer are about to enter (on receiving) or leave (on sending) user code.</span></span> <span data-ttu-id="f3516-134">Pokud filtry jste definovali, budou protokolovány jen zprávy, které odpovídají filtrům.</span><span class="sxs-lookup"><span data-stu-id="f3516-134">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="f3516-135">V opačném případě se protokolují všechny zprávy na úrovni služby.</span><span class="sxs-lookup"><span data-stu-id="f3516-135">Otherwise, all messages at the service level are logged.</span></span> <span data-ttu-id="f3516-136">Na této úrovni, s výjimkou zpráv spolehlivého zasílání zpráv jsou také zaznamenány infrastruktury zprávy (transakce, protokolu peer channel a zabezpečení).</span><span class="sxs-lookup"><span data-stu-id="f3516-136">Infrastructure messages (transactions, peer channel, and security) are also logged at this level, except for Reliable Messaging messages.</span></span> <span data-ttu-id="f3516-137">U zpráv s datovým proudem se protokolují pouze záhlaví.</span><span class="sxs-lookup"><span data-stu-id="f3516-137">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="f3516-138">Kromě toho zabezpečených zpráv jsou protokolovány dešifrovat na této úrovni.</span><span class="sxs-lookup"><span data-stu-id="f3516-138">In addition, secure messages are logged decrypted at this level.</span></span>  
  
### <a name="transport-level"></a><span data-ttu-id="f3516-139">Úroveň přenosu</span><span class="sxs-lookup"><span data-stu-id="f3516-139">Transport Level</span></span>  
 <span data-ttu-id="f3516-140">Zprávy zaprotokolované v této vrstvě připraveni být kódován nebo dekódován pro nebo po letenky na lince.</span><span class="sxs-lookup"><span data-stu-id="f3516-140">Messages logged at this layer are ready to be encoded or decoded for or after transportation on the wire.</span></span> <span data-ttu-id="f3516-141">Pokud filtry jste definovali, budou protokolovány jen zprávy, které odpovídají filtrům.</span><span class="sxs-lookup"><span data-stu-id="f3516-141">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="f3516-142">V opačném případě se protokolují všechny zprávy v přenosové vrstvě.</span><span class="sxs-lookup"><span data-stu-id="f3516-142">Otherwise, all messages at the transport layer are logged.</span></span> <span data-ttu-id="f3516-143">Všechny zprávy infrastruktury jsou protokolovány v této vrstvě, včetně zpráv spolehlivého zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="f3516-143">All infrastructure messages are logged at this layer, including reliable messaging messages.</span></span> <span data-ttu-id="f3516-144">U zpráv s datovým proudem se protokolují pouze záhlaví.</span><span class="sxs-lookup"><span data-stu-id="f3516-144">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="f3516-145">Kromě toho zabezpečených zpráv jsou protokolovány jako zašifrovaná na této úrovni, kromě případu, kdy zabezpečeného přenosu, jako se používá protokol HTTPS.</span><span class="sxs-lookup"><span data-stu-id="f3516-145">In addition, secure messages are logged as encrypted at this level, except if a secure transport such as HTTPS is used.</span></span>  
  
### <a name="malformed-level"></a><span data-ttu-id="f3516-146">Poškozená úroveň</span><span class="sxs-lookup"><span data-stu-id="f3516-146">Malformed Level</span></span>  
 <span data-ttu-id="f3516-147">Špatně vytvořené zprávy jsou zpráv, které jsou odmítnuty zásobníkem WCF v jakékoli fázi zpracování.</span><span class="sxs-lookup"><span data-stu-id="f3516-147">Malformed messages are messages that are rejected by the WCF stack at any stage of processing.</span></span> <span data-ttu-id="f3516-148">Jsou špatně vytvořené zprávy zaznamenány jako-se: šifrovaná, pokud jsou, bez správných XML a tak dále.</span><span class="sxs-lookup"><span data-stu-id="f3516-148">Malformed messages are logged as-is: encrypted if they are so, with non-proper XML, and so on.</span></span> `maxSizeOfMessageToLog` <span data-ttu-id="f3516-149">definovaná velikost zprávy, která se zaznamená jako CDATA.</span><span class="sxs-lookup"><span data-stu-id="f3516-149">defined the size of the message to be logged as CDATA.</span></span> <span data-ttu-id="f3516-150">Ve výchozím nastavení `maxSizeOfMessageToLog` je rovna 256 kB.</span><span class="sxs-lookup"><span data-stu-id="f3516-150">By default, `maxSizeOfMessageToLog` is equal to 256K.</span></span> <span data-ttu-id="f3516-151">Další informace o tomto atributu naleznete v části Další možnosti.</span><span class="sxs-lookup"><span data-stu-id="f3516-151">For more information about this attribute, see the Other Options section.</span></span>  
  
### <a name="other-options"></a><span data-ttu-id="f3516-152">Další možnosti</span><span class="sxs-lookup"><span data-stu-id="f3516-152">Other Options</span></span>  
 <span data-ttu-id="f3516-153">Kromě úrovní protokolování může uživatel zadat následující možnosti:</span><span class="sxs-lookup"><span data-stu-id="f3516-153">In addition to the logging levels, the user can specify the following options:</span></span>  
  
-   <span data-ttu-id="f3516-154">Protokolovat celá zpráva (`logEntireMessage` atribut): Tato hodnota určuje, zda je zaznamenána celá zpráva (hlavička a tělo zprávy).</span><span class="sxs-lookup"><span data-stu-id="f3516-154">Log Entire Message (`logEntireMessage` attribute): This value specifies whether the entire message (message header and body) is logged.</span></span> <span data-ttu-id="f3516-155">Výchozí hodnota je `false`, což znamená, že je zaznamenána pouze záhlaví.</span><span class="sxs-lookup"><span data-stu-id="f3516-155">The default value is `false`, meaning that only the header is logged.</span></span> <span data-ttu-id="f3516-156">Toto nastavení má vliv na služby a přenosu úrovně protokolování zpráv...</span><span class="sxs-lookup"><span data-stu-id="f3516-156">This setting affects service and transport message logging levels..</span></span>  
  
-   <span data-ttu-id="f3516-157">Maximální počet zaznamenavaných zpráv (`maxMessagesToLog` atribut): Tato hodnota určuje maximální počet zaznamenavaných zpráv.</span><span class="sxs-lookup"><span data-stu-id="f3516-157">Max messages to log (`maxMessagesToLog` attribute): This value specifies the maximum number of messages to log.</span></span> <span data-ttu-id="f3516-158">Všechny zprávy (služba, přenos a špatně vytvořené zprávy) se započítává této kvóty.</span><span class="sxs-lookup"><span data-stu-id="f3516-158">All messages (service, transport, and malformed messages) are counted towards this quota.</span></span> <span data-ttu-id="f3516-159">Po dosažení kvóty trasování je vygenerován a je zaznamenána žádná další zpráva.</span><span class="sxs-lookup"><span data-stu-id="f3516-159">When the quota is reached, a trace is emitted and no additional message is logged.</span></span> <span data-ttu-id="f3516-160">Výchozí hodnota je 10000.</span><span class="sxs-lookup"><span data-stu-id="f3516-160">The default value is 10000.</span></span>  
  
-   <span data-ttu-id="f3516-161">Maximální velikost zaznamenávané zprávy (`maxSizeOfMessageToLog` atribut): Tato hodnota určuje maximální velikost zprávy do protokolu v bajtech.</span><span class="sxs-lookup"><span data-stu-id="f3516-161">Max size of message to log (`maxSizeOfMessageToLog` attribute): This value specifies the maximum size of messages to log in bytes.</span></span> <span data-ttu-id="f3516-162">Nejsou zaznamenána zprávy, které překračují omezení velikosti a žádná další aktivita se provádí pro tuto zprávu.</span><span class="sxs-lookup"><span data-stu-id="f3516-162">Messages that exceed the size limit are not logged, and no other activity is performed for that message.</span></span> <span data-ttu-id="f3516-163">Toto nastavení ovlivňuje všechny úrovně trasování.</span><span class="sxs-lookup"><span data-stu-id="f3516-163">This setting affects all trace levels.</span></span> <span data-ttu-id="f3516-164">Je-li ServiceModel trasování na, úroveň trasování varování je vygenerován v prvním bodu protokolování (ServiceModelSend \* nebo TransportReceive) a upozorňovaly uživatele.</span><span class="sxs-lookup"><span data-stu-id="f3516-164">If ServiceModel tracing is on, a Warning level trace is emitted at the first logging point (ServiceModelSend\* or TransportReceive) to notify the user.</span></span> <span data-ttu-id="f3516-165">Výchozí hodnota pro služby úrovně a přenosu úrovně zprávy je 256 kB, výchozí hodnota pro špatně vytvořené zprávy je 4 kB.</span><span class="sxs-lookup"><span data-stu-id="f3516-165">The default value for service level and transport level messages is 256K, while the default value for malformed messages is 4K.</span></span>  
  
    > [!CAUTION]
    >  <span data-ttu-id="f3516-166">Velikost zprávy, které je vypočítán nímž bude porovnáváno `maxSizeOfMessageToLog` je velikosti zprávy v paměti před serializací.</span><span class="sxs-lookup"><span data-stu-id="f3516-166">The message size that is computed to compare against `maxSizeOfMessageToLog` is the message size in memory before serialization.</span></span> <span data-ttu-id="f3516-167">Tato velikost se může lišit od skutečná délka řetězce zprávy, která není přihlašováno a v mnoha případech je větší než skutečná velikost.</span><span class="sxs-lookup"><span data-stu-id="f3516-167">This size can differ from the actual length of the message string that is being logged, and in many occasions is bigger than the actual size.</span></span> <span data-ttu-id="f3516-168">V důsledku toho nemusí zaznamenávané zprávy.</span><span class="sxs-lookup"><span data-stu-id="f3516-168">As a result, messages may not be logged.</span></span> <span data-ttu-id="f3516-169">Můžete pro tuto skutečnost tak, že zadáte účet `maxSizeOfMessageToLog` atribut 10 % je větší než velikost očekávaná zpráva.</span><span class="sxs-lookup"><span data-stu-id="f3516-169">You can account for this fact by specifying the `maxSizeOfMessageToLog` attribute to be 10% larger than the expected message size.</span></span> <span data-ttu-id="f3516-170">Kromě toho, pokud jsou špatně vytvořené zprávy zaznamenány, místo na disku skutečné využívaných protokolů zpráv může být až 5krát velikost hodnotu zadanou pomocí `maxSizeOfMessageToLog`.</span><span class="sxs-lookup"><span data-stu-id="f3516-170">In addition, if malformed messages are logged, the actual disk space utilized by the message logs can be up to 5 times the size of the value specified by `maxSizeOfMessageToLog`.</span></span>  
  
 <span data-ttu-id="f3516-171">Pokud v konfiguračním souboru není definován žádný naslouchací proces trasování, nebude vygenerován žádný výstup protokolování bez ohledu na zadanou úroveň.</span><span class="sxs-lookup"><span data-stu-id="f3516-171">If no trace listener is defined in the configuration file, no logging output is generated regardless of the specified logging level.</span></span>  
  
 <span data-ttu-id="f3516-172">Možnosti protokolování zprávy, jako je například atributy popsané v této části můžete změnit za běhu pomocí Windows Management Instrumentation (WMI).</span><span class="sxs-lookup"><span data-stu-id="f3516-172">Message logging options, such as the attributes described in this section, can be changed at runtime using Windows Management Instrumentation (WMI).</span></span> <span data-ttu-id="f3516-173">To můžete udělat přechodem k [AppDomainInfo](../../../../docs/framework/wcf/diagnostics/wmi/appdomaininfo.md) instanci, která poskytuje tyto logické vlastnosti: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, a `LogMalformedMessages`.</span><span class="sxs-lookup"><span data-stu-id="f3516-173">This can be done by accessing the [AppDomainInfo](../../../../docs/framework/wcf/diagnostics/wmi/appdomaininfo.md) instance, which exposes these Boolean properties: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, and `LogMalformedMessages`.</span></span> <span data-ttu-id="f3516-174">Proto pokud nakonfigurovat naslouchací proces trasování pro protokolování zpráv, ale nastavit tyto možnosti na `false` v konfiguraci, můžete později změnit jejich `true` při spouštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3516-174">Therefore, if you configure a trace listener for message logging, but set these options to `false` in configuration, you can later change them to `true` when the application is running.</span></span> <span data-ttu-id="f3516-175">To umožňuje efektivní protokolování zpráv za běhu.</span><span class="sxs-lookup"><span data-stu-id="f3516-175">This effectively enables message logging at runtime.</span></span> <span data-ttu-id="f3516-176">Podobně pokud povolíte protokolování. v konfiguračním souboru, můžete ho zakázat za běhu pomocí rozhraní WMI.</span><span class="sxs-lookup"><span data-stu-id="f3516-176">Similarly, if you enable message logging in your configuration file, you can disable it at runtime using WMI.</span></span> <span data-ttu-id="f3516-177">Další informace najdete v tématu [pomocí Windows Management Instrumentation k diagnostice](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="f3516-177">For more information, see [Using Windows Management Instrumentation for Diagnostics](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span></span>  
  
 <span data-ttu-id="f3516-178">`source` Určuje pole v protokolu zpráv v daném kontextu se protokoluje zprávy: při odesílání nebo přijímání zprávu požadavku pro požadavek odpověď nebo způsob 1 žádost, ve vrstvě služeb modelu nebo přenosu nebo v případě poškozená zpráva.</span><span class="sxs-lookup"><span data-stu-id="f3516-178">The `source` field in a message log specifies in which context the message is logged: when sending/receiving a request message, for a request-reply or 1-way request, at service model or transport layer, or in the case of a malformed message.</span></span>  
  
 <span data-ttu-id="f3516-179">Pro špatně vytvořené zprávy `source` rovná `Malformed`.</span><span class="sxs-lookup"><span data-stu-id="f3516-179">For malformed messages, `source`  is equal to `Malformed`.</span></span> <span data-ttu-id="f3516-180">V opačném případě zdroj má následující hodnoty na základě kontextu.</span><span class="sxs-lookup"><span data-stu-id="f3516-180">Otherwise, source has the following values based on the context.</span></span>  
  
 <span data-ttu-id="f3516-181">Pro žádost odpověď</span><span class="sxs-lookup"><span data-stu-id="f3516-181">For Request/Reply</span></span>  
  
||<span data-ttu-id="f3516-182">Odeslání požadavku</span><span class="sxs-lookup"><span data-stu-id="f3516-182">Send Request</span></span>|<span data-ttu-id="f3516-183">Požadavku přijetí</span><span class="sxs-lookup"><span data-stu-id="f3516-183">Receive Request</span></span>|<span data-ttu-id="f3516-184">Odeslání odpovědi</span><span class="sxs-lookup"><span data-stu-id="f3516-184">Send Reply</span></span>|<span data-ttu-id="f3516-185">Přijmout odpověď</span><span class="sxs-lookup"><span data-stu-id="f3516-185">Receive Reply</span></span>|  
|-|------------------|---------------------|----------------|-------------------|  
|<span data-ttu-id="f3516-186">Vrstva modelu služby</span><span class="sxs-lookup"><span data-stu-id="f3516-186">Service Model layer</span></span>|<span data-ttu-id="f3516-187">Služba</span><span class="sxs-lookup"><span data-stu-id="f3516-187">Service</span></span><br /><br /> <span data-ttu-id="f3516-188">úroveň</span><span class="sxs-lookup"><span data-stu-id="f3516-188">Level</span></span><br /><br /> <span data-ttu-id="f3516-189">Odeslat</span><span class="sxs-lookup"><span data-stu-id="f3516-189">Send</span></span><br /><br /> <span data-ttu-id="f3516-190">Request</span><span class="sxs-lookup"><span data-stu-id="f3516-190">Request</span></span>|<span data-ttu-id="f3516-191">Služba</span><span class="sxs-lookup"><span data-stu-id="f3516-191">Service</span></span><br /><br /> <span data-ttu-id="f3516-192">úroveň</span><span class="sxs-lookup"><span data-stu-id="f3516-192">Level</span></span><br /><br /> <span data-ttu-id="f3516-193">Zobrazit</span><span class="sxs-lookup"><span data-stu-id="f3516-193">Receive</span></span><br /><br /> <span data-ttu-id="f3516-194">Request</span><span class="sxs-lookup"><span data-stu-id="f3516-194">Request</span></span>|<span data-ttu-id="f3516-195">Služba</span><span class="sxs-lookup"><span data-stu-id="f3516-195">Service</span></span><br /><br /> <span data-ttu-id="f3516-196">úroveň</span><span class="sxs-lookup"><span data-stu-id="f3516-196">Level</span></span><br /><br /> <span data-ttu-id="f3516-197">Odeslat</span><span class="sxs-lookup"><span data-stu-id="f3516-197">Send</span></span><br /><br /> <span data-ttu-id="f3516-198">Odpověď</span><span class="sxs-lookup"><span data-stu-id="f3516-198">Reply</span></span>|<span data-ttu-id="f3516-199">Služba</span><span class="sxs-lookup"><span data-stu-id="f3516-199">Service</span></span><br /><br /> <span data-ttu-id="f3516-200">úroveň</span><span class="sxs-lookup"><span data-stu-id="f3516-200">Level</span></span><br /><br /> <span data-ttu-id="f3516-201">Zobrazit</span><span class="sxs-lookup"><span data-stu-id="f3516-201">Receive</span></span><br /><br /> <span data-ttu-id="f3516-202">Odpověď</span><span class="sxs-lookup"><span data-stu-id="f3516-202">Reply</span></span>|  
|<span data-ttu-id="f3516-203">přenosové vrstvy</span><span class="sxs-lookup"><span data-stu-id="f3516-203">Transport layer</span></span>|<span data-ttu-id="f3516-204">Přenos</span><span class="sxs-lookup"><span data-stu-id="f3516-204">Transport</span></span><br /><br /> <span data-ttu-id="f3516-205">Odeslat</span><span class="sxs-lookup"><span data-stu-id="f3516-205">Send</span></span>|<span data-ttu-id="f3516-206">Přenos</span><span class="sxs-lookup"><span data-stu-id="f3516-206">Transport</span></span><br /><br /> <span data-ttu-id="f3516-207">Zobrazit</span><span class="sxs-lookup"><span data-stu-id="f3516-207">Receive</span></span>|<span data-ttu-id="f3516-208">Přenos</span><span class="sxs-lookup"><span data-stu-id="f3516-208">Transport</span></span><br /><br /> <span data-ttu-id="f3516-209">Odeslat</span><span class="sxs-lookup"><span data-stu-id="f3516-209">Send</span></span>|<span data-ttu-id="f3516-210">Přenos</span><span class="sxs-lookup"><span data-stu-id="f3516-210">Transport</span></span><br /><br /> <span data-ttu-id="f3516-211">Zobrazit</span><span class="sxs-lookup"><span data-stu-id="f3516-211">Receive</span></span>|  
  
 <span data-ttu-id="f3516-212">Pro jednosměrný požadavek</span><span class="sxs-lookup"><span data-stu-id="f3516-212">For One-way Request</span></span>  
  
||<span data-ttu-id="f3516-213">Odeslání požadavku</span><span class="sxs-lookup"><span data-stu-id="f3516-213">Send Request</span></span>|<span data-ttu-id="f3516-214">Požadavku přijetí</span><span class="sxs-lookup"><span data-stu-id="f3516-214">Receive Request</span></span>|  
|-|------------------|---------------------|  
|<span data-ttu-id="f3516-215">Vrstva modelu služby</span><span class="sxs-lookup"><span data-stu-id="f3516-215">Service Model layer</span></span>|<span data-ttu-id="f3516-216">Služba</span><span class="sxs-lookup"><span data-stu-id="f3516-216">Service</span></span><br /><br /> <span data-ttu-id="f3516-217">úroveň</span><span class="sxs-lookup"><span data-stu-id="f3516-217">Level</span></span><br /><br /> <span data-ttu-id="f3516-218">Odeslat</span><span class="sxs-lookup"><span data-stu-id="f3516-218">Send</span></span><br /><br /> <span data-ttu-id="f3516-219">Datagram</span><span class="sxs-lookup"><span data-stu-id="f3516-219">Datagram</span></span>|<span data-ttu-id="f3516-220">Služba</span><span class="sxs-lookup"><span data-stu-id="f3516-220">Service</span></span><br /><br /> <span data-ttu-id="f3516-221">úroveň</span><span class="sxs-lookup"><span data-stu-id="f3516-221">Level</span></span><br /><br /> <span data-ttu-id="f3516-222">Zobrazit</span><span class="sxs-lookup"><span data-stu-id="f3516-222">Receive</span></span><br /><br /> <span data-ttu-id="f3516-223">Datagram</span><span class="sxs-lookup"><span data-stu-id="f3516-223">Datagram</span></span>|  
|<span data-ttu-id="f3516-224">přenosové vrstvy</span><span class="sxs-lookup"><span data-stu-id="f3516-224">Transport layer</span></span>|<span data-ttu-id="f3516-225">Přenos</span><span class="sxs-lookup"><span data-stu-id="f3516-225">Transport</span></span><br /><br /> <span data-ttu-id="f3516-226">Odeslat</span><span class="sxs-lookup"><span data-stu-id="f3516-226">Send</span></span>|<span data-ttu-id="f3516-227">Přenos</span><span class="sxs-lookup"><span data-stu-id="f3516-227">Transport</span></span><br /><br /> <span data-ttu-id="f3516-228">Zobrazit</span><span class="sxs-lookup"><span data-stu-id="f3516-228">Receive</span></span>|  
  
## <a name="message-filters"></a><span data-ttu-id="f3516-229">Filtry zpráv</span><span class="sxs-lookup"><span data-stu-id="f3516-229">Message Filters</span></span>  
 <span data-ttu-id="f3516-230">Filtry zpráv jsou definovány v `messageLogging` element konfigurace `diagnostics` konfigurační oddíl.</span><span class="sxs-lookup"><span data-stu-id="f3516-230">Message filters are defined in the `messageLogging` configuration element of the `diagnostics` configuration section.</span></span> <span data-ttu-id="f3516-231">Tato nastavení použijí na úrovni služby a přenosu.</span><span class="sxs-lookup"><span data-stu-id="f3516-231">They are applied at the service and transport level.</span></span> <span data-ttu-id="f3516-232">Když jsou definovány jeden nebo více filtrů, jsou protokolovány jen zprávy, které odpovídají alespoň jeden z filtrů.</span><span class="sxs-lookup"><span data-stu-id="f3516-232">When one or more filters are defined, only messages that match at least one of the filters are logged.</span></span> <span data-ttu-id="f3516-233">Pokud není definován žádný filtr, všechny zprávy předávání.</span><span class="sxs-lookup"><span data-stu-id="f3516-233">If no filter is defined, all messages pass through.</span></span>  
  
 <span data-ttu-id="f3516-234">Filtry podporuje úplnou syntaxi XPath a nastavení se použijí v pořadí, ve kterém se zobrazují v konfiguračním souboru.</span><span class="sxs-lookup"><span data-stu-id="f3516-234">Filters support the full XPath syntax and are applied in the order they appear in the configuration file.</span></span> <span data-ttu-id="f3516-235">Filtr syntakticky nesprávný výsledkem výjimka v konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="f3516-235">A syntactically incorrect filter results in a configuration exception.</span></span>  
  
 <span data-ttu-id="f3516-236">Také poskytnout filtry, pomocí funkci bezpečnosti `nodeQuota` atribut, který omezí maximální počet uzlů v modelu DOM jazyka XPath, které se dají prozkoumat tak, aby odpovídaly filtru.</span><span class="sxs-lookup"><span data-stu-id="f3516-236">Filters also provide a safety feature using the `nodeQuota` attribute, which limits the maximum number of nodes in the XPath DOM that can be examined to match the filter.</span></span>  
  
 <span data-ttu-id="f3516-237">Následující příklad ukazuje, jak konfigurovat filtr pouze zprávy této záznamy, které mají záhlaví SOAP.</span><span class="sxs-lookup"><span data-stu-id="f3516-237">The following example shows how to configure a filter that records only messages that have a SOAP header section.</span></span>  
  
```xml  
<messageLogging logEntireMessage="true"  
    logMalformedMessages="true"   
    logMessagesAtServiceLevel="true"  
    logMessagesAtTransportLevel="true"  
    maxMessagesToLog="420">  
    <filters>  
        <add nodeQuota="10" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">  
                 /soap:Envelope/soap:Header  
        </add>  
     </filters>  
</messageLogging>  
```  
  
 <span data-ttu-id="f3516-238">Filtry nelze použít pro text zprávy.</span><span class="sxs-lookup"><span data-stu-id="f3516-238">Filters cannot be applied to the body of a message.</span></span> <span data-ttu-id="f3516-239">Filtry, které se pokoušejí k manipulaci s text zprávy se odeberou ze seznamu filtrů.</span><span class="sxs-lookup"><span data-stu-id="f3516-239">Filters that attempt to manipulate the body of a message are removed from the list of filters.</span></span> <span data-ttu-id="f3516-240">Událost je také vygenerován, která označuje to.</span><span class="sxs-lookup"><span data-stu-id="f3516-240">An event is also emitted that indicates this.</span></span> <span data-ttu-id="f3516-241">Například následující filtr se odeberou ze tabulce filtrů.</span><span class="sxs-lookup"><span data-stu-id="f3516-241">For example, the following filter would be removed from the filter table.</span></span>  
  
```xml  
<add xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">/s:Envelope/s:Body[contains(text(), "Hello")]</add>  
```  
  
## <a name="configuring-a-custom-listener"></a><span data-ttu-id="f3516-242">Konfigurace vlastní naslouchací proces</span><span class="sxs-lookup"><span data-stu-id="f3516-242">Configuring a Custom Listener</span></span>  
 <span data-ttu-id="f3516-243">Můžete také nakonfigurovat vlastní naslouchací proces s dalšími možnostmi.</span><span class="sxs-lookup"><span data-stu-id="f3516-243">You can also configure a custom listener with additional options.</span></span> <span data-ttu-id="f3516-244">Vlastní naslouchací proces může být užitečné při filtrování elementy identifikovatelné osobní údaje specifické pro aplikace ze zprávy před přihlášením.</span><span class="sxs-lookup"><span data-stu-id="f3516-244">A custom listener can be useful in filtering application-specific PII elements from messages before logging.</span></span> <span data-ttu-id="f3516-245">Následující příklad ukazuje vlastní naslouchací proces konfigurace.</span><span class="sxs-lookup"><span data-stu-id="f3516-245">The following example demonstrates a custom listener configuration.</span></span>  
  
```xml  
<system.diagnostics>  
   <sources>  
     <source name="System.ServiceModel.MessageLogging">  
           <listeners>  
             <add name="MyListener"   
                    type="YourCustomListener"  
                    initializeData="c:\logs\messages.svclog"  
                    maxDiskSpace="1000"/>  
           </listeners>  
     </source>  
   </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="f3516-246">Byste měli vědět, `type` atribut by měl být nastaven na kvalifikovaný název typu.</span><span class="sxs-lookup"><span data-stu-id="f3516-246">You should be aware that the `type` attribute should be set to a qualified assembly name of the type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f3516-247">Viz také:</span><span class="sxs-lookup"><span data-stu-id="f3516-247">See also</span></span>

- [<span data-ttu-id="f3516-248">\<messageLogging></span><span class="sxs-lookup"><span data-stu-id="f3516-248">\<messageLogging></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/messagelogging.md)
- [<span data-ttu-id="f3516-249">Protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="f3516-249">Message Logging</span></span>](../../../../docs/framework/wcf/diagnostics/message-logging.md)
- [<span data-ttu-id="f3516-250">Doporučené nastavení pro trasování a protokolování zpráv</span><span class="sxs-lookup"><span data-stu-id="f3516-250">Recommended Settings for Tracing and Message Logging</span></span>](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md)
