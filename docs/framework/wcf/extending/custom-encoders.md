---
title: Vlastní kodéry
ms.date: 03/30/2017
ms.assetid: fa0e1d7f-af36-4bf4-aac9-cd4eab95bc4f
ms.openlocfilehash: 7b68725346a2de23d405ed21ead93e3a6a8374e6
ms.sourcegitcommit: 3630c2515809e6f4b7dbb697a3354efec105a5cd
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/25/2019
ms.locfileid: "58411366"
---
# <a name="custom-encoders"></a><span data-ttu-id="19588-102">Vlastní kodéry</span><span class="sxs-lookup"><span data-stu-id="19588-102">Custom Encoders</span></span>
<span data-ttu-id="19588-103">Toto téma popisuje, jak vytvořit vlastní kodéry.</span><span class="sxs-lookup"><span data-stu-id="19588-103">This topic discusses how to create custom encoders.</span></span>  
  
 <span data-ttu-id="19588-104">Ve Windows Communication Foundation (WCF), je použít *vazby* určete, jak přenášet data přes síť mezi koncovými body.</span><span class="sxs-lookup"><span data-stu-id="19588-104">In Windows Communication Foundation (WCF), you use a *binding* to specify how to transfer data across a network between endpoints.</span></span> <span data-ttu-id="19588-105">Vazba se skládá z posloupnosti *elementů vazby*.</span><span class="sxs-lookup"><span data-stu-id="19588-105">A binding is made up of a sequence of *binding elements*.</span></span> <span data-ttu-id="19588-106">Vazba obsahuje volitelné protokol vazby prvky jako je zabezpečení, požadované *kodéru zpráv* element vazby a element vazby přenosu vyžaduje.</span><span class="sxs-lookup"><span data-stu-id="19588-106">A binding includes optional protocol binding elements such as security, a required *Message Encoder* binding element, and a required transport binding element.</span></span> <span data-ttu-id="19588-107">Kodér zprávy je reprezentován element vazby kódování zprávy.</span><span class="sxs-lookup"><span data-stu-id="19588-107">A message encoder is represented by a message encoding binding element.</span></span> <span data-ttu-id="19588-108">Tři kodérů zprávy jsou součástí WCF: Binární soubor, mechanismus optimalizaci přenosu zprávu (MTOM) a Text.</span><span class="sxs-lookup"><span data-stu-id="19588-108">Three message encoders are included in WCF: Binary, Message Transmission Optimization Mechanism (MTOM), and Text.</span></span>  
  
 <span data-ttu-id="19588-109">Element vazby kódování serializuje odchozí zprávu <xref:System.ServiceModel.Channels.Message> a předá ji do přenosu, nebo přijímá serializovanou formu zpráva z přenosu a předá ji do vrstvy protokolu, pokud jsou k dispozici, nebo k aplikaci, pokud není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="19588-109">A message encoding binding element serializes an outgoing <xref:System.ServiceModel.Channels.Message> and passes it to the transport, or receives the serialized form of a message from the transport and passes it to the protocol layer if present, or to the application, if not present.</span></span>  
  
 <span data-ttu-id="19588-110">Transformují kodéry zpráva <xref:System.ServiceModel.Channels.Message> instance do a z síťové vyjádření.</span><span class="sxs-lookup"><span data-stu-id="19588-110">Message encoders transform <xref:System.ServiceModel.Channels.Message> instances to and from a wire representation.</span></span> <span data-ttu-id="19588-111">I když kodérů jsou popsány jako nesídlí nad přenosové vrstvy v zásobníku kanál, jsou umístěné v přenosové vrstvě.</span><span class="sxs-lookup"><span data-stu-id="19588-111">Although encoders are described as sitting above the transport layer in the channel stack, they reside inside the transport layer.</span></span> <span data-ttu-id="19588-112">Přenosy (třeba HTTP) formátu zpráv podle požadavků standardu přenosu.</span><span class="sxs-lookup"><span data-stu-id="19588-112">Transports (for example HTTP) format the message according to the requirements of the transport standard.</span></span> <span data-ttu-id="19588-113">Kodérů (například Xml na Text) jenom kódování zprávy.</span><span class="sxs-lookup"><span data-stu-id="19588-113">Encoders (for example Text Xml) just encode the message.</span></span>  
  
 <span data-ttu-id="19588-114">Při připojování k dříve existující klient nebo server, nemusí mít možnost použití určité zprávy kódování.</span><span class="sxs-lookup"><span data-stu-id="19588-114">When connecting to a preexisting client or server, you may not have a choice about using a particular message encoding.</span></span> <span data-ttu-id="19588-115">Ale WCF služby můžou být přístupné přes několik koncových bodů, každý s kodéru různé zprávy.</span><span class="sxs-lookup"><span data-stu-id="19588-115">However, WCF services can be made accessible through multiple endpoints, each with a different message encoder.</span></span> <span data-ttu-id="19588-116">Při jedné kodér nepokrývá celý cílový pro vaši službu, vezměte v úvahu vystavení služby přes několik koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="19588-116">When a single encoder does not cover the entire audience for your service, consider exposing your service over multiple endpoints.</span></span> <span data-ttu-id="19588-117">Klientské aplikace pak můžou zvolit koncový bod, který je pro ně nejvhodnější.</span><span class="sxs-lookup"><span data-stu-id="19588-117">Client applications can then choose the endpoint that is best for them.</span></span> <span data-ttu-id="19588-118">Pomocí více koncových bodů můžete zkombinovat s jinými prvky vazby výhody jiná zpráva kodérů.</span><span class="sxs-lookup"><span data-stu-id="19588-118">Using multiple endpoints allows you to combine the advantages of different message encoders with other binding elements.</span></span>  
  
## <a name="system-provided-encoders"></a><span data-ttu-id="19588-119">Poskytnuté systémem kodérů</span><span class="sxs-lookup"><span data-stu-id="19588-119">System-Provided Encoders</span></span>  
 <span data-ttu-id="19588-120">WCF poskytuje několik vazeb poskytovaných systémem, které jsou navrženy pro nejčastější scénáře aplikací.</span><span class="sxs-lookup"><span data-stu-id="19588-120">WCF provides several system-provided bindings that are designed to cover the most common application scenarios.</span></span> <span data-ttu-id="19588-121">Každá z těchto vazeb kombinovat přenosu, kodéru zpráv a dalších možností (například zabezpečení).</span><span class="sxs-lookup"><span data-stu-id="19588-121">Each of these bindings combine a transport, message encoder, and other options (security, for example).</span></span> <span data-ttu-id="19588-122">Toto téma popisuje, jak rozšířit `Text`, `Binary`, a `MTOM` kodéry, které jsou součástí WCF, nebo vytvořte vlastní vlastní kodér zpráv.</span><span class="sxs-lookup"><span data-stu-id="19588-122">This topic describes how to extend the `Text`, `Binary`, and `MTOM` message encoders that are included in WCF, or create your own custom encoder.</span></span> <span data-ttu-id="19588-123">Kodér textu zprávy podporuje prostý XML encoding i kódování SOAP.</span><span class="sxs-lookup"><span data-stu-id="19588-123">The text message encoder supports both a plain XML encoding as well as SOAP encodings.</span></span> <span data-ttu-id="19588-124">Standardní režim kódování XML kodér textu zprávy se nazývá kodér POX ("Plain Old XML") pro jeho odlišení od založený na textu protokolu SOAP kódování.</span><span class="sxs-lookup"><span data-stu-id="19588-124">The plain XML encoding mode of the text message encoder is called the POX ("Plain Old XML") encoder to distinguish it from the text-based SOAP encoding.</span></span>  
  
 <span data-ttu-id="19588-125">Další informace o kombinacích prvky vazeb poskytovaných vazeb poskytovaných systémem, naleznete v části odpovídající v [volba přenosu](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="19588-125">For more information about the combinations of binding elements provided by the system-provided bindings, see the corresponding section in [Choosing a Transport](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span></span>  
  
## <a name="how-to-work-with-system-provided-encoders"></a><span data-ttu-id="19588-126">Jak pracovat s poskytnutými systémem kodérů</span><span class="sxs-lookup"><span data-stu-id="19588-126">How to Work with System-Provided Encoders</span></span>  
 <span data-ttu-id="19588-127">Kódování se přidá do vazby pomocí třídy odvozené od <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="19588-127">An encoding is added to a binding using a class derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
 <span data-ttu-id="19588-128">Poskytuje následující typy odvozené z elementů vazby WCF <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> třídu, která můžete zadat text, binárního souboru a kódování zpráv přenosu optimalizace mechanismus (MTOM):</span><span class="sxs-lookup"><span data-stu-id="19588-128">WCF provides the following types of binding elements derived from the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> class that can provide for text, binary and Message Transmission Optimization Mechanism (MTOM) encoding:</span></span>  
  
-   <span data-ttu-id="19588-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: Většina interoperabilní, ale nejméně efektivní kodéru zpráv XML.</span><span class="sxs-lookup"><span data-stu-id="19588-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: The most interoperable, but the least efficient encoder for XML messages.</span></span> <span data-ttu-id="19588-130">Webová služba nebo klient webové služby obecně by rozuměla textové XML.</span><span class="sxs-lookup"><span data-stu-id="19588-130">A Web service or Web service client can generally understand textual XML.</span></span> <span data-ttu-id="19588-131">Ale přenosu velkých bloků binárních dat jako text není efektivní.</span><span class="sxs-lookup"><span data-stu-id="19588-131">However, transmitting large blocks of binary data as text is not efficient.</span></span>  
  
-   <span data-ttu-id="19588-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Představuje element vazby, který určuje kódování znaků a verzování zprávy použité pro binární soubor založené zprávy XML.</span><span class="sxs-lookup"><span data-stu-id="19588-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Represents the binding element that specifies the character encoding and message versioning used for binary-based XML messages.</span></span> <span data-ttu-id="19588-133">Toto je nejefektivnější možnosti kódování, ale nejméně interoperabilní, protože je podporován pouze pomocí koncových bodů WCF.</span><span class="sxs-lookup"><span data-stu-id="19588-133">This is most efficient of the encoding options, but the least interoperable, because it is only supported by WCF endpoints.</span></span>  
  
-   <span data-ttu-id="19588-134"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>: Představuje element vazby, který určuje kódování znaků a správu verzí zpráv používá zprávy pomocí kódování zpráv přenosu optimalizace mechanismus (MTOM).</span><span class="sxs-lookup"><span data-stu-id="19588-134"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>: Represents the binding element that specifies the character encoding and message versioning used for a message using a Message Transmission Optimization Mechanism (MTOM) encoding.</span></span> <span data-ttu-id="19588-135">MTOM je efektivní technologie pro přenos zpráv WCF binární data.</span><span class="sxs-lookup"><span data-stu-id="19588-135">MTOM is an efficient technology for transmitting binary data in WCF messages.</span></span> <span data-ttu-id="19588-136">Kodér MTOM se pokusí rovnováhu mezi efektivitu a vzájemná funkční spolupráce.</span><span class="sxs-lookup"><span data-stu-id="19588-136">The MTOM encoder attempts to balance between efficiency and interoperability.</span></span> <span data-ttu-id="19588-137">Kódování MTOM přenáší většina XML v textové formě, ale optimalizuje velkých bloků binárních dat jako ušetřený přenosem-je, bez převodu na text.</span><span class="sxs-lookup"><span data-stu-id="19588-137">The MTOM encoding transmits most XML in textual form, but optimizes large blocks of binary data by transmitting them as-is, without conversion to text.</span></span>  
  
 <span data-ttu-id="19588-138">Element vazby vytvoří binární soubor, MTOM nebo text <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span><span class="sxs-lookup"><span data-stu-id="19588-138">The binding element creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span></span> <span data-ttu-id="19588-139">Vytvoří objekt pro vytváření binární soubor, MTOM nebo text <xref:System.ServiceModel.Channels.MessageEncoderFactory> instance.</span><span class="sxs-lookup"><span data-stu-id="19588-139">The factory creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory> instance.</span></span> <span data-ttu-id="19588-140">Obvykle je zaznamenána pouze jedna instance.</span><span class="sxs-lookup"><span data-stu-id="19588-140">Typically, there is only a single instance.</span></span> <span data-ttu-id="19588-141">Ale pokud jsou použity relace, můžeme poskytovat různé kodér každé relaci.</span><span class="sxs-lookup"><span data-stu-id="19588-141">However if sessions are used, a different encoder may be provided to each session.</span></span> <span data-ttu-id="19588-142">Binárního kodéru využívá to ke koordinaci dynamické slovníky (viz XML, infrastrukturu).</span><span class="sxs-lookup"><span data-stu-id="19588-142">The Binary encoder makes use of this to coordinate dynamic dictionaries (see XML Infrastructure).</span></span>  
  
 <span data-ttu-id="19588-143"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> a <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> metody jsou základní u kodérů.</span><span class="sxs-lookup"><span data-stu-id="19588-143">The <xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> and <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> methods are the core of the encoders.</span></span> <span data-ttu-id="19588-144">Poskytují metody pro čtení z datového proudu nebo zpráva <xref:System.Byte> pole.</span><span class="sxs-lookup"><span data-stu-id="19588-144">The methods provide for reading a message from a stream or from a <xref:System.Byte> array.</span></span> <span data-ttu-id="19588-145">Bajtová pole se používají při přenosu pracuje v režimu vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="19588-145">Byte arrays are used when the transport is operating in buffered mode.</span></span> <span data-ttu-id="19588-146">Vždy se zprávy zapisují do datových proudů.</span><span class="sxs-lookup"><span data-stu-id="19588-146">Messages are always written to streams.</span></span> <span data-ttu-id="19588-147">Pokud přenos musí uložit do vyrovnávací paměti se zpráva, poskytuje datový proud, který nemá vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="19588-147">If the transport must buffer the message, it provides a stream that does the buffering.</span></span>  
  
 <span data-ttu-id="19588-148">Zbývající členy fungují s typy médií obsahu, podpora, a <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span><span class="sxs-lookup"><span data-stu-id="19588-148">The rest of the members work with support content, media types, and <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span></span> <span data-ttu-id="19588-149">Přenos volá tyto metody kodér k ověření, zda příchozí zpráva může dekódovat jím nebo k určení, zda je platný pro tento kodér odchozí zprávy.</span><span class="sxs-lookup"><span data-stu-id="19588-149">The transport calls these encoder methods to test whether the incoming message can be decoded by it, or to determine if the outgoing message is valid for this encoder.</span></span>  
  
 <span data-ttu-id="19588-150">Všechny tři implementace kodér přidá vlastnosti, které jsou relevantní pro konkrétní kódování a je plně konfigurovatelné.</span><span class="sxs-lookup"><span data-stu-id="19588-150">Each of the three encoder implementations adds properties that are relevant to the specific encodings and is fully configurable.</span></span> <span data-ttu-id="19588-151">U kodérů také zveřejnit čtečky kvóty, které mají výchozí hodnoty zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="19588-151">The encoders also expose reader quotas that have secure defaults.</span></span> <span data-ttu-id="19588-152">Diskuzi o kvóty najdete v článku XML, infrastrukturu.</span><span class="sxs-lookup"><span data-stu-id="19588-152">See XML Infrastructure for a discussion of the quotas.</span></span>  
  
## <a name="features-of-system-provided-encoders"></a><span data-ttu-id="19588-153">Funkce poskytované systémem kodérů</span><span class="sxs-lookup"><span data-stu-id="19588-153">Features of System-Provided Encoders</span></span>  
 <span data-ttu-id="19588-154">Existuje mnoho z funkcí poskytovaných službou kodérů poskytované systémem.</span><span class="sxs-lookup"><span data-stu-id="19588-154">There are a number of features provided by the system-provided encoders.</span></span>  
  
### <a name="pooling"></a><span data-ttu-id="19588-155">Sdružování</span><span class="sxs-lookup"><span data-stu-id="19588-155">Pooling</span></span>  
 <span data-ttu-id="19588-156">Každá implementace kodér pokusí fondu co největší míře.</span><span class="sxs-lookup"><span data-stu-id="19588-156">Each of the encoder implementations tries to pool as much as possible.</span></span> <span data-ttu-id="19588-157">Omezení přidělení je klíče způsob, jak zlepšit výkon spravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="19588-157">Reducing allocations is a key way to improve the performance of managed code.</span></span> <span data-ttu-id="19588-158">K provedení této sdružování, implementace použít `SynchronizedPool` třídy.</span><span class="sxs-lookup"><span data-stu-id="19588-158">To accomplish this pooling, the implementations use the `SynchronizedPool` class.</span></span> <span data-ttu-id="19588-159">C# Soubor obsahuje popis Další optimalizace použitou touto třídou.</span><span class="sxs-lookup"><span data-stu-id="19588-159">The C# file contains a description of the additional optimizations used by this class.</span></span>  
  
 <span data-ttu-id="19588-160"><xref:System.Xml.XmlDictionaryReader> a <xref:System.Xml.XmlDictionaryWriter> instance jsou ve fondu a znovu inicializovat, aby se zabránilo přidělení nové značky pro každou zprávu.</span><span class="sxs-lookup"><span data-stu-id="19588-160"><xref:System.Xml.XmlDictionaryReader> and <xref:System.Xml.XmlDictionaryWriter> instances are pooled and reinitialized to prevent allocating new ones for each message.</span></span> <span data-ttu-id="19588-161">Pro čtenáře `OnClose` čtečky uvolňuje zpětného volání při `Close()` je volána.</span><span class="sxs-lookup"><span data-stu-id="19588-161">For the readers, an `OnClose` callback reclaims the reader when `Close()` is called.</span></span> <span data-ttu-id="19588-162">Kodér recykluje také některé objekty stavu zprávy používá při vytváření zpráv.</span><span class="sxs-lookup"><span data-stu-id="19588-162">The encoder also recycles some message state objects used when constructing messages.</span></span> <span data-ttu-id="19588-163">Velikosti tyto fondy se dají konfigurovat pomocí `MaxReadPoolSize` a `MaxWritePoolSize` vlastnosti na každé tři třídy odvozené z <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="19588-163">The sizes of these pools are configurable by the `MaxReadPoolSize` and `MaxWritePoolSize` properties on each of the three classes derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
### <a name="binary-encoding"></a><span data-ttu-id="19588-164">Binární kódování</span><span class="sxs-lookup"><span data-stu-id="19588-164">Binary Encoding</span></span>  
 <span data-ttu-id="19588-165">Když binární kódování používá relace, řetězec dynamický slovník musí sdělí příjemce zprávy.</span><span class="sxs-lookup"><span data-stu-id="19588-165">When binary encoding uses sessions, the dynamic dictionary string must be communicated to the receiver of the message.</span></span> <span data-ttu-id="19588-166">To se provádí přidáním prefixu zprávu s řetězci dynamický slovník.</span><span class="sxs-lookup"><span data-stu-id="19588-166">This is done by prefixing the message with the dynamic dictionary strings.</span></span> <span data-ttu-id="19588-167">Příjemce odstraní vypnout řetězce, se přidají do relace a zprávu zpracuje.</span><span class="sxs-lookup"><span data-stu-id="19588-167">The receiver strips off the strings, adds them to the session, and processes the message.</span></span> <span data-ttu-id="19588-168">Správně předávání řetězce slovníku vyžaduje, že přenos do vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="19588-168">Correctly passing dictionary strings requires that the transport be buffered.</span></span>  
  
 <span data-ttu-id="19588-169">Řetězce jsou připojeny k zpráva o interní `AddSessionInformationToMessage` metody.</span><span class="sxs-lookup"><span data-stu-id="19588-169">The strings are appended to the message by an internal `AddSessionInformationToMessage` method.</span></span> <span data-ttu-id="19588-170">Řetězce jako UTF-8 přidá do popředí předponu jejich délku zprávy.</span><span class="sxs-lookup"><span data-stu-id="19588-170">It adds the strings as UTF-8 to the front of the message prefixed with their length.</span></span> <span data-ttu-id="19588-171">Hlavička slovníku celý je pak předponu délky jeho data.</span><span class="sxs-lookup"><span data-stu-id="19588-171">The entire dictionary header is then prefixed with the length of its data.</span></span> <span data-ttu-id="19588-172">Zpětný provoz se provádí pomocí vnitřního `ExtractSessionInformationFromMessage` metody.</span><span class="sxs-lookup"><span data-stu-id="19588-172">The reverse operation is performed by an internal `ExtractSessionInformationFromMessage` method.</span></span>  
  
 <span data-ttu-id="19588-173">Kromě zpracování dynamický slovník klíčů, jsou ve vyrovnávací paměti s relacemi zprávy přijímány jednoznačným způsobem.</span><span class="sxs-lookup"><span data-stu-id="19588-173">In addition to processing dynamic dictionary keys, buffered sessionful messages are received in a unique way.</span></span> <span data-ttu-id="19588-174">Místo vytváření čtečky přes dokument a její zpracování, používá vnitřní binárního kodéru `MessagePatterns` třídy dekonstruovat binárního datového proudu.</span><span class="sxs-lookup"><span data-stu-id="19588-174">Instead of creating a reader over the document and processing it, the binary encoder uses the internal `MessagePatterns` class to deconstruct the binary stream.</span></span> <span data-ttu-id="19588-175">Cílem je, že většina zprávy mají určitou sadu záhlaví, které se zobrazí v určitém pořadí při generování službou WCF.</span><span class="sxs-lookup"><span data-stu-id="19588-175">The idea is that most messages have a certain set of headers that show up in a certain order when generated by WCF.</span></span> <span data-ttu-id="19588-176">Zpráva této doby změny nepublikujete založené na co se očekává, že se rozdělí vzor systému.</span><span class="sxs-lookup"><span data-stu-id="19588-176">The pattern system breaks the message apart based on what it expects.</span></span> <span data-ttu-id="19588-177">Pokud je úspěšná, inicializuje <xref:System.ServiceModel.Channels.MessageHeaders> objekt bez při parsování kódu XML.</span><span class="sxs-lookup"><span data-stu-id="19588-177">If it is successful, it initializes a <xref:System.ServiceModel.Channels.MessageHeaders> object without parsing the XML.</span></span> <span data-ttu-id="19588-178">Pokud ne, vrátí se zpět na standardní metodu.</span><span class="sxs-lookup"><span data-stu-id="19588-178">If not, it falls back to the standard method.</span></span>  
  
### <a name="mtom-encoding"></a><span data-ttu-id="19588-179">Kódování MTOM</span><span class="sxs-lookup"><span data-stu-id="19588-179">MTOM Encoding</span></span>  
 <span data-ttu-id="19588-180"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> Třída nemá další konfigurační vlastnost s názvem <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement.MaxBufferSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="19588-180">The <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> class has an additional configuration property called <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement.MaxBufferSize%2A>.</span></span> <span data-ttu-id="19588-181">To umístí horní mez na tom, kolik dat je povoleno ji uložit do vyrovnávací paměti při čtení zprávy.</span><span class="sxs-lookup"><span data-stu-id="19588-181">This places an upper bound on how much data it is allowed to buffer during the process of reading a message.</span></span> <span data-ttu-id="19588-182">XML informace o sadě (informační sadu) nebo jiné části MIME možná muset být sestavit všechny části MIME do jedné zprávy do vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="19588-182">The XML Information Set (Infoset), or other MIME parts, may need to be buffered to reassemble all the MIME parts into a single message.</span></span>  
  
 <span data-ttu-id="19588-183">Pro fungování s protokolem HTTP, poskytuje vnitřní třídu zpráv kodér MTOM některá interní rozhraní API pro `GetContentType` (což je také vnitřní) a `WriteMessage`, což je veřejná a mohou být přepsána nastaveními.</span><span class="sxs-lookup"><span data-stu-id="19588-183">To work correctly with HTTP, the internal MTOM message encoder class provides some internal APIs for `GetContentType` (which is also internal) and `WriteMessage`, which is public and can be overridden.</span></span> <span data-ttu-id="19588-184">Pokud chcete zajistit, aby hodnoty v hlavičkách protokolu HTTP svůj souhlas s hodnotami v hlavičky MIME se musí vyskytovat další komunikaci.</span><span class="sxs-lookup"><span data-stu-id="19588-184">More communication must occur to ensure values in the HTTP headers agree with values in the MIME headers.</span></span>  
  
 <span data-ttu-id="19588-185">Kodér MTOM zpráv interně používá čtečky textu pro WCF a je podobný kodér textu.</span><span class="sxs-lookup"><span data-stu-id="19588-185">Internally, the MTOM message encoder uses WCF's text readers, and is similar to the Text encoder.</span></span> <span data-ttu-id="19588-186">Hlavní rozdíl je, že optimalizuje velké skupiny binární soubor, nebo "Binární rozsáhlé objekty" objektů (BLOB), není jejich převedením do kódování Base-64 před je vložen do bajtů zpráv.</span><span class="sxs-lookup"><span data-stu-id="19588-186">The main difference is that it optimizes large chunks of binary, or "Binary Large Objects" (BLOBs), by not converting them to Base-64 encoding prior to being embedded into the message bytes.</span></span> <span data-ttu-id="19588-187">Místo toho tyto objekty BLOB jsou udržovány extrahované a odkazované jako přílohy MIME.</span><span class="sxs-lookup"><span data-stu-id="19588-187">Instead, these BLOBs are kept extracted, and referenced as the MIME attachments.</span></span>  
  
## <a name="writing-your-own-encoder"></a><span data-ttu-id="19588-188">Zápis vlastní kodér</span><span class="sxs-lookup"><span data-stu-id="19588-188">Writing your own Encoder</span></span>  
 <span data-ttu-id="19588-189">Pokud chcete implementovat vlastní vlastní kodér zpráv, je nutné zadat vlastní implementace následujících základních tříd abstraktu:</span><span class="sxs-lookup"><span data-stu-id="19588-189">To implement your own custom message encoder, you must provide custom implementations of the following abstract base classes:</span></span>  
  
-   <xref:System.ServiceModel.Channels.MessageEncoder>  
  
-   <xref:System.ServiceModel.Channels.MessageEncoderFactory>  
  
-   <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>  
  
 <span data-ttu-id="19588-190">Převod z reprezentace v paměti zprávy na reprezentaci, jež lze zapsat do datového proudu je zapouzdřen v rámci <xref:System.ServiceModel.Channels.MessageEncoder> třídu, která slouží jako objekt pro vytváření pro XML čtečky a zapisovače XML, které podporují konkrétní typy kódování XML.</span><span class="sxs-lookup"><span data-stu-id="19588-190">Converting from the in-memory representation of a message to a representation that can be written to a stream is encapsulated within the <xref:System.ServiceModel.Channels.MessageEncoder> class, which serves as a factory for XML readers and XML writers that support specific types of XML encodings.</span></span>  
  
-   <span data-ttu-id="19588-191">Jsou klíčové metody této třídy, které je nutné přepsat:</span><span class="sxs-lookup"><span data-stu-id="19588-191">The key methods of this class that you must override are:</span></span>  
  
-   <span data-ttu-id="19588-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> které přebírá <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> objektu a zapíše jej do <xref:System.IO.Stream> objektu.</span><span class="sxs-lookup"><span data-stu-id="19588-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> which takes a <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> object and writes it into a <xref:System.IO.Stream> object.</span></span>  
  
-   <span data-ttu-id="19588-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> které přebírá <xref:System.IO.Stream> a záhlaví maximální velikost a vrací <xref:System.ServiceModel.Channels.Message> objektu.</span><span class="sxs-lookup"><span data-stu-id="19588-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> which takes a <xref:System.IO.Stream> object and a maximum header size and returns a <xref:System.ServiceModel.Channels.Message> object.</span></span>  
  
 <span data-ttu-id="19588-194">Je kód, který píšete v těchto metodách, který zpracovává převod mezi standardní přenosový protokol a vlastní kódování.</span><span class="sxs-lookup"><span data-stu-id="19588-194">It is the code you write in these methods that handles conversion between the standard transport protocol, and your customized encoding.</span></span>  
  
 <span data-ttu-id="19588-195">Dál musíte kód třídu objektů factory, který vytváří vlastní kodér.</span><span class="sxs-lookup"><span data-stu-id="19588-195">Next you need to code a factory class that creates your custom encoder.</span></span> <span data-ttu-id="19588-196">Přepsat <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> vrátit instanci vaší vlastní <xref:System.ServiceModel.Channels.MessageEncoder>.</span><span class="sxs-lookup"><span data-stu-id="19588-196">Override the <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> to return an instance of your custom <xref:System.ServiceModel.Channels.MessageEncoder>.</span></span>  
  
 <span data-ttu-id="19588-197">Připojte své vlastní <xref:System.ServiceModel.Channels.MessageEncoderFactory> na zásobník element vazby, který se používá ke konfiguraci služby ani klienta tak, že přepíšete <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> metoda vrátí instanci tento objekt pro vytváření.</span><span class="sxs-lookup"><span data-stu-id="19588-197">Then connect your custom <xref:System.ServiceModel.Channels.MessageEncoderFactory> to the binding element stack used to configure the service or client by overriding the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> method to return an instance of this factory.</span></span>  
  
 <span data-ttu-id="19588-198">Existují dvě ukázky součástí WCF, které ilustrují tento proces se vzorovým kódem: [Vlastní kodér zpráv: Vlastní kodér textu](../../../../docs/framework/wcf/samples/custom-message-encoder-custom-text-encoder.md) a [vlastní kodér zpráv: Kompresní kodér](../../../../docs/framework/wcf/samples/custom-message-encoder-compression-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="19588-198">There are two samples provided with WCF that illustrate this process with sample code: [Custom Message Encoder: Custom Text Encoder](../../../../docs/framework/wcf/samples/custom-message-encoder-custom-text-encoder.md) and [Custom Message Encoder: Compression Encoder](../../../../docs/framework/wcf/samples/custom-message-encoder-compression-encoder.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="19588-199">Viz také:</span><span class="sxs-lookup"><span data-stu-id="19588-199">See also</span></span>
- <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>
- <xref:System.ServiceModel.Channels.MessageEncoderFactory>
- <xref:System.ServiceModel.Channels.MessageEncoder>
- [<span data-ttu-id="19588-200">Strukturální přehled přenosu dat</span><span class="sxs-lookup"><span data-stu-id="19588-200">Data Transfer Architectural Overview</span></span>](../../../../docs/framework/wcf/feature-details/data-transfer-architectural-overview.md)
- [<span data-ttu-id="19588-201">Výběr kodéru zprávy</span><span class="sxs-lookup"><span data-stu-id="19588-201">Choosing a Message Encoder</span></span>](../../../../docs/framework/wcf/feature-details/choosing-a-message-encoder.md)
- [<span data-ttu-id="19588-202">Volba přenosu</span><span class="sxs-lookup"><span data-stu-id="19588-202">Choosing a Transport</span></span>](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md)
