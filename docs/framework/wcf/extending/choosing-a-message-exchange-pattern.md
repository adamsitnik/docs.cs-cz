---
title: Výběr vzorce výměny zpráv
ms.date: 03/30/2017
ms.assetid: 0f502ca1-6a8e-4607-ba15-59198c0e6146
ms.openlocfilehash: 2d39164944207d73fdfe418a30326fb40462db72
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/28/2019
ms.locfileid: "64664912"
---
# <a name="choosing-a-message-exchange-pattern"></a><span data-ttu-id="dd709-102">Výběr vzorce výměny zpráv</span><span class="sxs-lookup"><span data-stu-id="dd709-102">Choosing a Message Exchange Pattern</span></span>
<span data-ttu-id="dd709-103">Prvním krokem při psaní vlastních přenosu je rozhodnout, které *zpráv exchange vzory* (nebo MEPs) jsou požadovány pro kanál, kterou vyvíjíte.</span><span class="sxs-lookup"><span data-stu-id="dd709-103">The first step in writing a custom transport is to decide which *message exchange patterns* (or MEPs) are required for the channel you are developing.</span></span> <span data-ttu-id="dd709-104">Toto téma popisuje dostupné možnosti a tento článek popisuje různé požadavky.</span><span class="sxs-lookup"><span data-stu-id="dd709-104">This topic describes the options available and discusses the various requirements.</span></span> <span data-ttu-id="dd709-105">Toto je první úkol v seznamu úkolů vývoj kanálu je popsáno v [vývoj kanálů](../../../../docs/framework/wcf/extending/developing-channels.md).</span><span class="sxs-lookup"><span data-stu-id="dd709-105">This is the first task in the channel development task list described in [Developing Channels](../../../../docs/framework/wcf/extending/developing-channels.md).</span></span>  
  
## <a name="six-message-exchange-patterns"></a><span data-ttu-id="dd709-106">Šest vzory zpráv Exchange</span><span class="sxs-lookup"><span data-stu-id="dd709-106">Six Message Exchange Patterns</span></span>  
 <span data-ttu-id="dd709-107">Existují tři MEPs lze vybírat:</span><span class="sxs-lookup"><span data-stu-id="dd709-107">There are three MEPs to choose from:</span></span>  
  
- <span data-ttu-id="dd709-108">Datagram (<xref:System.ServiceModel.Channels.IInputChannel> a <xref:System.ServiceModel.Channels.IOutputChannel>)</span><span class="sxs-lookup"><span data-stu-id="dd709-108">Datagram (<xref:System.ServiceModel.Channels.IInputChannel> and <xref:System.ServiceModel.Channels.IOutputChannel>)</span></span>  
  
     <span data-ttu-id="dd709-109">Při použití datagram MEP, klient odešle zprávu pomocí *vypal a zapomeň* exchange.</span><span class="sxs-lookup"><span data-stu-id="dd709-109">When using a datagram MEP, a client sends a message using a *fire and forget* exchange.</span></span> <span data-ttu-id="dd709-110">A vypal a zapomeň exchange je ten, který vyžaduje out-of-band potvrzení úspěšné dodání.</span><span class="sxs-lookup"><span data-stu-id="dd709-110">A fire and forget exchange is one that requires out-of-band confirmation of successful delivery.</span></span> <span data-ttu-id="dd709-111">Zpráva může dojít ke ztrátě během přenosu a nikdy nedorazí služby.</span><span class="sxs-lookup"><span data-stu-id="dd709-111">The message might be lost in transit and never reach the service.</span></span> <span data-ttu-id="dd709-112">Pokud se operace odeslání se úspěšně dokončí na straně klienta, není zaručeno, že vzdálený koncový bod přijal zprávu.</span><span class="sxs-lookup"><span data-stu-id="dd709-112">If the send operation completes successfully at the client end, it does not guarantee that the remote endpoint has received the message.</span></span> <span data-ttu-id="dd709-113">Datagram je základním stavebním blokem pro zasílání zpráv, jak můžete vytvářet vlastní protokoly, dojde k jeho zvýraznění – včetně protokolů spolehlivé a zabezpečené protokoly.</span><span class="sxs-lookup"><span data-stu-id="dd709-113">The datagram is a fundamental building block for messaging, as you can build your own protocols on top of it—including reliable protocols and secure protocols.</span></span> <span data-ttu-id="dd709-114">Implementace klienta datagram kanály <xref:System.ServiceModel.Channels.IOutputChannel> implementovat rozhraní a služba datagramu kanály <xref:System.ServiceModel.Channels.IInputChannel> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="dd709-114">Client datagram channels implement the <xref:System.ServiceModel.Channels.IOutputChannel> interface and service datagram channels implement the <xref:System.ServiceModel.Channels.IInputChannel> interface.</span></span>  
  
- <span data-ttu-id="dd709-115">Request-Response (<xref:System.ServiceModel.Channels.IRequestChannel> a <xref:System.ServiceModel.Channels.IReplyChannel>)</span><span class="sxs-lookup"><span data-stu-id="dd709-115">Request-Response (<xref:System.ServiceModel.Channels.IRequestChannel> and <xref:System.ServiceModel.Channels.IReplyChannel>)</span></span>  
  
     <span data-ttu-id="dd709-116">V tomto MEP je odeslána zpráva a přijetí odpovědi.</span><span class="sxs-lookup"><span data-stu-id="dd709-116">In this MEP, a message is sent, and a reply is received.</span></span> <span data-ttu-id="dd709-117">Vzor se skládá z dvojice žádost odpověď.</span><span class="sxs-lookup"><span data-stu-id="dd709-117">The pattern consists of request-response pairs.</span></span> <span data-ttu-id="dd709-118">Odpověď na požadavek volání příklady vzdálených volání procedur (RPC) a prohlížeč GET požadavky.</span><span class="sxs-lookup"><span data-stu-id="dd709-118">Examples of request-response calls are remote procedure calls (RPC) and browser GET requests.</span></span> <span data-ttu-id="dd709-119">Tento model se také označuje jako poloduplexní.</span><span class="sxs-lookup"><span data-stu-id="dd709-119">This pattern is also known as half-duplex.</span></span> <span data-ttu-id="dd709-120">V tomto MEP kanály klientů implementovat <xref:System.ServiceModel.Channels.IRequestChannel> a implementují kanály service <xref:System.ServiceModel.Channels.IReplyChannel>.</span><span class="sxs-lookup"><span data-stu-id="dd709-120">In this MEP, client channels implement <xref:System.ServiceModel.Channels.IRequestChannel> and service channels implement <xref:System.ServiceModel.Channels.IReplyChannel>.</span></span>  
  
- <span data-ttu-id="dd709-121">Duplexní (<xref:System.ServiceModel.Channels.IDuplexChannel>)</span><span class="sxs-lookup"><span data-stu-id="dd709-121">Duplex (<xref:System.ServiceModel.Channels.IDuplexChannel>)</span></span>  
  
     <span data-ttu-id="dd709-122">Duplexní MEP umožňuje libovolný počet zpráv pro klientem odesílat a přijímat v libovolném pořadí.</span><span class="sxs-lookup"><span data-stu-id="dd709-122">The duplex MEP allows an arbitrary number of messages to be sent by a client and received in any order.</span></span> <span data-ttu-id="dd709-123">Duplexní MEP je jako je telefonní hovor, kde je zpráva každého slova, se kterým se mluví.</span><span class="sxs-lookup"><span data-stu-id="dd709-123">The duplex MEP is like a phone conversation, where each word being spoken is a message.</span></span> <span data-ttu-id="dd709-124">Vzhledem k tomu, že obě strany můžete odesílat a přijímat v tomto MEP, rozhraní implementované pomocí kanálů klient a služba je <xref:System.ServiceModel.Channels.IDuplexChannel>.</span><span class="sxs-lookup"><span data-stu-id="dd709-124">Because both sides can send and receive in this MEP, the interface implemented by the client and service channels is <xref:System.ServiceModel.Channels.IDuplexChannel>.</span></span>  
  
 <span data-ttu-id="dd709-125">![Výběr vzoru výměny zpráv](../../../../docs/framework/wcf/extending/media/wcfc-basicthreemepsc.gif "wcfc_BasicThreeMEPsc")</span><span class="sxs-lookup"><span data-stu-id="dd709-125">![Choosing a message exchange pattern](../../../../docs/framework/wcf/extending/media/wcfc-basicthreemepsc.gif "wcfc_BasicThreeMEPsc")</span></span>  
<span data-ttu-id="dd709-126">Tři vzory základní zprávy exchange.</span><span class="sxs-lookup"><span data-stu-id="dd709-126">The three basic message exchange patterns.</span></span> <span data-ttu-id="dd709-127">Shora dolů: datagram, typu žádost odpověď a přenos.</span><span class="sxs-lookup"><span data-stu-id="dd709-127">Top to bottom: datagram, request-response, and duplex.</span></span>  
  
 <span data-ttu-id="dd709-128">Každá z těchto MEPs může také podporovat *relace*.</span><span class="sxs-lookup"><span data-stu-id="dd709-128">Each of these MEPs can also support *sessions*.</span></span> <span data-ttu-id="dd709-129">Relace (a provádění <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> typu <xref:System.ServiceModel.Channels.ISession?displayProperty=nameWithType>) koreluje všechny zprávy odeslané a přijaté v kanálu.</span><span class="sxs-lookup"><span data-stu-id="dd709-129">A session (and implementation of <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> of type <xref:System.ServiceModel.Channels.ISession?displayProperty=nameWithType>) correlates all messages sent and received on a channel.</span></span> <span data-ttu-id="dd709-130">Model typu žádost odpověď je samostatné relace dvě zprávy, jako jsou korelována žádost a odpověď.</span><span class="sxs-lookup"><span data-stu-id="dd709-130">The request-response pattern is a stand-alone two-message session, as the request and reply are correlated.</span></span> <span data-ttu-id="dd709-131">Vzor typu žádost odpověď, která podporuje relací naproti tomu znamená, že všechny páry žádostí a odpovědí v tomto kanálu jsou korelována mezi sebou.</span><span class="sxs-lookup"><span data-stu-id="dd709-131">In contrast, the request-response pattern that supports sessions implies that all request/response pairs on that channel are correlated with each other.</span></span> <span data-ttu-id="dd709-132">To vám dává celkem šest MEPs lze vybírat:</span><span class="sxs-lookup"><span data-stu-id="dd709-132">This gives you a total of six MEPs to choose from:</span></span>  
  
- <span data-ttu-id="dd709-133">Datagram</span><span class="sxs-lookup"><span data-stu-id="dd709-133">Datagram</span></span>  
  
- <span data-ttu-id="dd709-134">Žádost odpověď</span><span class="sxs-lookup"><span data-stu-id="dd709-134">Request-response</span></span>  
  
- <span data-ttu-id="dd709-135">Duplex</span><span class="sxs-lookup"><span data-stu-id="dd709-135">Duplex</span></span>  
  
- <span data-ttu-id="dd709-136">Datagram s relacemi</span><span class="sxs-lookup"><span data-stu-id="dd709-136">Datagram with sessions</span></span>  
  
- <span data-ttu-id="dd709-137">U relací typu žádost odpověď</span><span class="sxs-lookup"><span data-stu-id="dd709-137">Request-response with sessions</span></span>  
  
- <span data-ttu-id="dd709-138">Duplexní režim s relacemi</span><span class="sxs-lookup"><span data-stu-id="dd709-138">Duplex with sessions</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="dd709-139">Pro přenos UDP pouze MEP, který je podporovaný totiž datagram, UDP je ze své podstaty spustit a zapomenout protokolu.</span><span class="sxs-lookup"><span data-stu-id="dd709-139">For the UDP transport, the only MEP that is supported is datagram, because UDP is inherently a fire and forget protocol.</span></span>  
  
## <a name="sessions-and-sessionful-channels"></a><span data-ttu-id="dd709-140">Relace a který neobsahuje relace kanály</span><span class="sxs-lookup"><span data-stu-id="dd709-140">Sessions and Sessionful Channels</span></span>  
 <span data-ttu-id="dd709-141">Na světě sítě existují připojení objektově orientovaný protokoly (například TCP) a protokoly bez připojení (například UDP).</span><span class="sxs-lookup"><span data-stu-id="dd709-141">In the networking world, there are connection-oriented protocols (for example, TCP) and connection-less protocols (for example, UDP).</span></span> <span data-ttu-id="dd709-142">WCF používá termín relace jejich logické abstrakce jako připojení.</span><span class="sxs-lookup"><span data-stu-id="dd709-142">WCF uses the term session to mean a connection-like logical abstraction.</span></span> <span data-ttu-id="dd709-143">Protokoly s relacemi WCF jsou podobné připojovací síťové protokoly a protokoly nerelační WCF jsou podobné připojení bez síťových protokolů.</span><span class="sxs-lookup"><span data-stu-id="dd709-143">Sessionful WCF protocols are similar to connection-oriented network protocols and sessionless WCF protocols are similar to connection-less network protocols.</span></span>  
  
 <span data-ttu-id="dd709-144">V objektovém modelu kanál každou logickou relaci manifesty jako instance kanál s relacemi.</span><span class="sxs-lookup"><span data-stu-id="dd709-144">In the channel object model, each logical session manifests as an instance of a sessionful channel.</span></span> <span data-ttu-id="dd709-145">Proto všechny nové relace vytvořil klienta a přijmout na službě, odpovídá nový kanál s relacemi na každé straně.</span><span class="sxs-lookup"><span data-stu-id="dd709-145">Therefore every new session created by the client, and accepted on the service, corresponds to a new sessionful channel on each side.</span></span> <span data-ttu-id="dd709-146">Následující diagram znázorňuje, v horní části, struktura nerelační kanály a v dolní části, struktura duplexních kanálů s relacemi.</span><span class="sxs-lookup"><span data-stu-id="dd709-146">The following diagram shows, on the top, the structure of sessionless channels, and on the bottom, the structure of sessionful channels.</span></span>  
  
 <span data-ttu-id="dd709-147">![Výběr vzoru výměny zpráv](../../../../docs/framework/wcf/extending/media/wcfc-sessionandsessionlesschannelsc.gif "wcfc_SessionAndSessionlessChannelsc")</span><span class="sxs-lookup"><span data-stu-id="dd709-147">![Choosing a message exchange pattern](../../../../docs/framework/wcf/extending/media/wcfc-sessionandsessionlesschannelsc.gif "wcfc_SessionAndSessionlessChannelsc")</span></span>  
  
 <span data-ttu-id="dd709-148">Klient vytvoří nový kanál s relacemi a odešle zprávu.</span><span class="sxs-lookup"><span data-stu-id="dd709-148">A client creates a new sessionful channel and sends a message.</span></span> <span data-ttu-id="dd709-149">Modul pro naslouchání kanálu na straně služeb, obdrží tuto zprávu a zjistí, že patří do novou relaci tak, aby se vytvoří nový kanál s relacemi a předá ji do aplikace (jako reakce aplikace při volání AcceptChannel na modul pro naslouchání kanálu).</span><span class="sxs-lookup"><span data-stu-id="dd709-149">On the service side, the channel listener receives this message and detects that it belongs to a new session so it creates a new sessionful channel and hands it to the application (in response to the application calling AcceptChannel on the channel listener).</span></span> <span data-ttu-id="dd709-150">Aplikace pak obdrží tuto zprávu a všechny následné zprávy odeslané v rámci jedné relace prostřednictvím stejné kanál s relacemi.</span><span class="sxs-lookup"><span data-stu-id="dd709-150">The application then receives this message and all subsequent messages sent in the same session through the same sessionful channel.</span></span>  
  
 <span data-ttu-id="dd709-151">Jiného klienta (nebo stejného klienta) vytvoří nové který neobsahuje relace a odešle zprávu.</span><span class="sxs-lookup"><span data-stu-id="dd709-151">Another client (or the same client) creates a new sessionful and sends a message.</span></span> <span data-ttu-id="dd709-152">Modul pro naslouchání kanálu zjistí tato zpráva je v nové relaci a vytvoří nový kanál s relacemi, a postup se opakuje.</span><span class="sxs-lookup"><span data-stu-id="dd709-152">The channel listener detects this message is in a new session and creates a new sessionful channel and the process repeats.</span></span>  
  
 <span data-ttu-id="dd709-153">Bez relace neexistuje žádná korelace mezi kanály a relací.</span><span class="sxs-lookup"><span data-stu-id="dd709-153">Without sessions, there is no correlation between channels and sessions.</span></span> <span data-ttu-id="dd709-154">Modul pro naslouchání kanálu proto vytvoří jenom jeden kanál, přes který všechny přijaté zprávy doručovaly do aplikace.</span><span class="sxs-lookup"><span data-stu-id="dd709-154">Therefore a channel listener creates only one channel through which all received messages are delivered to the application.</span></span> <span data-ttu-id="dd709-155">Neexistuje žádná zpráva řazení, protože neexistuje žádná relace, ve kterém se mají zachovat pořadí zpráv.</span><span class="sxs-lookup"><span data-stu-id="dd709-155">There is also no message ordering because there is no session within which to maintain message order.</span></span> <span data-ttu-id="dd709-156">Horní části na předchozím obrázku je znázorněný nerelační zprávy exchange.</span><span class="sxs-lookup"><span data-stu-id="dd709-156">The top portion of the preceding graphic illustrates a sessionless message exchange.</span></span>  
  
## <a name="starting-and-terminating-sessions"></a><span data-ttu-id="dd709-157">Spuštění a ukončení relací</span><span class="sxs-lookup"><span data-stu-id="dd709-157">Starting and Terminating Sessions</span></span>  
 <span data-ttu-id="dd709-158">Relace se spustí v klientském počítači tak, že jednoduše vytvoříte nový kanál s relacemi.</span><span class="sxs-lookup"><span data-stu-id="dd709-158">Sessions are started on the client by simply creating a new sessionful channel.</span></span> <span data-ttu-id="dd709-159">Když služba přijímá zprávy, která byla odeslána v nové relaci jsou spuštěny na službu.</span><span class="sxs-lookup"><span data-stu-id="dd709-159">They are started on the service when the service receives a message that was sent in a new session.</span></span> <span data-ttu-id="dd709-160">Stejně tak relace jsou ukončeny zavření nebo ukončení kanál s relacemi.</span><span class="sxs-lookup"><span data-stu-id="dd709-160">Likewise, sessions are terminated by closing or aborting a sessionful channel.</span></span>  
  
 <span data-ttu-id="dd709-161">Výjimkou je <xref:System.ServiceModel.Channels.IDuplexSessionChannel> používaný pro odesílání a přijímání zpráv ve vzoru s relacemi duplexní komunikaci.</span><span class="sxs-lookup"><span data-stu-id="dd709-161">The exception to this is <xref:System.ServiceModel.Channels.IDuplexSessionChannel> which is used for both sending and receiving messages in a duplex, sessionful communication pattern.</span></span> <span data-ttu-id="dd709-162">Je možné, že jedna strana budou chtít zastavit odesílání zpráv, ale i nadále přijímat zprávy proto při použití <xref:System.ServiceModel.Channels.IDuplexSessionChannel> je mechanismus, který vám umožní zavřít výstupní relace označující odeslat další zprávy, nebudou ale ponechali relaci vstupu otevřít, abyste mohli nadále přijímat zprávy.</span><span class="sxs-lookup"><span data-stu-id="dd709-162">It is possible that one side will want to stop sending messages but continue to receive messages therefore when using <xref:System.ServiceModel.Channels.IDuplexSessionChannel> there is a mechanism that lets you close the output session indicating you will not send any more messages but keep the input session opened allowing you to continue to receive messages.</span></span>  
  
 <span data-ttu-id="dd709-163">Relace jsou obecně platí, Uzavřeno na straně odchozí a ne na straně příchozí.</span><span class="sxs-lookup"><span data-stu-id="dd709-163">In general, sessions are closed on the outgoing side and not on the incoming side.</span></span> <span data-ttu-id="dd709-164">To znamená kanálů s relacemi výstup můžete zavřít, a tím čistě ukončení relace.</span><span class="sxs-lookup"><span data-stu-id="dd709-164">That is, sessionful output channels can be closed, thereby cleanly terminating the session.</span></span> <span data-ttu-id="dd709-165">Zavření kanál s relacemi výstup způsobí, že odpovídající vstupní kanál s relacemi k vrácení hodnoty null pro volání aplikace <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> na <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span><span class="sxs-lookup"><span data-stu-id="dd709-165">Closing a sessionful output channel causes the corresponding sessionful input channel to return null to the application calling <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span></span>  
  
 <span data-ttu-id="dd709-166">Ale by neměly duplexních kanálů vstupní uzavřen, není-li <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> na <xref:System.ServiceModel.Channels.IDuplexSessionChannel> vrátí hodnotu null, která znamená, že relace je už zavřený.</span><span class="sxs-lookup"><span data-stu-id="dd709-166">However sessionful input channels should not be closed unless <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel> returns null, indicating that the session is already closed.</span></span> <span data-ttu-id="dd709-167">Pokud <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> na <xref:System.ServiceModel.Channels.IDuplexSessionChannel> se ne vrátila hodnotu null, zavírání vstupní kanál s relacemi může vyvolat výjimku protože obdržet neočekávané zprávy při zavírání.</span><span class="sxs-lookup"><span data-stu-id="dd709-167">If <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel> has not returned null, closing a sessionful input channel may throw an exception because it may receive unexpected messages while closing.</span></span> <span data-ttu-id="dd709-168">Je-li ukončit relaci před odesílatele a příjemce si přeje, měla by volat <xref:System.ServiceModel.ICommunicationObject.Abort%2A> na vstupní kanál, který náhle ukončí relace.</span><span class="sxs-lookup"><span data-stu-id="dd709-168">If a receiver wishes to terminate a session before the sender does, it should call <xref:System.ServiceModel.ICommunicationObject.Abort%2A> on the input channel, which abruptly terminates the session.</span></span>  
  
## <a name="writing-sessionful-channels"></a><span data-ttu-id="dd709-169">Zápis který neobsahuje relace kanály</span><span class="sxs-lookup"><span data-stu-id="dd709-169">Writing Sessionful Channels</span></span>  
 <span data-ttu-id="dd709-170">Jako autor kanál s relacemi existuje několik věcí, které váš kanál musíte udělat, abyste relací zadejte.</span><span class="sxs-lookup"><span data-stu-id="dd709-170">As a sessionful channel author, there are a few things your channel must do to provide sessions.</span></span> <span data-ttu-id="dd709-171">Na straně odesílání kanálu potřebuje:</span><span class="sxs-lookup"><span data-stu-id="dd709-171">On the send side, your channel needs to:</span></span>  
  
- <span data-ttu-id="dd709-172">Pro každý nový kanál vytvoří se nová relace a přidružte ji k nové relaci id, které jsou jedinečné řetězce.</span><span class="sxs-lookup"><span data-stu-id="dd709-172">For each new channel, create a new session and associate it with a new session id which is a unique string.</span></span> <span data-ttu-id="dd709-173">Nebo získat novou relaci z kanálu relací níže v zásobníku.</span><span class="sxs-lookup"><span data-stu-id="dd709-173">Or obtain a new session from the sessionful channel below you in the stack.</span></span>  
  
- <span data-ttu-id="dd709-174">Pro každou zprávu odeslaných pomocí tohoto kanálu Pokud váš kanál vytvořit relace (na rozdíl od získání ho z vrstvy níže), musíte přidružit k relaci zprávy.</span><span class="sxs-lookup"><span data-stu-id="dd709-174">For each message sent using this channel, if your channel created the session (as opposed to obtaining it from the layer below you), you need to associate the message with the session.</span></span> <span data-ttu-id="dd709-175">Pro kanály protokolů je obvykle to tak, že přidáte záhlaví SOAP.</span><span class="sxs-lookup"><span data-stu-id="dd709-175">For protocol channels, this is typically done by adding a SOAP header.</span></span> <span data-ttu-id="dd709-176">Pro přenosové kanály obvykle stačí vytváření nového připojení přenosu nebo přidání informací o relaci protokolu rámce.</span><span class="sxs-lookup"><span data-stu-id="dd709-176">For transport channels, this is typically done by creating a new transport connection or adding session information to the framing protocol.</span></span>  
  
- <span data-ttu-id="dd709-177">Každá zpráva odeslaná pomocí tohoto kanálu potřebujete poskytovat záruky doručení uvedených výše.</span><span class="sxs-lookup"><span data-stu-id="dd709-177">For each message sent using this channel, you need to provide the delivery guarantees mentioned above.</span></span> <span data-ttu-id="dd709-178">Pokud se spoléháte na kanálu níže, abychom vám poskytli relace, bude tento kanál také poskytovat záruky doručení.</span><span class="sxs-lookup"><span data-stu-id="dd709-178">If you are relying on the channel below you to provide the session, that channel will also provide the delivery guarantees.</span></span> <span data-ttu-id="dd709-179">Pokud zadáváte relaci sami, budete muset implementovat jako součást váš protokol záruk.</span><span class="sxs-lookup"><span data-stu-id="dd709-179">If you’re providing the session yourself, you need to implement those guarantees as part of your protocol.</span></span> <span data-ttu-id="dd709-180">Obecně platí Pokud vytváříte kanál protokolu, který předpokládá WCF na obou stranách můžete vyžadovat přenosu protokolu TCP nebo kanál spolehlivé zasílání zpráv a Spolehněte se na jednu relaci poskytnout.</span><span class="sxs-lookup"><span data-stu-id="dd709-180">In general, if you are writing a protocol channel that assumes WCF on both sides you may require the TCP transport or the Reliable Messaging channel and rely on either one to provide a session.</span></span>  
  
- <span data-ttu-id="dd709-181">Když <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> je volána na kanál, provedení potřebné práce k ukončení relace pomocí zadaného časového limitu nebo výchozí hodnotu.</span><span class="sxs-lookup"><span data-stu-id="dd709-181">When <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> is called on your channel, perform the necessary work to close the session using either the specified timeout or the default one.</span></span> <span data-ttu-id="dd709-182">To může být stejně jednoduché jako volání funkce <xref:System.ServiceModel.ICommunicationObject.Close%2A> na kanálu níže (Pokud jste právě získali relace z něj) nebo odesílání zprávy protokolu SOAP speciální nebo zavření připojení přenosu.</span><span class="sxs-lookup"><span data-stu-id="dd709-182">This can be as simple as calling <xref:System.ServiceModel.ICommunicationObject.Close%2A> on the channel below you (if you just obtained the session from it) or sending a special SOAP message or closing a transport connection.</span></span>  
  
- <span data-ttu-id="dd709-183">Když <xref:System.ServiceModel.ICommunicationObject.Abort%2A> je volána na kanál, ukončení relace náhle bez provádění vstupně-výstupních operací.</span><span class="sxs-lookup"><span data-stu-id="dd709-183">When <xref:System.ServiceModel.ICommunicationObject.Abort%2A> is called on your channel, terminate the session abruptly without performing I/O.</span></span> <span data-ttu-id="dd709-184">To může znamenat nicneděláním nebo může zahrnovat přerušení připojení k síti nebo jiný prostředek.</span><span class="sxs-lookup"><span data-stu-id="dd709-184">This may mean doing nothing or may involve aborting a network connection or some other resource.</span></span>  
  
 <span data-ttu-id="dd709-185">Na straně příjmu kanálu potřebuje:</span><span class="sxs-lookup"><span data-stu-id="dd709-185">On the receive side, your channel needs to:</span></span>  
  
- <span data-ttu-id="dd709-186">Pro příchozí zprávy musí odhalit modul pro naslouchání kanálu, do které patří do relace.</span><span class="sxs-lookup"><span data-stu-id="dd709-186">For each incoming message, the channel listener must detect the session it belongs to.</span></span> <span data-ttu-id="dd709-187">Pokud je toto první zprávu v relaci, modul pro naslouchání kanálu musíte vytvořit nový kanál a vrátit ji z volání <xref:System.ServiceModel.Channels.IChannelListener%601.AcceptChannel%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="dd709-187">If this is the first message in the session, the channel listener must create a new channel and return it from the call to <xref:System.ServiceModel.Channels.IChannelListener%601.AcceptChannel%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="dd709-188">Jinak modul pro naslouchání kanálu musí najít existující kanál, který odpovídá relace a doručit zprávu přes tento kanál.</span><span class="sxs-lookup"><span data-stu-id="dd709-188">Otherwise the channel listener must find the existing channel that corresponds to the session and deliver the message through that channel.</span></span>  
  
- <span data-ttu-id="dd709-189">Pokud váš kanál, je poskytování relace (spolu s záruky doručení požadované) na straně příjmu může být vyžadováno provést některé akce, jako je změna pořadí zpráv nebo odeslání potvrzení.</span><span class="sxs-lookup"><span data-stu-id="dd709-189">If your channel is providing the session (along with the required delivery guarantees) the receive side may be required to perform some actions such as re-order messages or send acknowledgements.</span></span>  
  
- <span data-ttu-id="dd709-190">Když <xref:System.ServiceModel.ICommunicationObject.Close%2A> je volána na kanál, provedení potřebné k ukončení relace zadaný časový limit nebo výchozí hodnotu.</span><span class="sxs-lookup"><span data-stu-id="dd709-190">When <xref:System.ServiceModel.ICommunicationObject.Close%2A> is called on your channel, perform the necessary work to close the session either the specified timeout or the default one.</span></span> <span data-ttu-id="dd709-191">To může vést k výjimkám Pokud kanál obdrží zprávu při čekání na časový limit pro uzavření vyprší.</span><span class="sxs-lookup"><span data-stu-id="dd709-191">This could result in exceptions if the channel receives a message while waiting for the close timeout to expire.</span></span> <span data-ttu-id="dd709-192">Důvodem je skutečnost, že kanál bude ve stavu zavírání obdrží zprávu, takže by výjimku.</span><span class="sxs-lookup"><span data-stu-id="dd709-192">That’s because the channel will be in the Closing state when it receives a message so it would throw.</span></span>  
  
- <span data-ttu-id="dd709-193">Když <xref:System.ServiceModel.ICommunicationObject.Abort%2A> je volána na kanál, ukončení relace náhle bez provádění vstupně-výstupních operací.</span><span class="sxs-lookup"><span data-stu-id="dd709-193">When <xref:System.ServiceModel.ICommunicationObject.Abort%2A> is called on your channel, terminate the session abruptly without performing I/O.</span></span> <span data-ttu-id="dd709-194">To znovu, může to znamenat nicneděláním nebo může zahrnovat přerušení připojení k síti nebo jiný prostředek.</span><span class="sxs-lookup"><span data-stu-id="dd709-194">Again, this may mean doing nothing or may involve aborting a network connection or some other resource.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dd709-195">Viz také:</span><span class="sxs-lookup"><span data-stu-id="dd709-195">See also</span></span>

- [<span data-ttu-id="dd709-196">Přehled modelu kanálu</span><span class="sxs-lookup"><span data-stu-id="dd709-196">Channel Model Overview</span></span>](../../../../docs/framework/wcf/extending/channel-model-overview.md)
