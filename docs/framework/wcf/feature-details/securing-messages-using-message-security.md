---
title: Zabezpečení zpráv
ms.date: 03/30/2017
ms.assetid: a17ebe67-836b-4c52-9a81-2c3d58e225ee
ms.openlocfilehash: cf014c8aa972c45140a523573b9806996062b40f
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/08/2019
ms.locfileid: "59172000"
---
# <a name="securing-messages-using-message-security"></a><span data-ttu-id="9b6b8-102">Zabezpečení zpráv</span><span class="sxs-lookup"><span data-stu-id="9b6b8-102">Securing Messages Using Message Security</span></span>
<span data-ttu-id="9b6b8-103">Tato část popisuje zabezpečení zpráv WCF při použití <xref:System.ServiceModel.NetMsmqBinding>.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-103">This section discusses WCF message security when using <xref:System.ServiceModel.NetMsmqBinding>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9b6b8-104">Před čtením prostřednictvím tohoto tématu, se doporučuje, abyste si přečetli [koncepty zabezpečení](../../../../docs/framework/wcf/feature-details/security-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="9b6b8-104">Before reading through this topic, it is recommended that you read [Security Concepts](../../../../docs/framework/wcf/feature-details/security-concepts.md).</span></span>  
  
 <span data-ttu-id="9b6b8-105">Následující obrázek poskytuje koncepční model komunikaci ve frontě pomocí technologie WCF.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-105">The following illustration provides a conceptual model of queued communication using WCF.</span></span> <span data-ttu-id="9b6b8-106">Tento obrázek a terminologie se používají k vysvětlení</span><span class="sxs-lookup"><span data-stu-id="9b6b8-106">This illustration and terminology are used to explain</span></span>  
  
 <span data-ttu-id="9b6b8-107">koncepty zabezpečení přenosu.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-107">transport security concepts.</span></span>  
  
 <span data-ttu-id="9b6b8-108">![Ve frontě diagramu aplikace](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "distribuované obrázek fronty")</span><span class="sxs-lookup"><span data-stu-id="9b6b8-108">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="9b6b8-109">Při odesílání zpráv zařazených do fronty pomocí technologie WCF, zprávy WCF je připojen jako text zprávy služby Řízení front zpráv (MSMQ).</span><span class="sxs-lookup"><span data-stu-id="9b6b8-109">When sending queued messages using WCF, the WCF message is attached as a body of the Message Queuing (MSMQ) message.</span></span> <span data-ttu-id="9b6b8-110">Při zabezpečení přenosu zabezpečuje celý MSMQ zprávy, zprávu (nebo SOAP) zabezpečení zabezpečuje pouze text zprávy služby MSMQ.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-110">While transport security secures the entire MSMQ message, message (or SOAP) security only secures the body of the MSMQ message.</span></span>  
  
 <span data-ttu-id="9b6b8-111">Klíčovým konceptem zabezpečení zpráv je, že klient zabezpečuje zprávu pro přijímající aplikace (služba), na rozdíl od přenosu zabezpečení, kde klient zabezpečuje pro cílovou frontu zprávy.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-111">The key concept of message security is that the client secures the message for the receiving application (service), unlike transport security where the client secures the message for the Target Queue.</span></span> <span data-ttu-id="9b6b8-112">V důsledku toho služba MSMQ hraje žádná část při zabezpečování zprávy WCF pomocí zabezpečení zpráv.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-112">As such, MSMQ plays no part when securing the WCF message using message security.</span></span>  
  
 <span data-ttu-id="9b6b8-113">Zabezpečení zpráv WCF přidá hlavičky zabezpečení zprávy WCF, která lze integrovat s stávajících infrastruktur zabezpečení, jako je například certifikát nebo protokolu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-113">WCF message security adds security headers to the WCF message that integrate with existing security infrastructures, such as a certificate or the Kerberos protocol.</span></span>  
  
## <a name="message-credential-type"></a><span data-ttu-id="9b6b8-114">Typ pověření zprávy</span><span class="sxs-lookup"><span data-stu-id="9b6b8-114">Message Credential Type</span></span>  
 <span data-ttu-id="9b6b8-115">Zabezpečení zpráv pomocí, klienta a služby ale může představovat přihlašovací údaje k ověření navzájem.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-115">Using message security, the service and client can present credentials to authenticate each another.</span></span> <span data-ttu-id="9b6b8-116">Zabezpečení zpráv můžete vybrat tak, že nastavíte <xref:System.ServiceModel.NetMsmqBinding.Security%2A> režimu `Message` nebo `Both` (to znamená použít zabezpečení přenosů a zpráv zabezpečení).</span><span class="sxs-lookup"><span data-stu-id="9b6b8-116">You can select message security by setting the <xref:System.ServiceModel.NetMsmqBinding.Security%2A> mode to `Message` or `Both` (that is, use both transport security and message security).</span></span>  
  
 <span data-ttu-id="9b6b8-117">Můžete použít službu <xref:System.ServiceModel.ServiceSecurityContext.Current%2A> vlastnost ke kontrole přihlašovacích údajů pro ověření klienta.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-117">The service can use the <xref:System.ServiceModel.ServiceSecurityContext.Current%2A> property to inspect the credential used to authenticate the client.</span></span> <span data-ttu-id="9b6b8-118">Může také sloužit pro další kontroly autorizace, který vybírá služby k implementaci.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-118">This can also be used for further authorization checks that the service chooses to implement.</span></span>  
  
 <span data-ttu-id="9b6b8-119">Tato část popisuje typy různých přihlašovacích údajů a jejich použití v případě front.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-119">This section explains the different credential types and how to use them with queues.</span></span>  
  
### <a name="certificate"></a><span data-ttu-id="9b6b8-120">Certifikát</span><span class="sxs-lookup"><span data-stu-id="9b6b8-120">Certificate</span></span>  
 <span data-ttu-id="9b6b8-121">Typ přihlašovacích údajů certifikát certifikát X.509, který používá k identifikaci služby a klienta.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-121">The certificate credential type uses an X.509 certificate to identify the service and the client.</span></span>  
  
 <span data-ttu-id="9b6b8-122">V rámci typického scénáře klient a služba vydal platný certifikát důvěryhodné certifikační autority.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-122">In a typical scenario, the client and the service are issued a valid certificate by a trusted certification authority.</span></span> <span data-ttu-id="9b6b8-123">Potom se naváže připojení, klient se ověří platnost služby pomocí certifikátu služby se rozhodnout, jestli je vztah důvěryhodnosti služby.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-123">Then the connection is established, the client authenticates the validity of the service using the service's certificate to decide whether it can trust the service.</span></span> <span data-ttu-id="9b6b8-124">Podobně služba používá certifikát klienta pro ověření klienta vztah důvěryhodnosti.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-124">Similarly, the service uses the client's certificate to validate the client trust.</span></span>  
  
 <span data-ttu-id="9b6b8-125">Vzhledem k odpojené povaze fronty, klient a služba nemusí být online ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-125">Given the disconnected nature of queues, the client and the service may not be online at the same time.</span></span> <span data-ttu-id="9b6b8-126">V důsledku toho klienta a služby mají k výměně certifikátů out-of-band.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-126">As such, the client and service have to exchange certificates out-of-band.</span></span> <span data-ttu-id="9b6b8-127">Zejména klienta tím, že podržíte ve svém úložišti důvěryhodných certifikátů služby, (která může být zřetězené k certifikační autoritě) musí důvěřovat, že komunikaci se službou správné.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-127">In particular, the client, by virtue of holding the service's certificate (which can be chained to a certification authority) in its trusted store, must trust that it is communicating with the correct service.</span></span> <span data-ttu-id="9b6b8-128">Pro ověření klienta, služba používá certifikát X.509 připojil se zpráva, která se mu odpovídá certifikátem v úložišti k ověření pravosti klienta.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-128">For authenticating the client, the service uses the X.509 certificate attached with the message to matches it with the certificate in its store to verify the authenticity of the client.</span></span> <span data-ttu-id="9b6b8-129">Znovu certifikát musí být zřetězené k certifikační autoritě.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-129">Again, the certificate must be chained to a certification authority.</span></span>  
  
 <span data-ttu-id="9b6b8-130">Na počítači se systémem Windows jsou certifikáty uložené v několika druhů úložišť.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-130">On a computer running Windows, certificates are held in several kinds of stores.</span></span> <span data-ttu-id="9b6b8-131">Další informace o různých úložištích, naleznete v tématu [úložiště certifikátů](https://go.microsoft.com/fwlink/?LinkId=87787).</span><span class="sxs-lookup"><span data-stu-id="9b6b8-131">For more information about the different stores, see [Certificate stores](https://go.microsoft.com/fwlink/?LinkId=87787).</span></span>  
  
### <a name="windows"></a><span data-ttu-id="9b6b8-132">Windows</span><span class="sxs-lookup"><span data-stu-id="9b6b8-132">Windows</span></span>  
 <span data-ttu-id="9b6b8-133">Typ pověření zprávy Windows používá protokol Kerberos.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-133">Windows message credential type uses the Kerberos protocol.</span></span>  
  
 <span data-ttu-id="9b6b8-134">Protokol Kerberos je mechanismus zabezpečení, který ověřuje uživatele v doméně a umožňuje ověřeným uživatelům k navázání zabezpečené kontextů se ostatní entity v doméně.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-134">The Kerberos protocol is a security mechanism that authenticates users on a domain and allows the authenticated users to establish secure contexts with other entities on a domain.</span></span>  
  
 <span data-ttu-id="9b6b8-135">Problém s pomocí protokolu Kerberos pro komunikaci ve frontě jsou relativně krátkodobou lístků, které obsahují identity klienta, který distribuuje na distribuční Center KDC (Key).</span><span class="sxs-lookup"><span data-stu-id="9b6b8-135">The problem with using the Kerberos protocol for queued communication is that the tickets that contain client identity that the Key Distribution Center (KDC) distributes are relatively short-lived.</span></span> <span data-ttu-id="9b6b8-136">A *životnost* souvisí s lístek služby Kerberos, který označuje platnost-the-ticket.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-136">A *lifetime* is associated with the Kerberos ticket that indicates the validity of the ticket.</span></span> <span data-ttu-id="9b6b8-137">V důsledku toho zadány vysokou latencí, vám nemůže být jisti, že token, který je stále platný pro službu, která ověřuje klienta.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-137">As such, given high latency, you cannot be sure that the token is still valid for the service that authenticates the client.</span></span>  
  
 <span data-ttu-id="9b6b8-138">Všimněte si, že při použití tento typ přihlašovacích údajů, služba musí být spuštěna pod účtem služby.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-138">Note that when using this credential type, the service must be running under the SERVICE account.</span></span>  
  
 <span data-ttu-id="9b6b8-139">Protokol Kerberos se používá ve výchozím nastavení při výběru přihlašovacími údaji zprávy.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-139">The Kerberos protocol is used by default when choosing message credential.</span></span> <span data-ttu-id="9b6b8-140">Další informace najdete v tématu [zkoumání protokolu Kerberos, protokol pro distribuované zabezpečení ve Windows 2000](https://go.microsoft.com/fwlink/?LinkId=87790).</span><span class="sxs-lookup"><span data-stu-id="9b6b8-140">For more information, see [Exploring Kerberos, the Protocol for Distributed Security in Windows 2000](https://go.microsoft.com/fwlink/?LinkId=87790).</span></span>  
  
### <a name="username-password"></a><span data-ttu-id="9b6b8-141">Uživatelské jméno, heslo</span><span class="sxs-lookup"><span data-stu-id="9b6b8-141">Username Password</span></span>  
 <span data-ttu-id="9b6b8-142">Pomocí této vlastnosti se klient může ověřit pomocí uživatelského jména hesla v záhlaví zabezpečení zprávy se k serveru.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-142">Using this property, the client can authenticate to the server using a username password in the security header of the message.</span></span>  
  
### <a name="issuedtoken"></a><span data-ttu-id="9b6b8-143">Třídy IssuedToken</span><span class="sxs-lookup"><span data-stu-id="9b6b8-143">IssuedToken</span></span>  
 <span data-ttu-id="9b6b8-144">K vydání tokenu, který lze připojit ke zprávě pro službu pro ověření klienta, můžete použít klienta služby tokenů zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-144">The client can use the security token service to issue a token that can then be attached to the message for the service to authenticate the client.</span></span>  
  
## <a name="using-transport-and-message-security"></a><span data-ttu-id="9b6b8-145">Pomocí přenosu a zabezpečení zpráv</span><span class="sxs-lookup"><span data-stu-id="9b6b8-145">Using Transport and Message Security</span></span>  
 <span data-ttu-id="9b6b8-146">Při použití zabezpečení přenosů a zpráv zabezpečení, musí být certifikát používaný k zabezpečení i na úrovni zprávy protokolu SOAP a přenos zprávy stejná.</span><span class="sxs-lookup"><span data-stu-id="9b6b8-146">When using both transport security and message security, the certificate used to secure the message both at the transport and the SOAP message level must be the same.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9b6b8-147">Viz také:</span><span class="sxs-lookup"><span data-stu-id="9b6b8-147">See also</span></span>

- [<span data-ttu-id="9b6b8-148">Zabezpečení zpráv pomocí zabezpečení přenosu</span><span class="sxs-lookup"><span data-stu-id="9b6b8-148">Securing Messages Using Transport Security</span></span>](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md)
- [<span data-ttu-id="9b6b8-149">Zabezpečení zprávy pomocí služby Řízení front zpráv</span><span class="sxs-lookup"><span data-stu-id="9b6b8-149">Message Security over Message Queuing</span></span>](../../../../docs/framework/wcf/samples/message-security-over-message-queuing.md)
- [<span data-ttu-id="9b6b8-150">Koncepty zabezpečení</span><span class="sxs-lookup"><span data-stu-id="9b6b8-150">Security Concepts</span></span>](../../../../docs/framework/wcf/feature-details/security-concepts.md)
- [<span data-ttu-id="9b6b8-151">Zabezpečení služeb a klientů</span><span class="sxs-lookup"><span data-stu-id="9b6b8-151">Securing Services and Clients</span></span>](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)
