---
title: Povolení toku transakcí
ms.date: 03/30/2017
helpviewer_keywords:
- transactions [WCF], enabling flow
ms.assetid: a03f5041-5049-43f4-897c-e0292d4718f7
ms.openlocfilehash: 2443e82dd9c6d8b5447c2fa16b537a9feed8ddaf
ms.sourcegitcommit: 5ae5a1a9520b8b8b6164ad728d396717f30edafc
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/11/2019
ms.locfileid: "70895154"
---
# <a name="enabling-transaction-flow"></a><span data-ttu-id="db3a3-102">Povolení toku transakcí</span><span class="sxs-lookup"><span data-stu-id="db3a3-102">Enabling Transaction Flow</span></span>
<span data-ttu-id="db3a3-103">Windows Communication Foundation (WCF) poskytuje vysoce flexibilní možnosti pro řízení toku transakce.</span><span class="sxs-lookup"><span data-stu-id="db3a3-103">Windows Communication Foundation (WCF) provides highly flexible options for controlling transaction flow.</span></span> <span data-ttu-id="db3a3-104">Nastavení toku transakce služby lze vyjádřit pomocí kombinace atributů a konfigurací.</span><span class="sxs-lookup"><span data-stu-id="db3a3-104">A service's transaction flow settings can be expressed using a combination of attributes and configuration.</span></span>  
  
## <a name="transaction-flow-settings"></a><span data-ttu-id="db3a3-105">Nastavení toku transakce</span><span class="sxs-lookup"><span data-stu-id="db3a3-105">Transaction Flow Settings</span></span>  
 <span data-ttu-id="db3a3-106">Nastavení toku transakce jsou generována pro koncový bod služby v důsledku průniku následujících tří hodnot:</span><span class="sxs-lookup"><span data-stu-id="db3a3-106">Transaction flow settings are generated for a service endpoint as a result of the intersection of the following three values:</span></span>  
  
- <span data-ttu-id="db3a3-107"><xref:System.ServiceModel.TransactionFlowAttribute> Atribut zadaný pro každou metodu v kontraktu služby.</span><span class="sxs-lookup"><span data-stu-id="db3a3-107">The <xref:System.ServiceModel.TransactionFlowAttribute> attribute specified for each method in the service contract.</span></span>  
  
- <span data-ttu-id="db3a3-108">Vlastnost `TransactionFlow` Binding v konkrétní vazbě.</span><span class="sxs-lookup"><span data-stu-id="db3a3-108">The `TransactionFlow` binding property in the specific binding.</span></span>  
  
- <span data-ttu-id="db3a3-109">Vlastnost `TransactionFlowProtocol` Binding v konkrétní vazbě.</span><span class="sxs-lookup"><span data-stu-id="db3a3-109">The `TransactionFlowProtocol` binding property in the specific binding.</span></span> <span data-ttu-id="db3a3-110">Vlastnost `TransactionFlowProtocol` Binding umožňuje zvolit ze dvou různých transakčních protokolů, které lze použít k flowování transakce.</span><span class="sxs-lookup"><span data-stu-id="db3a3-110">The `TransactionFlowProtocol` binding property enables you to choose among two different transaction protocols that you can use to flow a transaction.</span></span> <span data-ttu-id="db3a3-111">Následující části stručně popisují každou z nich.</span><span class="sxs-lookup"><span data-stu-id="db3a3-111">The following sections briefly describe each of them.</span></span>  
  
### <a name="ws-atomictransaction-protocol"></a><span data-ttu-id="db3a3-112">Protokol WS-AtomicTransaction</span><span class="sxs-lookup"><span data-stu-id="db3a3-112">WS-AtomicTransaction Protocol</span></span>  
 <span data-ttu-id="db3a3-113">Protokol WS-AtomicTransaction (WS-AT) je užitečný pro scénáře, kdy je potřeba vzájemná funkční spolupráce se zásobníky protokolů třetích stran.</span><span class="sxs-lookup"><span data-stu-id="db3a3-113">The WS-AtomicTransaction (WS-AT) protocol is useful for scenarios when interoperability with third-party protocol stacks is required.</span></span>  
  
### <a name="oletransactions-protocol"></a><span data-ttu-id="db3a3-114">Protokol OleTransactions</span><span class="sxs-lookup"><span data-stu-id="db3a3-114">OleTransactions Protocol</span></span>  
 <span data-ttu-id="db3a3-115">Protokol OleTransactions je vhodný pro scénáře, kdy se nepodporuje interoperabilita se zásobníky protokolů jiných výrobců, a nasazování služby ví předem, že je služba protokolu WS-AT zakázaná místně, nebo že existující topologie sítě. Nepoužívejte upřednostnění použití WS-AT.</span><span class="sxs-lookup"><span data-stu-id="db3a3-115">The OleTransactions protocol is useful for scenarios when interoperability with third-party protocol stacks is not required, and the deployer of a service knows in advance that the WS-AT protocol service is disabled locally or the existing network topology does not favor the usage of WS-AT.</span></span>  
  
 <span data-ttu-id="db3a3-116">V následující tabulce jsou uvedeny různé typy toků transakcí, které lze vygenerovat pomocí těchto různých kombinací.</span><span class="sxs-lookup"><span data-stu-id="db3a3-116">The following table shows the different types of transaction flows that can be generated using these various combinations.</span></span>  
  
|<span data-ttu-id="db3a3-117">TransactionFlow</span><span class="sxs-lookup"><span data-stu-id="db3a3-117">TransactionFlow</span></span><br /><br /> <span data-ttu-id="db3a3-118">vazba</span><span class="sxs-lookup"><span data-stu-id="db3a3-118">binding</span></span>|<span data-ttu-id="db3a3-119">Vlastnost vazby TransactionFlow</span><span class="sxs-lookup"><span data-stu-id="db3a3-119">TransactionFlow binding property</span></span>|<span data-ttu-id="db3a3-120">Protokol vazby TransactionFlowProtocol</span><span class="sxs-lookup"><span data-stu-id="db3a3-120">TransactionFlowProtocol binding protocol</span></span>|<span data-ttu-id="db3a3-121">Typ toku transakce</span><span class="sxs-lookup"><span data-stu-id="db3a3-121">Type of transaction flow</span></span>|  
|---------------------------------|--------------------------------------|----------------------------------------------|------------------------------|  
|<span data-ttu-id="db3a3-122">Povinné</span><span class="sxs-lookup"><span data-stu-id="db3a3-122">Mandatory</span></span>|<span data-ttu-id="db3a3-123">true</span><span class="sxs-lookup"><span data-stu-id="db3a3-123">true</span></span>|<span data-ttu-id="db3a3-124">WS-AT</span><span class="sxs-lookup"><span data-stu-id="db3a3-124">WS-AT</span></span>|<span data-ttu-id="db3a3-125">Transakce musí být převedena do interoperabilního formátu WS-AT.</span><span class="sxs-lookup"><span data-stu-id="db3a3-125">Transaction must be flowed in the interoperable WS-AT format.</span></span>|  
|<span data-ttu-id="db3a3-126">Povinné</span><span class="sxs-lookup"><span data-stu-id="db3a3-126">Mandatory</span></span>|<span data-ttu-id="db3a3-127">true</span><span class="sxs-lookup"><span data-stu-id="db3a3-127">true</span></span>|<span data-ttu-id="db3a3-128">OleTransactions</span><span class="sxs-lookup"><span data-stu-id="db3a3-128">OleTransactions</span></span>|<span data-ttu-id="db3a3-129">Transakce musí být předávána ve formátu OleTransactions WCF.</span><span class="sxs-lookup"><span data-stu-id="db3a3-129">Transaction must be flowed in the WCF OleTransactions format.</span></span>|  
|<span data-ttu-id="db3a3-130">Povinné</span><span class="sxs-lookup"><span data-stu-id="db3a3-130">Mandatory</span></span>|<span data-ttu-id="db3a3-131">false</span><span class="sxs-lookup"><span data-stu-id="db3a3-131">false</span></span>|<span data-ttu-id="db3a3-132">Nelze použít</span><span class="sxs-lookup"><span data-stu-id="db3a3-132">Not applicable</span></span>|<span data-ttu-id="db3a3-133">Nelze použít, protože se jedná o neplatnou konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="db3a3-133">Not applicable because this is an invalid configuration.</span></span>|  
|<span data-ttu-id="db3a3-134">Povoleno</span><span class="sxs-lookup"><span data-stu-id="db3a3-134">Allowed</span></span>|<span data-ttu-id="db3a3-135">true</span><span class="sxs-lookup"><span data-stu-id="db3a3-135">true</span></span>|<span data-ttu-id="db3a3-136">WS-AT</span><span class="sxs-lookup"><span data-stu-id="db3a3-136">WS-AT</span></span>|<span data-ttu-id="db3a3-137">Transakce může být převedena do interoperabilního formátu WS-AT.</span><span class="sxs-lookup"><span data-stu-id="db3a3-137">Transaction may be flowed in the interoperable WS-AT format.</span></span>|  
|<span data-ttu-id="db3a3-138">Povoleno</span><span class="sxs-lookup"><span data-stu-id="db3a3-138">Allowed</span></span>|<span data-ttu-id="db3a3-139">true</span><span class="sxs-lookup"><span data-stu-id="db3a3-139">true</span></span>|<span data-ttu-id="db3a3-140">OleTransactions</span><span class="sxs-lookup"><span data-stu-id="db3a3-140">OleTransactions</span></span>|<span data-ttu-id="db3a3-141">Transakce se může přesměrovat ve formátu WCF OleTransactions.</span><span class="sxs-lookup"><span data-stu-id="db3a3-141">Transaction may be flowed in the WCF OleTransactions format.</span></span>|  
|<span data-ttu-id="db3a3-142">Povoleno</span><span class="sxs-lookup"><span data-stu-id="db3a3-142">Allowed</span></span>|<span data-ttu-id="db3a3-143">false</span><span class="sxs-lookup"><span data-stu-id="db3a3-143">false</span></span>|<span data-ttu-id="db3a3-144">Libovolná hodnota</span><span class="sxs-lookup"><span data-stu-id="db3a3-144">Any value</span></span>|<span data-ttu-id="db3a3-145">Transakce není přesměrovaná.</span><span class="sxs-lookup"><span data-stu-id="db3a3-145">A transaction is not flowed.</span></span>|  
|<span data-ttu-id="db3a3-146">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="db3a3-146">NotAllowed</span></span>|<span data-ttu-id="db3a3-147">Libovolná hodnota</span><span class="sxs-lookup"><span data-stu-id="db3a3-147">Any value</span></span>|<span data-ttu-id="db3a3-148">Libovolná hodnota</span><span class="sxs-lookup"><span data-stu-id="db3a3-148">Any value</span></span>|<span data-ttu-id="db3a3-149">Transakce není přesměrovaná.</span><span class="sxs-lookup"><span data-stu-id="db3a3-149">A transaction is not flowed.</span></span>|  
  
 <span data-ttu-id="db3a3-150">Následující tabulka shrnuje výsledek zpracování zprávy.</span><span class="sxs-lookup"><span data-stu-id="db3a3-150">The following table summarizes the message processing result.</span></span>  
  
|<span data-ttu-id="db3a3-151">Příchozí zpráva</span><span class="sxs-lookup"><span data-stu-id="db3a3-151">Incoming message</span></span>|<span data-ttu-id="db3a3-152">Nastavení TransactionFlow</span><span class="sxs-lookup"><span data-stu-id="db3a3-152">TransactionFlow setting</span></span>|<span data-ttu-id="db3a3-153">Hlavička transakce</span><span class="sxs-lookup"><span data-stu-id="db3a3-153">Transaction header</span></span>|<span data-ttu-id="db3a3-154">Výsledek zpracování zprávy</span><span class="sxs-lookup"><span data-stu-id="db3a3-154">Message processing result</span></span>|  
|----------------------|-----------------------------|------------------------|-------------------------------|  
|<span data-ttu-id="db3a3-155">Formát očekávaného protokolu shody transakcí</span><span class="sxs-lookup"><span data-stu-id="db3a3-155">Transaction matches expected protocol format</span></span>|<span data-ttu-id="db3a3-156">Povoleno nebo povinný</span><span class="sxs-lookup"><span data-stu-id="db3a3-156">Allowed or Mandatory</span></span>|<span data-ttu-id="db3a3-157">`MustUnderstand`je rovno `true`.</span><span class="sxs-lookup"><span data-stu-id="db3a3-157">`MustUnderstand` equals `true`.</span></span>|<span data-ttu-id="db3a3-158">Proces</span><span class="sxs-lookup"><span data-stu-id="db3a3-158">Process</span></span>|  
|<span data-ttu-id="db3a3-159">Transakce neodpovídá očekávanému formátu protokolu.</span><span class="sxs-lookup"><span data-stu-id="db3a3-159">Transaction does not match expected protocol format</span></span>|<span data-ttu-id="db3a3-160">Povinné</span><span class="sxs-lookup"><span data-stu-id="db3a3-160">Mandatory</span></span>|<span data-ttu-id="db3a3-161">`MustUnderstand`je rovno `false`.</span><span class="sxs-lookup"><span data-stu-id="db3a3-161">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="db3a3-162">Odmítnuto, protože transakce je povinná</span><span class="sxs-lookup"><span data-stu-id="db3a3-162">Rejected because a transaction is required</span></span>|  
|<span data-ttu-id="db3a3-163">Transakce neodpovídá očekávanému formátu protokolu.</span><span class="sxs-lookup"><span data-stu-id="db3a3-163">Transaction does not match expected protocol format</span></span>|<span data-ttu-id="db3a3-164">Povoleno</span><span class="sxs-lookup"><span data-stu-id="db3a3-164">Allowed</span></span>|<span data-ttu-id="db3a3-165">`MustUnderstand`je rovno `false`.</span><span class="sxs-lookup"><span data-stu-id="db3a3-165">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="db3a3-166">Odmítnuto, protože hlavička není srozumitelná</span><span class="sxs-lookup"><span data-stu-id="db3a3-166">Rejected because the header is not understood</span></span>|  
|<span data-ttu-id="db3a3-167">Transakce pomocí libovolného formátu protokolu</span><span class="sxs-lookup"><span data-stu-id="db3a3-167">Transaction using any protocol format</span></span>|<span data-ttu-id="db3a3-168">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="db3a3-168">NotAllowed</span></span>|<span data-ttu-id="db3a3-169">`MustUnderstand`je rovno `false`.</span><span class="sxs-lookup"><span data-stu-id="db3a3-169">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="db3a3-170">Odmítnuto, protože hlavička není srozumitelná</span><span class="sxs-lookup"><span data-stu-id="db3a3-170">Rejected because the header is not understood</span></span>|  
|<span data-ttu-id="db3a3-171">Žádná transakce</span><span class="sxs-lookup"><span data-stu-id="db3a3-171">No transaction</span></span>|<span data-ttu-id="db3a3-172">Povinné</span><span class="sxs-lookup"><span data-stu-id="db3a3-172">Mandatory</span></span>|<span data-ttu-id="db3a3-173">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="db3a3-173">N/A</span></span>|<span data-ttu-id="db3a3-174">Odmítnuto, protože transakce je povinná</span><span class="sxs-lookup"><span data-stu-id="db3a3-174">Rejected because a transaction is required</span></span>|  
|<span data-ttu-id="db3a3-175">Žádná transakce</span><span class="sxs-lookup"><span data-stu-id="db3a3-175">No transaction</span></span>|<span data-ttu-id="db3a3-176">Povoleno</span><span class="sxs-lookup"><span data-stu-id="db3a3-176">Allowed</span></span>|<span data-ttu-id="db3a3-177">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="db3a3-177">N/A</span></span>|<span data-ttu-id="db3a3-178">Proces</span><span class="sxs-lookup"><span data-stu-id="db3a3-178">Process</span></span>|  
|<span data-ttu-id="db3a3-179">Žádná transakce</span><span class="sxs-lookup"><span data-stu-id="db3a3-179">No transaction</span></span>|<span data-ttu-id="db3a3-180">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="db3a3-180">NotAllowed</span></span>|<span data-ttu-id="db3a3-181">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="db3a3-181">N/A</span></span>|<span data-ttu-id="db3a3-182">Proces</span><span class="sxs-lookup"><span data-stu-id="db3a3-182">Process</span></span>|  
  
 <span data-ttu-id="db3a3-183">Zatímco každá metoda ve kontraktu může mít různé požadavky na tok transakce, nastavení protokolu toku transakce je vymezeno na úrovni vazby.</span><span class="sxs-lookup"><span data-stu-id="db3a3-183">While each method on a contract can have different transaction flow requirements, the transaction flow protocol setting is scoped at the level of the binding.</span></span> <span data-ttu-id="db3a3-184">To znamená, že všechny metody, které sdílejí stejný koncový bod (a tudíž stejnou vazbu), sdílejí také stejné zásady, které umožňují nebo vyžadují tok transakce a také stejný transakční protokol, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="db3a3-184">This means that all methods that share the same endpoint (and therefore the same binding) also share the same policy allowing or requiring transaction flow, as well as the same transaction protocol if applicable.</span></span>  
  
## <a name="enabling-transaction-flow-at-the-method-level"></a><span data-ttu-id="db3a3-185">Povolení toku transakce na úrovni metody</span><span class="sxs-lookup"><span data-stu-id="db3a3-185">Enabling Transaction Flow at the Method Level</span></span>  
 <span data-ttu-id="db3a3-186">Požadavky na tok transakce nejsou vždy stejné pro všechny metody v kontraktu služby.</span><span class="sxs-lookup"><span data-stu-id="db3a3-186">Transaction flow requirements are not always the same for all methods in a service contract.</span></span> <span data-ttu-id="db3a3-187">Proto WCF také poskytuje mechanismus založený na atributech, aby bylo možné vyjádřit předvolby toku transakce jednotlivých metod.</span><span class="sxs-lookup"><span data-stu-id="db3a3-187">Therefore, WCF also provides an attribute-based mechanism to allow each method's transaction flow preferences to be expressed.</span></span> <span data-ttu-id="db3a3-188">To se dosahuje tím <xref:System.ServiceModel.TransactionFlowAttribute> , že určuje úroveň, ve které operace služby akceptuje hlavičku transakce.</span><span class="sxs-lookup"><span data-stu-id="db3a3-188">This is achieved by the <xref:System.ServiceModel.TransactionFlowAttribute> that specifies the level in which a service operation accepts a transaction header.</span></span> <span data-ttu-id="db3a3-189">Metody kontraktu služby byste měli označit pomocí tohoto atributu, pokud chcete povolit tok transakce.</span><span class="sxs-lookup"><span data-stu-id="db3a3-189">You should mark your service contract methods with this attribute if you want to enable transaction flow.</span></span> <span data-ttu-id="db3a3-190">Tento atribut přebírá jednu z hodnot <xref:System.ServiceModel.TransactionFlowOption> výčtu, ve které je <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>výchozí hodnota.</span><span class="sxs-lookup"><span data-stu-id="db3a3-190">This attribute takes one of the values of the <xref:System.ServiceModel.TransactionFlowOption> enumeration, in which the default value is <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span></span> <span data-ttu-id="db3a3-191">Pokud je zadána libovolná hodnota s výjimkou <xref:System.ServiceModel.TransactionFlowOption.NotAllowed> , musí být metoda jednosměrná.</span><span class="sxs-lookup"><span data-stu-id="db3a3-191">If any value except <xref:System.ServiceModel.TransactionFlowOption.NotAllowed> is specified, the method is required to not be one-way.</span></span> <span data-ttu-id="db3a3-192">Vývojář může pomocí tohoto atributu zadat požadavky nebo omezení toku transakce na úrovni metody v době návrhu.</span><span class="sxs-lookup"><span data-stu-id="db3a3-192">A developer can use this attribute to specify method-level transaction flow requirements or constraints at design time.</span></span>  
  
## <a name="enabling-transaction-flow-at-the-endpoint-level"></a><span data-ttu-id="db3a3-193">Povolení toku transakce na úrovni koncového bodu</span><span class="sxs-lookup"><span data-stu-id="db3a3-193">Enabling Transaction Flow at the Endpoint Level</span></span>  
 <span data-ttu-id="db3a3-194">Kromě nastavení <xref:System.ServiceModel.TransactionFlowAttribute> toku transakce na úrovni metody poskytuje služba WCF nastavení pro tok transakce v rámci koncového bodu a umožňuje správcům řídit tok transakcí na vyšší úrovni.</span><span class="sxs-lookup"><span data-stu-id="db3a3-194">In addition to the method-level transaction flow setting  the <xref:System.ServiceModel.TransactionFlowAttribute> attribute provides, WCF provides an endpoint-wide setting for transaction flow to allow administrators to control transaction flow at a higher level.</span></span>  
  
 <span data-ttu-id="db3a3-195">K tomu je <xref:System.ServiceModel.Channels.TransactionFlowBindingElement>potřeba, což umožňuje povolit nebo zakázat tok příchozích transakcí v nastaveních vazby koncového bodu a také určit požadovaný formát protokolu transakcí pro příchozí transakce.</span><span class="sxs-lookup"><span data-stu-id="db3a3-195">This is achieved by the <xref:System.ServiceModel.Channels.TransactionFlowBindingElement>, which enables you to enable or disable incoming transaction flow in an endpoint’s binding settings, as well as to specify the desired transaction protocol format for incoming transactions.</span></span>  
  
 <span data-ttu-id="db3a3-196">Pokud vazba zakázala tok transakce, ale jedna z operací v kontraktu služby vyžaduje příchozí transakci, pak je vyvolána výjimka ověření při spuštění služby.</span><span class="sxs-lookup"><span data-stu-id="db3a3-196">If the binding has disabled transaction flow, but one of the operations on a service contract requires an incoming transaction, then a validation exception is thrown at service startup.</span></span>  
  
 <span data-ttu-id="db3a3-197">Většina ze stálých vazeb WCF poskytuje `transactionFlow` atributy a `transactionProtocol` , které umožňují nakonfigurovat konkrétní vazbu pro příjem příchozích transakcí.</span><span class="sxs-lookup"><span data-stu-id="db3a3-197">Most of the standing bindings WCF provides contain the `transactionFlow` and `transactionProtocol` attributes to enable you to configure the specific binding to accept incoming transactions.</span></span> <span data-ttu-id="db3a3-198">Další informace o nastavení elementů konfigurace naleznete v tématu [ \<Binding >](../../../../docs/framework/misc/binding.md).</span><span class="sxs-lookup"><span data-stu-id="db3a3-198">For more information about setting the configuration elements, see [\<binding>](../../../../docs/framework/misc/binding.md).</span></span>  
  
 <span data-ttu-id="db3a3-199">Správce nebo nástroj pro nasazení může použít tok transakce na úrovni koncového bodu ke konfiguraci požadavků a omezení toku transakce v době nasazení pomocí konfiguračního souboru.</span><span class="sxs-lookup"><span data-stu-id="db3a3-199">An administrator or deployer can use endpoint-level transaction flow to configure transaction flow requirements or constraints at deployment time using the configuration file.</span></span>  
  
## <a name="security"></a><span data-ttu-id="db3a3-200">Zabezpečení</span><span class="sxs-lookup"><span data-stu-id="db3a3-200">Security</span></span>  
 <span data-ttu-id="db3a3-201">Chcete-li zajistit zabezpečení a integritu systému, je nutné zabezpečit výměnu zpráv při toku transakcí mezi aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="db3a3-201">To ensure system security and integrity, you must secure message exchanges when flowing transactions between applications.</span></span> <span data-ttu-id="db3a3-202">Do žádné aplikace, která nemá nárok na účast ve stejné transakci, byste neměli přesměrovat ani zveřejňovat podrobnosti transakce.</span><span class="sxs-lookup"><span data-stu-id="db3a3-202">You should not flow or disclose transaction details to any application that is not entitled to participate in the same transaction.</span></span>  
  
 <span data-ttu-id="db3a3-203">Při generování klientů WCF pro neznámé nebo nedůvěryhodné webové služby prostřednictvím použití výměny metadat musí volání operací na těchto webových službách potlačit aktuální transakci, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="db3a3-203">When generating WCF clients to unknown or untrusted Web services through the use of metadata exchange, calls to operations on these Web services should suppress the current transaction if possible.</span></span> <span data-ttu-id="db3a3-204">Následující příklad demonstruje, jak to udělat.</span><span class="sxs-lookup"><span data-stu-id="db3a3-204">The following example demonstrates how to do this.</span></span>  
  
```csharp
//client code which has an ambient transaction  
using (TransactionScope scope = new TransactionScope(TransactionScopeOption.Suppress))  
{  
    // No transaction will flow to this operation  
    untrustedProxy.Operation1(...);  
    scope.Complete();  
}  
//remainder of client code  
```  
  
 <span data-ttu-id="db3a3-205">Služby je navíc potřeba nakonfigurovat tak, aby přijímaly příchozí transakce jenom od klientů, které ověřil a schválili.</span><span class="sxs-lookup"><span data-stu-id="db3a3-205">In addition, services should be configured to accept incoming transactions only from clients that they have authenticated and authorized.</span></span> <span data-ttu-id="db3a3-206">Příchozí transakce by měly být přijaty pouze v případě, že pocházejí z vysoce důvěryhodných klientů.</span><span class="sxs-lookup"><span data-stu-id="db3a3-206">Incoming transactions should only be accepted if they come from highly trusted clients.</span></span>  
  
## <a name="policy-assertions"></a><span data-ttu-id="db3a3-207">Kontrolní výrazy zásad</span><span class="sxs-lookup"><span data-stu-id="db3a3-207">Policy Assertions</span></span>  
 <span data-ttu-id="db3a3-208">WCF používá kontrolní výrazy zásad pro řízení toku transakce.</span><span class="sxs-lookup"><span data-stu-id="db3a3-208">WCF uses policy assertions to control transaction flow.</span></span> <span data-ttu-id="db3a3-209">Kontrolní výrazy zásad lze nalézt v dokumentu zásad služby, který je generován agregací smluv, konfigurací a atributů.</span><span class="sxs-lookup"><span data-stu-id="db3a3-209">Policy assertions can be found in a service’s policy document, which is generated by aggregating contracts, configuration, and attributes.</span></span> <span data-ttu-id="db3a3-210">Klient může získat dokument zásad služby pomocí požadavku HTTP GET nebo WS-MetadataExchange Request-Reply.</span><span class="sxs-lookup"><span data-stu-id="db3a3-210">The client can obtain the service’s policy document using an HTTP GET or a WS-MetadataExchange request-reply.</span></span> <span data-ttu-id="db3a3-211">Klienti pak mohou zpracovat dokument zásad a určit, které operace v kontraktu služby mohou podporovat nebo vyžadovat tok transakce.</span><span class="sxs-lookup"><span data-stu-id="db3a3-211">Clients can then process the policy document to determine which operations on a service contract may support or require transaction flow.</span></span>  
  
 <span data-ttu-id="db3a3-212">Kontrolní výrazy zásad toku transakce ovlivňují tok transakce určením hlaviček SOAP, které by měl klient odeslat službě, aby představovala transakci.</span><span class="sxs-lookup"><span data-stu-id="db3a3-212">Transaction flow policy assertions affect transaction flow by specifying the SOAP headers that a client should send to a service to represent a transaction.</span></span> <span data-ttu-id="db3a3-213">Všechna záhlaví transakcí musí být označena `MustUnderstand` atributem `true`EQUAL.</span><span class="sxs-lookup"><span data-stu-id="db3a3-213">All transaction headers must be marked with `MustUnderstand` equal to `true`.</span></span> <span data-ttu-id="db3a3-214">Jakákoli zpráva s záhlavím označeným jinak je odmítnuta s chybou protokolu SOAP.</span><span class="sxs-lookup"><span data-stu-id="db3a3-214">Any message with a header marked otherwise is rejected with a SOAP fault.</span></span>  
  
 <span data-ttu-id="db3a3-215">V rámci jedné operace může být k dispozici pouze jeden kontrolní výraz zásad souvisejících s transakcí.</span><span class="sxs-lookup"><span data-stu-id="db3a3-215">Only one transaction-related policy assertion can be present on a single operation.</span></span> <span data-ttu-id="db3a3-216">Dokumenty zásad s více než jedním kontrolním výrazem transakce u operace jsou považovány za neplatné a WCF je odmítne.</span><span class="sxs-lookup"><span data-stu-id="db3a3-216">Policy documents with more than one transaction assertion on an operation are considered invalid and are rejected by WCF.</span></span> <span data-ttu-id="db3a3-217">Kromě toho může být v každém typu portu přítomen pouze jeden transakční protokol.</span><span class="sxs-lookup"><span data-stu-id="db3a3-217">In addition, only a single transaction protocol can be present inside each port type.</span></span> <span data-ttu-id="db3a3-218">Dokumenty zásad s operacemi odkazujícími na více než jeden transakční protokol v rámci jednoho typu portu jsou považovány za neplatné a jsou odmítnuty nástrojem pro nástroj pro dodávání [metadat (Svcutil. exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="db3a3-218">Policy documents with operations referencing more than one transaction protocol inside a single port type are considered invalid, and are rejected by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span> <span data-ttu-id="db3a3-219">Dokumenty zásad s kontrolními výrazy transakce, které jsou k dispozici pro výstupní zprávy nebo jednosměrné vstupní zprávy, jsou také považovány za neplatné.</span><span class="sxs-lookup"><span data-stu-id="db3a3-219">Policy documents with transaction assertions present on output messages or one-way input messages are also considered invalid.</span></span>
