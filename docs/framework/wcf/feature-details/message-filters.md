---
title: Filtry zpráv
ms.date: 03/30/2017
helpviewer_keywords:
- routing [WCF], message filters
ms.assetid: cb33ba49-8b1f-4099-8acb-240404a46d9a
ms.openlocfilehash: fc4656a76894eb3a844bc9f2187847fd9eff0ffe
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "61785993"
---
# <a name="message-filters"></a><span data-ttu-id="b6b7a-102">Filtry zpráv</span><span class="sxs-lookup"><span data-stu-id="b6b7a-102">Message Filters</span></span>
<span data-ttu-id="b6b7a-103">K implementaci, směrování na základě obsahu, směrovací služba používá <xref:System.ServiceModel.Dispatcher.MessageFilter> implementace, které kontrolovat určité části zprávy, jako je například adresu, název koncového bodu nebo konkrétní příkaz XPath.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-103">To implement content-based routing, the Routing Service uses <xref:System.ServiceModel.Dispatcher.MessageFilter> implementations that inspect specific sections of a message, such as the address, endpoint name, or a specific XPath statement.</span></span> <span data-ttu-id="b6b7a-104">Pokud žádné filtry zpráv součástí [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] vašim potřebám, můžete vytvořit vlastní filtr tak, že vytvoříte novou implementaci základní třídy <xref:System.ServiceModel.Dispatcher.MessageFilter> třídy.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-104">If none of the message filters provided with [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] meet your needs, you can create a custom filter by creating a new implementation of the base <xref:System.ServiceModel.Dispatcher.MessageFilter> class.</span></span>  
  
 <span data-ttu-id="b6b7a-105">Při konfiguraci služby směrování, je nutné definovat prvků filtru (<xref:System.ServiceModel.Routing.Configuration.FilterElement> objekty), které popisují typ **MessageFilter** a všechny podpůrné data požadovaná k vytvoření filtru, například konkrétní řetězec hodnoty pro hledání pro v rámci zprávy.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-105">When configuring the Routing Service, you must define filter elements (<xref:System.ServiceModel.Routing.Configuration.FilterElement> objects) that describe the type of **MessageFilter** and any supporting data required to create the filter, such as specific string values to search for within the message.</span></span> <span data-ttu-id="b6b7a-106">Všimněte si, že vytváření prvků filtr definuje pouze filtry jednotlivých zpráv; použití filtrů k vyhodnocení a směrování zpráv, musíte také definovat tabulku filtru (<xref:System.ServiceModel.Routing.Configuration.FilterTableEntryCollection>).</span><span class="sxs-lookup"><span data-stu-id="b6b7a-106">Note that creating the filter elements only defines the individual message filters; to use the filters to evaluate and route messages you must also define a filter table (<xref:System.ServiceModel.Routing.Configuration.FilterTableEntryCollection>).</span></span>  
  
 <span data-ttu-id="b6b7a-107">Každý záznam v tabulce filtrů odkazuje na element filtr a Určuje koncový bod klienta, který zpráva bude směrován do zpráva odpovídá filtru.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-107">Each entry in the filter table references a filter element and specifies the client endpoint that a message will be routed to if the message matches the filter.</span></span> <span data-ttu-id="b6b7a-108">Filtrovat položky tabulky také umožňují zadat kolekce zálohování koncových bodů (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>), která definuje seznam koncových bodů, které zprávy budou předány v případě selhání přenosu při odesílání na primární koncový bod.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-108">The filter table entries also allow you to specify a collection of backup endpoints (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>), which defines a list of endpoints that the message will be transmitted to in the event of a transmission failure when sending to the primary endpoint.</span></span> <span data-ttu-id="b6b7a-109">Tyto koncové body, vyzkouší se v uvedeném pořadí, dokud jeden neuspěje.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-109">These endpoints will be tried in the order specified until one succeeds.</span></span>  
  
## <a name="message-filters"></a><span data-ttu-id="b6b7a-110">Filtry zpráv</span><span class="sxs-lookup"><span data-stu-id="b6b7a-110">Message Filters</span></span>  
 <span data-ttu-id="b6b7a-111">Filtry zpráv používá služba Směrování poskytují společné funkce výběru zprávy, například vyhodnocení názvu koncového bodu, který na akce SOAP, nebo adresu nebo předponu adresy, která byla zaslána zpráva byla odeslána zpráva.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-111">The message filters used by the Routing Service provide common message selection functionality, such as evaluating the name of the endpoint that a message was sent to, the SOAP action, or the address or address prefix that the message was sent to.</span></span> <span data-ttu-id="b6b7a-112">Filtry lze také připojit se `AND` podmínky tak, aby se zprávy budou směrovány pouze na koncový bod, pokud zpráva odpovídá oba filtry.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-112">Filters can also be joined with an `AND` condition, so that messages will only be routed to an endpoint if the message matches both filters.</span></span> <span data-ttu-id="b6b7a-113">Můžete také vytvořit vlastní filtry tak, že vytvoříte vlastní implementace <xref:System.ServiceModel.Dispatcher.MessageFilter>.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-113">You can also create custom filters by creating your own implementation of <xref:System.ServiceModel.Dispatcher.MessageFilter>.</span></span>  
  
 <span data-ttu-id="b6b7a-114">Následující tabulce jsou uvedeny <xref:System.ServiceModel.Routing.Configuration.FilterType> využívané ve službě Směrování třídy, která implementuje konkrétní zprávu filtr a požadované <xref:System.ServiceModel.Routing.Configuration.FilterElement.FilterData%2A> parametry.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-114">The following table lists the <xref:System.ServiceModel.Routing.Configuration.FilterType> used by the Routing Service, the class that implements the specific message filter, and the required <xref:System.ServiceModel.Routing.Configuration.FilterElement.FilterData%2A> parameters.</span></span>  
  
|<span data-ttu-id="b6b7a-115">Typ filtru</span><span class="sxs-lookup"><span data-stu-id="b6b7a-115">Filter  Type</span></span>|<span data-ttu-id="b6b7a-116">Popis</span><span class="sxs-lookup"><span data-stu-id="b6b7a-116">Description</span></span>|<span data-ttu-id="b6b7a-117">Filtrovat podle Data</span><span class="sxs-lookup"><span data-stu-id="b6b7a-117">Filter Data Meaning</span></span>|<span data-ttu-id="b6b7a-118">Příklad filtru</span><span class="sxs-lookup"><span data-stu-id="b6b7a-118">Example Filter</span></span>|  
|------------------|-----------------|-------------------------|--------------------|  
|<span data-ttu-id="b6b7a-119">Akce</span><span class="sxs-lookup"><span data-stu-id="b6b7a-119">Action</span></span>|<span data-ttu-id="b6b7a-120">Používá <xref:System.ServiceModel.Dispatcher.ActionMessageFilter> třídy tak, aby odpovídaly zpráv obsahujících určité akce.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-120">Uses the <xref:System.ServiceModel.Dispatcher.ActionMessageFilter> class to match messages containing a specific action.</span></span>|<span data-ttu-id="b6b7a-121">Akce, který se má filtrovat.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-121">The action to filter upon.</span></span>|<span data-ttu-id="b6b7a-122">\<filter name="action1" filterType="Action" filterData="http://namespace/contract/operation" /></span><span class="sxs-lookup"><span data-stu-id="b6b7a-122">\<filter name="action1" filterType="Action" filterData="http://namespace/contract/operation" /></span></span>|  
|<span data-ttu-id="b6b7a-123">EndpointAddress</span><span class="sxs-lookup"><span data-stu-id="b6b7a-123">EndpointAddress</span></span>|<span data-ttu-id="b6b7a-124">Používá <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter> třídy s <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter.IncludeHostNameInComparison%2A>  ==  `true` tak, aby odpovídaly zprávy obsahující konkrétní adresu.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-124">Uses the <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter> class, with <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter.IncludeHostNameInComparison%2A> == `true` to match messages containing a specific address.</span></span>|<span data-ttu-id="b6b7a-125">Adresa chcete filtrovat (v záhlaví Komu).</span><span class="sxs-lookup"><span data-stu-id="b6b7a-125">The address to filter upon (in the To header).</span></span>|<span data-ttu-id="b6b7a-126">\<filter name="address1" filterType="EndpointAddress" filterData="http://host/vdir/s.svc/b"  /></span><span class="sxs-lookup"><span data-stu-id="b6b7a-126">\<filter name="address1" filterType="EndpointAddress" filterData="http://host/vdir/s.svc/b"  /></span></span>|  
|<span data-ttu-id="b6b7a-127">EndpointAddressPrefix</span><span class="sxs-lookup"><span data-stu-id="b6b7a-127">EndpointAddressPrefix</span></span>|<span data-ttu-id="b6b7a-128">Používá <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter> třídy s <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter.IncludeHostNameInComparison%2A>  ==  `true` tak, aby odpovídaly zprávy obsahující předponu konkrétní adresu.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-128">Uses the <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter> class, with <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter.IncludeHostNameInComparison%2A> == `true` to match messages containing a specific address prefix.</span></span>|<span data-ttu-id="b6b7a-129">Adresa pro filtrování při použití nejdelší odpovídající předpona.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-129">The address to filter upon using longest prefix matching.</span></span>|<span data-ttu-id="b6b7a-130">\<filter name="prefix1" filterType="EndpointAddressPrefix" filterData="http://host/" /></span><span class="sxs-lookup"><span data-stu-id="b6b7a-130">\<filter name="prefix1" filterType="EndpointAddressPrefix" filterData="http://host/" /></span></span>|  
|<span data-ttu-id="b6b7a-131">A</span><span class="sxs-lookup"><span data-stu-id="b6b7a-131">And</span></span>|<span data-ttu-id="b6b7a-132">Používá <xref:System.ServiceModel.Dispatcher.StrictAndMessageFilter> třídu, která se vždycky vyhodnotí jako obě podmínky před vrácením.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-132">Uses the <xref:System.ServiceModel.Dispatcher.StrictAndMessageFilter> class that always evaluates both conditions before returning.</span></span>|<span data-ttu-id="b6b7a-133">fulltextových dat filtru se nepoužívá; Místo toho Filtr1 a Filtr2 mají názvy odpovídající filtry zpráv (také v tabulce), které by měly být **a**ed společně.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-133">filterData is not used; instead filter1 and filter2 have the names of the corresponding message filters (also in the table), which should be **AND**ed together.</span></span>|<span data-ttu-id="b6b7a-134">\<filter name="and1" filterType="And" filter1="address1" filter2="action1" /></span><span class="sxs-lookup"><span data-stu-id="b6b7a-134">\<filter name="and1" filterType="And" filter1="address1" filter2="action1" /></span></span>|  
|<span data-ttu-id="b6b7a-135">Vlastní</span><span class="sxs-lookup"><span data-stu-id="b6b7a-135">Custom</span></span>|<span data-ttu-id="b6b7a-136">Uživatelem definovaný typ, který rozšiřuje <xref:System.ServiceModel.Dispatcher.MessageFilter> třídy a má konstruktor, který přebírá řetězec.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-136">A user-defined type that extends the <xref:System.ServiceModel.Dispatcher.MessageFilter> class and has a constructor taking a string.</span></span>|<span data-ttu-id="b6b7a-137">Název plně kvalifikovaný typ třídy k vytvoření; je customtype – atribut fulltextových dat filtru je řetězec, který má předat konstruktoru při vytváření filtru.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-137">The customType attribute is the fully qualified type name of the class to create; filterData is the string to pass to the constructor when creating the filter.</span></span>|<span data-ttu-id="b6b7a-138">\<filter name="custom1" filterType="Custom" customType="CustomAssembly.CustomMsgFilter, CustomAssembly" filterData="Custom Data" /></span><span class="sxs-lookup"><span data-stu-id="b6b7a-138">\<filter name="custom1" filterType="Custom" customType="CustomAssembly.CustomMsgFilter, CustomAssembly" filterData="Custom Data" /></span></span>|  
|<span data-ttu-id="b6b7a-139">EndpointName</span><span class="sxs-lookup"><span data-stu-id="b6b7a-139">EndpointName</span></span>|<span data-ttu-id="b6b7a-140">Používá <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter> třídy tak, aby odpovídaly zprávy na základě názvu koncového bodu služby se dostali na.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-140">Uses the <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter> class to match messages based on the name of the service endpoint they arrived on.</span></span>|<span data-ttu-id="b6b7a-141">Název koncového bodu služby, například: "serviceEndpoint1".</span><span class="sxs-lookup"><span data-stu-id="b6b7a-141">The name of the service endpoint, for example: "serviceEndpoint1".</span></span>  <span data-ttu-id="b6b7a-142">To by měl být jeden z koncových bodů zveřejněné na směrovací služba.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-142">This should be one of the endpoints exposed on the Routing Service.</span></span>|<span data-ttu-id="b6b7a-143">\<filter name="stock1" filterType="Endpoint" filterData="SvcEndpoint" /></span><span class="sxs-lookup"><span data-stu-id="b6b7a-143">\<filter name="stock1" filterType="Endpoint" filterData="SvcEndpoint" /></span></span>|  
|<span data-ttu-id="b6b7a-144">MatchAll</span><span class="sxs-lookup"><span data-stu-id="b6b7a-144">MatchAll</span></span>|<span data-ttu-id="b6b7a-145">Používá <xref:System.ServiceModel.Dispatcher.MatchAllMessageFilter> třídy.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-145">Uses the <xref:System.ServiceModel.Dispatcher.MatchAllMessageFilter> class.</span></span> <span data-ttu-id="b6b7a-146">Tento filtr odpovídá všechny příchozí zprávy.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-146">This filter matches all arriving messages.</span></span>|<span data-ttu-id="b6b7a-147">fulltextových dat filtru se nepoužívá.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-147">filterData is not used.</span></span> <span data-ttu-id="b6b7a-148">Tento filtr bude vždy odpovídat všechny zprávy.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-148">This filter will always match all messages.</span></span>|<span data-ttu-id="b6b7a-149">\<Název filtru = filterType "matchAll1" = "MatchAll" / ></span><span class="sxs-lookup"><span data-stu-id="b6b7a-149">\<filter name="matchAll1" filterType="MatchAll" /></span></span>|  
|<span data-ttu-id="b6b7a-150">XPath</span><span class="sxs-lookup"><span data-stu-id="b6b7a-150">XPath</span></span>|<span data-ttu-id="b6b7a-151">Používá <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> třídy tak, aby odpovídaly určité dotazy XPath v něm.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-151">Uses the <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> class to match specific XPath queries within the message.</span></span>|<span data-ttu-id="b6b7a-152">Dotaz XPath, který se má použít při přiřazování zpráv.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-152">The XPath query to use when matching messages.</span></span>|<span data-ttu-id="b6b7a-153">\<filter name="XPath1" filterType="XPath" filterData="//ns:element" /></span><span class="sxs-lookup"><span data-stu-id="b6b7a-153">\<filter name="XPath1" filterType="XPath" filterData="//ns:element" /></span></span>|  
  
 <span data-ttu-id="b6b7a-154">Následující příklad definuje filtr položky, které používají filtry XPath, Název_koncového_bodu a PrefixEndpointAddress zpráv.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-154">The following example defines filter entries that use the XPath, EndpointName, and PrefixEndpointAddress message filters.</span></span> <span data-ttu-id="b6b7a-155">Tento příklad také znázorňuje použití vlastního filtru pro RoundRobinFilter1 a RoundRobinFilter2 položky.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-155">This example also demonstrates using a custom filter for the RoundRobinFilter1 and RoundRobinFilter2 entries.</span></span>  
  
```xml  
<filters>  
     <filter name="XPathFilter" filterType="XPath"   
             filterData="/s12:Envelope/s12:Header/custom:RoundingCalculator = 1"/>  
     <filter name="EndpointNameFilter" filterType="EndpointName"   
             filterData="calculatorEndpoint"/>  
     <filter name="PrefixAddressFilter" filterType="PrefixEndpointAddress"   
             filterData="http://localhost/routingservice/router/rounding/"/>  
     <filter name="RoundRobinFilter1" filterType="Custom"   
             customType="RoutingServiceFilters.RoundRobinMessageFilter,   
             RoutingService" filterData="group1"/>  
     <filter name="RoundRobinFilter2" filterType="Custom"   
             customType="RoutingServiceFilters.RoundRobinMessageFilter,   
             RoutingService" filterData="group1"/>  
</filters>  
```  
  
> [!NOTE]
>  <span data-ttu-id="b6b7a-156">Jednoduše definuje filtr nezpůsobí zprávy má být porovnán s filtru.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-156">Simply defining a filter does not cause messages to be evaluated against the filter.</span></span> <span data-ttu-id="b6b7a-157">Filtr musí být přidané do tabulky filtru, který je přidružený k koncový bod služby, vystavený službou směrování.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-157">The filter must be added to a filter table, which is then associated with the service endpoint exposed by the Routing Service.</span></span>  
  
### <a name="namespace-table"></a><span data-ttu-id="b6b7a-158">Namespace tabulky</span><span class="sxs-lookup"><span data-stu-id="b6b7a-158">Namespace Table</span></span>  
 <span data-ttu-id="b6b7a-159">Pokud používáte filtr XPath, může být příliš velké vzhledem k použití oborů názvů filtrování dat, která obsahuje dotaz XPath.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-159">When using an XPath filter, the filter data that contains the XPath query can become extremely large due to the use of namespaces.</span></span> <span data-ttu-id="b6b7a-160">Ke zmírnění tohoto problému směrovací služby umožňuje definovat vlastní předpony oboru názvů pomocí oboru názvů tabulek.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-160">To alleviate this problem the Routing Service provides the ability to define your own namespace prefixes by using the namespace table.</span></span>  
  
 <span data-ttu-id="b6b7a-161">Obor názvů tabulky je kolekce <xref:System.ServiceModel.Routing.Configuration.NamespaceElement> objekty, které definuje předpony oboru názvů pro běžné obory názvů, který lze použít v XPath.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-161">The namespace table is a collection of <xref:System.ServiceModel.Routing.Configuration.NamespaceElement> objects that defines the namespace prefixes for common namespaces that can be used in an XPath.</span></span> <span data-ttu-id="b6b7a-162">Toto jsou výchozí obory názvů a obor názvů předpony, které jsou obsaženy v tabulce oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-162">The following are the default namespaces and namespace prefixes that are contained in the namespace table.</span></span>  
  
|<span data-ttu-id="b6b7a-163">Předpona</span><span class="sxs-lookup"><span data-stu-id="b6b7a-163">Prefix</span></span>|<span data-ttu-id="b6b7a-164">Obor názvů</span><span class="sxs-lookup"><span data-stu-id="b6b7a-164">Namespace</span></span>|  
|------------|---------------|  
|<span data-ttu-id="b6b7a-165">s11</span><span class="sxs-lookup"><span data-stu-id="b6b7a-165">s11</span></span>|`http://schemas.xmlsoap.org/soap/envelope`|  
|<span data-ttu-id="b6b7a-166">s12</span><span class="sxs-lookup"><span data-stu-id="b6b7a-166">s12</span></span>|`http://www.w3.org/2003/05/soap-envelope`|  
|<span data-ttu-id="b6b7a-167">wsaAugust2004</span><span class="sxs-lookup"><span data-stu-id="b6b7a-167">wsaAugust2004</span></span>|`http://schemas.xmlsoap.org/ws/2004/08/addressing`|  
|<span data-ttu-id="b6b7a-168">wsa10</span><span class="sxs-lookup"><span data-stu-id="b6b7a-168">wsa10</span></span>|`http://www.w3.org/2005/08/addressing`|  
|<span data-ttu-id="b6b7a-169">sm</span><span class="sxs-lookup"><span data-stu-id="b6b7a-169">sm</span></span>|`http://schemas.microsoft.com/serviceModel/2004/05/xpathfunctions`|  
|<span data-ttu-id="b6b7a-170">tempuri</span><span class="sxs-lookup"><span data-stu-id="b6b7a-170">tempuri</span></span>|`http://tempuri.org`|  
|<span data-ttu-id="b6b7a-171">ser</span><span class="sxs-lookup"><span data-stu-id="b6b7a-171">ser</span></span>|`http://schemas.microsoft.com/2003/10/Serialization`|  
  
 <span data-ttu-id="b6b7a-172">Pokud víte, že budete používat konkrétní obor názvů v dotazech XPath, můžete ho přidat do oboru názvů tabulek spolu s předponu oboru názvů jedinečný a použijte předponu každého dotazu XPath místo úplné oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-172">When you know that you will be using a specific namespace in your XPath queries, you can add it to the namespace table along with a unique namespace prefix and use the prefix in any XPath query instead of the full namespace.</span></span> <span data-ttu-id="b6b7a-173">Následující příklad definuje předponu "vlastní" pro obor názvů `"http://my.custom.namespace"`, které se pak použije obsažená v fulltextových dat filtru dotazu XPath.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-173">The following example defines a prefix of "custom" for the namespace `"http://my.custom.namespace"`, which is then used in the XPath query contained in filterData.</span></span>  
  
```xml  
<namespaceTable>  
     <add prefix="custom" namespace="http://my.custom.namespace/"/>  
</namespaceTable>  
<filters>  
     <filter name="XPathFilter" filterType="XPath" filterData="/s12:Envelope/s12:Header/custom:RoundingCalculator = 1"/>  
</filters>  
```  
  
## <a name="filter-tables"></a><span data-ttu-id="b6b7a-174">Filtr tabulky</span><span class="sxs-lookup"><span data-stu-id="b6b7a-174">Filter Tables</span></span>  
 <span data-ttu-id="b6b7a-175">Zatímco každý prvek filtr definuje logické porovnání, který lze použít na zprávu, tabulky filtru poskytuje přidružení mezi prvkem filtr a cílový koncový bod klienta.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-175">While each filter element defines a logical comparison that can be applied to a message, the filter table provides the association between the filter element and the destination client endpoint.</span></span> <span data-ttu-id="b6b7a-176">Filtr tabulky je soubor s názvem <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement> objekty, které definují přidružení mezi filtr koncovým bodem v cílové primární a seznam alternativní koncové body záloh.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-176">A filter table is a named collection of <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement> objects that define the association between a filter, a primary destination endpoint, and a list of alternative backup endpoints.</span></span> <span data-ttu-id="b6b7a-177">Filtrovat položky tabulky také umožňují určit volitelné prioritu pro každou podmínku filtru.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-177">The filter table entries also allow you to specify an optional priority for each filter condition.</span></span> <span data-ttu-id="b6b7a-178">Následující příklad definuje dva filtry a pak definuje filtr tabulku, která se přidruží koncový bod cílové každého filtru.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-178">The following example defines two filters and then defines a filter table that associates each filter with a destination endpoint.</span></span>  
  
```xml  
<routing>  
     <filters>  
       <filter name="AddAction" filterType="Action" filterData="Add" />  
       <filter name="SubtractAction" filterType="Action" filterData="Subtract" />  
     </filters>  
     <filterTables>  
       <table name="routingTable1">  
         <filters>  
           <add filterName="AddAction" endpointName="Addition" />  
           <add filterName="SubtractAction" endpointName="Subtraction" />  
         </filters>  
       </table>  
     </filterTables>      
</routing>  
```  
  
### <a name="filter-evaluation-priority"></a><span data-ttu-id="b6b7a-179">Priorita vyhodnocení filtru</span><span class="sxs-lookup"><span data-stu-id="b6b7a-179">Filter Evaluation Priority</span></span>  
 <span data-ttu-id="b6b7a-180">Ve výchozím nastavení všechny položky v tabulce filtrů jsou vyhodnoceny současně a zpráva právě vyhodnocuje se směruje do koncových bodů spojené s každou položku odpovídající filtr.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-180">By default, all entries in the filter table are evaluated simultaneously, and the message being evaluated is routed to the endpoint(s) associated with each matching filter entry.</span></span> <span data-ttu-id="b6b7a-181">Pokud mají více filtrů `true`a zpráva je jednosměrné nebo obousměrné je zprávy vícesměrového vysílání do koncových bodů pro všechny odpovídající filtry.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-181">If multiple filters evaluate to `true`, and the message is one-way or duplex, the message is multicast to the endpoints for all matching filters.</span></span> <span data-ttu-id="b6b7a-182">Zprávy požadavek odpověď nemůže být vícesměrového vysílání, protože pouze jednu odpověď může být vrácen do klienta.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-182">Request-reply messages cannot be multicast because only one reply can be returned to the client.</span></span>  
  
 <span data-ttu-id="b6b7a-183">Složitější logiku směrování lze provést zadáním úrovně priority u každého filtru. Směrovací služba nejdřív vyhodnotí všechny filtry na úrovni nejvyšší prioritou.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-183">More complex routing logic can be implemented by specifying priority levels for each filter; the Routing Service evaluates all filters at the highest priority level first.</span></span> <span data-ttu-id="b6b7a-184">Pokud zpráva odpovídá filtru této úrovně, se zpracovávají žádné filtry s nižší prioritou.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-184">If a message matches a filter of this level, no filters of a lower priority are processed.</span></span> <span data-ttu-id="b6b7a-185">Například jednosměrný příchozí zprávy nejprve vyhodnotí oproti všechny filtry s prioritou 2.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-185">For example, an incoming one-way message is first evaluated against all filters with a priority of 2.</span></span> <span data-ttu-id="b6b7a-186">Zprávy se neshoduje s libovolný filtr na této úrovni prioritu, proto vám teď že zprávy se porovná s filtry s prioritou 1.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-186">The message does not match any filter at this priority level, so next the message is compared against filters with a priority of 1.</span></span> <span data-ttu-id="b6b7a-187">Dva filtry priority 1 odpovídat zprávu, a protože je jednosměrná zpráva se směruje do obou cílové koncové body.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-187">Two priority 1 filters match the message, and because it is a one-way message it is routed to both destination endpoints.</span></span>  <span data-ttu-id="b6b7a-188">Protože byla nalezena shoda mezi filtry priority 1, jsou vyhodnocovány žádné filtry prioritu 0.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-188">Because a match was found among the priority 1 filters, no filters of priority 0 are evaluated.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b6b7a-189">Pokud není zadána žádná priorita, použije se výchozí prioritu 0.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-189">If no priority is specified, the default priority of 0 is used.</span></span>  
  
 <span data-ttu-id="b6b7a-190">Následující příklad definuje filtr tabulku, která určuje priority 2 a 1, 0 pro filtry odkazuje v tabulce.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-190">The following example defines a filter table that specifies priorities of 2, 1, and 0 for the filters referenced in the table.</span></span>  
  
```xml  
<filterTables>  
     <filterTable name="filterTable1">  
          <add filterName="XPathFilter" endpointName="roundingCalcEndpoint"   
               priority="2"/>  
          <add filterName="EndpointNameFilter" endpointName="regularCalcEndpoint"   
               priority="1"/>  
          <add filterName="PrefixAddressFilter" endpointName="roundingCalcEndpoint"   
               priority="1"/>  
          <add filterName="MatchAllMessageFilter" endpointName="defaultCalcEndpoint"   
               priority="0"/>  
     </filterTable>  
</filterTables>  
```  
  
 <span data-ttu-id="b6b7a-191">V předchozím příkladu Pokud zpráva odpovídá Třída XPathFilter, bude směrována roundingCalcEndpoint a žádné další filtry. v tabulce se vyhodnotit, protože se všemi ostatními filtry s nižší prioritou.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-191">In the preceding example, if a message matches the XPathFilter, it will be routed to the roundingCalcEndpoint and no further filters in the table will be evaluated because all other filters are of a lower priority.</span></span> <span data-ttu-id="b6b7a-192">Ale pokud zprávy neodpovídá Třída XPathFilter ho pak se vyhodnotí pro všechny filtry další nižší prioritou EndpointNameFilter a PrefixAddressFilter.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-192">However, if the message does not match the XPathFilter it will then be evaluated against all filters of the next lower priority, EndpointNameFilter and PrefixAddressFilter.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b6b7a-193">Pokud je to možné, používejte filtry exkluzivní místo určení prioritu, protože vyhodnocení priority může způsobit snížení výkonu.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-193">When possible, use exclusive filters instead of specifying a priority because priority evaluation can result in performance degradation.</span></span>  
  
### <a name="backup-lists"></a><span data-ttu-id="b6b7a-194">Zálohování seznamy</span><span class="sxs-lookup"><span data-stu-id="b6b7a-194">Backup Lists</span></span>  
 <span data-ttu-id="b6b7a-195">Každý filtr v tabulce filtrů můžete volitelně zadat záložní seznam, který je pojmenovaná kolekce koncových bodů (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>).</span><span class="sxs-lookup"><span data-stu-id="b6b7a-195">Each filter in the filter table can optionally specify a backup list, which is a named collection of endpoints (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>).</span></span> <span data-ttu-id="b6b7a-196">Tato kolekce obsahuje uspořádaný seznam koncových bodů, které zprávy se dá přenést k v <xref:System.ServiceModel.CommunicationException> při odesílání do primárního koncového bodu určeného v <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement.EndpointName%2A>.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-196">This collection contains an ordered list of endpoints that the message will be transmitted to in the event of a <xref:System.ServiceModel.CommunicationException> when sending to the primary endpoint specified in <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement.EndpointName%2A>.</span></span> <span data-ttu-id="b6b7a-197">Následující příklad definuje záložní seznam s názvem "backupServiceEndpoints", který obsahuje dva koncové body.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-197">The following example defines a backup list named "backupServiceEndpoints" that contains two endpoints.</span></span>  
  
```xml  
<filterTables>  
     <filterTable name="filterTable1">  
          <add filterName="MatchAllFilter1" endpointName="Destination" backupList="backupEndpointList"/>  
     </filterTable>  
</filterTables>  
<backupLists>  
     <backupList name="backupEndpointList">  
          <add endpointName="backupServiceQueue" />  
          <add endpointName="alternateServiceQueue" />  
     </backupList>  
</backupLists>  
```  
  
 <span data-ttu-id="b6b7a-198">V předchozím příkladu, pokud se nepodaří odeslat na primární koncový bod "Cíl", směrovací služba zkusí odesílání do každého koncového bodu v pořadí, v jakém jsou uvedeny, první odesílání backupServiceQueue a následně odesláním do alternateServiceQueue, pokud Odeslat backupServiceQueue selže.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-198">In the preceding example, if a send to the primary endpoint "Destination" fails, the Routing Service will try sending to each endpoint in the sequence they are listed, first sending to backupServiceQueue and subsequently sending to alternateServiceQueue if the send to backupServiceQueue fails.</span></span> <span data-ttu-id="b6b7a-199">Pokud selžou i všechny koncové body pro zálohování, je vrácena chyba.</span><span class="sxs-lookup"><span data-stu-id="b6b7a-199">If all backup endpoints fail, a fault is returned.</span></span>
