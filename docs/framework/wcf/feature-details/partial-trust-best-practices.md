---
title: Doporučené postupy s částečnou důvěryhodností
ms.date: 03/30/2017
ms.assetid: 0d052bc0-5b98-4c50-8bb5-270cc8a8b145
ms.openlocfilehash: c83c36020cfd5b41e99ff9eeb7968d0b5df909a6
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/08/2019
ms.locfileid: "59184077"
---
# <a name="partial-trust-best-practices"></a><span data-ttu-id="c5cc7-102">Doporučené postupy s částečnou důvěryhodností</span><span class="sxs-lookup"><span data-stu-id="c5cc7-102">Partial Trust Best Practices</span></span>
<span data-ttu-id="c5cc7-103">Toto téma popisuje osvědčené postupy při spuštění Windows Communication Foundation (WCF) v prostředí s částečnou důvěryhodností.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-103">This topic describes best practices when running Windows Communication Foundation (WCF) in a partial trust environment.</span></span>  
  
## <a name="serialization"></a><span data-ttu-id="c5cc7-104">Serializace</span><span class="sxs-lookup"><span data-stu-id="c5cc7-104">Serialization</span></span>  
 <span data-ttu-id="c5cc7-105">Použijte následující postupy při používání <xref:System.Runtime.Serialization.DataContractSerializer> v částečně důvěryhodné aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-105">Apply the following practices when using the <xref:System.Runtime.Serialization.DataContractSerializer> in a partially-trusted application.</span></span>  
  
-   <span data-ttu-id="c5cc7-106">Všechny Serializovatelné typy musí být explicitně označeny pomocí `[DataContract]` atribut.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-106">All serializable types must be explicitly marked with the `[DataContract]` attribute.</span></span> <span data-ttu-id="c5cc7-107">V prostředí s částečnou důvěryhodností nejsou podporovány následující techniky:</span><span class="sxs-lookup"><span data-stu-id="c5cc7-107">The following techniques are not supported in a partial trust environment:</span></span>  
  
-   <span data-ttu-id="c5cc7-108">Označení tříd Dal serializovat s příznakem <xref:System.SerializableAttribute>.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-108">Marking classes to be serialized with the <xref:System.SerializableAttribute>.</span></span>  
  
-   <span data-ttu-id="c5cc7-109">Implementace <xref:System.Runtime.Serialization.ISerializable> rozhraní umožňující třídy řídit její procesu serializace.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-109">Implementing the <xref:System.Runtime.Serialization.ISerializable> interface to allow a class to control its serialization process.</span></span>  
  
### <a name="using-datacontractserializer"></a><span data-ttu-id="c5cc7-110">Pomocí třídy DataContractSerializer</span><span class="sxs-lookup"><span data-stu-id="c5cc7-110">Using DataContractSerializer</span></span>  
  
-   <span data-ttu-id="c5cc7-111">Všechny typy označeny pomocí `[DataContract]` atribut musí být veřejné.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-111">All types marked with the `[DataContract]` attribute must be public.</span></span> <span data-ttu-id="c5cc7-112">Neveřejné typy nejde serializovat v částečném vztahu důvěryhodnosti prostředí.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-112">Non-public types cannot be serialized in a partial trust environment.</span></span>  
  
-   <span data-ttu-id="c5cc7-113">Všechny `[DataContract]` členy v serializovatelného `[DataContract]` typ musí být veřejný.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-113">All `[DataContract]` members in a serializable `[DataContract]` type must be public.</span></span> <span data-ttu-id="c5cc7-114">Typ se oprávnění neveřejné `[DataMember]` nejde serializovat v částečném vztahu důvěryhodnosti prostředí.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-114">A type with a non-public `[DataMember]` cannot be serialized in a partial trust environment.</span></span>  
  
-   <span data-ttu-id="c5cc7-115">Metody, které zpracovávají události serializace (například `OnSerializing`, `OnSerialized`, `OnDeserializing`, a `OnDeserialized`) musí být deklarován jako veřejná.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-115">Methods that handle serialization events (such as `OnSerializing`, `OnSerialized`, `OnDeserializing`, and `OnDeserialized`) must be declared as public.</span></span> <span data-ttu-id="c5cc7-116">Ale implementace explicitního a implicitního <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%28System.Object%29> jsou podporovány.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-116">However, both explicit and implicit implementations of <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%28System.Object%29> are supported.</span></span>  
  
-   `[DataContract]` <span data-ttu-id="c5cc7-117">typy, které jsou implementované v sestavení označená pomocí <xref:System.Security.AllowPartiallyTrustedCallersAttribute> nesmí provádět akce související se zabezpečením v konstruktoru typu, jako <xref:System.Runtime.Serialization.DataContractSerializer> nevolá konstruktor objektu nově vytvořena při deserializaci.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-117">types implemented in assemblies marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> must not perform security-related actions in the type constructor, as the <xref:System.Runtime.Serialization.DataContractSerializer> does not call the constructor of the newly-instantiated object during deserialization.</span></span> <span data-ttu-id="c5cc7-118">Konkrétně, je třeba se vyhnout následující běžné postupy zabezpečení pro `[DataContract]` typy:</span><span class="sxs-lookup"><span data-stu-id="c5cc7-118">Specifically, the following common security techniques must be avoided for `[DataContract]` types:</span></span>  
  
-   <span data-ttu-id="c5cc7-119">Probíhá pokus o omezit částečným vztahem důvěryhodnosti přístup tím, že konstruktor typu interní nebo privátní.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-119">Attempting to restrict partial trust access by making the type's constructor internal or private.</span></span>  
  
-   <span data-ttu-id="c5cc7-120">Omezení přístupu k typu tak, že přidáte `[LinkDemand]` konstruktoru typu.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-120">Restricting access to the type by adding a `[LinkDemand]` to the type's constructor.</span></span>  
  
-   <span data-ttu-id="c5cc7-121">Za předpokladu, že vzhledem k tomu, že má byla úspěšně vytvořena instance objektu, mají všechny ověřovací kontroly vynucuje konstruktoru bylo úspěšné.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-121">Assuming that because the object has been successfully instantiated, any validation checks enforced by the constructor have passed successfully.</span></span>  
  
### <a name="using-ixmlserializable"></a><span data-ttu-id="c5cc7-122">Pomocí rozhraní IXmlSerializable</span><span class="sxs-lookup"><span data-stu-id="c5cc7-122">Using IXmlSerializable</span></span>  
 <span data-ttu-id="c5cc7-123">Použijte následující osvědčené postupy pro typy, které implementují <xref:System.Xml.Serialization.IXmlSerializable> a serializují pomocí <xref:System.Runtime.Serialization.DataContractSerializer>:</span><span class="sxs-lookup"><span data-stu-id="c5cc7-123">The following best practices apply for types that implement <xref:System.Xml.Serialization.IXmlSerializable> and are serialized using the <xref:System.Runtime.Serialization.DataContractSerializer>:</span></span>  
  
-   <span data-ttu-id="c5cc7-124"><xref:System.Xml.Serialization.IXmlSerializable.GetSchema%2A> Musí být statická metoda implementace `public`.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-124">The <xref:System.Xml.Serialization.IXmlSerializable.GetSchema%2A> static method implementations must be `public`.</span></span>  
  
-   <span data-ttu-id="c5cc7-125">Instance metody, které implementují <xref:System.Xml.Serialization.IXmlSerializable> rozhraní musí být `public`.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-125">The instance methods that implement the <xref:System.Xml.Serialization.IXmlSerializable> interface must be `public`.</span></span>  
  
## <a name="using-wcf-from-fully-trusted-platform-code-that-allows-calls-from-partially-trusted-callers"></a><span data-ttu-id="c5cc7-126">Pomocí technologie WCF z plně důvěryhodné platformě kódu, který umožňuje volání od částečně důvěryhodné volající</span><span class="sxs-lookup"><span data-stu-id="c5cc7-126">Using WCF from Fully-Trusted Platform Code that Allows Calls from Partially Trusted Callers</span></span>  
 <span data-ttu-id="c5cc7-127">Model zabezpečení částečným vztahem důvěryhodnosti WCF se předpokládá, že jakýkoli volající této WCF veřejnou metodu nebo vlastnost běží v rámci kódu access security (CAS) hostitelské aplikace.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-127">The WCF partial trust security model assumes that any caller of a WCF public method or property is running in the code access security (CAS) context of the hosting application.</span></span> <span data-ttu-id="c5cc7-128">WCF také předpokládá tento kontext zabezpečení pouze jednu aplikaci existuje pro každý <xref:System.AppDomain>, a že tento kontext se stanoví při <xref:System.AppDomain> čas vytvoření důvěryhodný hostitel (například voláním <xref:System.AppDomain.CreateDomain%2A> nebo správcem aplikace technologie ASP.NET).</span><span class="sxs-lookup"><span data-stu-id="c5cc7-128">WCF also assumes that only one application security context exists for each <xref:System.AppDomain>, and that this context is established at <xref:System.AppDomain> creation time by a trusted host (for example, by a call to <xref:System.AppDomain.CreateDomain%2A> or by the ASP.NET Application Manager).</span></span>  
  
 <span data-ttu-id="c5cc7-129">Tento model zabezpečení se vztahuje na uživatelem zapsaný aplikace, které nelze uplatnit další oprávnění certifikační Autority, jako je například uživatelský kód spuštěný v aplikaci ASP.NET důvěřovat střední.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-129">This security model applies to user-written applications that cannot assert additional CAS permissions, such as user code running in a Medium Trust ASP.NET application.</span></span> <span data-ttu-id="c5cc7-130">Však musí kód platformy plně důvěryhodné (například sestavení třetích stran, která je nainstalována v globální mezipaměti sestavení a přijímá volání od částečně důvěryhodným kódem) postupujte opatrně explicitní při volání do WCF jménem částečně důvěryhodné aplikace Vyhýbejte se ohrožení zabezpečení na úrovni aplikace.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-130">However, fully-trusted platform code (for example, a third-party assembly that is installed in the global assembly cache and accepts calls from partially-trusted code) must take explicit care when calling into WCF on behalf of a partially-trusted application to avoid introducing application-level security vulnerabilities.</span></span>  
  
 <span data-ttu-id="c5cc7-131">Plně důvěryhodného kódu by měla neupravujte sada oprávnění CAS aktuálního vlákna (voláním <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, nebo <xref:System.Security.PermissionSet.Deny%2A>) před voláním rozhraní API pro WCF jménem částečně důvěryhodným kódem.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-131">Full-trust code should avoid altering the CAS permission set of the current thread (by calling <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, or <xref:System.Security.PermissionSet.Deny%2A>) prior to calling WCF APIs on behalf of partially-trusted code.</span></span> <span data-ttu-id="c5cc7-132">Uplatnění, zamítnutí nebo jinak vytvoření kontextu specifické pro vlákno oprávnění, která je nezávislá kontextu zabezpečení na úrovni aplikace může způsobit neočekávané chování.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-132">Asserting, denying, or otherwise creating a thread-specific permission context that is independent of the application-level security context can result in unexpected behavior.</span></span> <span data-ttu-id="c5cc7-133">V závislosti na aplikaci toto chování může vést k ohrožení zabezpečení na úrovni aplikace.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-133">Depending on the application, this behavior may result in application-level security vulnerabilities.</span></span>  
  
 <span data-ttu-id="c5cc7-134">Kód, který volá do WCF pomocí oprávnění specifické pro vlákno kontextu musí být připravena ke zpracování těchto situacích, které může způsobit:</span><span class="sxs-lookup"><span data-stu-id="c5cc7-134">Code that calls into WCF using a thread-specific permission context must be prepared to handle the following situations that may arise:</span></span>  
  
-   <span data-ttu-id="c5cc7-135">Kontext zabezpečení specifické pro vlákno nemusí být zachována po dobu trvání operace, což vede k potenciálním bezpečnostním výjimkám.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-135">The thread-specific security context may not be maintained for the duration of the operation, which results in potential security exceptions.</span></span>  
  
-   <span data-ttu-id="c5cc7-136">Vnitřní kód WCF, stejně jako všechny uživatelem zadaný zpětná volání může spustit v kontextu zabezpečení než ve kterém bylo původně zahájeno volání.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-136">Internal WCF code as well as any user-provided callbacks may run in a different security context than the one under which the call was originally initiated.</span></span> <span data-ttu-id="c5cc7-137">Kontexty patří:</span><span class="sxs-lookup"><span data-stu-id="c5cc7-137">These contexts include:</span></span>  
  
    -   <span data-ttu-id="c5cc7-138">Kontext oprávnění aplikace.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-138">The application permission context.</span></span>  
  
    -   <span data-ttu-id="c5cc7-139">Jakýkoli kontext specifické pro vlákno oprávnění dříve vytvořené jinými vlákny uživatele použít k volání do WCF po celou dobu životnosti aktuálně běžících <xref:System.AppDomain>.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-139">Any thread-specific permission context previously created by other user threads used to call into WCF during the lifetime of the currently running <xref:System.AppDomain>.</span></span>  
  
 <span data-ttu-id="c5cc7-140">WCF zaručuje, že částečně důvěryhodným kódem nemůže získat oprávnění plné důvěryhodnosti, pokud taková oprávnění se uplatňovaný plně důvěryhodné komponenty před voláním do veřejných rozhraní API WCF.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-140">WCF guarantees that partially-trusted code cannot obtain full-trust permissions unless such permissions are asserted by a fully-trusted component prior to calling into WCF public APIs.</span></span> <span data-ttu-id="c5cc7-141">Však nezaručuje, že účinky uplatnění úplný vztah důvěryhodnosti je izolovaná na konkrétní vlákno, operace nebo akce uživatele.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-141">However, it does not guarantee that the effects of asserting full trust is isolated to a particular thread, operation, or user action.</span></span>  
  
 <span data-ttu-id="c5cc7-142">Jako osvědčený postup, vyhněte se vytváření kontextu oprávnění specifické pro vlákno voláním <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, nebo <xref:System.Security.PermissionSet.Deny%2A>.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-142">As a best practice, avoid creating thread-specific permission context by calling <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, or <xref:System.Security.PermissionSet.Deny%2A>.</span></span> <span data-ttu-id="c5cc7-143">Místo toho udělit nebo odepřít oprávnění k aplikaci, tak, aby žádné <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.Deny%2A>, nebo <xref:System.Security.PermissionSet.PermitOnly%2A> je povinný.</span><span class="sxs-lookup"><span data-stu-id="c5cc7-143">Instead, grant or deny the privilege to the application itself, so that no <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.Deny%2A>, or <xref:System.Security.PermissionSet.PermitOnly%2A> is required.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c5cc7-144">Viz také:</span><span class="sxs-lookup"><span data-stu-id="c5cc7-144">See also</span></span>

- <xref:System.Runtime.Serialization.DataContractSerializer>
- <xref:System.Xml.Serialization.IXmlSerializable>
