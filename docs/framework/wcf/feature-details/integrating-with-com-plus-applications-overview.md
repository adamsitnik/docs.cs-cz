---
title: Integrace s aplikacemi modelu COM+ – přehled
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Communication Foundation, COM+ integration
- WCF, COM+ integration
ms.assetid: e481e48f-7096-40eb-9f20-7f0098412941
ms.openlocfilehash: 75711ea534907e5692d97e0ec5f290e03fb75235
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/22/2019
ms.locfileid: "69988697"
---
# <a name="integrating-with-com-applications-overview"></a><span data-ttu-id="f72d8-102">Integrace s aplikacemi modelu COM+ – přehled</span><span class="sxs-lookup"><span data-stu-id="f72d8-102">Integrating with COM+ Applications Overview</span></span>
<span data-ttu-id="f72d8-103">Windows Communication Foundation (WCF) poskytuje bohatou prostředí pro vytváření distribuovaných aplikací.</span><span class="sxs-lookup"><span data-stu-id="f72d8-103">Windows Communication Foundation (WCF) provides a rich environment for creating distributed applications.</span></span> <span data-ttu-id="f72d8-104">Pokud již používáte aplikační logiku, která je hostována v modelu COM+, můžete použít WCF k rozšiřování stávající logiky, a nemusíte ji přepsat.</span><span class="sxs-lookup"><span data-stu-id="f72d8-104">If you are already using component-based application logic hosted in COM+, you can use WCF to extend your existing logic rather than having to rewrite it.</span></span> <span data-ttu-id="f72d8-105">Běžným scénářem je, že chcete v rámci webové služby vystavit existující obchodní logiku služby COM+ nebo podnikových služeb.</span><span class="sxs-lookup"><span data-stu-id="f72d8-105">A common scenario is when you want to expose existing COM+ or Enterprise Services business logic through Web Services.</span></span>  
  
 <span data-ttu-id="f72d8-106">Pokud je rozhraní komponenty modelu COM+ vystaveno jako webová služba, specifikace a kontrakt těchto služeb jsou určeny automatickým mapováním, které se provádí při inicializaci aplikace.</span><span class="sxs-lookup"><span data-stu-id="f72d8-106">When an interface on a COM+ component is exposed as a Web service, the specification and contract of these services are determined by an automatic mapping that is performed at application initialization time.</span></span> <span data-ttu-id="f72d8-107">Následující seznam uvádí koncepční model pro toto mapování:</span><span class="sxs-lookup"><span data-stu-id="f72d8-107">The following list shows the conceptual model for this mapping:</span></span>  
  
- <span data-ttu-id="f72d8-108">Jedna služba je definována pro každou vystavenou třídu modelu COM.</span><span class="sxs-lookup"><span data-stu-id="f72d8-108">One service is defined for each exposed COM class.</span></span>  
  
- <span data-ttu-id="f72d8-109">Kontrakt pro službu je odvozen přímo z definice rozhraní vybrané součásti s možností vyloučení metody definované v konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="f72d8-109">The contract for the service is derived directly from the selected component's interface definition with the possibility of method exclusion defined in configuration.</span></span>  
  
- <span data-ttu-id="f72d8-110">Operace v tomto kontraktu jsou odvozeny přímo z metod v definici rozhraní komponenty.</span><span class="sxs-lookup"><span data-stu-id="f72d8-110">The operations in that contract are derived directly from the methods on the component's interface definition.</span></span>  
  
- <span data-ttu-id="f72d8-111">Parametry pro tyto operace jsou odvozeny přímo z typu interoperability modelu COM, který odpovídá parametrům metody komponenty.</span><span class="sxs-lookup"><span data-stu-id="f72d8-111">The parameters for those operations are derived directly from the COM interoperability type that corresponds to the component's method parameters.</span></span>  
  
 <span data-ttu-id="f72d8-112">Výchozí adresy a vazby přenosu pro službu jsou k dispozici v konfiguračním souboru služby, ale je možné je v případě potřeby překonfigurovat.</span><span class="sxs-lookup"><span data-stu-id="f72d8-112">Default addresses and transport bindings for the service are provided in a service configuration file, but these can be reconfigured as required.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="f72d8-113">Smlouvy pro exponované webové služby zůstávají konstantní, dokud rozhraní a konfigurace modelu COM+ zůstanou beze změny.</span><span class="sxs-lookup"><span data-stu-id="f72d8-113">The contracts for the exposed Web services remain constant as long as the COM+ interfaces and configuration remain unchanged.</span></span> <span data-ttu-id="f72d8-114">Úprava několika rozhraní neaktualizuje automaticky dostupné služby a vyžaduje opětovné spuštění nástroje pro konfiguraci modelu služby COM+ (ComSvcConfig. exe).</span><span class="sxs-lookup"><span data-stu-id="f72d8-114">A modification to several interfaces does not automatically update the available services and requires re-running the COM+ Service Model Configuration tool (ComSvcConfig.exe).</span></span>  
  
 <span data-ttu-id="f72d8-115">Požadavky na ověřování a autorizaci aplikace modelu COM+ a jejích komponent se budou při použití jako webové služby nadále vymáhat.</span><span class="sxs-lookup"><span data-stu-id="f72d8-115">The authentication and authorization requirements of the COM+ application and its components continue to be enforced when used as a Web service.</span></span>  
  
 <span data-ttu-id="f72d8-116">Pokud volající inicializuje transakci webové služby, komponenty označené jako transakční zařazení v rámci tohoto oboru transakce.</span><span class="sxs-lookup"><span data-stu-id="f72d8-116">If the caller initiates a Web service transaction, components marked as transactional enlist within that transaction scope.</span></span>  
  
 <span data-ttu-id="f72d8-117">K vystavení rozhraní komponenty COM+ jako webové služby bez změny součásti se vyžadují následující kroky:</span><span class="sxs-lookup"><span data-stu-id="f72d8-117">The following steps are required to expose a COM+ component's interface as a Web service without modifying the component:</span></span>  
  
1. <span data-ttu-id="f72d8-118">Určete, zda je možné rozhraní komponenty modelu COM+ zveřejnit jako webovou službu.</span><span class="sxs-lookup"><span data-stu-id="f72d8-118">Determine whether the COM+ component's interface can be exposed as a Web service.</span></span>  
  
2. <span data-ttu-id="f72d8-119">Vyberte vhodný hostující režim.</span><span class="sxs-lookup"><span data-stu-id="f72d8-119">Select an appropriate hosting mode.</span></span>  
  
3. <span data-ttu-id="f72d8-120">K přidání webové služby pro rozhraní použijte nástroj pro konfiguraci modelu služby COM+ (ComSvcConfig. exe).</span><span class="sxs-lookup"><span data-stu-id="f72d8-120">Use the COM+ Service Model Configuration tool (ComSvcConfig.exe) to add a Web service for the interface.</span></span> <span data-ttu-id="f72d8-121">Další informace o použití ComSvcConfig. exe naleznete v tématu [How to: Použijte nástroj](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md)pro konfiguraci modelu služby com+.</span><span class="sxs-lookup"><span data-stu-id="f72d8-121">For more information about how to use ComSvcConfig.exe, see [How to: Use the COM+ Service Model Configuration Tool](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span></span>  
  
4. <span data-ttu-id="f72d8-122">Nakonfigurujte všechna další nastavení služby v konfiguračním souboru aplikace.</span><span class="sxs-lookup"><span data-stu-id="f72d8-122">Configure any additional service settings in the application configuration file.</span></span> <span data-ttu-id="f72d8-123">Další informace o tom, jak nakonfigurovat součást, najdete v [tématu How to: Nakonfigurujte nastavení](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md)služby com+.</span><span class="sxs-lookup"><span data-stu-id="f72d8-123">For more information about how to configure a component, see [How to: Configure COM+ Service Settings](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span></span>  
  
## <a name="supported-interfaces"></a><span data-ttu-id="f72d8-124">Podporovaná rozhraní</span><span class="sxs-lookup"><span data-stu-id="f72d8-124">Supported Interfaces</span></span>  
 <span data-ttu-id="f72d8-125">Existují určitá omezení typu rozhraní, která je možné zveřejnit jako webovou službu.</span><span class="sxs-lookup"><span data-stu-id="f72d8-125">There are some restrictions on the type of interfaces that can be exposed as a Web service.</span></span> <span data-ttu-id="f72d8-126">Následující typy rozhraní nejsou podporovány:</span><span class="sxs-lookup"><span data-stu-id="f72d8-126">The following types of interfaces are not supported:</span></span>  
  
- <span data-ttu-id="f72d8-127">Rozhraní, která přecházejí odkazy na objekty jako parametry – následující omezený přístup k objektům je popsán v části Podpora omezeného počtu objektů.</span><span class="sxs-lookup"><span data-stu-id="f72d8-127">Interfaces that pass object references as parameters - the following limited object reference approach is described in the Limited Object Reference Support section.</span></span>  
  
- <span data-ttu-id="f72d8-128">Rozhraní, která předává typy, které nejsou kompatibilní s konverzemi interoperability .NET Framework COM.</span><span class="sxs-lookup"><span data-stu-id="f72d8-128">Interfaces that pass types that are not compatible with the .NET Framework COM interoperability conversions.</span></span>  
  
- <span data-ttu-id="f72d8-129">Rozhraní pro aplikace, které mají povolený fond aplikací, když hostuje model COM+.</span><span class="sxs-lookup"><span data-stu-id="f72d8-129">Interfaces for applications that have application pooling enabled when hosted by COM+.</span></span>  
  
- <span data-ttu-id="f72d8-130">Rozhraní komponent, která jsou pro aplikaci označena jako soukromá.</span><span class="sxs-lookup"><span data-stu-id="f72d8-130">Interfaces of components that are marked as private to the application.</span></span>  
  
- <span data-ttu-id="f72d8-131">Rozhraní infrastruktury COM+.</span><span class="sxs-lookup"><span data-stu-id="f72d8-131">COM+ infrastructure interfaces.</span></span>  
  
- <span data-ttu-id="f72d8-132">Rozhraní ze systémové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f72d8-132">Interfaces from the system application.</span></span>  
  
- <span data-ttu-id="f72d8-133">Rozhraní z komponent služeb Enterprise Services, které nebyly přidány do globální mezipaměti sestavení (GAC).</span><span class="sxs-lookup"><span data-stu-id="f72d8-133">Interfaces from Enterprise Services components that have not been added to the global assembly cache.</span></span>  
  
### <a name="limited-object-reference-support"></a><span data-ttu-id="f72d8-134">Omezená podpora odkazů na objekty</span><span class="sxs-lookup"><span data-stu-id="f72d8-134">Limited Object Reference Support</span></span>  
 <span data-ttu-id="f72d8-135">Vzhledem k tomu, že řada nasazených komponent modelu COM+ používá objekty podle referenčních parametrů, jako je například vrácení objektu ADO Recordset, integrace modelu COM+ zahrnuje omezené podpory pro parametry odkazů na objekty.</span><span class="sxs-lookup"><span data-stu-id="f72d8-135">Because a number of deployed COM+ components do use objects by reference parameters, such as returning an ADO Recordset object, COM+ integration includes limited support for object reference parameters.</span></span> <span data-ttu-id="f72d8-136">Podpora je omezená na objekty, které implementují `IPersistStream` rozhraní com.</span><span class="sxs-lookup"><span data-stu-id="f72d8-136">The support is limited to objects that implement the `IPersistStream` COM interface.</span></span> <span data-ttu-id="f72d8-137">To zahrnuje objekty ADO sady záznamů a lze je implementovat pro objekty modelu COM specifické pro danou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="f72d8-137">This includes ADO Recordset objects and can be implemented for application specific COM objects.</span></span>  
  
 <span data-ttu-id="f72d8-138">Chcete-li povolit tuto podporu, nástroj ComSvcConfig. exe poskytuje přepínač **allowreferences** , který zakáže parametr signatury regulární metody a kontroluje, zda je nástroj spuštěn, aby bylo zajištěno, že parametry objektu reference nejsou používány.</span><span class="sxs-lookup"><span data-stu-id="f72d8-138">To enable this support, the ComSvcConfig.exe tool provides the **allowreferences** switch that disables the regular method signature parameter and checks that the tool runs to ensure that object reference parameters are not being used.</span></span> <span data-ttu-id="f72d8-139">Kromě toho musí být typy objektů, které předáváte jako parametry, pojmenovány a identifikovány v rámci elementu <`persistableTypes`> Konfigurace, který je podřízenou položkou prvku <`comContract`>.</span><span class="sxs-lookup"><span data-stu-id="f72d8-139">In addition, the object types that you pass as parameters must be named and identified within the <`persistableTypes`> configuration element that is a child of the <`comContract`> element.</span></span>  
  
 <span data-ttu-id="f72d8-140">Při použití této funkce služba Integration Service modelu COM+ používá `IPersistStream` rozhraní k serializaci nebo deserializaci instance objektu.</span><span class="sxs-lookup"><span data-stu-id="f72d8-140">When this feature is used, the COM+ integration service uses the `IPersistStream` interface to serialize or deserialize the object instance.</span></span> <span data-ttu-id="f72d8-141">Pokud instance objektu nepodporuje `IPersistStream`, je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="f72d8-141">If the object instance does not support `IPersistStream`, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f72d8-142">V rámci klientské aplikace lze metody <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> objektu použít k předání objektu do služby a podobně k načtení objektu.</span><span class="sxs-lookup"><span data-stu-id="f72d8-142">Within a client application, the methods on the <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> object can be used to pass an object in to a service and similarly to retrieve an object.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="f72d8-143">Z důvodu vlastní povahy a specifického přístupu k serializaci je to nejvhodnější pro použití mezi klienty WCF a službami WCF.</span><span class="sxs-lookup"><span data-stu-id="f72d8-143">Due to the custom and platform-specific nature of the serialization approach, this is best suited for use between WCF clients and WCF services.</span></span>  
  
## <a name="selecting-the-hosting-mode"></a><span data-ttu-id="f72d8-144">Výběr režimu hostování</span><span class="sxs-lookup"><span data-stu-id="f72d8-144">Selecting the Hosting Mode</span></span>  
 <span data-ttu-id="f72d8-145">Model COM+ zveřejňuje webové služby v jednom z následujících způsobů hostování:</span><span class="sxs-lookup"><span data-stu-id="f72d8-145">COM+ exposes Web services in one of the following hosting modes:</span></span>  
  
- <span data-ttu-id="f72d8-146">COM+ – hostované</span><span class="sxs-lookup"><span data-stu-id="f72d8-146">COM+-hosted</span></span>  
  
     <span data-ttu-id="f72d8-147">Webová služba je hostována v rámci procesu vyhrazeného serveru COM+ aplikace (Dllhost. exe).</span><span class="sxs-lookup"><span data-stu-id="f72d8-147">The Web service is hosted within the application's dedicated COM+ server process (Dllhost.exe).</span></span> <span data-ttu-id="f72d8-148">Tento režim vyžaduje, aby aplikace byla explicitně spuštěna předtím, než může přijímat žádosti webové služby.</span><span class="sxs-lookup"><span data-stu-id="f72d8-148">This mode requires the application to be explicitly started before it can receive Web service requests.</span></span> <span data-ttu-id="f72d8-149">Možnosti modelu COM+ "spustit jako službu NT" nebo "ponechat spuštěné v případě nečinnosti" lze použít k zabránění nečinnému vypnutí aplikace a jejích služeb.</span><span class="sxs-lookup"><span data-stu-id="f72d8-149">The COM+ options "Run as an NT Service" or "Leave running when idle" can be used to prevent idle shutdown of the application and its services.</span></span> <span data-ttu-id="f72d8-150">Tento režim poskytuje obě webové služby i DCOM přístup k serverové aplikaci.</span><span class="sxs-lookup"><span data-stu-id="f72d8-150">This mode provides both Web service and DCOM access to the server application.</span></span>  
  
- <span data-ttu-id="f72d8-151">Hostovaný na webu</span><span class="sxs-lookup"><span data-stu-id="f72d8-151">Web-hosted</span></span>  
  
     <span data-ttu-id="f72d8-152">Webová služba je hostována v rámci pracovního procesu webového serveru.</span><span class="sxs-lookup"><span data-stu-id="f72d8-152">The Web service is hosted within a Web server worker process.</span></span> <span data-ttu-id="f72d8-153">Tento režim nevyžaduje, aby model COM+ byl aktivní při přijetí počáteční žádosti.</span><span class="sxs-lookup"><span data-stu-id="f72d8-153">This mode does not require COM+ to be active when the initial request is received.</span></span> <span data-ttu-id="f72d8-154">Pokud aplikace není při přijetí této žádosti aktivní, je před zpracováním žádosti automaticky aktivována.</span><span class="sxs-lookup"><span data-stu-id="f72d8-154">If the application is not active when this request is received, it is automatically activated prior to processing the request.</span></span> <span data-ttu-id="f72d8-155">Tento režim také poskytuje přístup k serverové aplikaci prostřednictvím webové služby i modelu DCOM, ale vyvolá přesměrování procesu pro žádosti webové služby.</span><span class="sxs-lookup"><span data-stu-id="f72d8-155">This mode also provides both Web service and DCOM access to the server application, but causes a process hop for Web service requests.</span></span> <span data-ttu-id="f72d8-156">To obvykle vyžaduje, aby klient povolil zosobnění.</span><span class="sxs-lookup"><span data-stu-id="f72d8-156">This typically requires the client to enable impersonation.</span></span> <span data-ttu-id="f72d8-157">V rámci WCF to lze provést <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> s vlastností <xref:System.ServiceModel.Security.WindowsClientCredential> třídy, která je k dispozici jako vlastnost obecné <xref:System.ServiceModel.ChannelFactory%601> třídy a také jako <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> hodnota výčtu.</span><span class="sxs-lookup"><span data-stu-id="f72d8-157">In WCF, this can be done with the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class, which is accessed as a property of the generic <xref:System.ServiceModel.ChannelFactory%601> class, as well as the <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> enumeration value.</span></span>  
  
- <span data-ttu-id="f72d8-158">Webový Host v procesu</span><span class="sxs-lookup"><span data-stu-id="f72d8-158">Web-hosted in-process</span></span>  
  
     <span data-ttu-id="f72d8-159">Webová služba a logika aplikace modelu COM+ jsou hostovány v rámci pracovního procesu webového serveru.</span><span class="sxs-lookup"><span data-stu-id="f72d8-159">The Web service and the COM+ application logic are hosted within the Web server worker process.</span></span> <span data-ttu-id="f72d8-160">To zajišťuje automatickou aktivaci režimu hostovaného na webu, aniž by to způsobilo přesměrování procesu na požadavky webové služby.</span><span class="sxs-lookup"><span data-stu-id="f72d8-160">This provides automatic activation of the Web-hosted mode without causing a process hop for Web service requests.</span></span> <span data-ttu-id="f72d8-161">Nevýhodou je, že k serverové aplikaci nelze přistup prostřednictvím modelu DCOM.</span><span class="sxs-lookup"><span data-stu-id="f72d8-161">The disadvantage is that the server application cannot be accessed through DCOM.</span></span>  
  
### <a name="security-considerations"></a><span data-ttu-id="f72d8-162">Důležité informace o zabezpečení</span><span class="sxs-lookup"><span data-stu-id="f72d8-162">Security Considerations</span></span>  
 <span data-ttu-id="f72d8-163">Stejně jako jiné služby WCF se nastavení zabezpečení pro vystavené služby spravují prostřednictvím nastavení konfigurace pro kanál WCF.</span><span class="sxs-lookup"><span data-stu-id="f72d8-163">Like other WCF services, the security settings for the exposed service are administered through configuration settings for the WCF channel.</span></span> <span data-ttu-id="f72d8-164">Nejsou vynutila tradiční nastavení zabezpečení DCOM, jako je nastavení oprávnění na úrovni modelu DCOM.</span><span class="sxs-lookup"><span data-stu-id="f72d8-164">Traditional DCOM security settings such as the DCOM machine-wide permissions settings are not enforced.</span></span> <span data-ttu-id="f72d8-165">Aby bylo možné vyhovět aplikačním rolím COM+, musí být pro danou součást povolena autorizace "kontroly přístupu na úrovni součásti".</span><span class="sxs-lookup"><span data-stu-id="f72d8-165">To enforce COM+ application roles, "component-level access checks" authorization must be enabled for the component.</span></span>  
  
 <span data-ttu-id="f72d8-166">Použití nezabezpečené vazby může opustit komunikaci, která je otevřená pro manipulaci nebo zpřístupnění informací.</span><span class="sxs-lookup"><span data-stu-id="f72d8-166">The use of a non-secured binding can leave communication open to tampering or information disclosure.</span></span> <span data-ttu-id="f72d8-167">Abyste tomu předešli, doporučuje se používat zabezpečenou vazbu.</span><span class="sxs-lookup"><span data-stu-id="f72d8-167">To prevent this, it is recommended that you use a secured binding.</span></span>  
  
 <span data-ttu-id="f72d8-168">Pro režimy hostované v modelu COM+ a na webu musí klientské aplikace povolit zosobnění uživatele klienta v procesu serveru.</span><span class="sxs-lookup"><span data-stu-id="f72d8-168">For the COM+-hosted and Web-hosted modes, client applications must permit the server process to impersonate the client user.</span></span> <span data-ttu-id="f72d8-169">To lze provést v klientech WCF nastavením úrovně zosobnění na <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span><span class="sxs-lookup"><span data-stu-id="f72d8-169">This can be done in WCF clients by setting the impersonation level to <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span></span>  
  
 <span data-ttu-id="f72d8-170">Pomocí služby Internetová informační služba (IIS) nebo aktivační služby procesů systému Windows (WAS) pomocí přenosového protokolu HTTP lze použít nástroj Httpcfg. exe k rezervaci adresy koncového bodu přenosu.</span><span class="sxs-lookup"><span data-stu-id="f72d8-170">With Internet Information Services (IIS) or Windows Process Activation Service (WAS) using the HTTP transport, the Httpcfg.exe tool can be used to reserve a transport endpoint address.</span></span> <span data-ttu-id="f72d8-171">V jiných konfiguracích je důležité chránit před neautorizovanými službami, které fungují jako zamýšlená služba.</span><span class="sxs-lookup"><span data-stu-id="f72d8-171">In other configurations, it is important to protect against rogue services that act as the intended service.</span></span> <span data-ttu-id="f72d8-172">Chcete-li zabránit tomu, aby se nepovolená služba spouštěla v požadovaném koncovém bodě, může být legitimní služba nakonfigurována tak, aby běžela jako služba NT.</span><span class="sxs-lookup"><span data-stu-id="f72d8-172">To prevent a rogue service from starting at the desired endpoint, the legitimate service can be configured to run as an NT service.</span></span> <span data-ttu-id="f72d8-173">To umožňuje legitimní službě deklarovat adresu koncového bodu před všemi neautorizovanými službami.</span><span class="sxs-lookup"><span data-stu-id="f72d8-173">This enables the legitimate service to claim the endpoint address prior to any rogue services.</span></span>  
  
 <span data-ttu-id="f72d8-174">Při vystavení aplikace modelu COM+ s nakonfigurovanými rolemi modelu COM+ jako webové služby, je nutné přidat účet procesu spuštění služby IIS do jedné z rolí aplikace.</span><span class="sxs-lookup"><span data-stu-id="f72d8-174">When exposing a COM+ application with configured COM+ roles as a Web-hosted service, the "Launch IIS Process Account" must be added to one of the application’s roles.</span></span> <span data-ttu-id="f72d8-175">Tento účet, obvykle s názvem IWAM_machinename, musí být přidán za účelem povolení čistého vypnutí objektů po použití.</span><span class="sxs-lookup"><span data-stu-id="f72d8-175">This account, typically with the name IWAM_machinename, must be added to enable clean shutdown of objects after use.</span></span> <span data-ttu-id="f72d8-176">Účtu by se neměla udělit žádná další oprávnění.</span><span class="sxs-lookup"><span data-stu-id="f72d8-176">The account should not be granted any additional permissions.</span></span>  
  
 <span data-ttu-id="f72d8-177">Funkce recyklace procesu COM+ se nedají použít u integrovaných aplikací.</span><span class="sxs-lookup"><span data-stu-id="f72d8-177">The COM+ process recycling features cannot be used on integrated applications.</span></span> <span data-ttu-id="f72d8-178">Pokud je aplikace nakonfigurována pro použití recyklace procesu a součásti jsou spuštěny v hostovaném procesu modelu COM+, spuštění služby se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="f72d8-178">If the application is configured to use process recycling and the components are running in a COM+ hosted process, the service fails to start.</span></span> <span data-ttu-id="f72d8-179">Tento požadavek nezahrnuje služby, které používají režim v rámci hostování na webu, protože nastavení recyklace procesu se nepoužívají.</span><span class="sxs-lookup"><span data-stu-id="f72d8-179">This requirement does not include services using the Web-hosted in-process mode because the process recycling settings are not applied.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f72d8-180">Viz také:</span><span class="sxs-lookup"><span data-stu-id="f72d8-180">See also</span></span>

- [<span data-ttu-id="f72d8-181">Přehled integrace s aplikacemi modelu COM</span><span class="sxs-lookup"><span data-stu-id="f72d8-181">Integrating with COM Applications Overview</span></span>](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)
