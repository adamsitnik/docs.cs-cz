---
title: Federace a důvěryhodnost
ms.date: 03/30/2017
helpviewer_keywords:
- federation [WCF], and trust
ms.assetid: 4bdec4f2-f8a2-4512-bdcf-14ef54b5877a
ms.openlocfilehash: 4e1529db6cc52b6b8cc8881d2b2a35a754b4b311
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/18/2019
ms.locfileid: "59225336"
---
# <a name="federation-and-trust"></a><span data-ttu-id="ebc59-102">Federace a důvěryhodnost</span><span class="sxs-lookup"><span data-stu-id="ebc59-102">Federation and Trust</span></span>
<span data-ttu-id="ebc59-103">Toto téma popisuje různé aspekty související s federovaným aplikacím, hranicemi vztahů důvěryhodnosti a konfigurace a použití vydané tokeny ve Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="ebc59-103">This topic covers various aspects related to federated applications, trust boundaries and configuration, and use of issued tokens in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="services-security-token-services-and-trust"></a><span data-ttu-id="ebc59-104">Služby, služby tokenu zabezpečení a důvěryhodnost</span><span class="sxs-lookup"><span data-stu-id="ebc59-104">Services, Security Token Services, and Trust</span></span>  
 <span data-ttu-id="ebc59-105">Služby, které obvykle vystavují federované koncové body očekávat, že klienti k ověření pomocí tokenu poskytované konkrétní vystavitele.</span><span class="sxs-lookup"><span data-stu-id="ebc59-105">Services that expose federated endpoints typically expect clients to authenticate using a token provided by a specific issuer.</span></span> <span data-ttu-id="ebc59-106">Je důležité, že služba je nakonfigurována se správnými přihlašovacími údaji pro vystavitele; v opačném případě nebude moct k ověřování podpisů nad vydané tokeny, a klient nebude moci komunikovat se službou.</span><span class="sxs-lookup"><span data-stu-id="ebc59-106">It is important that the service is configured with the correct credentials for the issuer; otherwise, it will not be able to verify signatures over the issued tokens, and the client will be unable to communicate with the service.</span></span> <span data-ttu-id="ebc59-107">Další informace o konfiguraci přihlašovacích údajů vystavitele pro službu, naleznete v tématu [jak: Konfigurace pověření ve službě Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md).</span><span class="sxs-lookup"><span data-stu-id="ebc59-107">For more information about configuring issuer credentials on the service, see [How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md).</span></span>  
  
 <span data-ttu-id="ebc59-108">Podobně při použití symetrické klíče, že klíče se zašifrují pro cílovou službu, tak se správnými přihlašovacími údaji pro cílovou službu, musíte nakonfigurovat službu tokenů zabezpečení v opačném případě nebude možné k šifrování klíče pro cílovou službu a znovu, klient nebude moci komunikovat se službou.</span><span class="sxs-lookup"><span data-stu-id="ebc59-108">Similarly, when using symmetric keys, the keys are encrypted for the target service, so you must configure the security token service with the correct credentials for the target service; otherwise, it will be unable to encrypt the key for the target service, and again, the client will be unable to communicate with the service.</span></span>  
  
 <span data-ttu-id="ebc59-109">Služby WCF, použijte hodnotu <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> vlastnost [SecurityBindingElement](../../../../docs/framework/wcf/diagnostics/wmi/securitybindingelement.md) umožňující hodiny nerovnoměrné rozdělení mezi klientem a službou.</span><span class="sxs-lookup"><span data-stu-id="ebc59-109">WCF services use the value of the <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> property on the [SecurityBindingElement](../../../../docs/framework/wcf/diagnostics/wmi/securitybindingelement.md) to allow for clock skew between the client and service.</span></span> <span data-ttu-id="ebc59-110">Na federaci `MaxClockSkew` nastavení se vztahuje na hodiny zkosí mezi klientem a služba tokenů zabezpečení z kde klient získal vydaný token.</span><span class="sxs-lookup"><span data-stu-id="ebc59-110">In federation, the `MaxClockSkew` setting applies to clock skews between both the client and the security token service from where the client obtained the issued token.</span></span> <span data-ttu-id="ebc59-111">Služby tokenu zabezpečení nemusí proto zkontrolujte limity časový posun při nastavování vydaný token platí a časy vypršení platnosti.</span><span class="sxs-lookup"><span data-stu-id="ebc59-111">Therefore, security token services need not make clock-skew allowances when setting the issued token's effective and expiration times.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ebc59-112">Důležitost posun hodin se zvyšuje podle zkracuje dobu života vydaný token.</span><span class="sxs-lookup"><span data-stu-id="ebc59-112">The importance of clock skew increases as the lifetime of the issued token shortens.</span></span> <span data-ttu-id="ebc59-113">Ve většině případů není časový posun významný problém, pokud token doba platnosti je 30 minut nebo déle.</span><span class="sxs-lookup"><span data-stu-id="ebc59-113">In most cases, clock skew is not a significant issue if the token lifetime is 30 minutes or more.</span></span> <span data-ttu-id="ebc59-114">Scénáře s kratší doby platnosti nebo kde je důležité čas přesný platnosti tokenu by se měly navrhovat vzít v úvahu posun hodin.</span><span class="sxs-lookup"><span data-stu-id="ebc59-114">Scenarios with shorter lifetimes or where the exact validity time of the token is important should be designed to take clock skew into account.</span></span>  
  
## <a name="federated-endpoints-and-time-outs"></a><span data-ttu-id="ebc59-115">Federované koncové body a časové limity</span><span class="sxs-lookup"><span data-stu-id="ebc59-115">Federated Endpoints and Time-Outs</span></span>  
 <span data-ttu-id="ebc59-116">Pokud klient komunikuje s federovaný koncový bod, musíte nejprve získat příslušné token od služby tokenů zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="ebc59-116">When a client communicates with a federated endpoint, it must first acquire an appropriate token from a security token service.</span></span> <span data-ttu-id="ebc59-117">Pokud služba tokenů zabezpečení zpřístupní federovaný koncový bod, musí klient nejdřív získat token od vydavatele pro tento koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ebc59-117">If the security token service exposes a federated endpoint, the client must first obtain a token from the issuer for that endpoint.</span></span> <span data-ttu-id="ebc59-118">Získání tokenu každé služby trvá určitou dobu a tato doba je v souladu s celkový časový limit pro odesílání skutečné zpráva koncovým bodem.</span><span class="sxs-lookup"><span data-stu-id="ebc59-118">Each token acquisition takes time, and that time is subject to the overall time-out for sending the actual message to the final endpoint.</span></span>  
  
 <span data-ttu-id="ebc59-119">Časový limit na straně klienta kanálu je třeba nastavit na 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="ebc59-119">For example, the time-out on the client-side channel is set to 30 seconds.</span></span> <span data-ttu-id="ebc59-120">Dva vystavitele tokenu musí být volána k získání tokenů před odesláním zpráva koncovým bodem a každý trvá 15 sekund vydání tokenu.</span><span class="sxs-lookup"><span data-stu-id="ebc59-120">Two token issuers need to be called to retrieve tokens before sending the message to the final endpoint, and each takes 15 seconds to issue a token.</span></span> <span data-ttu-id="ebc59-121">V takovém případě se pokus nezdaří a <xref:System.TimeoutException> je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="ebc59-121">In this case, the attempt will fail and a <xref:System.TimeoutException> is thrown.</span></span> <span data-ttu-id="ebc59-122">Proto je nutné nastavit <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> hodnotu na kanálu klienta na hodnotu dostatečně velký, aby patří čas potřebný k načtení všech vydané tokeny.</span><span class="sxs-lookup"><span data-stu-id="ebc59-122">Thus, you need to set the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> value on the client channel to a value large enough to include the time taken to retrieve all issued tokens.</span></span> <span data-ttu-id="ebc59-123">V případě, pokud není zadána hodnota pro <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> vlastnost, <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> vlastnost nebo <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> vlastnost (nebo obojí) musí být nastavena na hodnotu dostatečně velký, aby patří čas potřebný k načtení všech vydaných tokenů.</span><span class="sxs-lookup"><span data-stu-id="ebc59-123">In the case where a value is not specified for the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> property, the <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> property or the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> property (or both) need to be set to a value large enough to include the time taken to retrieve all issued tokens.</span></span>  
  
## <a name="token-lifetime-and-renewal"></a><span data-ttu-id="ebc59-124">Životnost tokenu a obnovení</span><span class="sxs-lookup"><span data-stu-id="ebc59-124">Token Lifetime and Renewal</span></span>  
 <span data-ttu-id="ebc59-125">Klienti WCF nezaškrtávejte políčko vydaný token při provádění prvotní žádosti o službu.</span><span class="sxs-lookup"><span data-stu-id="ebc59-125">WCF clients do not check the issued token when making an initial request to a service.</span></span>  <span data-ttu-id="ebc59-126">Místo toho WCF vztahy důvěryhodnosti služby tokenů zabezpečení k vydání tokenu s vhodnou dobu platnosti a vypršení platnosti.</span><span class="sxs-lookup"><span data-stu-id="ebc59-126">Rather, WCF trusts the security token service to issue a token with appropriate effective and expiration times.</span></span> <span data-ttu-id="ebc59-127">Pokud je token v mezipaměti klienta a znovu použít, dobu životnosti tokenu je zaškrtnuté políčko na následné žádosti a klient automaticky token obnovuje, v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="ebc59-127">If the token is cached by the client and reused, the token lifetime is checked on subsequent requests and the client automatically renews the token if necessary.</span></span> <span data-ttu-id="ebc59-128">Další informace o ukládání tokenu do mezipaměti najdete v tématu [jak: Vytvoření federovaného klienta](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md).</span><span class="sxs-lookup"><span data-stu-id="ebc59-128">For more information about token caching, see [How to: Create a Federated Client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md).</span></span>  
  
 <span data-ttu-id="ebc59-129">Určení krátkou životnost, menší nebo v řádu 30 sekund pro vydané tokeny nebo tokeny kontextu zabezpečení, může mít za následek vypršení časových limitů vyjednávání nebo další výjimky vyvolané klienti WCF při žádosti o tokeny vydané nebo při vyjednávání nebo obnovení zabezpečení tokeny kontextu.</span><span class="sxs-lookup"><span data-stu-id="ebc59-129">Specifying short lifetimes, on the order of 30 seconds or less for issued tokens or security context tokens, may result in negotiation time-outs or other exceptions being thrown by WCF clients when requesting issued tokens or when negotiating or renewing security context tokens.</span></span>  
  
## <a name="issued-tokens-and-inclusionmode"></a><span data-ttu-id="ebc59-130">Vystavené tokeny a InclusionMode</span><span class="sxs-lookup"><span data-stu-id="ebc59-130">Issued Tokens and InclusionMode</span></span>  
 <span data-ttu-id="ebc59-131">Určuje, zda je serializován ve zpráv odesílaných z klienta do federovaný koncový bod vydaný token, nebo není řízen pomocí nastavení <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> vlastnost <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> třídy.</span><span class="sxs-lookup"><span data-stu-id="ebc59-131">Whether an issued token is serialized in a message sent from a client to a federated endpoint or not is controlled by setting the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> property of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> class.</span></span> <span data-ttu-id="ebc59-132">Tuto vlastnost lze nastavit na jednu z <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> hodnot výčtu, ale není užitečné v situacích, většina federované.</span><span class="sxs-lookup"><span data-stu-id="ebc59-132">This property can be set to one of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> enumeration values, but it is not useful in most federated scenarios.</span></span> <span data-ttu-id="ebc59-133">`SecurityTokenInclusionMode.Never` a `SecurityTokenInclusionMode.AlwaysToInitiator` hodnoty způsobit klientovi umožní odeslat odkaz na tokenem vydaným službou tokenů zabezpečení k předávající straně.</span><span class="sxs-lookup"><span data-stu-id="ebc59-133">The `SecurityTokenInclusionMode.Never` and `SecurityTokenInclusionMode.AlwaysToInitiator` values cause the client to send a reference to the token issued by the security token service to the relying party.</span></span> <span data-ttu-id="ebc59-134">Pokud předávající strana má kopii vystavený ověřovací token, se nezdaří, protože není možné přeložit odkaz na token.</span><span class="sxs-lookup"><span data-stu-id="ebc59-134">Unless the relying party possesses a copy of the issued token, authentication will fail because the token reference is not resolvable.</span></span> <span data-ttu-id="ebc59-135">Zpracovává WCF `SecurityTokenInclusionMode.Once` jako ekvivalentní `SecurityTokenInclusionMode.AlwaysToRecipient`.</span><span class="sxs-lookup"><span data-stu-id="ebc59-135">WCF treats `SecurityTokenInclusionMode.Once` as equivalent to `SecurityTokenInclusionMode.AlwaysToRecipient`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ebc59-136">Viz také:</span><span class="sxs-lookup"><span data-stu-id="ebc59-136">See also</span></span>

- <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>
- [<span data-ttu-id="ebc59-137">Postupy: Vytvoření federovaného klienta</span><span class="sxs-lookup"><span data-stu-id="ebc59-137">How to: Create a Federated Client</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)
- [<span data-ttu-id="ebc59-138">Postupy: Konfigurace pověření ve službě Federation Service</span><span class="sxs-lookup"><span data-stu-id="ebc59-138">How to: Configure Credentials on a Federation Service</span></span>](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)
- [<span data-ttu-id="ebc59-139">Postupy: Vytvoření instance WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="ebc59-139">How to: Create a WSFederationHttpBinding</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-wsfederationhttpbinding.md)
