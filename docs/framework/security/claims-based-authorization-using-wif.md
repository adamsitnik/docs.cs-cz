---
title: Autorizace deklarovaných identit pomocí WIF
ms.date: 03/30/2017
ms.assetid: e24000a3-8fd8-4c0e-bdf0-39882cc0f6d8
author: BrucePerlerMS
ms.openlocfilehash: 0c99053610c8df9b6825c773a09cb1330d1e22f4
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/28/2019
ms.locfileid: "64650454"
---
# <a name="claims-based-authorization-using-wif"></a><span data-ttu-id="0edeb-102">Autorizace deklarovaných identit pomocí WIF</span><span class="sxs-lookup"><span data-stu-id="0edeb-102">Claims Based Authorization Using WIF</span></span>
<span data-ttu-id="0edeb-103">V aplikaci předávající strany autorizace určuje, k jakým prostředkům má ověřená identita povolen přístup a jaké operace s těmito prostředky smí provádět.</span><span class="sxs-lookup"><span data-stu-id="0edeb-103">In a relying party application, authorization determines what resources an authenticated identity is allowed to access and what operations it is allowed to perform on those resources.</span></span> <span data-ttu-id="0edeb-104">Nesprávná nebo slabá autorizace může vést k úniku informací nebo neoprávněným úpravám dat.</span><span class="sxs-lookup"><span data-stu-id="0edeb-104">Improper or weak authorization leads to information disclosure and data tampering.</span></span> <span data-ttu-id="0edeb-105">Toto téma popisuje, jak webové aplikace a služby technologie ASP.NET pracující s deklaracemi mohou implementovat autorizaci s použitím technologie Windows Identity Foundation (WIF) a služby tokenů zabezpečení (STS), jako je například Služba řízení přístupu Microsoft Azure (ACS).</span><span class="sxs-lookup"><span data-stu-id="0edeb-105">This topic outlines the available approaches to implementing authorization for claims-aware ASP.NET web applications and services using Windows Identity Foundation (WIF) and a Security Token Service (STS), for example, the Windows Azure Access Control Service (ACS).</span></span>  
  
## <a name="overview"></a><span data-ttu-id="0edeb-106">Přehled</span><span class="sxs-lookup"><span data-stu-id="0edeb-106">Overview</span></span>  
 <span data-ttu-id="0edeb-107">Již od své první verze nabízí rozhraní .NET Framework flexibilní mechanismus pro implementaci autorizace.</span><span class="sxs-lookup"><span data-stu-id="0edeb-107">Since its first version, the .NET Framework has offered a flexible mechanism for implementing authorization.</span></span> <span data-ttu-id="0edeb-108">Tento mechanismus je založen na dvou jednoduchých rozhraních –**IPrincipal** a **IIdentity**.</span><span class="sxs-lookup"><span data-stu-id="0edeb-108">This mechanism is based on two simple interfaces—**IPrincipal** and **IIdentity**.</span></span> <span data-ttu-id="0edeb-109">Konkrétní implementace **IIdentity** reprezentují ověřené uživatele.</span><span class="sxs-lookup"><span data-stu-id="0edeb-109">Concrete implementations of **IIdentity** represent an authenticated user.</span></span> <span data-ttu-id="0edeb-110">Například **WindowsIdentity** implementace představuje uživatele, který je ověřen službou Active Directory, a **GenericIdentity** představuje uživatele, jehož identita je ověřena prostřednictvím vlastního Proces ověřování.</span><span class="sxs-lookup"><span data-stu-id="0edeb-110">For example, the **WindowsIdentity** implementation represents a user who is authenticated by Active Directory, and **GenericIdentity** represents a user whose identity is verified via a custom authentication process.</span></span> <span data-ttu-id="0edeb-111">Konkrétní implementace **IPrincipal** pomáhají kontrolovat oprávnění s použitím rolí v závislosti na úložišti rolí.</span><span class="sxs-lookup"><span data-stu-id="0edeb-111">Concrete implementations of **IPrincipal** help to check permissions using roles depending on the role store.</span></span> <span data-ttu-id="0edeb-112">Například **WindowsPrincipal** kontroluje **WindowsIdentity** pro členství ve skupinách služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="0edeb-112">For example, **WindowsPrincipal** checks **WindowsIdentity** for membership in Active Directory groups.</span></span> <span data-ttu-id="0edeb-113">Tato kontrola se provádí pomocí volání **IsInRole** metodu **IPrincipal** rozhraní.</span><span class="sxs-lookup"><span data-stu-id="0edeb-113">This check is performed by calling the **IsInRole** method on the **IPrincipal** interface.</span></span> <span data-ttu-id="0edeb-114">Kontrola přístupu na základě rolí se nazývá řízení přístupu na základě rolí (RBAC).</span><span class="sxs-lookup"><span data-stu-id="0edeb-114">Checking access based on roles is called Role-Based Access Control (RBAC).</span></span> <span data-ttu-id="0edeb-115">Další informace najdete v tématu [řízení přístupu na základě Role](../../../docs/framework/security/claims-based-authorization-using-wif.md#BKMK_1).</span><span class="sxs-lookup"><span data-stu-id="0edeb-115">For more information, see [Role-Based Access Control](../../../docs/framework/security/claims-based-authorization-using-wif.md#BKMK_1).</span></span>  <span data-ttu-id="0edeb-116">Deklarace mohou přenášet informace o rolích a podporovat tak známé mechanismy ověřování na základě rolí.</span><span class="sxs-lookup"><span data-stu-id="0edeb-116">Claims can be used to carry information about roles to support familiar, role-based authorization mechanisms.</span></span>  
  
 <span data-ttu-id="0edeb-117">Deklarace také umožňují složitější rozhodování o autorizaci než pouze s použitím rolí.</span><span class="sxs-lookup"><span data-stu-id="0edeb-117">Claims can also be used to enable more complicated authorization decisions beyond roles.</span></span> <span data-ttu-id="0edeb-118">Deklarace může být založen na prakticky jakékoli informaci o uživateli - věk, poštovní směrovací číslo, velikost bot atd. Mechanismus řízení přístupu, který je založený na libovolných deklaracích se nazývá autorizace na základě rolí.</span><span class="sxs-lookup"><span data-stu-id="0edeb-118">Claims can be based on virtually any information about the user - age, zip code, shoe size, etc. An access control mechanism that is based on arbitrary claims is called claims-based authorization.</span></span> <span data-ttu-id="0edeb-119">Další informace najdete v tématu [autorizace na základě rolí](../../../docs/framework/security/claims-based-authorization-using-wif.md#BKMK_2).</span><span class="sxs-lookup"><span data-stu-id="0edeb-119">For more information, see [Claims-based Authorization](../../../docs/framework/security/claims-based-authorization-using-wif.md#BKMK_2).</span></span>  
  
<a name="BKMK_1"></a>   
## <a name="role-based-access-control"></a><span data-ttu-id="0edeb-120">Řízení přístupu na základě rolí</span><span class="sxs-lookup"><span data-stu-id="0edeb-120">Role-Based Access Control</span></span>  
 <span data-ttu-id="0edeb-121">RBAC představuje přístup k autorizaci, v rámci něhož aplikace spravuje a vynucuje uživatelská oprávnění na základě rolí uživatelů.</span><span class="sxs-lookup"><span data-stu-id="0edeb-121">RBAC is an authorization approach in which user permissions are managed and enforced by an application based on user roles.</span></span> <span data-ttu-id="0edeb-122">Má-li uživatel roli, která je vyžadována k provedení určité akce, je mu udělen přístup. V opačném případě je přístup odepřen.</span><span class="sxs-lookup"><span data-stu-id="0edeb-122">If a user has a role that is required to perform an action, the access is granted; otherwise, access is denied.</span></span>  
  
### <a name="iprincipalisinrole-method"></a><span data-ttu-id="0edeb-123">Metoda IPrincipal.IsInRole</span><span class="sxs-lookup"><span data-stu-id="0edeb-123">IPrincipal.IsInRole Method</span></span>  
 <span data-ttu-id="0edeb-124">Chcete-li v deklaracemi implementovat přístup RBAC, použijte **IsInRole()** metoda ve **IPrinicpal** rozhraní, stejně jako v jiných deklaracemi identity aplikace.</span><span class="sxs-lookup"><span data-stu-id="0edeb-124">To implement the RBAC approach in claims-aware applications, use the **IsInRole()** method in the **IPrinicpal** interface, just as you would in non-claims-aware applications.</span></span> <span data-ttu-id="0edeb-125">Existuje několik způsobů použití **IsInRole()** metody:</span><span class="sxs-lookup"><span data-stu-id="0edeb-125">There are several ways of using the **IsInRole()** method:</span></span>  
  
- <span data-ttu-id="0edeb-126">Explicitně pomocí volání **IPrincipal.IsInRole("Administrator")**.</span><span class="sxs-lookup"><span data-stu-id="0edeb-126">Explicitly calling on **IPrincipal.IsInRole("Administrator")**.</span></span> <span data-ttu-id="0edeb-127">Při použití tohoto přístupu je výsledkem logická hodnota,</span><span class="sxs-lookup"><span data-stu-id="0edeb-127">In this approach, the outcome is a Boolean.</span></span> <span data-ttu-id="0edeb-128">kterou můžete používat v podmíněných příkazech.</span><span class="sxs-lookup"><span data-stu-id="0edeb-128">Use it in your conditional statements.</span></span> <span data-ttu-id="0edeb-129">Toto volání lze používat kdekoli v kódu.</span><span class="sxs-lookup"><span data-stu-id="0edeb-129">It can be used arbitrarily any place in your code.</span></span>  
  
- <span data-ttu-id="0edeb-130">Pomocí požadavku zabezpečení **PrincipalPermission.Demand()**.</span><span class="sxs-lookup"><span data-stu-id="0edeb-130">Using the security demand **PrincipalPermission.Demand()**.</span></span> <span data-ttu-id="0edeb-131">Při použití tohoto přístupu je výsledkem výjimka, pokud není požadavek splněn.</span><span class="sxs-lookup"><span data-stu-id="0edeb-131">In this approach, the outcome is an exception in case the demand is not satisfied.</span></span> <span data-ttu-id="0edeb-132">Tento přístup můžete zapracovat do své strategie pro zpracování výjimek.</span><span class="sxs-lookup"><span data-stu-id="0edeb-132">This should fit your exception handling strategy.</span></span> <span data-ttu-id="0edeb-133">Je vyvolání výjimky mnohem nákladnější z hlediska výkonu ve srovnání s vrací datový typ Boolean.</span><span class="sxs-lookup"><span data-stu-id="0edeb-133">Throwing exceptions is much more expensive from a performance perspective compared to returning Boolean.</span></span> <span data-ttu-id="0edeb-134">Tento přístup lze používat kdekoli v kódu.</span><span class="sxs-lookup"><span data-stu-id="0edeb-134">This can be used any place in your code.</span></span>  
  
- <span data-ttu-id="0edeb-135">Pomocí deklarativních atributů **[PrincipalPermission (SecurityAction.Demand, Role = "Správce")]**.</span><span class="sxs-lookup"><span data-stu-id="0edeb-135">Using the declarative attributes **[PrincipalPermission(SecurityAction.Demand, Role = "Administrator")]**.</span></span> <span data-ttu-id="0edeb-136">Tento přístup se nazývá deklarativní, protože slouží pro úpravu metody.</span><span class="sxs-lookup"><span data-stu-id="0edeb-136">This approach is called declarative, because it is used to decorate methods.</span></span> <span data-ttu-id="0edeb-137">Nelze jej používat v blocích kódu uvnitř implementace metody.</span><span class="sxs-lookup"><span data-stu-id="0edeb-137">It cannot be used in code blocks inside the method’s implementations.</span></span> <span data-ttu-id="0edeb-138">Výsledkem je výjimka, pokud není požadavek splněn.</span><span class="sxs-lookup"><span data-stu-id="0edeb-138">The outcome is an exception in case the demand is not satisfied.</span></span> <span data-ttu-id="0edeb-139">Musíte ji zohlednit ve své strategii zpracování výjimek.</span><span class="sxs-lookup"><span data-stu-id="0edeb-139">You should make sure that it fits your exception-handling strategy.</span></span>  
  
- <span data-ttu-id="0edeb-140">Použitím autorizace adres URL, pomocí  **\<autorizace >** tématu **web.config**. Tento přístup je vhodný, pokud autorizaci řídíte na úrovni adres URL.</span><span class="sxs-lookup"><span data-stu-id="0edeb-140">Using URL authorization, using the **\<authorization>** section in **web.config**. This approach is suitable when you are managing authorization on a URL level.</span></span> <span data-ttu-id="0edeb-141">Ze všech dříve zmíněných přístupů se jedná o způsob použití na nejméně podrobné úrovni.</span><span class="sxs-lookup"><span data-stu-id="0edeb-141">This is the most coarse level among those previously mentioned.</span></span> <span data-ttu-id="0edeb-142">Výhodou tohoto přístupu je, že se změny provádějí v konfiguračním souboru, což znamená, že je možné změny využívat bez nutnosti kompilace kódu.</span><span class="sxs-lookup"><span data-stu-id="0edeb-142">The advantage of this approach is that changes are made in the configuration file, which means that the code should not be compiled to take advantage of the change.</span></span>  
  
### <a name="expressing-roles-as-claims"></a><span data-ttu-id="0edeb-143">Vyjádření rolí jako deklarací</span><span class="sxs-lookup"><span data-stu-id="0edeb-143">Expressing Roles as Claims</span></span>  
 <span data-ttu-id="0edeb-144">Když **IsInRole()** metoda je volána, je kontrola se kontroluje, zda má aktuální uživatel tuto roli.</span><span class="sxs-lookup"><span data-stu-id="0edeb-144">When the **IsInRole()** method is called, there is a check made to see if the current user has that role.</span></span> <span data-ttu-id="0edeb-145">V aplikacích pracujících s deklaracemi je role vyjádřena pomocí deklarace typu Role, která by měla být k dispozici v tokenu.</span><span class="sxs-lookup"><span data-stu-id="0edeb-145">In claims-aware applications, the role is expressed by a role claim type that should be available in the token.</span></span> <span data-ttu-id="0edeb-146">Deklarace typu Role je vyjádřena pomocí následujícího identifikátoru URI:</span><span class="sxs-lookup"><span data-stu-id="0edeb-146">The role claim type is expressed using the following URI:</span></span>  
  
 `http://schemas.microsoft.com/ws/2008/06/identity/claims/role`
  
 <span data-ttu-id="0edeb-147">K dispozici je několik možností, jak do tokenu doplnit deklaraci typu Role:</span><span class="sxs-lookup"><span data-stu-id="0edeb-147">There are several ways to enrich a token with a role claim type:</span></span>  
  
- <span data-ttu-id="0edeb-148">**Při vystavení tokenu**.</span><span class="sxs-lookup"><span data-stu-id="0edeb-148">**During token issuance**.</span></span> <span data-ttu-id="0edeb-149">Při ověření uživatele může být deklarace role vydané poskytovatelem identity STS nebo federačního zprostředkovatele, jako je například Windows Azure Access Control Service (ACS).</span><span class="sxs-lookup"><span data-stu-id="0edeb-149">When a user is authenticated the role claim can be issued by the identity provider STS or by a federation provider such as the Windows Azure Access Control Service (ACS).</span></span>  
  
- <span data-ttu-id="0edeb-150">**Přeměna libovolných deklarací na deklarace typu role pomocí komponenty ClaimsAuthenticationManager**.</span><span class="sxs-lookup"><span data-stu-id="0edeb-150">**Transforming arbitrary claims into of claims role type using ClaimsAuthenticationManager**.</span></span> <span data-ttu-id="0edeb-151">ClaimsAuthenticationManager je komponenta, která je dodávána jako součást technologie WIF.</span><span class="sxs-lookup"><span data-stu-id="0edeb-151">The ClaimsAuthenticationManager is a component that ships as part of WIF.</span></span> <span data-ttu-id="0edeb-152">Umožňuje zachytávat žádosti při spuštění aplikace, kontrolovat tokeny a transformovat je pomocí přidání, změny nebo odebrání deklarací.</span><span class="sxs-lookup"><span data-stu-id="0edeb-152">It allows requests to be intercepted when they launch an application, inspecting tokens and transforming them by adding, changing, or removing claims.</span></span> <span data-ttu-id="0edeb-153">Další informace o tom, jak transformovat deklarace pomocí komponenty ClaimsAuthenticationManager, naleznete v tématu [How To: Řízení přístupu (RBAC) v aplikaci ASP.NET vědět deklarace identity pomocí technologie WIF a služby ACS na základě rolí implementujte](https://go.microsoft.com/fwlink/?LinkID=247445).</span><span class="sxs-lookup"><span data-stu-id="0edeb-153">For more information about how to use ClaimsAuthenticationManager for transforming claims, see [How To: Implement Role Based Access Control (RBAC) in a Claims Aware ASP.NET Application Using WIF and ACS](https://go.microsoft.com/fwlink/?LinkID=247445).</span></span>  
  
- <span data-ttu-id="0edeb-154">**Mapování libovolných deklarací na typ role pomocí konfiguračního oddílu samlSecurityTokenRequirement**– deklarativní přístup, kde se provádí transformaci deklarací pomocí jenom konfigurace a bez kódování je povinný.</span><span class="sxs-lookup"><span data-stu-id="0edeb-154">**Mapping arbitrary claims to a role type using the samlSecurityTokenRequirement configuration section**—A declarative approach where the claims transformation is done using only the configuration and no coding is required.</span></span>  
  
<a name="BKMK_2"></a>   
## <a name="claims-based-authorization"></a><span data-ttu-id="0edeb-155">Autorizace na základě rolí</span><span class="sxs-lookup"><span data-stu-id="0edeb-155">Claims-based Authorization</span></span>  
 <span data-ttu-id="0edeb-156">Autorizace na základě deklarací je přístup, v rámci něhož autorizační rozhodnutí udělit nebo odepřít přístup vychází z libovolné logiky využívající data, která jsou k dispozici v deklaracích.</span><span class="sxs-lookup"><span data-stu-id="0edeb-156">Claims-based authorization is an approach where the authorization decision to grant or deny access is based on arbitrary logic that uses data available in claims to make the decision.</span></span> <span data-ttu-id="0edeb-157">Připomínáme, že v případě řízení přístupu RBAC se využívala jediná deklarace, a to deklarace typu Role.</span><span class="sxs-lookup"><span data-stu-id="0edeb-157">Recall that in the case of RBAC, the only claim used was role type claim.</span></span> <span data-ttu-id="0edeb-158">Deklarace typu Role umožňovala zjistit, zda uživatel patří či nepatří do určité role.</span><span class="sxs-lookup"><span data-stu-id="0edeb-158">A role type claim was used to check if the user belongs to specific role or not.</span></span> <span data-ttu-id="0edeb-159">Proces rozhodování o autorizaci s použitím autorizace na základě deklarací ilustrují následující kroky:</span><span class="sxs-lookup"><span data-stu-id="0edeb-159">To illustrate the process of making the authorization decisions using claims-based authorization approach, consider the following steps:</span></span>  
  
1. <span data-ttu-id="0edeb-160">Aplikace obdrží žádost, která vyžaduje ověření uživatele.</span><span class="sxs-lookup"><span data-stu-id="0edeb-160">The application receives a request that requires the user is authenticated.</span></span>  
  
2. <span data-ttu-id="0edeb-161">Technologie WIF přesměruje uživatele na jeho poskytovatele identity. Po ověření uživatele je aplikaci předložena žádost, k níž je přidružen token zabezpečení reprezentující uživatele a obsahující deklarace o uživateli.</span><span class="sxs-lookup"><span data-stu-id="0edeb-161">WIF redirects the user to their identity provider, after they are authenticated the application request is made with an associated security token representing the user containing claims about them.</span></span> <span data-ttu-id="0edeb-162">Technologie WIF přidruží tyto deklarace k objektu zabezpečení, který uživatele reprezentuje.</span><span class="sxs-lookup"><span data-stu-id="0edeb-162">WIF associates those claims with the principal that represents the user.</span></span>  
  
3. <span data-ttu-id="0edeb-163">Aplikace předá deklarace mechanismu, který implementuje rozhodovací logiku.</span><span class="sxs-lookup"><span data-stu-id="0edeb-163">The application passes the claims to the decision logic mechanism.</span></span> <span data-ttu-id="0edeb-164">Může to být kód v paměti, volání webové služby, dotaz do databáze, propracovaný modul pravidel nebo komponenta ClaimsAuthorizationManager.</span><span class="sxs-lookup"><span data-stu-id="0edeb-164">It can be in-memory code, a call to a web service, a query to a database, a sophisticated rules engine, or using the ClaimsAuthorizationManager.</span></span>  
  
4. <span data-ttu-id="0edeb-165">Rozhodovací mechanismus vypočítá výsledek na základě deklarací.</span><span class="sxs-lookup"><span data-stu-id="0edeb-165">The decision mechanism calculates the outcome based on the claims.</span></span>  
  
5. <span data-ttu-id="0edeb-166">Přístup je udělen, pokud je výsledkem hodnota true, a odepřen, pokud je výsledkem hodnota false.</span><span class="sxs-lookup"><span data-stu-id="0edeb-166">Access is granted if the outcome is true and denied if it is false.</span></span> <span data-ttu-id="0edeb-167">Pravidlo například může být, že věk uživatele je minimálně 21 let a žije ve státě Washington.</span><span class="sxs-lookup"><span data-stu-id="0edeb-167">For example, the rule might be that the user is of age 21 or above and lives in Washington State.</span></span>  
  
 <span data-ttu-id="0edeb-168"><xref:System.Security.Claims.ClaimsAuthorizationManager> je užitečné pro rozhodovací logiku pro ověřování na základě deklarací identity ve svých aplikacích.</span><span class="sxs-lookup"><span data-stu-id="0edeb-168"><xref:System.Security.Claims.ClaimsAuthorizationManager> is useful for externalizing the decision logic for  claims-based authorization in your applications.</span></span> <span data-ttu-id="0edeb-169">ClaimsAuthenticationManager je komponenta technologie WIF, která je dodávána jako součást technologie .NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="0edeb-169">ClaimsAuthorizationManager is a WIF component that ships as part of .NET 4.5.</span></span> <span data-ttu-id="0edeb-170">Komponenta ClaimsAuthorizationManager umožňuje zachytávat příchozí žádosti a implementovat jakoukoli logiku, která rozhoduje o autorizaci na základě obdržených deklarací.</span><span class="sxs-lookup"><span data-stu-id="0edeb-170">ClaimsAuthorizationManager allows you to intercept incoming requests and implement any logic of your choice to make authorization decisions based on the incoming claims.</span></span> <span data-ttu-id="0edeb-171">To je důležité, pokud je potřeba logiku autorizace změnit.</span><span class="sxs-lookup"><span data-stu-id="0edeb-171">This becomes important when authorization logic needs to be changed.</span></span> <span data-ttu-id="0edeb-172">V takovém případě používání komponenty ClaimsAuthorizationManager neovlivní integritu aplikace, a tím snižuje pravděpodobnost chyby v aplikaci v důsledku této změny.</span><span class="sxs-lookup"><span data-stu-id="0edeb-172">In that case, using ClaimsAuthorizationManager will not affect the application’s integrity, thereby reducing the likelihood of an application error as a result of the change.</span></span> <span data-ttu-id="0edeb-173">Další informace o tom, jak používat ClaimsAuthorizationManager implementovat řízení přístupu podle deklarací identity najdete v tématu [How To: Implementace deklarací autorizace v aplikaci ASP.NET vědět deklarace identity pomocí technologie WIF a služby ACS](https://go.microsoft.com/fwlink/?LinkID=247446).</span><span class="sxs-lookup"><span data-stu-id="0edeb-173">To learn more about how to use ClaimsAuthorizationManager to implement claims-based access control, see [How To: Implement Claims Authorization in a Claims Aware ASP.NET Application Using WIF and ACS](https://go.microsoft.com/fwlink/?LinkID=247446).</span></span>
