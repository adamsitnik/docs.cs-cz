---
title: Stromy v subsystému WPF
ms.date: 03/30/2017
helpviewer_keywords:
- logical tree [WPF]
- element tree [WPF]
- visual tree [WPF]
ms.assetid: e83f25e5-d66b-4fc7-92d2-50130c9a6649
ms.openlocfilehash: 1b1763f2fcad60da757a3d6ff23dc289e7506ead
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/22/2019
ms.locfileid: "69966094"
---
# <a name="trees-in-wpf"></a>Stromy v subsystému WPF
V mnoha technologiích jsou prvky a komponenty uspořádány ve stromové struktuře, kde vývojáři přímo manipulují s uzly objektů ve stromu, aby to ovlivnilo vykreslování nebo chování aplikace. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]k definování vztahů mezi prvky programu používá také několik metaphors stromové struktury. Pro většinu výrobců WPF mohou vývojáři vytvořit aplikaci v kódu nebo definovat části aplikace v jazyce XAML a současně se zamyslet na stromové struktuře objektů metafora, ale budou volat konkrétní rozhraní API nebo pomocí konkrétního kódu tak, aby místo obecných rozhraní API pro manipulaci se stromem objektů, například můžete použít v XML DOM. WPF zpřístupňuje dvě pomocné třídy, které poskytují stromové zobrazení <xref:System.Windows.LogicalTreeHelper> metafora <xref:System.Windows.Media.VisualTreeHelper>a. Výrazy vizuální strom a logický strom jsou také používány v dokumentaci k platformě WPF, protože tyto stejné stromy jsou užitečné pro porozumění chování některých klíčových funkcí WPF. Toto téma definuje, co znázorňuje vizuální strom a logický strom, popisuje, jak se tyto stromy vztahují k celkovému konceptu stromu objektů <xref:System.Windows.LogicalTreeHelper> a <xref:System.Windows.Media.VisualTreeHelper>zavádí a s.  

<a name="element_tree"></a>   
## <a name="trees-in-wpf"></a>Stromy v subsystému WPF  
 Nejvíce kompletní stromová struktura v [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nástroji je stromem objektů. Pokud definujete stránku aplikace v [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] a potom [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]načtete, je stromová struktura vytvořena na základě vztahů vnořování prvků v kódu. Definujete-li aplikaci nebo část aplikace v kódu, je vytvořena stromová struktura na základě toho, jak přiřazujete hodnoty vlastností pro vlastnosti, které implementují model obsahu pro daný objekt. V [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]nástroji existují dva způsoby, jak je koncepčně dokončen strom objektů a může být hlášen jeho veřejnému rozhraní API: jako logický strom a jako vizuální strom. Rozdíly mezi logickým stromem a vizuálním stromem nejsou vždy nutně důležité, ale mohou občas způsobovat problémy s určitými [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] subsystémy a ovlivnit volby, které provedete v kódu nebo kódu.  
  
 I když nebudete vždy pracovat buď s logickým stromem, nebo s vizuálním stromem přímo, porozumět konceptům, jak jsou stromy interakce, užitečné pro porozumění WPF jako technologii. Metafora WPF jako stromové struktury určitého druhu je také zásadní pro porozumění, jak dědičnost vlastností a směrování událostí fungují v [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
> [!NOTE]
> Vzhledem k tomu, že strom objektů je více konceptů než skutečné rozhraní API, je další způsob, jak si představit koncept, je jako graf objektů. V praxi jsou relace mezi objekty v době běhu, kde se metafora stromové struktury rozdělují. Nicméně, zejména s uživatelským rozhraním definovaným v jazyce XAML, je metafora ke stromu dostatečně důležité, aby většina dokumentace WPF při odkazování na tento obecný koncept používala pojem strom objektů.  
  
<a name="logical_tree"></a>   
## <a name="the-logical-tree"></a>Logický Strom  
 V [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]nástroji můžete přidat obsah do prvků uživatelského rozhraní nastavením vlastností objektů, které tyto prvky vrátí. Například můžete přidat položky do <xref:System.Windows.Controls.ListBox> ovládacího prvku pomocí manipulace s jeho <xref:System.Windows.Controls.ItemsControl.Items%2A> vlastností. Tímto způsobem umísťujete položky do <xref:System.Windows.Controls.ItemCollection> , což <xref:System.Windows.Controls.ItemsControl.Items%2A> je hodnota vlastnosti. Podobně pokud chcete přidat objekty do <xref:System.Windows.Controls.DockPanel>, budete pracovat s jeho <xref:System.Windows.Controls.Panel.Children%2A> hodnotou vlastnosti. Sem přidáváte objekty do <xref:System.Windows.Controls.UIElementCollection>. Příklad kódu naleznete v tématu [How to: Dynamicky](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms752374(v=vs.100))přidejte element.  
  
 <xref:System.Windows.Controls.DockPanel> <xref:System.Windows.Controls.ListBox> <xref:System.Windows.Controls.Panel.Children%2A> <xref:System.Windows.Controls.ItemsControl.Items%2A> Při umístění položek seznamu v ovládacím prvku nebo v jiných prvcích uživatelského rozhraní v, můžete také použít vlastnosti a, buď explicitně nebo implicitně, jako v následujícím příkladu. [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]  
  
 [!code-xaml[TreeOvwsSupport#AllCode](~/samples/snippets/csharp/VS_Snippets_Wpf/TreeOvwsSupport/CS/page1.xaml#allcode)]  
  
 Pokud byste chtěli tento XAML zpracovat jako XML v modelu objektu dokumentu a pokud jste zahrnuli značky jako implicitní (což by bylo právní), výsledný strom XML DOM by obsahoval prvky pro `<ListBox.Items>` a další implicitní položky. Jazyk XAML ale nezpracovává tento způsob při čtení značek a zápisů do objektů, což výsledný graf objektů nezahrnuje `ListBox.Items`. Má <xref:System.Windows.Controls.ListBox> však vlastnost s názvem `Items` , která obsahuje <xref:System.Windows.Controls.ItemCollection>a, která <xref:System.Windows.Controls.ItemCollection> je inicializována, ale prázdná při <xref:System.Windows.Controls.ListBox> zpracování XAML. Pak každý podřízený prvek objektu, který existuje jako obsah pro, <xref:System.Windows.Controls.ListBox> je přidán do rozhraní <xref:System.Windows.Controls.ItemCollection> analyzátorem volání `ItemCollection.Add`. Tento příklad zpracování XAML do stromové struktury objektů je zatím zdánlivě příklad, ve kterém je vytvořený strom objektů v podstatě logický strom.  
  
 Nicméně logický strom není celý graf objektů, který existuje pro uživatelské rozhraní aplikace za běhu, a to i v případě, že jsou implicitní položky syntaxe XAML vypočítané. Hlavním důvodem pro toto jsou vizuály a šablony. Zvažte <xref:System.Windows.Controls.Button>například. Logický Strom hlásí <xref:System.Windows.Controls.Button> objekt a také jeho řetězec `Content`. Ale k tomuto tlačítku je ve stromové struktuře objektů run-time k dispozici další. Konkrétně se tlačítko na obrazovce zobrazí jenom v případě, že se použila konkrétní <xref:System.Windows.Controls.Button> šablona ovládacího prvku. Vizuály, které pocházejí z použité šablony (jako je například šablona definovaná <xref:System.Windows.Controls.Border> tmavě šedou kolem tlačítka vizuálu), nejsou hlášeny v logickém stromu, a to ani v případě, že během běhu (například zpracování vstupní události z viditelné uživatelské rozhraní a následně čtení logického stromu). Chcete-li najít vizuály šablony, místo toho je nutné prostudovat vizuální strom.  
  
 Další informace o tom, [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] jak syntaxe namapována na graf vytvořeného objektu a implicitní syntaxi v jazyce XAML, naleznete [v tématu detail syntaxe jazyka XAML nebo v](xaml-syntax-in-detail.md) [přehledu XAML (WPF)](xaml-overview-wpf.md).  
  
<a name="tree_property_inheritance_event_routing"></a>   
### <a name="the-purpose-of-the-logical-tree"></a>Účel logického stromu  
 Logický Strom existuje, aby modely obsahu mohli snadno iterovat přes jejich možné podřízené objekty, a aby bylo možné modely obsahu rozšířit. Logický Strom také poskytuje rozhraní pro určitá oznámení, například když jsou načteny všechny objekty v logickém stromu. V podstatě je logický strom aproximací grafu objektů běhového času na úrovni rozhraní, která nezahrnuje vizuály, ale je vhodný pro mnoho operací dotazování na vlastní kompozici aplikace doby běhu.  
  
 Statické i dynamické odkazy na prostředky jsou navíc vyřešeny prohledáním v logickém stromové struktuře pro <xref:System.Windows.FrameworkElement.Resources%2A> kolekce na počátečním objektu, který požaduje, a následným pokračováním logického stromu <xref:System.Windows.FrameworkElement> a kontrolou každého (nebo <xref:System.Windows.FrameworkContentElement>) pro jinou `Resources` hodnotu, která <xref:System.Windows.ResourceDictionary>obsahuje, případně obsahující tento klíč. Logický strom se používá pro vyhledávání prostředků, pokud jsou k dispozici jak logický strom, tak i vizuální strom. Další informace o slovnících a vyhledáváních prostředků najdete v tématu věnovaném [prostředkům XAML](xaml-resources.md).  
  
<a name="composition"></a>   
### <a name="composition-of-the-logical-tree"></a>Složení logického stromu  
 Logický Strom je definován na úrovni architektury WPF, což znamená, že základní prvek WPF, který je nejrelevantnější pro operace logického stromu, je buď <xref:System.Windows.FrameworkElement> nebo. <xref:System.Windows.FrameworkContentElement> Nicméně jak vidíte, jestli <xref:System.Windows.LogicalTreeHelper> rozhraní API skutečně používáte, logický stromová struktura někdy obsahuje uzly, které nejsou buď <xref:System.Windows.FrameworkElement> nebo <xref:System.Windows.FrameworkContentElement>. Například Logický Strom hlásí <xref:System.Windows.Controls.TextBlock.Text%2A> hodnotu a <xref:System.Windows.Controls.TextBlock>, což je řetězec.  
  
<a name="override_logical_tree"></a>   
### <a name="overriding-the-logical-tree"></a>Přepsání logického stromu  
 Pokročilí autoři ovládacích prvků mohou přepsat logický strom přepsáním několika rozhraní API, která definují, jak obecný objekt nebo obsahový model přidávají nebo odstraňují objekty v rámci logického stromu. Příklad, jak přepsat logický strom, naleznete v tématu override The [Logical Tree](how-to-override-the-logical-tree.md).  
  
<a name="pvi"></a>   
### <a name="property-value-inheritance"></a>Dědičnost hodnoty vlastnosti  
 Dědičnost hodnot vlastností funguje prostřednictvím hybridního stromu. Skutečná metadata <xref:System.Windows.FrameworkPropertyMetadata.Inherits%2A> obsahující vlastnost, která umožňuje dědění vlastností, je třída úrovně <xref:System.Windows.FrameworkPropertyMetadata> rozhraní WPF. Proto obě nadřazené položky, která drží původní hodnotu a podřízený objekt, který dědí tuto hodnotu, musí být <xref:System.Windows.FrameworkElement> nebo <xref:System.Windows.FrameworkContentElement>a musí být součástí některých logických stromových struktur. Nicméně pro existující vlastnosti WPF, které podporují dědění vlastností, dědičnost hodnot vlastností může perpetuate prostřednictvím objektu, který není v logickém stromu. Hlavně to je relevantní pro to, aby prvky šablony používaly všechny zděděné hodnoty vlastností nastavené buď na instanci, která je šablonou, nebo ve stále vyšší úrovni složení na úrovni stránky, a proto vyšší v logickém stromu. Aby dědičnost hodnoty vlastností mohla v takové hranici konzistentně fungovat, musí být vlastnost dědění registrována jako připojená vlastnost a pokud chcete definovat vlastní vlastnost závislosti s vlastností, měli byste postupovat podle tohoto vzoru. chování dědičnosti. Přesný strom použitý k dědění vlastností nemůže být zcela předpokládaný metodou pomocné třídy, a to i v době běhu. Další informace najdete v tématu [Dědičnost hodnot vlastností](property-value-inheritance.md).  
  
<a name="two_trees"></a>   
## <a name="the-visual-tree"></a>Vizuální strom  
 Kromě konceptu logického stromu je také koncept vizuálního stromu v [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]. Vizuální strom popisuje strukturu vizuálních objektů, jak je znázorněno v <xref:System.Windows.Media.Visual> základní třídě. Při psaní šablony pro ovládací prvek definujete nebo předefinujete vizuální strom, který se vztahuje na tento ovládací prvek. Vizuální strom je také zajímavá vývojářům, kteří chtějí mít kontrolu na nižší úrovni nad vykreslováním kvůli výkonu a optimalizaci. Jednou z expozicí vizuálního stromu v rámci konvenčního [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programování aplikací je, že trasy událostí pro směrovanou událost většinou cestují do vizuálního stromu, nikoli z logického stromu. Tato Subtlety chování směrované události nemusí být hned zřejmá, pokud jste autorem ovládacího prvku. Směrování událostí prostřednictvím vizuálního stromu umožňuje ovládací prvky, které implementují složení na úrovni vizuálu pro zpracování událostí nebo vytváření setter událostí.  
  
<a name="trees_content"></a>   
## <a name="trees-content-elements-and-content-hosts"></a>Stromy, prvky obsahu a hostitelé obsahu  
 Prvky obsahu (třídy, které jsou <xref:System.Windows.ContentElement>odvozeny z) nejsou součástí vizuálního stromu, nedědí z <xref:System.Windows.Media.Visual> a nemají vizuální znázornění. Aby se mohla zobrazit v uživatelském rozhraní, <xref:System.Windows.ContentElement> musí být hostovaná v hostiteli obsahu, který je <xref:System.Windows.Media.Visual> účastníkem a i s logickým účastníkem stromu. Takový objekt je <xref:System.Windows.FrameworkElement>obvykle. Můžete conceptualize, že hostitel obsahu je trochu podobný jako "prohlížeč" pro obsah a zvolí, jak zobrazit daný obsah v oblasti obrazovky, kterou hostitel řídí. Po hostování obsahu může být obsah vytvořen účastníkem v určitých stromových procesech, které jsou obvykle přidruženy ke vizuálnímu stromu. Obecně třída <xref:System.Windows.ContentElement> Host zahrnuje implementační kód, který přidává všechny hostované do trasy události prostřednictvím dílčích uzlů logického stromu obsahu, i když hostovaný obsah není součástí skutečného vizuálního stromu. <xref:System.Windows.FrameworkElement> To je nezbytné, <xref:System.Windows.ContentElement> aby mohl zdroj směrované události směrovat na libovolný element jiný než samotný.  
  
<a name="tree_traversal"></a>   
## <a name="tree-traversal"></a>Procházení stromem  
 Třída poskytuje metody<xref:System.Windows.LogicalTreeHelper.GetParent%2A> ,a<xref:System.Windows.LogicalTreeHelper.FindLogicalNode%2A> pro procházení logických stromových struktur. <xref:System.Windows.LogicalTreeHelper.GetChildren%2A> <xref:System.Windows.LogicalTreeHelper> Ve většině případů nemusíte procházet logický strom existujících ovládacích prvků, protože tyto ovládací prvky téměř vždy zveřejňují své logické podřízené prvky jako vyhrazenou vlastnost kolekce, která podporuje přístup `Add`kolekce, jako je například indexer, a tak dále. Procházení stromové struktury je hlavně scénář, který se používá pro autory ovládacích prvků, které se rozhodnou neodvozovat <xref:System.Windows.Controls.Panel> od zamýšlených vzorů <xref:System.Windows.Controls.ItemsControl> ovládacích prvků, jako jsou již definované vlastnosti kolekce, a kteří mají v úmyslu poskytnout svou vlastní kolekci. Podpora vlastností.  
  
 Vizuální strom také podporuje pomocnou třídu pro procházení vizuálního stromu, <xref:System.Windows.Media.VisualTreeHelper>. Vizuální strom není přístupný jako pohodlný prostřednictvím vlastností specifických pro ovládací prvek, takže <xref:System.Windows.Media.VisualTreeHelper> třída je doporučeným způsobem pro procházení vizuálního stromu, pokud je to nezbytné pro váš scénář programování. Další informace naleznete v tématu [Přehled vykreslování grafiky WPF](../graphics-multimedia/wpf-graphics-rendering-overview.md).  
  
> [!NOTE]
> V některých případech je nutné prostudovat vizuální strom použité šablony. Při použití tohoto postupu byste měli být opatrní. I v případě, že přecházíte mezi vizuální stromovou strukturu ovládacího prvku, kde definujete šablonu, mohou uživatelé vašeho ovládacího prvku vždy měnit šablonu <xref:System.Windows.Controls.Control.Template%2A> nastavením vlastnosti u instancí a dokonce i koncový uživatel může ovlivnit použitou šablonu změnou systémový motiv.  
  
<a name="routes"></a>   
## <a name="routes-for-routed-events-as-a-tree"></a>Trasy pro směrované události jako "strom"  
 Jak už bylo zmíněno dříve, trasa každé směrované události je přenášena podél jedné a předem určené cesty stromu, který je hybridem reprezentace vizuálu a logického stromu. Směrování událostí může v závislosti na tom, zda se jedná o tunelové nebo probublávání směrované události, směrovat ve směru nahoru nebo dolů v rámci stromu. Koncept trasy události nemá přímo podpůrnou pomocnou třídu, která by se dala použít k "procházení" Směrování událostí nezávisle na vyvolání události, která ve skutečnosti směruje. Existuje třída, která představuje trasu, <xref:System.Windows.EventRoute>ale metody této třídy jsou obecně pouze pro interní použití.  
  
<a name="resourcesandtrees"></a>   
## <a name="resource-dictionaries-and-trees"></a>Slovníky prostředků a stromy  
 Vyhledávání slovníku prostředků pro všechny `Resources` definované na stránce projde v podstatě logický strom. Objekty, které nejsou v logickém stromu, mohou odkazovat na prostředky s klíčem, ale pořadí vyhledávání prostředků začíná v místě, kde je objekt připojen k logickému stromu. V jazyce WPF může mít `Resources` vlastnost, která <xref:System.Windows.ResourceDictionary>obsahuje, pouze logické uzly stromové struktury, takže není k dispozici žádný přínos při procházení vizuálního stromu při hledání prostředků <xref:System.Windows.ResourceDictionary>s klíčem z.  
  
 Vyhledávání prostředků ale může také překračovat rámec bezprostředního logického stromu. Pro označení aplikace může vyhledávání prostředků dále pokračovat ve slovnících prostředků na úrovni aplikace a následně na podporu motivů a systémové hodnoty, na které se odkazuje jako na statické vlastnosti nebo klíče. Pokud jsou odkazy na prostředky dynamické, mohou vlastní motivy také odkazovat na systémové hodnoty mimo logický strom motivů. Další informace o slovnících Resource a logikě vyhledávání najdete v tématu [prostředky XAML](xaml-resources.md).  
  
## <a name="see-also"></a>Viz také:

- [Přehled vstupu](input-overview.md)
- [Přehled vykreslování grafiky WPF](../graphics-multimedia/wpf-graphics-rendering-overview.md)
- [Přehled směrovaných událostí](routed-events-overview.md)
- [Inicializace elementů objektu, které nejsou ve stromu objektů](initialization-for-object-elements-not-in-an-object-tree.md)
- [Architektura WPF](wpf-architecture.md)
