---
title: 'Postupy: Zjištění, jestli jde vytisknout tiskovou úlohu v této denní době'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print queues [WPF], timing
- printers [WPF], availability
- print jobs [WPF], timing
ms.assetid: 7e9c8ec1-abf6-4b3d-b1c6-33b35d3c4063
ms.openlocfilehash: 859dc75169e443d07361951692a428507886fa2e
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/22/2019
ms.locfileid: "69947799"
---
# <a name="how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day"></a><span data-ttu-id="bc8b0-102">Postupy: Zjištění, jestli jde vytisknout tiskovou úlohu v této denní době</span><span class="sxs-lookup"><span data-stu-id="bc8b0-102">How to: Discover Whether a Print Job Can Be Printed At This Time of Day</span></span>
<span data-ttu-id="bc8b0-103">Tiskové fronty nejsou vždy k dispozici po dobu 24 hodin denně.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-103">Print queues are not always available for 24 hours a day.</span></span> <span data-ttu-id="bc8b0-104">Mají vlastnosti počáteční a koncového času, které je možné nastavit tak, aby byly v určitou dobu nedostupné.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-104">They have start and end time properties that can be set to make them unavailable at certain times of day.</span></span> <span data-ttu-id="bc8b0-105">Tato funkce se dá použít například k vyhrazení tiskárny pro výhradní použití určitého oddělení po dobu 5 hodin.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-105">This feature can be used, for example, to reserve a printer for the exclusive use of a certain department after 5 P.M..</span></span> <span data-ttu-id="bc8b0-106">Toto oddělení by mělo jinou frontu, která obsluhuje tiskárnu, než jiné oddělení používají.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-106">That department would have a different queue servicing the printer than other departments use.</span></span> <span data-ttu-id="bc8b0-107">Fronta pro ostatní oddělení se nastaví jako nedostupná po dobu 5 hodin, zatímco fronta pro Upřednostněné oddělení by mohla být na všech místech k dispozici.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-107">The queue for the other departments would be set to be unavailable after 5 P.M., while queue for the favored department could be set to be available at all times.</span></span>  
  
 <span data-ttu-id="bc8b0-108">Tisk samotných úloh se navíc dá nastavit tak, aby se daly tisknout jenom v určeném časovém intervalu.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-108">Moreover, print jobs themselves can be set to be printable only within a specified span of time.</span></span>  
  
 <span data-ttu-id="bc8b0-109">Třídy <xref:System.Printing.PrintQueue> a<xref:System.Printing.PrintSystemJobInfo> zveřejněné v rozhraní API Microsoft .NET Framework poskytují prostředky pro vzdálenou kontrolu toho, zda může daná tisková úloha tisknout v dané frontě v aktuálním čase.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-109">The <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> classes exposed in the APIs of Microsoft .NET Framework provide a means for remotely checking whether a given print job can print on a given queue at the current time.</span></span>  
  
## <a name="example"></a><span data-ttu-id="bc8b0-110">Příklad</span><span class="sxs-lookup"><span data-stu-id="bc8b0-110">Example</span></span>  
 <span data-ttu-id="bc8b0-111">Příkladem níže je ukázka, která může diagnostikovat problémy s tiskovou úlohou.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-111">The example below is a sample that can diagnose problems with a print job.</span></span>  
  
 <span data-ttu-id="bc8b0-112">Existují dva hlavní kroky pro tento druh funkce, jak je znázorněno níže.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-112">There are two major steps for this kind of function as follows.</span></span>  
  
1. <span data-ttu-id="bc8b0-113">Přečtěte si <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> vlastnosti <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> <xref:System.Printing.PrintQueue> a a určete, zda je mezi nimi aktuální čas.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-113">Read the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintQueue> to determine whether the current time is between them.</span></span>  
  
2. <span data-ttu-id="bc8b0-114">Přečtěte si <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> vlastnosti <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> <xref:System.Printing.PrintSystemJobInfo> a a určete, zda je mezi nimi aktuální čas.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-114">Read the <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> and <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintSystemJobInfo> to determine whether the current time is between them.</span></span>  
  
 <span data-ttu-id="bc8b0-115">Ale komplikace se projeví z faktu, že <xref:System.DateTime> tyto vlastnosti nejsou objekty.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-115">But complications arise from the fact that these properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="bc8b0-116">Místo toho jsou <xref:System.Int32> objekty, které vyjadřují denní dobu jako počet minut od půlnoci.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-116">Instead they are <xref:System.Int32> objects that express the time of day as the number of minutes since midnight.</span></span> <span data-ttu-id="bc8b0-117">Kromě toho se nejedná o půlnoc v aktuálním časovém pásmu, ale o půlnoci UTC (koordinovaný světový čas).</span><span class="sxs-lookup"><span data-stu-id="bc8b0-117">Moreover, this is not midnight in the current time zone, but midnight UTC (Coordinated Universal Time).</span></span>  
  
 <span data-ttu-id="bc8b0-118">První příklad kódu představuje statickou metodu **ReportQueueAndJobAvailability**, která je předána <xref:System.Printing.PrintSystemJobInfo> a volá pomocné metody k určení, zda se může úloha tisknout v aktuálním čase a v případě, že je může tisknout.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-118">The first code example presents the static method **ReportQueueAndJobAvailability**, which is passed a <xref:System.Printing.PrintSystemJobInfo> and calls helper methods to determine whether the job can print at the current time and, if not, when it can print.</span></span> <span data-ttu-id="bc8b0-119">Všimněte si, <xref:System.Printing.PrintQueue> že metoda není předána metodě.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-119">Notice that a <xref:System.Printing.PrintQueue> is not passed to the method.</span></span> <span data-ttu-id="bc8b0-120">Důvodem je, <xref:System.Printing.PrintSystemJobInfo> že zahrnuje odkaz na frontu ve své <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-120">This is because the <xref:System.Printing.PrintSystemJobInfo> includes a reference to the queue in its <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> property.</span></span>  
  
 <span data-ttu-id="bc8b0-121">Podřízené metody zahrnují přetíženou metodu **ReportAvailabilityAtThisTime** , která může použít buď <xref:System.Printing.PrintQueue> nebo <xref:System.Printing.PrintSystemJobInfo> jako parametr.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-121">The subordinate methods include the overloaded **ReportAvailabilityAtThisTime** method which can take either a <xref:System.Printing.PrintQueue> or a <xref:System.Printing.PrintSystemJobInfo> as a parameter.</span></span> <span data-ttu-id="bc8b0-122">K dispozici je také **TimeConverter. ConvertToLocalHumanReadableTime**.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-122">There is also a **TimeConverter.ConvertToLocalHumanReadableTime**.</span></span> <span data-ttu-id="bc8b0-123">Všechny tyto metody jsou popsány níže.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-123">All of these methods are discussed below.</span></span>  
  
 <span data-ttu-id="bc8b0-124">Metoda **ReportQueueAndJobAvailability** se spustí tak, že zkontroluje, jestli není v tuto chvíli fronta nebo tisková úloha dostupná.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-124">The **ReportQueueAndJobAvailability** method begins by checking to see if either the queue or the print job is unavailable at this time.</span></span> <span data-ttu-id="bc8b0-125">Pokud je některá z nich nedostupná, zkontroluje, jestli není fronta k dispozici.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-125">If either of them is unavailable, it then checks to see if the queue unavailable.</span></span> <span data-ttu-id="bc8b0-126">Pokud není k dispozici, pak metoda oznámí tuto skutečnost a čas, kdy bude fronta opět k dispozici.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-126">If it is not available, then the method reports this fact and the time when the queue will become available again.</span></span> <span data-ttu-id="bc8b0-127">Pak zkontroluje úlohu a pokud není k dispozici, ohlásí příští časové období, kdy může tisknout.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-127">It then checks the job and if it is unavailable, it reports the next time span when it when it can print.</span></span> <span data-ttu-id="bc8b0-128">Nakonec metoda oznamuje Nejdřívější čas, kdy může úloha tisknout.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-128">Finally, the method reports the earliest time when the job can print.</span></span> <span data-ttu-id="bc8b0-129">To je pozdější, než dvakrát.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-129">This is the later of following two times.</span></span>  
  
- <span data-ttu-id="bc8b0-130">Čas, kdy bude tisková fronta příště dostupná.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-130">The time when the print queue is next available.</span></span>  
  
- <span data-ttu-id="bc8b0-131">Čas, kdy bude tisková úloha příště k dispozici.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-131">The time when the print job is next available.</span></span>  
  
 <span data-ttu-id="bc8b0-132">Při vykazování času dne <xref:System.DateTime.ToShortTimeString%2A> je metoda volána také proto, že tato metoda potlačuje roky, měsíce a dny z výstupu.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-132">When reporting times of day, the <xref:System.DateTime.ToShortTimeString%2A> method is also called because this method suppresses the years, months, and days from the output.</span></span> <span data-ttu-id="bc8b0-133">Nemůžete omezit dostupnost tiskové fronty ani tiskové úlohy na konkrétní roky, měsíce nebo dny.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-133">You cannot restrict the availability of either a print queue or a print job to particular years, months, or days.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#reportqueueandjobavailability)]
 [!code-csharp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#reportqueueandjobavailability)]
 [!code-vb[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#reportqueueandjobavailability)]  
  
 <span data-ttu-id="bc8b0-134">Dvě přetížení metody **ReportAvailabilityAtThisTime** jsou identická s výjimkou typu, který je předaný, takže níže je uvedena pouze <xref:System.Printing.PrintQueue> verze.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-134">The two overloads of the **ReportAvailabilityAtThisTime** method are identical except for the type passed to them, so only the <xref:System.Printing.PrintQueue> version is presented below.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="bc8b0-135">Skutečnost, že metody jsou identické s výjimkou typu, vyvolává otázku proč ukázka nevytvoří obecnou metodu **\<ReportAvailabilityAtThisTime T >** .</span><span class="sxs-lookup"><span data-stu-id="bc8b0-135">The fact that the methods are identical except for type raises the question of why the sample does not create a generic method **ReportAvailabilityAtThisTime\<T>**.</span></span> <span data-ttu-id="bc8b0-136">Důvodem je, že taková metoda by musela být omezena na třídu, která má vlastnosti **StartTimeOfDay** a **UntilTimeOfDay** , kterou metoda volá, ale obecnou metodu lze omezit pouze na jedinou třídu a jedinou třídou, která je společná pro obě. <xref:System.Printing.PrintQueue> a ve<xref:System.Printing.PrintSystemJobInfo>stromové struktuře dědičnosti<xref:System.Printing.PrintSystemObject> nemá takové vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-136">The reason is that such a method would have to be restricted to a class that has the **StartTimeOfDay** and **UntilTimeOfDay** properties that the method calls, but a generic method can only be restricted to a single class and the only class common to both <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> in the inheritance tree is <xref:System.Printing.PrintSystemObject> which has no such properties.</span></span>  
  
 <span data-ttu-id="bc8b0-137">Metoda **ReportAvailabilityAtThisTime** (uvedená v následujícím příkladu kódu) začíná inicializací <xref:System.Boolean> proměnné Sentinel na. `true`</span><span class="sxs-lookup"><span data-stu-id="bc8b0-137">The **ReportAvailabilityAtThisTime** method (presented in the code example below) begins by initializing a <xref:System.Boolean> sentinel variable to `true`.</span></span> <span data-ttu-id="bc8b0-138">V případě `false`, že fronta není k dispozici, bude obnovena.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-138">It will be reset to `false`, if the queue is not available.</span></span>  
  
 <span data-ttu-id="bc8b0-139">Dále metoda zkontroluje, zda jsou časy Start a "do" stejné.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-139">Next, the method checks to see if the start and "until" times are identical.</span></span> <span data-ttu-id="bc8b0-140">Pokud jsou, fronta je vždy k dispozici, takže se metoda vrátí `true`.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-140">If they are, the queue is always available, so the method returns `true`.</span></span>  
  
 <span data-ttu-id="bc8b0-141">Pokud není fronta k dispozici po celou dobu, metoda použije statickou <xref:System.DateTime.UtcNow%2A> vlastnost k získání aktuálního času <xref:System.DateTime> jako objektu.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-141">If the queue is not available all the time, the method uses the static <xref:System.DateTime.UtcNow%2A> property to get the current time as a <xref:System.DateTime> object.</span></span> <span data-ttu-id="bc8b0-142">(Nepotřebujeme místní čas, protože <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> vlastnosti a <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> jsou samy v čase UTC.)</span><span class="sxs-lookup"><span data-stu-id="bc8b0-142">(We do not need local time because the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties are themselves in UTC time.)</span></span>  
  
 <span data-ttu-id="bc8b0-143">Tyto dvě vlastnosti <xref:System.DateTime> však nejsou objekty.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-143">However, these two properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="bc8b0-144">Jsou <xref:System.Int32>v čase vyjádřené jako počet minut po UTC-půlnoci.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-144">They are <xref:System.Int32>s expressing the time as the number of minutes-after-UTC-midnight.</span></span> <span data-ttu-id="bc8b0-145">Proto musíme převést náš <xref:System.DateTime> objekt na minuty po půlnoci.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-145">So we do have to convert our <xref:System.DateTime> object to minutes-after-midnight.</span></span> <span data-ttu-id="bc8b0-146">V takovém případě metoda jednoduše zkontroluje, jestli je "Now" mezi dobou spuštění fronty a "do", nastaví Sentinel na hodnotu false, pokud "Now" není mezi dvěma časy a vrátí Sentinel.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-146">When that is done, the method simply checks to see whether "now" is between the queue's start and "until" times, sets the sentinel to false if "now" is not between the two times, and returns the sentinel.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#printqueuestartuntil)]
 [!code-csharp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#printqueuestartuntil)]
 [!code-vb[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#printqueuestartuntil)]  
  
 <span data-ttu-id="bc8b0-147">Metoda **TimeConverter. ConvertToLocalHumanReadableTime** (uvedená v následujícím příkladu kódu) nepoužívá žádné metody, které jsou zavedeny v rámci Microsoft .NET Framework, takže diskuze je stručná.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-147">The **TimeConverter.ConvertToLocalHumanReadableTime** method (presented in the code example below) does not use any methods introduced with Microsoft .NET Framework, so the discussion is brief.</span></span> <span data-ttu-id="bc8b0-148">Metoda má úlohu s dvojitou konverzí: musí přijmout celé číslo vyjadřující minuty po půlnoci a převést ji na čas, který je čitelný člověkem, a musí to převést na místní čas.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-148">The method has a double conversion task: it must take an integer expressing minutes-after-midnight and convert it to a human-readable time and it must convert this to the local time.</span></span> <span data-ttu-id="bc8b0-149">To to provede tím, že nejprve vytvoří <xref:System.DateTime> objekt, který je nastaven na půlnoc UTC, a pak <xref:System.DateTime.AddMinutes%2A> použije metodu k přidání minut, které byly předány metodě.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-149">It accomplishes this by first creating a <xref:System.DateTime> object that is set to midnight UTC and then it uses the <xref:System.DateTime.AddMinutes%2A> method to add the minutes that were passed to the method.</span></span> <span data-ttu-id="bc8b0-150">To vrací nové <xref:System.DateTime> vyjádření původního času, který byl předán metodě.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-150">This returns a new <xref:System.DateTime> expressing the original time that was passed to the method.</span></span> <span data-ttu-id="bc8b0-151"><xref:System.DateTime.ToLocalTime%2A> Metoda pak tuto metodu převede na místní čas.</span><span class="sxs-lookup"><span data-stu-id="bc8b0-151">The <xref:System.DateTime.ToLocalTime%2A> method then converts this to local time.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#timeconverter)]
 [!code-csharp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#timeconverter)]
 [!code-vb[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#timeconverter)]  
  
## <a name="see-also"></a><span data-ttu-id="bc8b0-152">Viz také:</span><span class="sxs-lookup"><span data-stu-id="bc8b0-152">See also</span></span>

- <xref:System.DateTime>
- <xref:System.Printing.PrintSystemJobInfo>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="bc8b0-153">Dokumenty v platformě WPF</span><span class="sxs-lookup"><span data-stu-id="bc8b0-153">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="bc8b0-154">Přehled tisku</span><span class="sxs-lookup"><span data-stu-id="bc8b0-154">Printing Overview</span></span>](printing-overview.md)
