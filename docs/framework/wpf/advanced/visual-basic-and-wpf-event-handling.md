---
title: Zpracování událostí v jazyku Visual Basic a WPF
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 8b4601ea4034068ccdb4bfe0744f658586d74ece
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/23/2019
ms.locfileid: "54582224"
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="fbb3d-102">Zpracování událostí v jazyku Visual Basic a WPF</span><span class="sxs-lookup"><span data-stu-id="fbb3d-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="fbb3d-103">Pro jazyk Microsoft Visual Basic .NET, můžete použít konkrétní jazyk `Handles` – klíčové slovo k přidružení obslužné rutiny události instance, místo připojování obslužné rutiny události s atributy nebo použití <xref:System.Windows.UIElement.AddHandler%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-103">For the Microsoft Visual Basic .NET language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="fbb3d-104">Ale `Handles` techniku pro připojení k instancím obslužných rutin mají určitá omezení, protože `Handles` syntaxe nemůže zajišťovat podporu pro některé funkce konkrétní směrované události [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] systém událostí.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="fbb3d-105">Použití "Popisovače" v aplikaci WPF</span><span class="sxs-lookup"><span data-stu-id="fbb3d-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="fbb3d-106">Obslužné rutiny událostí, které jsou připojené k instancí a událostí pomocí `Handles` musí všechny definovat v deklaraci částečné třídy instance, která je také požadavek pro obslužné rutiny událostí, které jsou přiřazeny prostřednictvím hodnoty atributů na prvky.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="fbb3d-107">Můžete zadat jenom `Handles` pro element na stránce, která má <xref:System.Windows.FrameworkContentElement.Name%2A> hodnotu vlastnosti (nebo [x: Name – direktiva](../../../../docs/framework/xaml-services/x-name-directive.md) deklarovaná).</span><span class="sxs-lookup"><span data-stu-id="fbb3d-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../../../docs/framework/xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="fbb3d-108">Důvodem je, že <xref:System.Windows.FrameworkContentElement.Name%2A> v [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] vytvoří instanci odkaz, který je nezbytný pro podporu *Instance.Event* vyžadované formát reference `Handles` syntaxe.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="fbb3d-109">Jediným prvkem, který lze použít pro `Handles` bez <xref:System.Windows.FrameworkContentElement.Name%2A> odkaz je instance kořenový element, který definuje částečné třídy.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="fbb3d-110">Můžete přiřadit stejnou obslužnou rutinu více prvků tak, že oddělíte *Instance.Event* odkazuje po `Handles` čárkami.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="fbb3d-111">Můžete použít `Handles` přiřadit více než jednu obslužnou rutinu na stejný *Instance.Event*odkaz.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="fbb3d-112">Nepřiřazujte všechny důležité pořadí, ve kterém jsou uvedeny obslužných rutin v `Handles` odkazovat; byste měli předpokládat, že obslužné rutiny, které zpracovávají stejnou událost může být vyvolána v libovolném pořadí.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="fbb3d-113">Chcete-li odebrat obslužnou rutinu, která byla přidána s `Handles` v deklaraci, můžete volat <xref:System.Windows.UIElement.RemoveHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="fbb3d-114">Můžete použít `Handles` připojit obslužné rutiny pro směrované události, tak dlouho, dokud obslužné rutiny připojit k instancím, které definují zpracovává události v tabulkách jejich členy.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="fbb3d-115">Směrované události, obslužné rutiny, které jsou připojené pomocí `Handles` postupujte podle stejných pravidel směrování, stejně jako obslužné rutiny, které jsou připojené jako [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] atributy, nebo pomocí běžných podpis <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="fbb3d-116">To znamená, že pokud je již označena zpracované události ( <xref:System.Windows.RoutedEventArgs.Handled%2A> vlastnost v datech událostí je `True`), a připojil se k němu obslužné rutiny `Handles` nejsou vyvolány v reakci na tuto instanci události.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="fbb3d-117">Události lze označit jako zpracované instance obslužné rutiny na jiný element v trase, nebo zpracování buď na aktuální prvek nebo nemusí předchozí prvky na trase třídy.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="fbb3d-118">Pro vstupní události, které podporují spárované tunelového propojení/bubliny událostí může tunelového propojení směrování označili pár událost zpracovává.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="fbb3d-119">Další informace o směrované události najdete v tématu [směrovat Přehled událostí](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fbb3d-119">For more information about routed events, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="fbb3d-120">Omezení "Popisovače" pro přidání obslužné rutiny</span><span class="sxs-lookup"><span data-stu-id="fbb3d-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="fbb3d-121">`Handles` obslužné rutiny pro připojené události nelze odkazovat.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="fbb3d-122">Je nutné použít `add` přístupové metody pro tuto událost pro připojené, nebo *typename.eventname* události atributy v [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fbb3d-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="fbb3d-123">Podrobnosti najdete v tématu [směrovat Přehled událostí](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fbb3d-123">For details, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="fbb3d-124">Pro směrovaných událostí, lze použít pouze `Handles` přiřadit obslužné rutiny pro instance, kde existuje tuto událost v tabulce členů instance.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="fbb3d-125">Ale za použití směrovaných událostí obecně platí, nadřazený element může být naslouchacího procesu pro událost z podřízených prvků, i v případě, že nadřazený element nemá tuto událost v tabulce jeho členů.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="fbb3d-126">V syntaxi atributu, můžete určit to prostřednictvím *typename.membername* atribut formulář, který kvalifikuje typů, které se definuje skutečně vy chcete zpracovávat události.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="fbb3d-127">Například nadřazené `Page` (bez `Click` události definované) můžete očekávat události kliknutí na tlačítko přiřazením obslužnou rutinu atributu ve formuláři `Button.Click`.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="fbb3d-128">Ale `Handles` nepodporuje *typename.membername* formuláře, protože musí podporovat konfliktní *Instance.Event* formuláře.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="fbb3d-129">Podrobnosti najdete v tématu [směrovat Přehled událostí](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fbb3d-129">For details, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="fbb3d-130">`Handles` obslužné rutiny, které jsou vyvolány události, které jsou označeny už zpracované nelze připojit.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="fbb3d-131">Místo toho je nutné použít kód a volání `handledEventsToo` přetížení <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="fbb3d-132">Nepoužívejte `Handles` syntaxe v kódu jazyka Visual Basic, když zadáte obslužnou rutinu události pro stejnou událost v XAML.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-132">Do not use the `Handles` syntax in Visual Basic code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="fbb3d-133">V tomto případě obslužná rutina události je volána dvakrát.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="fbb3d-134">Způsob, jakým implementuje WPF "zpracovává" funkce</span><span class="sxs-lookup"><span data-stu-id="fbb3d-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="fbb3d-135">Při [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] je stránka kompilovaná, deklaruje pomocný soubor `Friend` `WithEvents` odkazy na každý prvek na stránce, která má <xref:System.Windows.FrameworkContentElement.Name%2A> nastavenou vlastnost (nebo [x: Name – direktiva](../../../../docs/framework/xaml-services/x-name-directive.md) deklarovaná).</span><span class="sxs-lookup"><span data-stu-id="fbb3d-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../../../docs/framework/xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="fbb3d-136">Každá pojmenované instance je potenciálně element, jemuž lze přiřadit k obslužné rutině prostřednictvím `Handles`.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="fbb3d-137">V rámci [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], [!INCLUDE[TLA2#tla_intellisense](../../../../includes/tla2sharptla-intellisense-md.md)] zobrazit dokončení pro které jsou k dispozici pro prvky `Handles` odkazu na stránce.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-137">Within [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], [!INCLUDE[TLA2#tla_intellisense](../../../../includes/tla2sharptla-intellisense-md.md)] can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="fbb3d-138">Ale může to trvat kompilace najednou tak, aby všechny zprostředkující soubor můžete zadat `Friends` odkazy.</span><span class="sxs-lookup"><span data-stu-id="fbb3d-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fbb3d-139">Viz také:</span><span class="sxs-lookup"><span data-stu-id="fbb3d-139">See also</span></span>
- <xref:System.Windows.UIElement.AddHandler%2A>
- [<span data-ttu-id="fbb3d-140">Označení směrovaných událostí jako zpracovaných a zpracování tříd</span><span class="sxs-lookup"><span data-stu-id="fbb3d-140">Marking Routed Events as Handled, and Class Handling</span></span>](../../../../docs/framework/wpf/advanced/marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="fbb3d-141">Přehled směrovaných událostí</span><span class="sxs-lookup"><span data-stu-id="fbb3d-141">Routed Events Overview</span></span>](../../../../docs/framework/wpf/advanced/routed-events-overview.md)
- [<span data-ttu-id="fbb3d-142">Přehled XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="fbb3d-142">XAML Overview (WPF)</span></span>](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)
