---
title: 'Postupy: Diagnostika problematické tiskové úlohy'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- troubleshooting print job problems [WPF]
- print jobs [WPF], troubleshooting
- print jobs [WPF], diagnosing problems
ms.assetid: b081a170-84c6-48f9-a487-5766a8d58a82
ms.openlocfilehash: fc38d239720b5d5a8e159f91749b03512568cd9b
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/18/2019
ms.locfileid: "59338472"
---
# <a name="how-to-diagnose-problematic-print-job"></a><span data-ttu-id="0f3ce-102">Postupy: Diagnostika problematické tiskové úlohy</span><span class="sxs-lookup"><span data-stu-id="0f3ce-102">How to: Diagnose Problematic Print Job</span></span>
<span data-ttu-id="0f3ce-103">Správci sítě často pole stížností od uživatelů o tiskové úlohy, které vytisknout nebo vytisknout pomalu.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-103">Network administrators often field complaints from users about print jobs that do not print or print slowly.</span></span> <span data-ttu-id="0f3ce-104">Bohaté sadě vlastností tiskovou úlohu v [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] Microsoft .NET Framework poskytují způsob pro provádění rychlé vzdálené diagnostiky tiskových úloh.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-104">The rich set of print job properties exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of Microsoft .NET Framework provide a means for performing a rapid remote diagnosis of print jobs.</span></span>  
  
## <a name="example"></a><span data-ttu-id="0f3ce-105">Příklad</span><span class="sxs-lookup"><span data-stu-id="0f3ce-105">Example</span></span>  
 <span data-ttu-id="0f3ce-106">Hlavní kroky pro vytvoření tento druh nástroj jsou následující.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-106">The major steps for creating this kind of utility are as follows.</span></span>  
  
1. <span data-ttu-id="0f3ce-107">Identifikujte tiskové úlohy, která je stěžovat uživatele.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-107">Identify the print job that the user is complaining about.</span></span> <span data-ttu-id="0f3ce-108">Uživatelé často nelze provést přesně.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-108">Users often cannot do this precisely.</span></span> <span data-ttu-id="0f3ce-109">Názvy tiskáren nebo tiskových serverů, které nemusí znají.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-109">They may not know the names of the print servers or printers.</span></span> <span data-ttu-id="0f3ce-110">Může popisu umístění tiskárny v odlišnou terminologii, než se používá v nastavení jeho <xref:System.Printing.PrintQueue.Location%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-110">They may describe the location of the printer in different terminology than was used in setting its <xref:System.Printing.PrintQueue.Location%2A> property.</span></span> <span data-ttu-id="0f3ce-111">Proto je vhodné vytvořit seznam uživatele aktuálně odeslaných úloh.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-111">Accordingly, it is a good idea to generate a list of the user's currently submitted jobs.</span></span> <span data-ttu-id="0f3ce-112">Pokud existuje více než jeden, pak komunikace mezi uživatelem a správce tiskovém systému slouží ke kotvícímu bodu na úlohu, problémy.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-112">If there is more than one, then communication between the user and the print system administrator can be used to pinpoint the job that is having problems.</span></span> <span data-ttu-id="0f3ce-113">Dílčí kroky jsou následující.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-113">The substeps are as follows.</span></span>  
  
    1.  <span data-ttu-id="0f3ce-114">Získáte seznam všech tiskových serverů.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-114">Obtain a list of all print servers.</span></span>  
  
    2.  <span data-ttu-id="0f3ce-115">Projít servery, které chcete dotazovat jejich tiskové fronty.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-115">Loop through the servers to query their print queues.</span></span>  
  
    3.  <span data-ttu-id="0f3ce-116">V každém průchodu server smyčky projděte všechny server fronty a dotazování svých úloh</span><span class="sxs-lookup"><span data-stu-id="0f3ce-116">Within each pass of the server loop, loop through all the server's queues to query their jobs</span></span>  
  
    4.  <span data-ttu-id="0f3ce-117">V každém průchodu fronty smyčky projít jeho úlohy a shromážděte identifikační informace o těch, které byly předány žalující uživatelem.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-117">Within each pass of the queue loop, loop through its jobs and gather identifying information about those that were submitted by the complaining user.</span></span>  
  
2. <span data-ttu-id="0f3ce-118">Pokud byla zjištěna problematické tiskové úlohy, podívejte se na relevantní vlastnosti chcete zobrazit, co může být problém.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-118">When the problematic print job has been identified, examine relevant properties to see what might be the problem.</span></span> <span data-ttu-id="0f3ce-119">Například je úloha ve stavu chyby nebo nebyla Údržba tiskárny fronty přejít do režimu offline, než má úloha může vytisknout?</span><span class="sxs-lookup"><span data-stu-id="0f3ce-119">For example, is job in an error state or did the printer servicing the queue go offline before the job could print?</span></span>  
  
 <span data-ttu-id="0f3ce-120">Následující kód je řada příklady kódu.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-120">The code below is series of code examples.</span></span> <span data-ttu-id="0f3ce-121">První příklad kódu obsahuje projděte tiskové fronty.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-121">The first code example contains the loop through the print queues.</span></span> <span data-ttu-id="0f3ce-122">(Krok 1c výše). Proměnná `myPrintQueues` je <xref:System.Printing.PrintQueueCollection> objektů pro aktuální tiskový server.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-122">(Step 1c above.) The variable `myPrintQueues` is the <xref:System.Printing.PrintQueueCollection> object for the current print server.</span></span>  
  
 <span data-ttu-id="0f3ce-123">Příklad kódu začíná aktualizací aktuální objekt tiskové fronty s <xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-123">The code example begins by refreshing the current print queue object with <xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0f3ce-124">Tím se zajistí, že vlastnosti objektu přesně reprezentovat stav fyzické tiskárny, který představuje.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-124">This ensures that the object's properties accurately represent the state of the physical printer that it represents.</span></span> <span data-ttu-id="0f3ce-125">Potom aplikace získá kolekci tiskových úloh aktuálně v tiskové frontě pomocí <xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A>.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-125">Then the application gets the collection of print jobs currently in the print queue by using <xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A>.</span></span>  
  
 <span data-ttu-id="0f3ce-126">Další aplikace prochází <xref:System.Printing.PrintSystemJobInfo> kolekce a porovná <xref:System.Printing.PrintSystemJobInfo.Submitter%2A> vlastnost s aliasem žalující uživatele.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-126">Next the application loops through the <xref:System.Printing.PrintSystemJobInfo> collection and compares each <xref:System.Printing.PrintSystemJobInfo.Submitter%2A> property with the alias of the complaining user.</span></span> <span data-ttu-id="0f3ce-127">Pokud se shodují, aplikace přidá identifikační informace o úloze řetězec, který se zobrazí.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-127">If they match, the application adds identifying information about the job to the string that will be presented.</span></span> <span data-ttu-id="0f3ce-128">( `userName` a `jobList` proměnné jsou inicializovány dříve v aplikaci.)</span><span class="sxs-lookup"><span data-stu-id="0f3ce-128">(The `userName` and `jobList` variables are initialized earlier in the application.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#enumeratejobsinqueues)]
 [!code-csharp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#enumeratejobsinqueues)]
 [!code-vb[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#enumeratejobsinqueues)]  
  
 <span data-ttu-id="0f3ce-129">Následující příklad kódu načte, začne používat tuto aplikaci v kroku 2.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-129">The next code example picks up the application at Step 2.</span></span> <span data-ttu-id="0f3ce-130">(Viz výše). Byla zjištěna problematické úlohy a aplikace vyzve k zadání informací, které bude identifikovat.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-130">(See above.) The problematic job has been identified and the application prompts for the information that will identify it.</span></span> <span data-ttu-id="0f3ce-131">Z těchto informací vytvoří <xref:System.Printing.PrintServer>, <xref:System.Printing.PrintQueue>, a <xref:System.Printing.PrintSystemJobInfo> objekty.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-131">From this information it creates <xref:System.Printing.PrintServer>, <xref:System.Printing.PrintQueue>, and <xref:System.Printing.PrintSystemJobInfo> objects.</span></span>  
  
 <span data-ttu-id="0f3ce-132">V tomto okamžiku aplikace obsahuje strukturu větvení odpovídající na dva způsoby, jak kontroluje se stav tiskové úlohy:</span><span class="sxs-lookup"><span data-stu-id="0f3ce-132">At this point the application contains a branching structure corresponding to the two ways of checking a print job's status:</span></span>  
  
-   <span data-ttu-id="0f3ce-133">Můžete si přečíst příznaky z <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> vlastnost, která je typu <xref:System.Printing.PrintJobStatus>.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-133">You can read the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property which is of type <xref:System.Printing.PrintJobStatus>.</span></span>  
  
-   <span data-ttu-id="0f3ce-134">Můžete si přečíst každý relevantní vlastnosti, jako <xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A> a <xref:System.Printing.PrintSystemJobInfo.IsInError%2A>.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-134">You can read each relevant property such as <xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A> and <xref:System.Printing.PrintSystemJobInfo.IsInError%2A>.</span></span>  
  
 <span data-ttu-id="0f3ce-135">Tento příklad ukazuje obě metody, uživateli se zobrazí výzva, jakou metodu použít a odpověděl zprávou "Y", pokud uživatel chce použít příznaky z <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-135">This example demonstrates both methods, so the user was previously prompted as to which method to use and responded with "Y" if he or she wanted to use the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property.</span></span> <span data-ttu-id="0f3ce-136">Níže naleznete podrobnosti ze dvou způsobů.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-136">See below for the details of the two methods.</span></span> <span data-ttu-id="0f3ce-137">A konečně aplikace používá metodu nazvanou **ReportQueueAndJobAvailability** zprávu o tom, jestli lze vytisknout úlohy v této denní době.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-137">Finally, the application uses a method called **ReportQueueAndJobAvailability** to report on whether the job can be printed at this time of day.</span></span> <span data-ttu-id="0f3ce-138">Tato metoda je popsána v [zjistit, jestli tisk úlohy můžete být vytisknout na tento denní dobu](how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md).</span><span class="sxs-lookup"><span data-stu-id="0f3ce-138">This method is discussed in [Discover Whether a Print Job Can Be Printed At This Time of Day](how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md).</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#identifyanddiagnoseproblematicjob)]
 [!code-csharp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#identifyanddiagnoseproblematicjob)]
 [!code-vb[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#identifyanddiagnoseproblematicjob)]  
  
 <span data-ttu-id="0f3ce-139">Ke kontrole stavu úlohy pomocí příznaky z <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> vlastnost, zkontrolujte každý relevantní příznak zobrazíte, pokud je nastavena.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-139">To check print job status using the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property, you check each relevant flag to see if it is set.</span></span> <span data-ttu-id="0f3ce-140">K provedení logické operace a sadu příznaků jako jeden operand a příznak samotný jako druhý je standardní způsob, jak zobrazit, pokud jeden bit nastaven sadu bitových příznaků.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-140">The standard way to see if one bit is set in a set of bit flags is to perform a logical AND operation with the set of flags as one operand and the flag itself as the other.</span></span> <span data-ttu-id="0f3ce-141">Protože příznak samotný má pouze jeden bit nastaven, výsledek logické a je to, že, maximálně Tento stejný bit nastaven.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-141">Since the flag itself has only one bit set, the result of the logical AND is that, at most, that same bit is set.</span></span> <span data-ttu-id="0f3ce-142">Pokud chcete zjistit, jestli je nebo není, stačí porovnání výsledku logické a s příznakem samotný.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-142">To find out whether it is or not, just compare the result of the logical AND with the flag itself.</span></span> <span data-ttu-id="0f3ce-143">Další informace najdete v tématu <xref:System.Printing.PrintJobStatus>, [& – operátor (C# odkaz)](~/docs/csharp/language-reference/operators/and-operator.md), a <xref:System.FlagsAttribute>.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-143">For more information, see <xref:System.Printing.PrintJobStatus>, the [& Operator (C# Reference)](~/docs/csharp/language-reference/operators/and-operator.md), and <xref:System.FlagsAttribute>.</span></span>  
  
 <span data-ttu-id="0f3ce-144">Kód pro každý atribut, jehož bit nastaven, to hlásí do okna konzoly a někdy navrhuje způsob, jak reagovat.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-144">For each attribute whose bit is set, the code reports this to the console screen and sometimes suggests a way to respond.</span></span> <span data-ttu-id="0f3ce-145">( **HandlePausedJob** metodu, která je volána, pokud úlohy nebo fronta je pozastavená, jsou popsány níže.)</span><span class="sxs-lookup"><span data-stu-id="0f3ce-145">(The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobattributes)]
 [!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobattributes)]
 [!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobattributes)]  
  
 <span data-ttu-id="0f3ce-146">Ke kontrole stavu tiskové úlohy pomocí samostatné vlastnosti, jednoduše načíst každou vlastnost a, pokud je vlastnost `true`zprávu do okna konzoly a pravděpodobně navrhnout způsob, jak reagovat.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-146">To check print job status using separate properties, you simply read each property and, if the property is `true`, report to the console screen and possibly suggest a way to respond.</span></span> <span data-ttu-id="0f3ce-147">( **HandlePausedJob** metodu, která je volána, pokud úlohy nebo fronta je pozastavená, jsou popsány níže.)</span><span class="sxs-lookup"><span data-stu-id="0f3ce-147">(The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobproperties)]
 [!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobproperties)]
 [!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobproperties)]  
  
 <span data-ttu-id="0f3ce-148">**HandlePausedJob** metoda umožňuje uživatelům vaší aplikace vzdáleně obnovit pozastavené úlohy.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-148">The **HandlePausedJob** method enables the application's user to remotely resume paused jobs.</span></span> <span data-ttu-id="0f3ce-149">Protože můžou existovat dobrý důvod, proč byla pozastavena tiskovou frontu, metoda začíná vás vyzve k zadání uživatele rozhodnutí o tom, jestli ho obnovit.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-149">Because there might be a good reason why the print queue was paused, the method begins by prompting for a user decision about whether to resume it.</span></span> <span data-ttu-id="0f3ce-150">Pokud je odpověď "Y", pak bude <xref:System.Printing.PrintQueue.Resume%2A?displayProperty=nameWithType> metoda je volána.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-150">If the answer is "Y", then the <xref:System.Printing.PrintQueue.Resume%2A?displayProperty=nameWithType> method is called.</span></span>  
  
 <span data-ttu-id="0f3ce-151">Dále bude uživatel vyzván k rozhodování, pokud by měl být obnoveno samotnou úlohu, jen v případě, že je pozastavený nezávisle na tiskovou frontu.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-151">Next the user is prompted to decide if the job itself should be resumed, just in case it is paused independently of the print queue.</span></span> <span data-ttu-id="0f3ce-152">(Porovnání <xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=nameWithType> a <xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=nameWithType>.) Pokud je odpověď "Y", pak <xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=nameWithType> volané; v opačném <xref:System.Printing.PrintSystemJobInfo.Cancel%2A> je volána.</span><span class="sxs-lookup"><span data-stu-id="0f3ce-152">(Compare <xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=nameWithType> and <xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=nameWithType>.) If the answer is "Y", then <xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=nameWithType> is called; otherwise <xref:System.Printing.PrintSystemJobInfo.Cancel%2A> is called.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#HandlePausedJob](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#handlepausedjob)]
 [!code-csharp[DiagnoseProblematicPrintJob#HandlePausedJob](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#handlepausedjob)]
 [!code-vb[DiagnoseProblematicPrintJob#HandlePausedJob](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#handlepausedjob)]  
  
## <a name="see-also"></a><span data-ttu-id="0f3ce-153">Viz také:</span><span class="sxs-lookup"><span data-stu-id="0f3ce-153">See also</span></span>

- <xref:System.Printing.PrintJobStatus>
- <xref:System.Printing.PrintSystemJobInfo>
- <xref:System.FlagsAttribute>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="0f3ce-154">& – Operátor (C# odkaz)</span><span class="sxs-lookup"><span data-stu-id="0f3ce-154">& Operator (C# Reference)</span></span>](~/docs/csharp/language-reference/operators/and-operator.md)
- [<span data-ttu-id="0f3ce-155">Dokumenty v platformě WPF</span><span class="sxs-lookup"><span data-stu-id="0f3ce-155">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="0f3ce-156">Přehled tisku</span><span class="sxs-lookup"><span data-stu-id="0f3ce-156">Printing Overview</span></span>](printing-overview.md)
