---
title: 'Návod: Implementace formuláře, který používá operaci na pozadí'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- threading [Windows Forms], forms
- BackgroundWorker component
- background tasks
- forms [Windows Forms], multithreading
- threading [Windows Forms], walkthroughs
- forms [Windows Forms], background operations
- threading [Windows Forms], background operations
- background operations
ms.assetid: 4691b796-9200-471a-89c3-ba4c7cc78c03
ms.openlocfilehash: 6399fb853162174895d892399fd3eb5226101515
ms.sourcegitcommit: 558d78d2a68acd4c95ef23231c8b4e4c7bac3902
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/09/2019
ms.locfileid: "59343399"
---
# <a name="walkthrough-implementing-a-form-that-uses-a-background-operation"></a><span data-ttu-id="eb391-102">Návod: Implementace formuláře, který používá operaci na pozadí</span><span class="sxs-lookup"><span data-stu-id="eb391-102">Walkthrough: Implementing a Form That Uses a Background Operation</span></span>
<span data-ttu-id="eb391-103">Pokud máte operace, která bude trvat dlouhou dobu pro dokončení, a nechcete uživatelského rozhraní (UI) přestane reagovat nebo "zablokování", můžete použít <xref:System.ComponentModel.BackgroundWorker> třídy k provedení operace v jiném vlákně.</span><span class="sxs-lookup"><span data-stu-id="eb391-103">If you have an operation that will take a long time to complete, and you do not want your user interface (UI) to stop responding or "hang," you can use the <xref:System.ComponentModel.BackgroundWorker> class to execute the operation on another thread.</span></span>  
  
 <span data-ttu-id="eb391-104">Tento návod ukazuje, jak používat <xref:System.ComponentModel.BackgroundWorker> pro provádění časově náročné výpočty "v pozadí," při stále poměrně rychle reaguje uživatelské rozhraní.</span><span class="sxs-lookup"><span data-stu-id="eb391-104">This walkthrough illustrates how to use the <xref:System.ComponentModel.BackgroundWorker> class to perform time-consuming computations "in the background," while the user interface remains responsive.</span></span>  <span data-ttu-id="eb391-105">Pokud jste si prostřednictvím, budete mít aplikaci, která vypočítá Fibonacciho čísla asynchronně.</span><span class="sxs-lookup"><span data-stu-id="eb391-105">When you are through, you will have an application that computes Fibonacci numbers asynchronously.</span></span> <span data-ttu-id="eb391-106">Přestože výpočetní že hodně Fibonacciho může trvat určitou dobu, hlavní vlákno uživatelského rozhraní nebude možné přerušit toto zpoždění a formulář bude responzivní během výpočtu.</span><span class="sxs-lookup"><span data-stu-id="eb391-106">Even though computing a large Fibonacci number can take a noticeable amount of time, the main UI thread will not be interrupted by this delay, and the form will be responsive during the calculation.</span></span>  
  
 <span data-ttu-id="eb391-107">Úlohy v tomto návodu zahrnují:</span><span class="sxs-lookup"><span data-stu-id="eb391-107">Tasks illustrated in this walkthrough include:</span></span>  
  
-   <span data-ttu-id="eb391-108">Vytvoření aplikace pro Windows</span><span class="sxs-lookup"><span data-stu-id="eb391-108">Creating a Windows-based Application</span></span>  
  
-   <span data-ttu-id="eb391-109">Vytváření <xref:System.ComponentModel.BackgroundWorker> ve formuláři</span><span class="sxs-lookup"><span data-stu-id="eb391-109">Creating a <xref:System.ComponentModel.BackgroundWorker> in Your Form</span></span>  
  
-   <span data-ttu-id="eb391-110">Přidání asynchronní obslužné rutiny</span><span class="sxs-lookup"><span data-stu-id="eb391-110">Adding Asynchronous Event Handlers</span></span>  
  
-   <span data-ttu-id="eb391-111">Přidání vytváření sestav průběhu a podporu pro zrušení</span><span class="sxs-lookup"><span data-stu-id="eb391-111">Adding Progress Reporting and Support for Cancellation</span></span>  
  
 <span data-ttu-id="eb391-112">Úplný seznam všech kód použitý v tomto příkladu najdete v části [jak: Implementace formuláře, který používá operaci na pozadí](how-to-implement-a-form-that-uses-a-background-operation.md).</span><span class="sxs-lookup"><span data-stu-id="eb391-112">For a complete listing of the code used in this example, see [How to: Implement a Form That Uses a Background Operation](how-to-implement-a-form-that-uses-a-background-operation.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="eb391-113">Dialogová okna a příkazy nabídek, které vidíte, se mohou lišit od těch popsaných v nápovědě v závislosti na aktivních nastaveních nebo edici.</span><span class="sxs-lookup"><span data-stu-id="eb391-113">The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.</span></span> <span data-ttu-id="eb391-114">Chcete-li změnit nastavení, zvolte **nastavení importu a exportu** na **nástroje** nabídky.</span><span class="sxs-lookup"><span data-stu-id="eb391-114">To change your settings, choose **Import and Export Settings** on the **Tools** menu.</span></span> <span data-ttu-id="eb391-115">Další informace najdete v tématu [přizpůsobení integrovaného vývojového prostředí sady Visual Studio](/visualstudio/ide/personalizing-the-visual-studio-ide).</span><span class="sxs-lookup"><span data-stu-id="eb391-115">For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).</span></span>  
  
## <a name="creating-the-project"></a><span data-ttu-id="eb391-116">Vytvoření projektu</span><span class="sxs-lookup"><span data-stu-id="eb391-116">Creating the Project</span></span>  
 <span data-ttu-id="eb391-117">Prvním krokem je vytvoření projektu a k nastavení tvaru.</span><span class="sxs-lookup"><span data-stu-id="eb391-117">The first step is to create the project and to set up the form.</span></span>  
  
#### <a name="to-create-a-form-that-uses-a-background-operation"></a><span data-ttu-id="eb391-118">Chcete-li vytvořit formulář, který používá operaci na pozadí</span><span class="sxs-lookup"><span data-stu-id="eb391-118">To create a form that uses a background operation</span></span>  
  
1. <span data-ttu-id="eb391-119">Vytvořte projekt aplikace pro systém Windows s názvem `BackgroundWorkerExample` (**souboru** > **nový** > **projektu**  >  **Visual C#** nebo **jazyka Visual Basic** > **klasický desktopový** > **aplikaci Windows Forms**).</span><span class="sxs-lookup"><span data-stu-id="eb391-119">Create a Windows-based application project called `BackgroundWorkerExample` (**File** > **New** > **Project** > **Visual C#** or **Visual Basic** > **Classic Desktop** > **Windows Forms Application**).</span></span>  
  
2. <span data-ttu-id="eb391-120">V **Průzkumníka řešení**, klikněte pravým tlačítkem na **Form1** a vyberte **přejmenovat** z místní nabídky.</span><span class="sxs-lookup"><span data-stu-id="eb391-120">In **Solution Explorer**, right-click **Form1** and select **Rename** from the shortcut menu.</span></span> <span data-ttu-id="eb391-121">Změňte název souboru, aby `FibonacciCalculator`.</span><span class="sxs-lookup"><span data-stu-id="eb391-121">Change the file name to `FibonacciCalculator`.</span></span> <span data-ttu-id="eb391-122">Klikněte na tlačítko **Ano** tlačítko, pokud budete vyzváni, pokud chcete přejmenovat všechny odkazy na prvek kódu '`Form1`".</span><span class="sxs-lookup"><span data-stu-id="eb391-122">Click the **Yes** button when you are asked if you want to rename all references to the code element '`Form1`'.</span></span>  
  
3. <span data-ttu-id="eb391-123">Přetáhněte <xref:System.Windows.Forms.NumericUpDown> ovládacího prvku **nástrojů** do formuláře.</span><span class="sxs-lookup"><span data-stu-id="eb391-123">Drag a <xref:System.Windows.Forms.NumericUpDown> control from the **Toolbox** onto the form.</span></span> <span data-ttu-id="eb391-124">Nastavte <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> vlastnost `1` a <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> vlastnost `91`.</span><span class="sxs-lookup"><span data-stu-id="eb391-124">Set the <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> property to `1` and the <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> property to `91`.</span></span>  
  
4. <span data-ttu-id="eb391-125">Přidejte dva <xref:System.Windows.Forms.Button> ovládací prvky do formuláře.</span><span class="sxs-lookup"><span data-stu-id="eb391-125">Add two <xref:System.Windows.Forms.Button> controls to the form.</span></span>  
  
5. <span data-ttu-id="eb391-126">Přejmenování prvního <xref:System.Windows.Forms.Button> ovládací prvek `startAsyncButton` a nastavit <xref:System.Windows.Forms.Control.Text%2A> vlastnost `Start Async`.</span><span class="sxs-lookup"><span data-stu-id="eb391-126">Rename the first <xref:System.Windows.Forms.Button> control `startAsyncButton` and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Start Async`.</span></span> <span data-ttu-id="eb391-127">Přejmenujte druhý <xref:System.Windows.Forms.Button> ovládací prvek `cancelAsyncButton`a nastavte <xref:System.Windows.Forms.Control.Text%2A> vlastnost `Cancel Async`.</span><span class="sxs-lookup"><span data-stu-id="eb391-127">Rename the second <xref:System.Windows.Forms.Button> control `cancelAsyncButton`, and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Cancel Async`.</span></span> <span data-ttu-id="eb391-128">Nastavte jeho <xref:System.Windows.Forms.Control.Enabled%2A> vlastnost `false`.</span><span class="sxs-lookup"><span data-stu-id="eb391-128">Set its <xref:System.Windows.Forms.Control.Enabled%2A> property to `false`.</span></span>  
  
6. <span data-ttu-id="eb391-129">Vytvořte obslužnou rutinu události pro obě <xref:System.Windows.Forms.Button> ovládacích prvků <xref:System.Windows.Forms.Control.Click> události.</span><span class="sxs-lookup"><span data-stu-id="eb391-129">Create an event handler for both of the <xref:System.Windows.Forms.Button> controls' <xref:System.Windows.Forms.Control.Click> events.</span></span> <span data-ttu-id="eb391-130">Podrobnosti najdete v tématu [jak: Vytváření obslužných rutin událostí pomocí návrháře](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="eb391-130">For details, see [How to: Create Event Handlers Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span></span>  
  
7. <span data-ttu-id="eb391-131">Přetáhněte <xref:System.Windows.Forms.Label> ovládacího prvku **nástrojů** do formuláře a přejmenujte jej `resultLabel`.</span><span class="sxs-lookup"><span data-stu-id="eb391-131">Drag a <xref:System.Windows.Forms.Label> control from the **Toolbox** onto the form and rename it `resultLabel`.</span></span>  
  
8. <span data-ttu-id="eb391-132">Přetáhněte <xref:System.Windows.Forms.ProgressBar> ovládacího prvku **nástrojů** do formuláře.</span><span class="sxs-lookup"><span data-stu-id="eb391-132">Drag a <xref:System.Windows.Forms.ProgressBar> control from the **Toolbox** onto the form.</span></span>  
  
## <a name="creating-a-backgroundworker-in-your-form"></a><span data-ttu-id="eb391-133">Vytváření podproces BackgroundWorker ve formuláři</span><span class="sxs-lookup"><span data-stu-id="eb391-133">Creating a BackgroundWorker in Your Form</span></span>  
 <span data-ttu-id="eb391-134">Můžete vytvořit <xref:System.ComponentModel.BackgroundWorker> pro asynchronní operace pomocí **Windows** **Návrháře formulářů**.</span><span class="sxs-lookup"><span data-stu-id="eb391-134">You can create the <xref:System.ComponentModel.BackgroundWorker> for your asynchronous operation using the **Windows** **Forms Designer**.</span></span>  
  
#### <a name="to-create-a-backgroundworker-with-the-designer"></a><span data-ttu-id="eb391-135">Chcete-li vytvořit podproces BackgroundWorker pomocí návrháře</span><span class="sxs-lookup"><span data-stu-id="eb391-135">To create a BackgroundWorker with the Designer</span></span>  
  
-   <span data-ttu-id="eb391-136">Z **součásti** karty **nástrojů**, přetáhněte <xref:System.ComponentModel.BackgroundWorker> do formuláře.</span><span class="sxs-lookup"><span data-stu-id="eb391-136">From the **Components** tab of the **Toolbox**, drag a <xref:System.ComponentModel.BackgroundWorker> onto the form.</span></span>  
  
## <a name="adding-asynchronous-event-handlers"></a><span data-ttu-id="eb391-137">Přidání asynchronní obslužné rutiny</span><span class="sxs-lookup"><span data-stu-id="eb391-137">Adding Asynchronous Event Handlers</span></span>  
 <span data-ttu-id="eb391-138">Nyní jste připraveni pro přidání obslužné rutiny událostí pro <xref:System.ComponentModel.BackgroundWorker> asynchronní událostí komponenty.</span><span class="sxs-lookup"><span data-stu-id="eb391-138">You are now ready to add event handlers for the <xref:System.ComponentModel.BackgroundWorker> component's asynchronous events.</span></span> <span data-ttu-id="eb391-139">Časově náročná operace, která se spustí na pozadí, která vypočítá Fibonacciho čísla, je volána pomocí jedné z těchto obslužných rutin událostí.</span><span class="sxs-lookup"><span data-stu-id="eb391-139">The time-consuming operation that will run in the background, which computes Fibonacci numbers, is called by one of these event handlers.</span></span>  
  
#### <a name="to-implement-asynchronous-event-handlers"></a><span data-ttu-id="eb391-140">K implementaci asynchronní obslužné rutiny</span><span class="sxs-lookup"><span data-stu-id="eb391-140">To implement asynchronous event handlers</span></span>  
  
1. <span data-ttu-id="eb391-141">V **vlastnosti** okně s <xref:System.ComponentModel.BackgroundWorker> stále vybranou možností komponenty, klikněte na tlačítko **události** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="eb391-141">In the **Properties** window, with the <xref:System.ComponentModel.BackgroundWorker> component still selected, click the **Events** button.</span></span> <span data-ttu-id="eb391-142">Dvakrát klikněte <xref:System.ComponentModel.BackgroundWorker.DoWork> a <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> událostí pro vytváření obslužných rutin událostí.</span><span class="sxs-lookup"><span data-stu-id="eb391-142">Double-click the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> events to create event handlers.</span></span> <span data-ttu-id="eb391-143">Další informace o tom, jak používat obslužné rutiny událostí, naleznete v tématu [jak: Vytváření obslužných rutin událostí pomocí návrháře](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="eb391-143">For more information about how to use event handlers, see [How to: Create Event Handlers Using the Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span></span>  
  
2. <span data-ttu-id="eb391-144">Vytvoření nové metody, volá `ComputeFibonacci`, ve formuláři.</span><span class="sxs-lookup"><span data-stu-id="eb391-144">Create a new method, called `ComputeFibonacci`, in your form.</span></span> <span data-ttu-id="eb391-145">Tato metoda provádí samotnou práci, a tok se spustí na pozadí.</span><span class="sxs-lookup"><span data-stu-id="eb391-145">This method does the actual work, and it will run in the background.</span></span> <span data-ttu-id="eb391-146">Tento kód ukazuje implementaci rekurzivní Fibonacciho algoritmu, který je zejména, přičemž exponenciálně delší dobu pro velké objemy.</span><span class="sxs-lookup"><span data-stu-id="eb391-146">This code demonstrates the recursive implementation of the Fibonacci algorithm, which is notably inefficient, taking exponentially longer time to complete for larger numbers.</span></span> <span data-ttu-id="eb391-147">Používá se tady pro ilustraci, chcete-li zobrazit operace, která můžete zavést dlouhá zpoždění ve vaší aplikaci.</span><span class="sxs-lookup"><span data-stu-id="eb391-147">It is used here for illustrative purposes, to show an operation that can introduce long delays in your application.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#10)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#10)]
     [!code-vb[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#10)]  
  
3. <span data-ttu-id="eb391-148">V <xref:System.ComponentModel.BackgroundWorker.DoWork> obslužná rutina události, přidejte volání `ComputeFibonacci` metody.</span><span class="sxs-lookup"><span data-stu-id="eb391-148">In the <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler, add a call to the `ComputeFibonacci` method.</span></span> <span data-ttu-id="eb391-149">Využijte první parametr `ComputeFibonacci` z <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> vlastnost <xref:System.ComponentModel.DoWorkEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="eb391-149">Take the first parameter for `ComputeFibonacci` from the <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.</span></span> <span data-ttu-id="eb391-150"><xref:System.ComponentModel.BackgroundWorker> a <xref:System.ComponentModel.DoWorkEventArgs> parametry se později použijí pro vykazování průběhu a zrušení podporovat.</span><span class="sxs-lookup"><span data-stu-id="eb391-150">The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.ComponentModel.DoWorkEventArgs> parameters will be used later for progress reporting and cancellation support.</span></span> <span data-ttu-id="eb391-151">Přiřadit návratovou hodnotu z `ComputeFibonacci` k <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> vlastnost <xref:System.ComponentModel.DoWorkEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="eb391-151">Assign the return value from `ComputeFibonacci` to the <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.</span></span> <span data-ttu-id="eb391-152">Tohoto výsledku bude k dispozici na <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="eb391-152">This result will be available to the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="eb391-153"><xref:System.ComponentModel.BackgroundWorker.DoWork> Obslužná rutina události neobsahuje odkaz `backgroundWorker1` instance proměnné přímo, protože to by spárovat tuto obslužnou rutinu události pro konkrétní instanci <xref:System.ComponentModel.BackgroundWorker>.</span><span class="sxs-lookup"><span data-stu-id="eb391-153">The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler does not reference the `backgroundWorker1` instance variable directly, as this would couple this event handler to a specific instance of <xref:System.ComponentModel.BackgroundWorker>.</span></span> <span data-ttu-id="eb391-154">Místo toho odkaz na <xref:System.ComponentModel.BackgroundWorker> , který vyvolá tato událost se zotavilo z `sender` parametru.</span><span class="sxs-lookup"><span data-stu-id="eb391-154">Instead, a reference to the <xref:System.ComponentModel.BackgroundWorker> that raised this event is recovered from the `sender` parameter.</span></span> <span data-ttu-id="eb391-155">To je důležité při formuláři hostiteli více než jedné <xref:System.ComponentModel.BackgroundWorker>.</span><span class="sxs-lookup"><span data-stu-id="eb391-155">This is important when the form hosts more than one <xref:System.ComponentModel.BackgroundWorker>.</span></span> <span data-ttu-id="eb391-156">Je také důležité, abyste manipulovat s objekty uživatelského rozhraní ve vašich <xref:System.ComponentModel.BackgroundWorker.DoWork> obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="eb391-156">It is also important not to manipulate any user-interface objects in your <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler.</span></span> <span data-ttu-id="eb391-157">Místo toho komunikovat prostřednictvím uživatelského rozhraní <xref:System.ComponentModel.BackgroundWorker> události.</span><span class="sxs-lookup"><span data-stu-id="eb391-157">Instead, communicate to the user interface through the <xref:System.ComponentModel.BackgroundWorker> events.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#5)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#5)]
     [!code-vb[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#5)]  
  
4. <span data-ttu-id="eb391-158">V `startAsyncButton` ovládacího prvku <xref:System.Windows.Forms.Control.Click> obslužná rutina události, přidejte kód, který spustí asynchronní operaci.</span><span class="sxs-lookup"><span data-stu-id="eb391-158">In the `startAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that starts the asynchronous operation.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#13)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#13)]
     [!code-vb[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#13)]  
  
5. <span data-ttu-id="eb391-159">V <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> obslužná rutina události, přiřadit výsledek výpočtu, která `resultLabel` ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="eb391-159">In the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler, assign the result of the calculation to the `resultLabel` control.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#6)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#6)]
     [!code-vb[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#6)]  
  
## <a name="adding-progress-reporting-and-support-for-cancellation"></a><span data-ttu-id="eb391-160">Přidání vytváření sestav průběhu a podporu pro zrušení</span><span class="sxs-lookup"><span data-stu-id="eb391-160">Adding Progress Reporting and Support for Cancellation</span></span>  
 <span data-ttu-id="eb391-161">Pro asynchronní operace, které bude trvat dlouhou dobu je často žádoucí sestav průběhu pro uživatele a aby uživatel mohl zrušit operaci.</span><span class="sxs-lookup"><span data-stu-id="eb391-161">For asynchronous operations that will take a long time, it is often desirable to report progress to the user and to allow the user to cancel the operation.</span></span> <span data-ttu-id="eb391-162"><xref:System.ComponentModel.BackgroundWorker> Třída poskytuje událost, která umožňuje publikovat průběh jako vaše operace pokračuje na pozadí.</span><span class="sxs-lookup"><span data-stu-id="eb391-162">The <xref:System.ComponentModel.BackgroundWorker> class provides an event that allows you to post progress as your background operation proceeds.</span></span> <span data-ttu-id="eb391-163">Poskytuje také příznak, který umožňuje detekovat volání do kódu pracovního procesu <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> a přerušit sama sebe.</span><span class="sxs-lookup"><span data-stu-id="eb391-163">It also provides a flag that allows your worker code to detect a call to <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> and interrupt itself.</span></span>  
  
#### <a name="to-implement-progress-reporting"></a><span data-ttu-id="eb391-164">K implementaci vykazování průběhu</span><span class="sxs-lookup"><span data-stu-id="eb391-164">To implement progress reporting</span></span>  
  
1. <span data-ttu-id="eb391-165">V **vlastnosti**, vyberte `backgroundWorker1`.</span><span class="sxs-lookup"><span data-stu-id="eb391-165">In the **Properties**, window, select `backgroundWorker1`.</span></span> <span data-ttu-id="eb391-166">Nastavte <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> a <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> vlastností `true`.</span><span class="sxs-lookup"><span data-stu-id="eb391-166">Set the <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`.</span></span>  
  
2. <span data-ttu-id="eb391-167">Deklarujte dvě proměnné v `FibonacciCalculator` formuláře.</span><span class="sxs-lookup"><span data-stu-id="eb391-167">Declare two variables in the `FibonacciCalculator` form.</span></span> <span data-ttu-id="eb391-168">Ty se používají ke sledování pokroku.</span><span class="sxs-lookup"><span data-stu-id="eb391-168">These will be used to track progress.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#14)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#14)]
     [!code-vb[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#14)]  
  
3. <span data-ttu-id="eb391-169">Přidat obslužnou rutinu události pro <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> událostí.</span><span class="sxs-lookup"><span data-stu-id="eb391-169">Add an event handler for the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event.</span></span> <span data-ttu-id="eb391-170">V <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> obslužná rutina události, aktualizace <xref:System.Windows.Forms.ProgressBar> s <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> vlastnost <xref:System.ComponentModel.ProgressChangedEventArgs> parametru.</span><span class="sxs-lookup"><span data-stu-id="eb391-170">In the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler, update the <xref:System.Windows.Forms.ProgressBar> with the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> property of the <xref:System.ComponentModel.ProgressChangedEventArgs> parameter.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#7)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#7)]
     [!code-vb[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#7)]  
  
#### <a name="to-implement-support-for-cancellation"></a><span data-ttu-id="eb391-171">K implementaci podpory pro zrušení</span><span class="sxs-lookup"><span data-stu-id="eb391-171">To implement support for cancellation</span></span>  
  
1. <span data-ttu-id="eb391-172">V `cancelAsyncButton` ovládacího prvku <xref:System.Windows.Forms.Control.Click> obslužná rutina události, přidejte kód, který zruší asynchronní operaci.</span><span class="sxs-lookup"><span data-stu-id="eb391-172">In the `cancelAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that cancels the asynchronous operation.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#4)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#4)]
     [!code-vb[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#4)]  
  
2. <span data-ttu-id="eb391-173">Fragmenty se od následujícího kódu `ComputeFibonacci` metoda sestavy průběh a podporu zrušení.</span><span class="sxs-lookup"><span data-stu-id="eb391-173">The following code fragments in the `ComputeFibonacci` method report progress and support cancellation.</span></span>  
  
     [!code-cpp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#11)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#11)]
     [!code-vb[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#11)]  
    [!code-cpp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#12)]
    [!code-csharp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#12)]
    [!code-vb[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#12)]  
  
## <a name="checkpoint"></a><span data-ttu-id="eb391-174">CheckPoint</span><span class="sxs-lookup"><span data-stu-id="eb391-174">Checkpoint</span></span>  
 <span data-ttu-id="eb391-175">V tomto okamžiku můžete zkompilujete a spustíte aplikaci Fibonacciho kalkulačku.</span><span class="sxs-lookup"><span data-stu-id="eb391-175">At this point, you can compile and run the Fibonacci Calculator application.</span></span>  
  
#### <a name="to-test-your-project"></a><span data-ttu-id="eb391-176">K otestování vašeho projektu</span><span class="sxs-lookup"><span data-stu-id="eb391-176">To test your project</span></span>  
  
-   <span data-ttu-id="eb391-177">Stiskněte klávesu F5 ke kompilaci a spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="eb391-177">Press F5 to compile and run the application.</span></span>  
  
     <span data-ttu-id="eb391-178">Při výpočtu běží na pozadí, zobrazí se <xref:System.Windows.Forms.ProgressBar> zobrazení průběhu výpočtu směrem k dokončení.</span><span class="sxs-lookup"><span data-stu-id="eb391-178">While the calculation is running in the background, you will see the <xref:System.Windows.Forms.ProgressBar> displaying the progress of the calculation toward completion.</span></span> <span data-ttu-id="eb391-179">Můžete také zrušit čekající operace.</span><span class="sxs-lookup"><span data-stu-id="eb391-179">You can also cancel the pending operation.</span></span>  
  
     <span data-ttu-id="eb391-180">Pro malé čísla výpočtu by měla být velmi rychlé zpracování, ale pro větší čísla, měli byste vidět významnému zpoždění.</span><span class="sxs-lookup"><span data-stu-id="eb391-180">For small numbers, the calculation should be very fast, but for larger numbers, you should see a noticeable delay.</span></span> <span data-ttu-id="eb391-181">Pokud zadáte hodnotu 30 nebo vyšší, měli byste vidět trvat několik sekund, v závislosti na rychlosti počítače.</span><span class="sxs-lookup"><span data-stu-id="eb391-181">If you enter a value of 30 or greater, you should see a delay of several seconds, depending on the speed of your computer.</span></span> <span data-ttu-id="eb391-182">Pro hodnoty větší než 40 může trvat minuty nebo hodiny na dokončení výpočtu.</span><span class="sxs-lookup"><span data-stu-id="eb391-182">For values greater than 40, it may take minutes or hours to finish the calculation.</span></span> <span data-ttu-id="eb391-183">Je zaneprázdněn computingu hodně Fibonacciho kalkulačky, Všimněte si, že můžete volně pohyb tvaru, minimalizovat, maximalizovat a dokonce i zavřít.</span><span class="sxs-lookup"><span data-stu-id="eb391-183">While the calculator is busy computing a large Fibonacci number, notice that you can freely move the form around, minimize, maximize, and even dismiss it.</span></span> <span data-ttu-id="eb391-184">Je to proto, že hlavní vlákno uživatelského rozhraní nečeká na výpočet na dokončení.</span><span class="sxs-lookup"><span data-stu-id="eb391-184">This is because the main UI thread is not waiting for the calculation to finish.</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="eb391-185">Další kroky</span><span class="sxs-lookup"><span data-stu-id="eb391-185">Next Steps</span></span>  
 <span data-ttu-id="eb391-186">Teď, když jste implementovali formulář, který používá <xref:System.ComponentModel.BackgroundWorker> komponentu pro spuštění výpočtu na pozadí můžete prozkoumat další možnosti pro asynchronní operace:</span><span class="sxs-lookup"><span data-stu-id="eb391-186">Now that you have implemented a form that uses a <xref:System.ComponentModel.BackgroundWorker> component to execute a computation in the background, you can explore other possibilities for asynchronous operations:</span></span>  
  
-   <span data-ttu-id="eb391-187">Použití více <xref:System.ComponentModel.BackgroundWorker> objekty pro několik souběžných operací.</span><span class="sxs-lookup"><span data-stu-id="eb391-187">Use multiple <xref:System.ComponentModel.BackgroundWorker> objects for several simultaneous operations.</span></span>  
  
-   <span data-ttu-id="eb391-188">Ladění aplikace s více vlákny, naleznete v tématu [jak: Použití okna vláken](/visualstudio/debugger/how-to-use-the-threads-window).</span><span class="sxs-lookup"><span data-stu-id="eb391-188">To debug your multithreaded application, see [How to: Use the Threads Window](/visualstudio/debugger/how-to-use-the-threads-window).</span></span>  
  
-   <span data-ttu-id="eb391-189">Implementujte vlastní komponenty, která podporuje asynchronní programovací model.</span><span class="sxs-lookup"><span data-stu-id="eb391-189">Implement your own component that supports the asynchronous programming model.</span></span> <span data-ttu-id="eb391-190">Další informace najdete v tématu [založený na událostech přehled asynchronních vzorů](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md).</span><span class="sxs-lookup"><span data-stu-id="eb391-190">For more information, see [Event-based Asynchronous Pattern Overview](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md).</span></span>  
  
    > [!CAUTION]
    >  <span data-ttu-id="eb391-191">Pokud používáte multithreading jakéhokoli druhu, potenciálně zpřístupníte sami velmi závažných a složitých chyb.</span><span class="sxs-lookup"><span data-stu-id="eb391-191">When using multithreading of any sort, you potentially expose yourself to very serious and complex bugs.</span></span> <span data-ttu-id="eb391-192">Poraďte [spravovaných vláken osvědčené postupy](../../../standard/threading/managed-threading-best-practices.md) před implementací jakéhokoli řešení, které používá multithreading.</span><span class="sxs-lookup"><span data-stu-id="eb391-192">Consult the [Managed Threading Best Practices](../../../standard/threading/managed-threading-best-practices.md) before implementing any solution that uses multithreading.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="eb391-193">Viz také:</span><span class="sxs-lookup"><span data-stu-id="eb391-193">See also</span></span>

- <xref:System.ComponentModel.BackgroundWorker?displayProperty=nameWithType>
- [<span data-ttu-id="eb391-194">Dělení na spravovaná vlákna</span><span class="sxs-lookup"><span data-stu-id="eb391-194">Managed Threading</span></span>](../../../standard/threading/index.md)
- [<span data-ttu-id="eb391-195">Doporučené postupy spravovaného dělení na vlákna</span><span class="sxs-lookup"><span data-stu-id="eb391-195">Managed Threading Best Practices</span></span>](../../../standard/threading/managed-threading-best-practices.md)
- [<span data-ttu-id="eb391-196">Přehled asynchronních vzorů založených na událostech</span><span class="sxs-lookup"><span data-stu-id="eb391-196">Event-based Asynchronous Pattern Overview</span></span>](../../../standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview.md)
- [<span data-ttu-id="eb391-197">Postupy: Implementace formuláře, který používá operaci na pozadí</span><span class="sxs-lookup"><span data-stu-id="eb391-197">How to: Implement a Form That Uses a Background Operation</span></span>](how-to-implement-a-form-that-uses-a-background-operation.md)
- [<span data-ttu-id="eb391-198">Návod: Spuštění operace na pozadí</span><span class="sxs-lookup"><span data-stu-id="eb391-198">Walkthrough: Running an Operation in the Background</span></span>](walkthrough-running-an-operation-in-the-background.md)
- [<span data-ttu-id="eb391-199">BackgroundWorker – komponenta</span><span class="sxs-lookup"><span data-stu-id="eb391-199">BackgroundWorker Component</span></span>](backgroundworker-component.md)
