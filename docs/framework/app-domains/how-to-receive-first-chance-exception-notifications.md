---
title: 'Postupy: Přijímání oznámení o první odpovídající výjimce'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- first-chance exception notifications
- exceptions, first chance notifications
ms.assetid: 66f002b8-a97d-4a6e-a503-2cec01689113
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: f6f70b4c67de892c3b66a0099dae9f618a99b3f1
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "61705633"
---
# <a name="how-to-receive-first-chance-exception-notifications"></a><span data-ttu-id="2bc6b-102">Postupy: Přijímání oznámení o první odpovídající výjimce</span><span class="sxs-lookup"><span data-stu-id="2bc6b-102">How to: Receive First-Chance Exception Notifications</span></span>
<span data-ttu-id="2bc6b-103"><xref:System.AppDomain.FirstChanceException> Událost <xref:System.AppDomain> třída umožňuje dostávat oznámení, že byla vyvolána výjimka, před common language runtime začne hledat obslužné rutiny výjimek.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-103">The <xref:System.AppDomain.FirstChanceException> event of the <xref:System.AppDomain> class lets you receive a notification that an exception has been thrown, before the common language runtime has begun searching for exception handlers.</span></span>

 <span data-ttu-id="2bc6b-104">Událost je vyvolána na úrovni domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-104">The event is raised at the application domain level.</span></span> <span data-ttu-id="2bc6b-105">Vlákno provádění můžete předat prostřednictvím více domén aplikace, takže výjimka je ošetřena v jedné doméně aplikace může být zpracovány v jiné doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-105">A thread of execution can pass through multiple application domains, so an exception that is unhandled in one application domain could be handled in another application domain.</span></span> <span data-ttu-id="2bc6b-106">Oznámení se vyskytuje v každé doméně aplikace, která se má přidat obslužnou rutinu pro událost, dokud zpracovává výjimku domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-106">The notification occurs in each application domain that has added a handler for the event, until an application domain handles the exception.</span></span>

 <span data-ttu-id="2bc6b-107">Postupy a příklady v tomto článku ukazují, jak dostávat oznámení o první odpovídající výjimce v jednoduchý program, který má jednu doménu aplikace a v doméně aplikace, kterou vytvoříte.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-107">The procedures and examples in this article show how to receive first-chance exception notifications in a simple program that has one application domain, and in an application domain that you create.</span></span>

 <span data-ttu-id="2bc6b-108">Pro složitější příklad, který obsahuje několik domén aplikace, podívejte se na příklad pro <xref:System.AppDomain.FirstChanceException> událostí.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-108">For a more complex example that spans several application domains, see the example for the <xref:System.AppDomain.FirstChanceException> event.</span></span>

## <a name="receiving-first-chance-exception-notifications-in-the-default-application-domain"></a><span data-ttu-id="2bc6b-109">Příjem oznámení o první odpovídající výjimce ve výchozí doméně aplikace</span><span class="sxs-lookup"><span data-stu-id="2bc6b-109">Receiving First-Chance Exception Notifications in the Default Application Domain</span></span>
 <span data-ttu-id="2bc6b-110">V následujícím postupu, vstupní bod pro aplikaci, `Main()` spuštěním metody, ve výchozí doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-110">In the following procedure, the entry point for the application, the `Main()` method, runs in the default application domain.</span></span>

#### <a name="to-demonstrate-first-chance-exception-notifications-in-the-default-application-domain"></a><span data-ttu-id="2bc6b-111">K předvedení oznámení o první odpovídající výjimce ve výchozí doméně aplikace</span><span class="sxs-lookup"><span data-stu-id="2bc6b-111">To demonstrate first-chance exception notifications in the default application domain</span></span>

1. <span data-ttu-id="2bc6b-112">Definování obslužné rutiny události pro <xref:System.AppDomain.FirstChanceException> událostí, použití výrazu lambda funkce a připojte ho k této události.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-112">Define an event handler for the <xref:System.AppDomain.FirstChanceException> event, using a lambda function, and attach it to the event.</span></span> <span data-ttu-id="2bc6b-113">V tomto příkladu vypisuje obslužná rutina události, název domény aplikace, kde byla zpracována události a výjimky <xref:System.Exception.Message%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-113">In this example, the event handler prints the name of the application domain where the event was handled and the exception's <xref:System.Exception.Message%2A> property.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#2)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#2)]

2. <span data-ttu-id="2bc6b-114">Vyvolání výjimky a zachytit.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-114">Throw an exception and catch it.</span></span> <span data-ttu-id="2bc6b-115">Před běhové prostředí vyhledává obslužnou rutinu výjimky, <xref:System.AppDomain.FirstChanceException> zobrazí zprávu a je vyvolána událost.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-115">Before the runtime locates the exception handler, the <xref:System.AppDomain.FirstChanceException> event is raised and displays a message.</span></span> <span data-ttu-id="2bc6b-116">Tato zpráva je následován zprávu, která se zobrazí při obslužná rutina výjimky.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-116">This message is followed by the message that is displayed by the exception handler.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#3](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#3)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#3)]

3. <span data-ttu-id="2bc6b-117">Vytvořit výjimku, ale nebude zachytávat.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-117">Throw an exception, but do not catch it.</span></span> <span data-ttu-id="2bc6b-118">Předtím, než modul runtime vyhledá obslužnou rutinu výjimky, <xref:System.AppDomain.FirstChanceException> zobrazí zprávu a je vyvolána událost.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-118">Before the runtime looks for an exception handler, the <xref:System.AppDomain.FirstChanceException> event is raised and displays a message.</span></span> <span data-ttu-id="2bc6b-119">Neexistuje žádná obslužná rutina výjimky, takže ukončení aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-119">There is no exception handler, so the application terminates.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#4](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#4)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#4)]

     <span data-ttu-id="2bc6b-120">Kód, který se zobrazí v první tři kroky tohoto postupu tvoří úplnou konzolové aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-120">The code that is shown in the first three steps of this procedure forms a complete console application.</span></span> <span data-ttu-id="2bc6b-121">Výstup z aplikace se liší v závislosti na název souboru .exe, protože název výchozí domény aplikace se skládá z názvu a příponu souboru .exe.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-121">The output from the application varies, depending on the name of the .exe file, because the name of the default application domain consists of the name and extension of the .exe file.</span></span> <span data-ttu-id="2bc6b-122">Si přečtěte následující ukázkový výstup.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-122">See the following for sample output.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto_simple#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/cs/example.cs#5)]
     [!code-vb[System.AppDomain.FirstChanceException_howto_simple#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto_simple/vb/example.vb#5)]

## <a name="receiving-first-chance-exception-notifications-in-another-application-domain"></a><span data-ttu-id="2bc6b-123">Příjem oznámení o první odpovídající výjimce v jiné doméně aplikace</span><span class="sxs-lookup"><span data-stu-id="2bc6b-123">Receiving First-Chance Exception Notifications in Another Application Domain</span></span>
 <span data-ttu-id="2bc6b-124">Pokud váš program obsahuje více než jednu doménu aplikace, můžete nastavit, které domény aplikace přijímat oznámení.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-124">If your program contains more than one application domain, you can choose which application domains receive notifications.</span></span>

#### <a name="to-receive-first-chance-exception-notifications-in-an-application-domain-that-you-create"></a><span data-ttu-id="2bc6b-125">K přijímání oznámení o první odpovídající výjimce v doméně aplikace, kterou vytvoříte</span><span class="sxs-lookup"><span data-stu-id="2bc6b-125">To receive first-chance exception notifications in an application domain that you create</span></span>

1. <span data-ttu-id="2bc6b-126">Definování obslužné rutiny události <xref:System.AppDomain.FirstChanceException> událostí.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-126">Define an event handler for the <xref:System.AppDomain.FirstChanceException> event.</span></span> <span data-ttu-id="2bc6b-127">Tento příklad používá `static` – metoda (`Shared` metody v jazyce Visual Basic), který vytiskne název domény aplikace, kde byla zpracována události a výjimky <xref:System.Exception.Message%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-127">This example uses a `static` method (`Shared` method in Visual Basic) that prints the name of the application domain where the event was handled and the exception's <xref:System.Exception.Message%2A> property.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#3](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#3)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#3)]

2. <span data-ttu-id="2bc6b-128">Vytvoření domény aplikace a přidejme obslužnou rutinu události pro <xref:System.AppDomain.FirstChanceException> události pro tuto doménu aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-128">Create an application domain and add the event handler to the <xref:System.AppDomain.FirstChanceException> event for that application domain.</span></span> <span data-ttu-id="2bc6b-129">V tomto příkladu je název domény aplikace `AD1`.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-129">In this example, the application domain is named `AD1`.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#2)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#2)]

     <span data-ttu-id="2bc6b-130">Tato událost ve výchozí doméně aplikace dokáže zpracovat stejným způsobem.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-130">You can handle this event in the default application domain in the same way.</span></span> <span data-ttu-id="2bc6b-131">Použití `static` (`Shared` v jazyce Visual Basic) <xref:System.AppDomain.CurrentDomain%2A?displayProperty=nameWithType> vlastnost `Main()` získat odkaz na výchozí doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-131">Use the `static` (`Shared` in Visual Basic) <xref:System.AppDomain.CurrentDomain%2A?displayProperty=nameWithType> property in `Main()` to get a reference to the default application domain.</span></span>

#### <a name="to-demonstrate-first-chance-exception-notifications-in-the-application-domain"></a><span data-ttu-id="2bc6b-132">K předvedení oznámení o první odpovídající výjimce v aplikační doméně</span><span class="sxs-lookup"><span data-stu-id="2bc6b-132">To demonstrate first-chance exception notifications in the application domain</span></span>

1. <span data-ttu-id="2bc6b-133">Vytvoření `Worker` objekt v doméně aplikace, kterou jste vytvořili v předchozím postupu.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-133">Create a `Worker` object in the application domain that you created in the previous procedure.</span></span> <span data-ttu-id="2bc6b-134">`Worker` Třída musí být veřejné a musí být odvozen od <xref:System.MarshalByRefObject>, jak je uvedeno v úplném příkladu na konci tohoto článku.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-134">The `Worker` class must be public, and must derive from <xref:System.MarshalByRefObject>, as shown in the complete example at the end of this article.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#4](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#4)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#4)]

2. <span data-ttu-id="2bc6b-135">Volání metody `Worker` objekt, který vyvolá výjimku.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-135">Call a method of the `Worker` object that throws an exception.</span></span> <span data-ttu-id="2bc6b-136">V tomto příkladu `Thrower` metoda je volána dvakrát.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-136">In this example, the `Thrower` method is called twice.</span></span> <span data-ttu-id="2bc6b-137">První argument metody je `true`, což způsobí, že metoda zachytí vlastní výjimky.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-137">The first time, the method argument is `true`, which causes the method to catch its own exception.</span></span> <span data-ttu-id="2bc6b-138">Při druhém volání má argument hodnotu `false`a `Main()` metoda zachytí výjimku ve výchozí doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-138">The second time, the argument is `false`, and the `Main()` method catches the exception in the default application domain.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#6](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#6)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#6)]

3. <span data-ttu-id="2bc6b-139">Kód v umístěte `Thrower` metoda řídit, jestli tato metoda obsluhuje vlastní výjimky.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-139">Place code in the `Thrower` method to control whether the method handles its own exception.</span></span>

     [!code-csharp[System.AppDomain.FirstChanceException_howto#5](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#5)]
     [!code-vb[System.AppDomain.FirstChanceException_howto#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#5)]

## <a name="example"></a><span data-ttu-id="2bc6b-140">Příklad</span><span class="sxs-lookup"><span data-stu-id="2bc6b-140">Example</span></span>
 <span data-ttu-id="2bc6b-141">Následující příklad vytvoří aplikační doménu s názvem `AD1` a přidá obslužnou rutinu události do domény aplikace <xref:System.AppDomain.FirstChanceException> událostí.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-141">The following example creates an application domain named `AD1` and adds an event handler to the application domain's <xref:System.AppDomain.FirstChanceException> event.</span></span> <span data-ttu-id="2bc6b-142">Tento příklad vytvoří instanci `Worker` třídy v aplikační doméně a volá metodu s názvem `Thrower` , které vyvolá <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-142">The example creates an instance of the `Worker` class in the application domain, and calls a method named `Thrower` that throws an <xref:System.ArgumentException>.</span></span> <span data-ttu-id="2bc6b-143">V závislosti na hodnotě argumentu metody zachytí výjimku nebo selže, aby to zvládnul.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-143">Depending on the value of its argument, the method either catches the exception or fails to handle it.</span></span>

 <span data-ttu-id="2bc6b-144">Pokaždé, když `Thrower` metoda vyvolá výjimku `AD1`, <xref:System.AppDomain.FirstChanceException> událost je aktivována v `AD1`, a zobrazí zprávu, obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-144">Each time the `Thrower` method throws an exception in `AD1`, the <xref:System.AppDomain.FirstChanceException> event is raised in `AD1`, and the event handler displays a message.</span></span> <span data-ttu-id="2bc6b-145">Modul runtime pak vyhledá obslužnou rutinu výjimky.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-145">The runtime then looks for an exception handler.</span></span> <span data-ttu-id="2bc6b-146">V prvním případě obslužné rutiny výjimky je nalezena v `AD1`.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-146">In the first case, the exception handler is found in `AD1`.</span></span> <span data-ttu-id="2bc6b-147">V druhém případě je neošetřená výjimka v `AD1`a místo toho je zachycena ve výchozí doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-147">In the second case, the exception is unhandled in `AD1`, and instead is caught in the default application domain.</span></span>

> [!NOTE]
>  <span data-ttu-id="2bc6b-148">Název výchozí domény aplikace je stejný jako název spustitelného souboru.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-148">The name of the default application domain is the same as the name of the executable.</span></span>

 <span data-ttu-id="2bc6b-149">Pokud chcete přidat obslužnou rutinu pro <xref:System.AppDomain.FirstChanceException> událostí do výchozí domény aplikace, událost se vyvolá a zpracovány před výchozí domény aplikace zpracovává výjimku.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-149">If you add a handler for the <xref:System.AppDomain.FirstChanceException> event to the default application domain, the event is raised and handled before the default application domain handles the exception.</span></span> <span data-ttu-id="2bc6b-150">Tento údaj zobrazíte, přidejte kód jazyka C# `AppDomain.CurrentDomain.FirstChanceException += FirstChanceException;` (v jazyce Visual Basic `AddHandler AppDomain.CurrentDomain.FirstChanceException, FirstChanceException`) na začátku `Main()`.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-150">To see this, add the C# code `AppDomain.CurrentDomain.FirstChanceException += FirstChanceException;` (in Visual Basic, `AddHandler AppDomain.CurrentDomain.FirstChanceException, FirstChanceException`) at the beginning of `Main()`.</span></span>

 [!code-csharp[System.AppDomain.FirstChanceException_howto#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/cs/example.cs#1)]
 [!code-vb[System.AppDomain.FirstChanceException_howto#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.appdomain.firstchanceexception_howto/vb/example.vb#1)]

## <a name="compiling-the-code"></a><span data-ttu-id="2bc6b-151">Probíhá kompilace kódu</span><span class="sxs-lookup"><span data-stu-id="2bc6b-151">Compiling the Code</span></span>

- <span data-ttu-id="2bc6b-152">V tomto příkladu je aplikace příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-152">This example is a command-line application.</span></span> <span data-ttu-id="2bc6b-153">Chcete-li zkompilovat a spustit tento kód v sadě Visual Studio, přidejte kód jazyka C# `Console.ReadLine();` (v jazyce Visual Basic `Console.ReadLine()`) na konci `Main()`, zabránit ukončit dříve, než si můžete přečíst výstup příkazového okna.</span><span class="sxs-lookup"><span data-stu-id="2bc6b-153">To compile and run this code in Visual Studio, add the C# code `Console.ReadLine();` (in Visual Basic, `Console.ReadLine()`) at the end of `Main()`, to prevent the command window from closing before you can read the output.</span></span>

## <a name="see-also"></a><span data-ttu-id="2bc6b-154">Viz také:</span><span class="sxs-lookup"><span data-stu-id="2bc6b-154">See also</span></span>

- <xref:System.AppDomain.FirstChanceException>
