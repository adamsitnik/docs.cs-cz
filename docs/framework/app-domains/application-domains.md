---
title: Aplikační domény
ms.date: 03/30/2017
helpviewer_keywords:
- process boundaries for isolation
- application isolation
- application domains, about
- common language runtime, application domains
- application domains
- runtime, application domains
- isolation between applications
- code, verification process
- verification testing code
ms.assetid: 113a8bbf-6875-4a72-a49d-ca2d92e19cc8
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: bd6004bce42a3617c9b7de940336de0fb03c8cc9
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "61675114"
---
# <a name="application-domains"></a><span data-ttu-id="9b1e4-102">Aplikační domény</span><span class="sxs-lookup"><span data-stu-id="9b1e4-102">Application domains</span></span>

<span data-ttu-id="9b1e4-103">Operační systémy a běhová prostředí obvykle poskytují určitou formu izolace mezi aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-103">Operating systems and runtime environments typically provide some form of isolation between applications.</span></span> <span data-ttu-id="9b1e4-104">Například Windows používá procesy k izolaci aplikací.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-104">For example, Windows uses processes to isolate applications.</span></span> <span data-ttu-id="9b1e4-105">Tato izolace je nezbytná k zajištění, že kód spuštěný v jedné aplikaci nemohl nepříznivě ovlivnit jiné nesouvisející aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-105">This isolation is necessary to ensure that code running in one application cannot adversely affect other, unrelated applications.</span></span>  
  
 <span data-ttu-id="9b1e4-106">Aplikační domény poskytují izolační hranici pro zabezpečení, spolehlivosti a správy verzí a pro uvolňování sestavení.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-106">Application domains provide an isolation boundary for security, reliability, and versioning, and for unloading assemblies.</span></span> <span data-ttu-id="9b1e4-107">Aplikační domény jsou obvykle vytvářeny hostitelská prostředí modulu runtime, která jsou odpovědná za spuštění modul common language runtime, před spuštěním aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-107">Application domains are typically created by runtime hosts, which are responsible for bootstrapping the common language runtime before an application is run.</span></span>  
  
## <a name="the-benefits-of-isolating-applications"></a><span data-ttu-id="9b1e4-108">Výhody izolace aplikací</span><span class="sxs-lookup"><span data-stu-id="9b1e4-108">The benefits of isolating applications</span></span>

 <span data-ttu-id="9b1e4-109">V minulosti byly hranice procesů použity k izolaci aplikací spuštěných na stejném počítači.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-109">Historically, process boundaries have been used to isolate applications running on the same computer.</span></span> <span data-ttu-id="9b1e4-110">Každá aplikace je načtena jako samostatný proces, který ji izoluje od jiných aplikací spuštěných na stejném počítači.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-110">Each application is loaded into a separate process, which isolates the application from other applications running on the same computer.</span></span>  
  
 <span data-ttu-id="9b1e4-111">Aplikace jsou izolovány vzhledem k tomu, že adresy paměti jsou procesně relativní; ukazatel paměti předaný z jednoho procesu nelze žádným smysluplným způsobem v cílovém procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-111">The applications are isolated because memory addresses are process-relative; a memory pointer passed from one process to another cannot be used in any meaningful way in the target process.</span></span> <span data-ttu-id="9b1e4-112">Kromě toho nemůžete provádět přímá volání mezi dvěma procesy.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-112">In addition, you cannot make direct calls between two processes.</span></span> <span data-ttu-id="9b1e4-113">Místo toho musíte použít proxy servery, které zajišťují určitou úroveň dereference.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-113">Instead, you must use proxies, which provide a level of indirection.</span></span>  
  
 <span data-ttu-id="9b1e4-114">Spravovaný kód musí být předán skrz ověřovací proces před spuštěním (pokud správce udělil oprávnění k přeskočení ověření).</span><span class="sxs-lookup"><span data-stu-id="9b1e4-114">Managed code must be passed through a verification process before it can be run (unless the administrator has granted permission to skip the verification).</span></span> <span data-ttu-id="9b1e4-115">Ověřovací proces určuje, zda kód může pokusit o přístup k neplatné adrese paměti nebo provede nějakou jinou akci, která by mohla způsobit procesu, ve kterém je spuštěna nesprávné fungování.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-115">The verification process determines whether the code can attempt to access invalid memory addresses or perform some other action that could cause the process in which it is running to fail to operate properly.</span></span> <span data-ttu-id="9b1e4-116">Kód, který projde ověřovacím testem je označen jako typově bezpečný.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-116">Code that passes the verification test is said to be type-safe.</span></span> <span data-ttu-id="9b1e4-117">Schopnost ověřit kód jako typově bezpečný umožňuje poskytovat tak skvělou úroveň izolace, jako je hranice procesu a za mnohem nižší výkon, modul common language runtime.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-117">The ability to verify code as type-safe enables the common language runtime to provide as great a level of isolation as the process boundary, at a much lower performance cost.</span></span>  
  
 <span data-ttu-id="9b1e4-118">Aplikační domény poskytují bezpečnější a všestrannější jednotky zpracování, které modul common language runtime můžete použít k poskytnutí izolace mezi aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-118">Application domains provide a more secure and versatile unit of processing that the common language runtime can use to provide isolation between applications.</span></span> <span data-ttu-id="9b1e4-119">Můžete spustit několik domén aplikace v jediném procesu se stejnou úrovní izolace, která by existovala v oddělených procesech, ale bez další režie mezi procesní volání nebo přepínání mezi procesy.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-119">You can run several application domains in a single process with the same level of isolation that would exist in separate processes, but without incurring the additional overhead of making cross-process calls or switching between processes.</span></span> <span data-ttu-id="9b1e4-120">Umožňuje spustit několik aplikací v rámci jediného procesu výrazně zvyšuje škálovatelnost serveru.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-120">The ability to run multiple applications within a single process dramatically increases server scalability.</span></span>  
  
 <span data-ttu-id="9b1e4-121">Izolování aplikace je také důležité kvůli jejímu zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-121">Isolating applications is also important for application security.</span></span> <span data-ttu-id="9b1e4-122">Například můžete spustit ovládací prvky z několika webových aplikací v jediném procesu prohlížeče takovým způsobem, že ovládací prvky nelze přistupovat k datům a prostředkům.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-122">For example, you can run controls from several Web applications in a single browser process in such a way that the controls cannot access each other's data and resources.</span></span>  
  
 <span data-ttu-id="9b1e4-123">Izolace poskytovaná aplikačními doménami má následující výhody:</span><span class="sxs-lookup"><span data-stu-id="9b1e4-123">The isolation provided by application domains has the following benefits:</span></span>  
  
- <span data-ttu-id="9b1e4-124">Chyby v jedné aplikaci nemůžou ovlivnit jiné aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-124">Faults in one application cannot affect other applications.</span></span> <span data-ttu-id="9b1e4-125">Vzhledem k tomu, že kód zajišťující bezpečnost typů nemůže způsobit chyby paměti, pomocí aplikačních domén zajišťuje, že kód spuštěný v jedné doméně nemohl ovlivnit jiné aplikace v procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-125">Because type-safe code cannot cause memory faults, using application domains ensures that code running in one domain cannot affect other applications in the process.</span></span>  
  
- <span data-ttu-id="9b1e4-126">Jednotlivé aplikace mohou být ukončeny bez ukončení celého procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-126">Individual applications can be stopped without stopping the entire process.</span></span> <span data-ttu-id="9b1e4-127">Používání domén aplikací umožňuje uvolnit kód spuštěný v jedné aplikaci.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-127">Using application domains enables you to unload the code running in a single application.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="9b1e4-128">Není možné uvolnit samostatná sestavení nebo typy.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-128">You cannot unload individual assemblies or types.</span></span> <span data-ttu-id="9b1e4-129">Pouze úplná doména může být uvolněna.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-129">Only a complete domain can be unloaded.</span></span>  
  
- <span data-ttu-id="9b1e4-130">Kód spuštěný v jedné aplikaci nemůže přímo přistupovat ke kódu nebo prostředkům jiné aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-130">Code running in one application cannot directly access code or resources from another application.</span></span> <span data-ttu-id="9b1e4-131">Modul common language runtime vynucuje tuto izolaci, aby zabránil přímým voláním mezi objekty v různých aplikačních doménách.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-131">The common language runtime enforces this isolation by preventing direct calls between objects in different application domains.</span></span> <span data-ttu-id="9b1e4-132">Objekty, které prochází mezi doménami jsou buď zkopírovány nebo zpřístupněny pomocí proxy serveru.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-132">Objects that pass between domains are either copied or accessed by proxy.</span></span> <span data-ttu-id="9b1e4-133">Pokud je objekt zkopírován, volání objektu je lokální.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-133">If the object is copied, the call to the object is local.</span></span> <span data-ttu-id="9b1e4-134">To znamená volající a odkazovaný objekt jsou ve stejné doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-134">That is, both the caller and the object being referenced are in the same application domain.</span></span> <span data-ttu-id="9b1e4-135">Pokud je objekt zpřístupněný prostřednictvím proxy serveru, je volání objektu vzdálené.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-135">If the object is accessed through a proxy, the call to the object is remote.</span></span> <span data-ttu-id="9b1e4-136">V takovém případě volající a odkazovaný objekt jsou v různých aplikačních doménách.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-136">In this case, the caller and the object being referenced are in different application domains.</span></span> <span data-ttu-id="9b1e4-137">Volání mezi doménami používat stejnou infrastrukturu vzdáleného volání jako volání mezi dvěma procesy nebo mezi dvěma počítači.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-137">Cross-domain calls use the same remote call infrastructure as calls between two processes or between two machines.</span></span> <span data-ttu-id="9b1e4-138">Metadata pro objekt, který se odkazuje v důsledku toho musí být k dispozici pro obě domény aplikace. Chcete-li povolit volání metody, které chcete být JIT kompilován správně.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-138">As such, the metadata for the object being referenced must be available to both application domains to allow the method call to be JIT-compiled properly.</span></span> <span data-ttu-id="9b1e4-139">Pokud volající doména nemá přístup k metadatům pro volaný objekt, kompilace může selhat s výjimkou typu <xref:System.IO.FileNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-139">If the calling domain does not have access to the metadata for the object being called, the compilation might fail with an exception of type <xref:System.IO.FileNotFoundException>.</span></span> <span data-ttu-id="9b1e4-140">Další informace najdete v tématu [vzdálené objekty](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/72x4h507(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="9b1e4-140">For more information, see [Remote Objects](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/72x4h507(v=vs.100)).</span></span> <span data-ttu-id="9b1e4-141">Mechanismus pro stanovení toho, jak mohou být objekty přístupné napříč doménami je určen objektem.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-141">The mechanism for determining how objects can be accessed across domains is determined by the object.</span></span> <span data-ttu-id="9b1e4-142">Další informace naleznete v tématu <xref:System.MarshalByRefObject?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-142">For more information, see <xref:System.MarshalByRefObject?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="9b1e4-143">Chování kódu je určeno aplikací, ve kterém běží.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-143">The behavior of code is scoped by the application in which it runs.</span></span> <span data-ttu-id="9b1e4-144">Jinými slovy aplikační doména poskytuje nastavení konfigurace, například zásady stanovování verzí aplikace, umístění jakýchkoliv vzdálených sestavení, k nimž přistupuje a informace o tom, kde nalézt sestavení, která jsou načtena do domény.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-144">In other words, the application domain provides configuration settings such as application version policies, the location of any remote assemblies it accesses, and information about where to locate assemblies that are loaded into the domain.</span></span>  
  
- <span data-ttu-id="9b1e4-145">Oprávnění udělená kódu mohou být řízena domény aplikace, ve kterém kód běží.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-145">Permissions granted to code can be controlled by the application domain in which the code is running.</span></span>  
  
## <a name="application-domains-and-assemblies"></a><span data-ttu-id="9b1e4-146">Doménám a sestavením aplikací</span><span class="sxs-lookup"><span data-stu-id="9b1e4-146">Application domains and assemblies</span></span>

 <span data-ttu-id="9b1e4-147">Tato část popisuje vztah mezi doménami aplikací a sestaveními.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-147">This section describes the relationship between application domains and assemblies.</span></span> <span data-ttu-id="9b1e4-148">Předtím, než může spustit kód, který ho obsahuje, je nutné načíst sestavení do domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-148">You must load an assembly into an application domain before you can execute the code it contains.</span></span> <span data-ttu-id="9b1e4-149">Spuštění Typická aplikace způsobí, že několik sestavení mají být načtena do domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-149">Running a typical application causes several assemblies to be loaded into an application domain.</span></span>  
  
 <span data-ttu-id="9b1e4-150">Způsob, jakým je sestavení načteno Určuje, zda jeho just-in-time (JIT) kompilaci kódu může být sdílen více aplikačními doménami v procesu, a zda může být uvolněna z procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-150">The way an assembly is loaded determines whether its just-in-time (JIT) compiled code can be shared by multiple application domains in the process, and whether the assembly can be unloaded from the process.</span></span>  
  
- <span data-ttu-id="9b1e4-151">Pokud je sestavení načteno jako doménově neutrální, všechny aplikační domény, které sdílejí stejné zabezpečení udělují sady můžete sdílet stejný kód zkompilovaný pomocí kompilátoru JIT, který je sníženo množství paměti požadované aplikací.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-151">If an assembly is loaded domain-neutral, all application domains that share the same security grant set can share the same JIT-compiled code, which reduces the memory required by the application.</span></span> <span data-ttu-id="9b1e4-152">Nicméně sestavení může nikdy být uvolněna z procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-152">However, the assembly can never be unloaded from the process.</span></span>  
  
- <span data-ttu-id="9b1e4-153">Pokud sestavení není načteno jako doménově neutrální, musí být JIT kompilován v každé aplikační doméně, ve které je načten.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-153">If an assembly is not loaded domain-neutral, it must be JIT-compiled in every application domain in which it is loaded.</span></span> <span data-ttu-id="9b1e4-154">Sestavení však může být uvolněna z procesu uvolnění všech aplikačních doménách, ve kterých je načíst.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-154">However, the assembly can be unloaded from the process by unloading all the application domains in which it is loaded.</span></span>  
  
 <span data-ttu-id="9b1e4-155">Hostitelský modul runtime určuje, jestli se má načíst sestavení jako doménově neutrální, když ho načítá modul runtime do procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-155">The runtime host determines whether to load assemblies as domain-neutral when it loads the runtime into a process.</span></span> <span data-ttu-id="9b1e4-156">Spravované aplikace, použijte <xref:System.LoaderOptimizationAttribute> atribut do metody vstupního bodu pro proces a zadejte hodnotu od přidruženého <xref:System.LoaderOptimization> výčtu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-156">For managed applications, apply the <xref:System.LoaderOptimizationAttribute> attribute to the entry-point method for the process, and specify a value from the associated <xref:System.LoaderOptimization> enumeration.</span></span> <span data-ttu-id="9b1e4-157">Nespravované aplikace, které jsou hostiteli společného jazykového modulu runtime, zadejte odpovídající příznak při volání [CorBindToRuntimeEx – funkce](../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) metody.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-157">For unmanaged applications that host the common language runtime, specify the appropriate flag when you call the [CorBindToRuntimeEx Function](../../../docs/framework/unmanaged-api/hosting/corbindtoruntimeex-function.md) method.</span></span>  
  
 <span data-ttu-id="9b1e4-158">Existují tři možnosti načtení doménově neutrální sestavení:</span><span class="sxs-lookup"><span data-stu-id="9b1e4-158">There are three options for loading domain-neutral assemblies:</span></span>  
  
- <span data-ttu-id="9b1e4-159"><xref:System.LoaderOptimization.SingleDomain?displayProperty=nameWithType> nenačítá žádné sestavení jako doménově neutrální, s výjimkou Mscorlib, které je vždy načteno jako doménově neutrální.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-159"><xref:System.LoaderOptimization.SingleDomain?displayProperty=nameWithType> loads no assemblies as domain-neutral, except Mscorlib, which is always loaded domain-neutral.</span></span> <span data-ttu-id="9b1e4-160">Toto nastavení se nazývá jediná doména, protože se běžně používá, když na hostiteli běží pouze jednu aplikaci v procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-160">This setting is called single domain because it is commonly used when the host is running only a single application in the process.</span></span>

- <span data-ttu-id="9b1e4-161"><xref:System.LoaderOptimization.MultiDomain?displayProperty=nameWithType> načte všechna sestavení jako doménově neutrální.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-161"><xref:System.LoaderOptimization.MultiDomain?displayProperty=nameWithType> loads all assemblies as domain-neutral.</span></span> <span data-ttu-id="9b1e4-162">Toto nastavení použijte, pokud existuje více domén aplikace v procesu, z nichž všechny spustit stejný kód.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-162">Use this setting when there are multiple application domains in the process, all of which run the same code.</span></span>

- <span data-ttu-id="9b1e4-163"><xref:System.LoaderOptimization.MultiDomainHost?displayProperty=nameWithType> načte sestavení se silným názvem jako doménově neutrální, pokud byly nainstalovány a jejich závislosti v globální mezipaměti sestavení.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-163"><xref:System.LoaderOptimization.MultiDomainHost?displayProperty=nameWithType> loads strong-named assemblies as domain-neutral, if they and all their dependencies have been installed in the global assembly cache.</span></span> <span data-ttu-id="9b1e4-164">Jiná sestavení jsou načtena a JIT kompilován samostatně pro každou doménu aplikace, ve kterém jsou načteny a proto mohou být uvolněna z procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-164">Other assemblies are loaded and JIT-compiled separately for each application domain in which they are loaded, and thus can be unloaded from the process.</span></span> <span data-ttu-id="9b1e4-165">Pomocí tohoto nastavení při spuštění více než jednu aplikaci ve stejném procesu, nebo pokud máte různé sestavení, které sdílí mnoho aplikačních doménách a sestavení, které musí být uvolněna z procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-165">Use this setting when running more than one application in the same process, or if you have a mixture of assemblies that are shared by many application domains and assemblies that need to be unloaded from the process.</span></span>
  
 <span data-ttu-id="9b1e4-166">Nelze sdílet kód zkompilovaný kompilátorem JIT pro sestavení, které načítají do kontextu načtení z pomocí <xref:System.Reflection.Assembly.LoadFrom%2A> metodu <xref:System.Reflection.Assembly> třídy nebo načíst z imagí pomocí přetížení <xref:System.Reflection.Assembly.Load%2A> metody, které specifikují pole bajtů.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-166">JIT-compiled code cannot be shared for assemblies loaded into the load-from context, using the <xref:System.Reflection.Assembly.LoadFrom%2A> method of the <xref:System.Reflection.Assembly> class, or loaded from images using overloads of the <xref:System.Reflection.Assembly.Load%2A> method that specify byte arrays.</span></span>  
  
 <span data-ttu-id="9b1e4-167">Sestavení, která byla zkompilována do nativního kódu s použitím [Ngen.exe (Generátor nativních obrázků)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) je možné sdílet mezi doménami aplikace, že jsou načtena jako doménově neutrální prvním načtením do procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-167">Assemblies that have been compiled to native code by using the [Ngen.exe (Native Image Generator)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) can be shared between application domains, if they are loaded domain-neutral the first time they are loaded into a process.</span></span>  
  
 <span data-ttu-id="9b1e4-168">Kód zkompilovaný kompilátorem JIT pro sestavení, který obsahuje vstupní bod aplikace se sdílí jenom v případě, že je možné sdílet jeho závislosti.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-168">JIT-compiled code for the assembly that contains the application entry point is shared only if all its dependencies can be shared.</span></span>  
  
 <span data-ttu-id="9b1e4-169">Sestavení nezávislá na doméně může být JIT kompilován více než jednou.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-169">A domain-neutral assembly can be JIT-compiled more than once.</span></span> <span data-ttu-id="9b1e4-170">Například při zabezpečení udělit sady z obou aplikačních doménách se liší, nemůžou ale sdílet stejný kód zkompilovaný kompilátorem JIT.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-170">For example, when the security grant sets of two application domains are different, they cannot share the same JIT-compiled code.</span></span> <span data-ttu-id="9b1e4-171">Každá kopie JIT kompilaci sestavení však, mohou být sdíleny s dalšími doménami aplikace, které mají stejná sada udělení oprávnění.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-171">However, each copy of the JIT-compiled assembly can be shared with other application domains that have the same grant set.</span></span>  
  
 <span data-ttu-id="9b1e4-172">Při rozhodování, jestli se má načíst sestavení jako doménově neutrální, je třeba kompromis mezi snížení využití paměti a dalších faktorů výkonu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-172">When you decide whether to load assemblies as domain-neutral, you must make a tradeoff between reducing memory use and other performance factors.</span></span>  
  
- <span data-ttu-id="9b1e4-173">Přístup ke statickým datům a metodám je kvůli potřebě izolovat sestavení pomalejší pro sestavení jako doménově neutrální.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-173">Access to static data and methods is slower for domain-neutral assemblies because of the need to isolate assemblies.</span></span> <span data-ttu-id="9b1e4-174">Každá doména aplikace, který přistupuje k sestavení musí mít samostatnou kopii statická data, aby se zabránilo odkazy na objekty v statická pole z přes hranice domén.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-174">Each application domain that accesses the assembly must have a separate copy of the static data, to prevent references to objects in static fields from crossing domain boundaries.</span></span> <span data-ttu-id="9b1e4-175">V důsledku toho modul runtime obsahuje další logiku ke směrování volajícímu odpovídající kopii statická data nebo metody.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-175">As a result, the runtime contains additional logic to direct a caller to the appropriate copy of the static data or method.</span></span> <span data-ttu-id="9b1e4-176">Tuto logiku navíc může zpomalit volání.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-176">This extra logic slows down the call.</span></span>  
  
- <span data-ttu-id="9b1e4-177">Všechny závislosti sestavení musí být umístěn a načíst, když je sestavení načteno jako doménově neutrální, protože závislost, která nemůže být načtena jako doménově neutrální, brání sestavení jsou načtena jako doménově neutrální.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-177">All the dependencies of an assembly must be located and loaded when the assembly is loaded domain-neutral, because a dependency that cannot be loaded domain-neutral prevents the assembly from being loaded domain-neutral.</span></span>  
  
## <a name="application-domains-and-threads"></a><span data-ttu-id="9b1e4-178">Domény aplikace a vlákna</span><span class="sxs-lookup"><span data-stu-id="9b1e4-178">Application domains and threads</span></span>

 <span data-ttu-id="9b1e4-179">Domény aplikace tvoří hranici izolace zabezpečení, správy verzí, spolehlivost a uvolňování spravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-179">An application domain forms an isolation boundary for security, versioning, reliability, and unloading of managed code.</span></span> <span data-ttu-id="9b1e4-180">Vlákno je konstrukce operační systém používá modul common language runtime k provádění kódu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-180">A thread is the operating system construct used by the common language runtime to execute code.</span></span> <span data-ttu-id="9b1e4-181">Veškerého spravovaného kódu v době běhu, je načteno do domény aplikace a běží na jeden nebo více spravovaných vláken.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-181">At run time, all managed code is loaded into an application domain and is run by one or more managed threads.</span></span>  
  
 <span data-ttu-id="9b1e4-182">Není k dispozici 1: 1 korelace mezi doménami aplikace a vlákna.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-182">There is not a one-to-one correlation between application domains and threads.</span></span> <span data-ttu-id="9b1e4-183">V jediné doméně aplikace v daném okamžiku můžete spustit několik vláken a konkrétní vlákno nejsou omezené na jedné aplikace domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-183">Several threads can execute in a single application domain at any given time, and a particular thread is not confined to a single application domain.</span></span> <span data-ttu-id="9b1e4-184">To znamená, že jsou zdarma přes hranice aplikační domény; vláken nové vlákno není vytvořena pro každou doménu aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-184">That is, threads are free to cross application domain boundaries; a new thread is not created for each application domain.</span></span>  
  
 <span data-ttu-id="9b1e4-185">V daném okamžiku každé vlákno spustí v doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-185">At any given time, every thread executes in an application domain.</span></span> <span data-ttu-id="9b1e4-186">Žádného, jednoho nebo více vláken může být spuštěno v libovolné doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-186">Zero, one, or multiple threads might be executing in any given application domain.</span></span> <span data-ttu-id="9b1e4-187">Uchovává informace o modulu runtime, která vlákna jsou spuštěny v které domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-187">The runtime keeps track of which threads are running in which application domains.</span></span> <span data-ttu-id="9b1e4-188">Můžete najít doménu, ve kterém je vlákno provádění v každém okamžiku voláním <xref:System.Threading.Thread.GetDomain%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-188">You can locate the domain in which a thread is executing at any time by calling the <xref:System.Threading.Thread.GetDomain%2A?displayProperty=nameWithType> method.</span></span>

### <a name="application-domains-and-cultures"></a><span data-ttu-id="9b1e4-189">Aplikační domény a jazykové verze</span><span class="sxs-lookup"><span data-stu-id="9b1e4-189">Application domains and cultures</span></span>

 <span data-ttu-id="9b1e4-190">Jazykové verze, která je reprezentována <xref:System.Globalization.CultureInfo> objektu, je spojen s vlákny.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-190">Culture, which is represented by a <xref:System.Globalization.CultureInfo> object, is associated with threads.</span></span> <span data-ttu-id="9b1e4-191">Můžete získat jazykovou verzi, která souvisí s aktuálně spuštěné vlákno s použitím <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> vlastnosti kde můžete získat nebo nastavit jazykovou verzi, která souvisí s aktuálně spuštěné vlákno s použitím <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-191">You can get the culture that is associated with the currently executing thread by using the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property, and you can get or set the culture that is associated with the currently executing thread by using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="9b1e4-192">Pokud jazykovou verzi, která souvisí s vláknem explicitně nastavené pomocí <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> vlastnost, pokračuje souviset s tímto vláknem po vlákno překročí hranice domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-192">If the culture that is associated with a thread has been explicitly set by using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property, it continues to be associated with that thread when the thread crosses application domain boundaries.</span></span> <span data-ttu-id="9b1e4-193">V opačném případě určení jazykové verze, která souvisí s vláknem v daném okamžiku hodnotou <xref:System.Globalization.CultureInfo.DefaultThreadCurrentCulture%2A?displayProperty=nameWithType> vlastnost v aplikační doméně, ve kterém je spuštěn vlákna:</span><span class="sxs-lookup"><span data-stu-id="9b1e4-193">Otherwise, the culture that is associated with the thread at any given time is determined by the value of the <xref:System.Globalization.CultureInfo.DefaultThreadCurrentCulture%2A?displayProperty=nameWithType> property in the application domain in which the thread is executing:</span></span>  
  
- <span data-ttu-id="9b1e4-194">Pokud hodnota vlastnosti není `null`, jazykovou verzi, která je vrácena vlastností je přidružené vlákno (a tedy vrácené <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> a <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> vlastnosti).</span><span class="sxs-lookup"><span data-stu-id="9b1e4-194">If the value of the property is not `null`, the culture that is returned by the property is associated with the thread (and therefore returned by the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> and <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> properties).</span></span>  
  
- <span data-ttu-id="9b1e4-195">Pokud je hodnota vlastnosti `null`, je spojen s vláknem aktuální systémovou kulturu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-195">If the value of the property is `null`, the current system culture is associated with the thread.</span></span>  
  
## <a name="programming-with-application-domains"></a><span data-ttu-id="9b1e4-196">Programování pomocí domén aplikace</span><span class="sxs-lookup"><span data-stu-id="9b1e4-196">Programming with application domains</span></span>

 <span data-ttu-id="9b1e4-197">Aplikační domény jsou obvykle vytvořit a spravovat prostřednictvím kódu programu pomocí hostitelská prostředí modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-197">Application domains are usually created and manipulated programmatically by runtime hosts.</span></span> <span data-ttu-id="9b1e4-198">Ale někdy programu aplikace může být také vhodné pro práci s doménami aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-198">However, sometimes an application program might also want to work with application domains.</span></span> <span data-ttu-id="9b1e4-199">Programu aplikace může například načíst součásti do domény, aby bylo možné uvolnění domény aplikace (a komponenta) bez nutnosti zastavení celé aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-199">For example, an application program could load an application component into a domain to be able to unload the domain (and the component) without having to stop the entire application.</span></span>  
  
 <span data-ttu-id="9b1e4-200"><xref:System.AppDomain> Je programové rozhraní do domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-200">The <xref:System.AppDomain> is the programmatic interface to application domains.</span></span> <span data-ttu-id="9b1e4-201">Tato třída obsahuje metody pro vytvoření a uvolnění domény, chcete-li vytvořit instance typů v doménách a k registraci pro různá upozornění, jako je například uvolnění domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-201">This class includes methods to create and unload domains, to create instances of types in domains, and to register for various notifications such as application domain unloading.</span></span> <span data-ttu-id="9b1e4-202">Následující tabulce jsou uvedeny běžně používané <xref:System.AppDomain> metody.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-202">The following table lists commonly used <xref:System.AppDomain> methods.</span></span>  
  
|<span data-ttu-id="9b1e4-203">Metoda třídy AppDomain</span><span class="sxs-lookup"><span data-stu-id="9b1e4-203">AppDomain Method</span></span>|<span data-ttu-id="9b1e4-204">Popis</span><span class="sxs-lookup"><span data-stu-id="9b1e4-204">Description</span></span>|  
|----------------------|-----------------|  
|<xref:System.AppDomain.CreateDomain%2A>|<span data-ttu-id="9b1e4-205">Vytvoří novou doménu aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-205">Creates a new application domain.</span></span> <span data-ttu-id="9b1e4-206">Je doporučeno používat přetížení této metody, které určuje <xref:System.AppDomainSetup> objektu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-206">It is recommended that you use an overload of this method that specifies an <xref:System.AppDomainSetup> object.</span></span> <span data-ttu-id="9b1e4-207">Toto je upřednostňovaný způsob, jak nastavit vlastnosti nové domény, jako je například základ cesty aplikace nebo kořenového adresáře pro aplikaci. umístění konfiguračního souboru pro domény. a vyhledávací cestu, modul common language runtime, je použít k načtení sestavení do domény.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-207">This is the preferred way to set the properties of a new domain, such as the application base, or root directory for the application; the location of the configuration file for the domain; and the search path that the common language runtime is to use to load assemblies into the domain.</span></span>|  
|<span data-ttu-id="9b1e4-208"><xref:System.AppDomain.ExecuteAssembly%2A> a <xref:System.AppDomain.ExecuteAssemblyByName%2A></span><span class="sxs-lookup"><span data-stu-id="9b1e4-208"><xref:System.AppDomain.ExecuteAssembly%2A> and <xref:System.AppDomain.ExecuteAssemblyByName%2A></span></span>|<span data-ttu-id="9b1e4-209">Spustí sestavení v doméně aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-209">Executes an assembly in the application domain.</span></span> <span data-ttu-id="9b1e4-210">Toto je metoda instance, takže ho můžete použít ke spouštění kódu vytvořeného v jiné doméně aplikace, ke kterému budete mít odkaz na.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-210">This is an instance method, so it can be used to execute code in another application domain to which you have a reference.</span></span>|  
|<xref:System.AppDomain.CreateInstanceAndUnwrap%2A>|<span data-ttu-id="9b1e4-211">Vytvoří instanci zadaného typu v aplikační doméně a vrátí proxy server.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-211">Creates an instance of a specified type in the application domain, and returns a proxy.</span></span> <span data-ttu-id="9b1e4-212">Pomocí této metody můžete předejít sestavení obsahující typ vytvořeného do volajícího sestavení.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-212">Use this method to avoid loading the assembly containing the created type into the calling assembly.</span></span>|  
|<xref:System.AppDomain.Unload%2A>|<span data-ttu-id="9b1e4-213">Provádí řádné vypnutí domény.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-213">Performs a graceful shutdown of the domain.</span></span> <span data-ttu-id="9b1e4-214">Doména aplikace není uvolněn, dokud všechna vlákna spuštěná v doméně, byla buď zastavena nebo už nejsou v doméně.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-214">The application domain is not unloaded until all threads running in the domain have either stopped or are no longer in the domain.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="9b1e4-215">Modul common language runtime nepodporuje serializace globálních metod, takže delegáty nelze použít k provedení globálních metod v jiných doménách aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-215">The common language runtime does not support serialization of global methods, so delegates cannot be used to execute global methods in other application domains.</span></span>  
  
 <span data-ttu-id="9b1e4-216">Nespravovaná rozhraní, je popsáno v modulu common language runtime hostování specifikace rozhraní také poskytnout přístup k aplikační domény.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-216">The unmanaged interfaces described in the common language runtime Hosting Interfaces Specification also provide access to application domains.</span></span> <span data-ttu-id="9b1e4-217">Hostitelská prostředí modulu runtime slouží k vytvoření a získat přístup do domény aplikace uvnitř procesu rozhraní z nespravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-217">Runtime hosts can use interfaces from unmanaged code to create and gain access to the application domains within a process.</span></span>  
  
## <a name="the-complusloaderoptimization-environment-variable"></a><span data-ttu-id="9b1e4-218">Complus_loaderoptimization – proměnná prostředí</span><span class="sxs-lookup"><span data-stu-id="9b1e4-218">The COMPLUS_LoaderOptimization environment variable</span></span>

 <span data-ttu-id="9b1e4-219">Proměnné prostředí, která nastaví výchozí zásady optimalizace zavaděče spustitelného souboru.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-219">An environment variable that sets the default loader optimization policy of an executable application.</span></span>  
  
### <a name="syntax"></a><span data-ttu-id="9b1e4-220">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="9b1e4-220">Syntax</span></span>  
  
```  
COMPLUS_LoaderOptimization = 1  
```  
  
### <a name="remarks"></a><span data-ttu-id="9b1e4-221">Poznámky</span><span class="sxs-lookup"><span data-stu-id="9b1e4-221">Remarks</span></span>

 <span data-ttu-id="9b1e4-222">Typická aplikace několik sestavení načte do domény aplikace předtím, než mohou být provedeny v kódu, které obsahují.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-222">A typical application loads several assemblies into an application domain before the code they contain can be executed.</span></span>  
  
 <span data-ttu-id="9b1e4-223">Způsob, jakým je načteno sestavení určuje, zda jeho just-in-time (JIT) kompilaci kódu může být sdílen více aplikačními doménami v procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-223">The way the assembly is loaded determines whether its just-in-time (JIT) compiled code can be shared by multiple application domains in the process.</span></span>  
  
- <span data-ttu-id="9b1e4-224">Pokud je sestavení načteno jako doménově neutrální, všechny aplikační domény, které sdílejí stejnou sadu zabezpečení můžete sdílet stejný kód zkompilovaný kompilátorem JIT.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-224">If an assembly is loaded domain-neutral, all application domains that share the same security grant set can share the same JIT-compiled code.</span></span> <span data-ttu-id="9b1e4-225">Tím je sníženo množství paměti požadované aplikací.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-225">This reduces the memory required by the application.</span></span>  
  
- <span data-ttu-id="9b1e4-226">Pokud sestavení není načteno jako doménově neutrální, musí být JIT kompilován v každé aplikační doméně, ve které je načten a zavaděč nesmí sdílet interní prostředky mezi doménami aplikace.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-226">If an assembly is not loaded domain-neutral, it must be JIT-compiled in every application domain in which it is loaded and the loader must not share internal resources across application domains.</span></span>  
  
 <span data-ttu-id="9b1e4-227">Při natavení na 1 příznak prostředí COMPLUS_LoaderOptimization vynutí hostitelský modul runtime načtení všech sestavení způsobem domény neutrální označované jako SingleDomain.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-227">When set to 1, the COMPLUS_LoaderOptimization environment flag forces the runtime host to load all assemblies in non-domain-neutral way known as SingleDomain.</span></span> <span data-ttu-id="9b1e4-228">SingleDomain nenačítá žádné sestavení jako doménově neutrální, s výjimkou Mscorlib, které je vždy načteno jako doménově neutrální.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-228">SingleDomain loads no assemblies as domain-neutral, except Mscorlib, which is always loaded domain-neutral.</span></span> <span data-ttu-id="9b1e4-229">Toto nastavení se nazývá jediná doména, protože se běžně používá, když na hostiteli běží pouze jednu aplikaci v procesu.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-229">This setting is called single domain because it is commonly used when the host is running only a single application in the process.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="9b1e4-230">Příznak prostředí COMPLUS_LoaderOptimization byl navržen pro použití v rámci diagnostiky a testovací scénáře.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-230">The COMPLUS_LoaderOptimization environment flag was designed to be used in diagnostic and test scenarios.</span></span> <span data-ttu-id="9b1e4-231">S se zapnutým příznakem můžete způsobit vážné zpomalování a zvýšení využití paměti.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-231">Having the flag turned on can cause severe slow-down and increase in memory usage.</span></span>  
  
### <a name="code-example"></a><span data-ttu-id="9b1e4-232">Příklad kódu</span><span class="sxs-lookup"><span data-stu-id="9b1e4-232">Code example</span></span>

 <span data-ttu-id="9b1e4-233">K vynucení všechna sestavení zavedeny jako doménově neutrální pro IISADMIN, připojte service můžete dosáhnout přidáním `COMPLUS_LoaderOptimization=1` víceřetězcovou hodnotu prostředí v klíči HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN.</span><span class="sxs-lookup"><span data-stu-id="9b1e4-233">To force all assemblies not to be loaded as domain-neutral for the IISADMIN service can be achieved by appending `COMPLUS_LoaderOptimization=1` to the Environment’s Multi-String Value in the HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN key.</span></span>  
  
```  
Key = HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN  
Name = Environment  
Type = REG_MULTI_SZ  
Value (to append) = COMPLUS_LoaderOptimization=1  
```  
  
## <a name="see-also"></a><span data-ttu-id="9b1e4-234">Viz také:</span><span class="sxs-lookup"><span data-stu-id="9b1e4-234">See also</span></span>

- <xref:System.AppDomain?displayProperty=nameWithType>
- <xref:System.MarshalByRefObject?displayProperty=nameWithType>
- [<span data-ttu-id="9b1e4-235">Programování s doménami aplikací a sestaveními</span><span class="sxs-lookup"><span data-stu-id="9b1e4-235">Programming with Application Domains and Assemblies</span></span>](index.md)
- [<span data-ttu-id="9b1e4-236">Používání domén aplikací</span><span class="sxs-lookup"><span data-stu-id="9b1e4-236">Using Application Domains</span></span>](use.md)
