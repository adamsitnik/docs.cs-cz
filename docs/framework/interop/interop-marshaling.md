---
title: Zařazování spolupráce
ms.date: 03/30/2017
helpviewer_keywords:
- marshaling, COM interop
- interop marshaling
- interop marshaling, about interop marshaling
ms.assetid: 115f7a2f-d422-4605-ab36-13a8dd28142a
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 21eea2ccdff88a11e9708fef317011dc547cafda
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "61873224"
---
# <a name="interop-marshaling"></a><span data-ttu-id="cf8be-102">Zařazování spolupráce</span><span class="sxs-lookup"><span data-stu-id="cf8be-102">Interop Marshaling</span></span>
<a name="top"></a> <span data-ttu-id="cf8be-103">Zařazování spolupráce řídí, jak se data předaná v metoda argumentů a vrácené hodnoty mezi spravovaným a nespravovaným paměti během volání.</span><span class="sxs-lookup"><span data-stu-id="cf8be-103">Interop marshaling governs how data is passed in method arguments and return values between managed and unmanaged memory during calls.</span></span> <span data-ttu-id="cf8be-104">Zařazování spolupráce je za běhu aktivity prováděné common language runtime zařazovací služby.</span><span class="sxs-lookup"><span data-stu-id="cf8be-104">Interop marshaling is a run-time activity performed by the common language runtime's marshaling service.</span></span>  
  
 <span data-ttu-id="cf8be-105">Většina datových typů mají společné reprezentací v paměti spravovaných i nespravovaných.</span><span class="sxs-lookup"><span data-stu-id="cf8be-105">Most data types have common representations in both managed and unmanaged memory.</span></span> <span data-ttu-id="cf8be-106">Tyto typy interoperační zařazovač zpracuje za vás.</span><span class="sxs-lookup"><span data-stu-id="cf8be-106">The interop marshaler handles these types for you.</span></span> <span data-ttu-id="cf8be-107">Jiné typy mohou být nejednoznačná nebo není zastoupené vůbec ve spravované paměti.</span><span class="sxs-lookup"><span data-stu-id="cf8be-107">Other types can be ambiguous or not represented at all in managed memory.</span></span>  
  
 <span data-ttu-id="cf8be-108">Nejednoznačný typ, který může mít více nespravované reprezentace, které mapují na jeden spravovaný typ nebo chybějící informace o typu, jako je například velikost pole.</span><span class="sxs-lookup"><span data-stu-id="cf8be-108">An ambiguous type can have either multiple unmanaged representations that map to a single managed type, or missing type information, such as the size of an array.</span></span> <span data-ttu-id="cf8be-109">Pro dvojznačné typy aby zařazování odvozovalo poskytuje reprezentaci výchozí a alternativní zobrazení, kde existuje více reprezentací.</span><span class="sxs-lookup"><span data-stu-id="cf8be-109">For ambiguous types, the marshaler provides a default representation and alternative representations where multiple representations exist.</span></span> <span data-ttu-id="cf8be-110">Můžete zadat explicitní pokynů zařazovacího modulu na to, jak je nejednoznačný typ přeuspořádat.</span><span class="sxs-lookup"><span data-stu-id="cf8be-110">You can supply explicit instructions to the marshaler on how it is to marshal an ambiguous type.</span></span>  
  
 <span data-ttu-id="cf8be-111">Tento přehled obsahuje následující části:</span><span class="sxs-lookup"><span data-stu-id="cf8be-111">This overview contains the following sections:</span></span>  
  
- [<span data-ttu-id="cf8be-112">Vyvolání platformy a modely spolupráce COM</span><span class="sxs-lookup"><span data-stu-id="cf8be-112">Platform Invoke and COM Interop Models</span></span>](#platform_invoke_and_com_interop_models)  
  
- [<span data-ttu-id="cf8be-113">Zařazování a objekty apartment modelu COM</span><span class="sxs-lookup"><span data-stu-id="cf8be-113">Marshaling and COM Apartments</span></span>](#marshaling_and_com_apartments)  
  
- [<span data-ttu-id="cf8be-114">Zařazování Vzdálená volání</span><span class="sxs-lookup"><span data-stu-id="cf8be-114">Marshaling Remote Calls</span></span>](#marshaling_remote_calls)  
  
- [<span data-ttu-id="cf8be-115">Související témata</span><span class="sxs-lookup"><span data-stu-id="cf8be-115">Related Topics</span></span>](#related_topics)  
  
- [<span data-ttu-id="cf8be-116">Referenční informace</span><span class="sxs-lookup"><span data-stu-id="cf8be-116">Reference</span></span>](#reference)  
  
<a name="platform_invoke_and_com_interop_models"></a>   
## <a name="platform-invoke-and-com-interop-models"></a><span data-ttu-id="cf8be-117">Vyvolání platformy a modely spolupráce COM</span><span class="sxs-lookup"><span data-stu-id="cf8be-117">Platform Invoke and COM Interop Models</span></span>  
 <span data-ttu-id="cf8be-118">Modul common language runtime poskytuje dva mechanismy pro spolupráce s nespravovaným kódem:</span><span class="sxs-lookup"><span data-stu-id="cf8be-118">The common language runtime provides two mechanisms for interoperating with unmanaged code:</span></span>  
  
- <span data-ttu-id="cf8be-119">Nespravovaného kódu, což umožňuje spravovanému kódu volat exportované funkce z nespravované knihovny.</span><span class="sxs-lookup"><span data-stu-id="cf8be-119">Platform invoke, which enables managed code to call functions exported from an unmanaged library.</span></span>  
  
- <span data-ttu-id="cf8be-120">Komunikace s objekty COM, která umožňuje spravovanému kódu pracovat s objekty modelu COM (Component Object) prostřednictvím rozhraní.</span><span class="sxs-lookup"><span data-stu-id="cf8be-120">COM interop, which enables managed code to interact with Component Object Model (COM) objects through interfaces.</span></span>  
  
 <span data-ttu-id="cf8be-121">Vyvolání obě platformy a modelu COM interop použití zařazování spolupráce přesně argumenty metody přesouvat mezi volajícím a volaný a zpět, pokud vyžaduje.</span><span class="sxs-lookup"><span data-stu-id="cf8be-121">Both platform invoke and COM interop use interop marshaling to accurately move method arguments between caller and callee and back, if required.</span></span> <span data-ttu-id="cf8be-122">Jak ukazuje následující obrázek, platformu vyvolání toky volání metody ze spravovaného do nespravovaného kódu a nikdy jiným způsobem, kromě případů, kdy [funkce zpětného volání](callback-functions.md) se využívá řada.</span><span class="sxs-lookup"><span data-stu-id="cf8be-122">As the following illustration shows, a platform invoke method call flows from managed to unmanaged code and never the other way, except when [callback functions](callback-functions.md) are involved.</span></span> <span data-ttu-id="cf8be-123">I v případě vyvolání platformy můžete tok volání pouze ze spravovaného do nespravovaného kódu, může tok dat v obou směrech jako vstupní nebo výstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="cf8be-123">Even though platform invoke calls can flow only from managed to unmanaged code, data can flow in both directions as input or output parameters.</span></span> <span data-ttu-id="cf8be-124">Volání metody vzájemné spolupráce COM můžete tok v obou směrech.</span><span class="sxs-lookup"><span data-stu-id="cf8be-124">COM interop method calls can flow in either direction.</span></span>  
  
 <span data-ttu-id="cf8be-125">![Vyvolání platformy](./media/interop-marshaling/interop-marshaling-invoke-and-com.png "vyvolání platformy a tok volání interop modelu COM")</span><span class="sxs-lookup"><span data-stu-id="cf8be-125">![Platform invoke](./media/interop-marshaling/interop-marshaling-invoke-and-com.png "Platform invoke and COM interop call flow")</span></span>  
  
 <span data-ttu-id="cf8be-126">Na nejnižší úrovni obou mechanismy používají stejný zprostředkovatel komunikace s objekty zařazování služby; ale některé typy dat podporovaných výhradně ve spolupráci s COM nebo vyvolání platformy.</span><span class="sxs-lookup"><span data-stu-id="cf8be-126">At the lowest level, both mechanisms use the same interop marshaling service; however, certain data types are supported exclusively by COM interop or platform invoke.</span></span> <span data-ttu-id="cf8be-127">Podrobnosti najdete v tématu [výchozí chování zařazování](default-marshaling-behavior.md).</span><span class="sxs-lookup"><span data-stu-id="cf8be-127">For details, see [Default Marshaling Behavior](default-marshaling-behavior.md).</span></span>  
  
 [<span data-ttu-id="cf8be-128">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="cf8be-128">Back to top</span></span>](#top)  
  
<a name="marshaling_and_com_apartments"></a>   
## <a name="marshaling-and-com-apartments"></a><span data-ttu-id="cf8be-129">Zařazování a objekty apartment modelu COM</span><span class="sxs-lookup"><span data-stu-id="cf8be-129">Marshaling and COM Apartments</span></span>  
 <span data-ttu-id="cf8be-130">Interoperační zařazovač zařadí data mezi běžné haldě modulu runtime jazyka a nespravované haldě.</span><span class="sxs-lookup"><span data-stu-id="cf8be-130">The interop marshaler marshals data between the common language runtime heap and the unmanaged heap.</span></span> <span data-ttu-id="cf8be-131">Zařazování vyvolá se při každém volajícím a volaným nelze použít ve stejné instanci data.</span><span class="sxs-lookup"><span data-stu-id="cf8be-131">Marshaling occurs whenever the caller and callee cannot operate on the same instance of data.</span></span> <span data-ttu-id="cf8be-132">Interoperační zařazovač umožňuje volajícím a volaným provoz na stejná data, i v případě, že mají své vlastní kopie dat se zobrazí.</span><span class="sxs-lookup"><span data-stu-id="cf8be-132">The interop marshaler makes it possible for the caller and callee to appear to be operating on the same data even if they have their own copy of the data.</span></span>  
  
 <span data-ttu-id="cf8be-133">COM také obsahuje zařazovací modul, který zařadí data mezi objekty apartment modelu COM nebo jiné procesy COM.</span><span class="sxs-lookup"><span data-stu-id="cf8be-133">COM also has a marshaler that marshals data between COM apartments or different COM processes.</span></span> <span data-ttu-id="cf8be-134">Při volání mezi spravovaný a nespravovaný kód v rámci stejného objektu apartment modelu COM, interoperační zařazovač je potřebný jenom zařazování.</span><span class="sxs-lookup"><span data-stu-id="cf8be-134">When calling between managed and unmanaged code within the same COM apartment, the interop marshaler is the only marshaler involved.</span></span> <span data-ttu-id="cf8be-135">Při volání mezi spravovaný kód a nespravovaný kód v různých apartment modelu COM nebo jiným procesem, interoperační zařazovač a zařazovacího modulu COM souvisejí.</span><span class="sxs-lookup"><span data-stu-id="cf8be-135">When calling between managed code and unmanaged code in a different COM apartment or a different process, both the interop marshaler and the COM marshaler are involved.</span></span>  
  
### <a name="com-clients-and-managed-servers"></a><span data-ttu-id="cf8be-136">Klienti modelu COM a spravovaných serverů</span><span class="sxs-lookup"><span data-stu-id="cf8be-136">COM Clients and Managed Servers</span></span>  
 <span data-ttu-id="cf8be-137">Registrovaných exportované spravovaný server pomocí knihovny typů [Regasm.exe (Nástroj registrace sestavení)](../tools/regasm-exe-assembly-registration-tool.md) má `ThreadingModel` záznam v registru nastavte na `Both`.</span><span class="sxs-lookup"><span data-stu-id="cf8be-137">An exported managed server with a type library registered by the [Regasm.exe (Assembly Registration Tool)](../tools/regasm-exe-assembly-registration-tool.md) has a `ThreadingModel` registry entry set to `Both`.</span></span> <span data-ttu-id="cf8be-138">Tato hodnota označuje, že server možné ho aktivovat v jednovláknový apartment (STA) nebo s více vlákny typu apartment (MTA).</span><span class="sxs-lookup"><span data-stu-id="cf8be-138">This value indicates that the server can be activated in a single-threaded apartment (STA) or a multithreaded apartment (MTA).</span></span> <span data-ttu-id="cf8be-139">Objekt serveru se vytvoří ve stejném objektu apartment jako volající funkci, jak je znázorněno v následující tabulce.</span><span class="sxs-lookup"><span data-stu-id="cf8be-139">The server object is created in the same apartment as its caller, as shown in the following table.</span></span>  
  
|<span data-ttu-id="cf8be-140">Klient modelu COM</span><span class="sxs-lookup"><span data-stu-id="cf8be-140">COM client</span></span>|<span data-ttu-id="cf8be-141">.NET serveru</span><span class="sxs-lookup"><span data-stu-id="cf8be-141">.NET server</span></span>|<span data-ttu-id="cf8be-142">Požadavky zařazování</span><span class="sxs-lookup"><span data-stu-id="cf8be-142">Marshaling requirements</span></span>|  
|----------------|-----------------|-----------------------------|  
|<span data-ttu-id="cf8be-143">STA</span><span class="sxs-lookup"><span data-stu-id="cf8be-143">STA</span></span>|<span data-ttu-id="cf8be-144">`Both` změní STA.</span><span class="sxs-lookup"><span data-stu-id="cf8be-144">`Both` becomes STA.</span></span>|<span data-ttu-id="cf8be-145">Zařazování stejného objektu apartment.</span><span class="sxs-lookup"><span data-stu-id="cf8be-145">Same-apartment marshaling.</span></span>|  
|<span data-ttu-id="cf8be-146">MTA</span><span class="sxs-lookup"><span data-stu-id="cf8be-146">MTA</span></span>|<span data-ttu-id="cf8be-147">`Both` změní MTA.</span><span class="sxs-lookup"><span data-stu-id="cf8be-147">`Both` becomes MTA.</span></span>|<span data-ttu-id="cf8be-148">Zařazování stejného objektu apartment.</span><span class="sxs-lookup"><span data-stu-id="cf8be-148">Same-apartment marshaling.</span></span>|  
  
 <span data-ttu-id="cf8be-149">Protože klient a server jsou ve stejném objektu apartment, zprostředkovatel komunikace s objekty zařazování service automaticky zpracovává všechna data zařazování.</span><span class="sxs-lookup"><span data-stu-id="cf8be-149">Because the client and server are in the same apartment, the interop marshaling service automatically handles all data marshaling.</span></span> <span data-ttu-id="cf8be-150">Následující obrázek znázorňuje spolupráce zařazovací služby provoz mezi spravovanými a nespravovanými haldy v rámci stejného objektu apartment modelu COM-style.</span><span class="sxs-lookup"><span data-stu-id="cf8be-150">The following illustration shows the interop marshaling service operating between managed and unmanaged heaps within the same COM-style apartment.</span></span>  
  
 <span data-ttu-id="cf8be-151">![Zařazování spolupráce mezi spravovaných a nespravovaných haldy](./media/interop-marshaling/interop-heaps-managed-and-unmanaged.gif "stejné apartment zařazování procesu")</span><span class="sxs-lookup"><span data-stu-id="cf8be-151">![Interop marshaling between managed and unmanaged heaps](./media/interop-marshaling/interop-heaps-managed-and-unmanaged.gif "Same-apartment marshaling process")</span></span>  
  
 <span data-ttu-id="cf8be-152">Pokud budete chtít exportovat spravovaného serveru, mějte na paměti, určuje klient modelu COM typu apartment serveru.</span><span class="sxs-lookup"><span data-stu-id="cf8be-152">If you plan to export a managed server, be aware that the COM client determines the apartment of the server.</span></span> <span data-ttu-id="cf8be-153">Spravovaný server volá klient modelu COM ve MTA inicializovat, musíte zajistit bezpečný přístup z více vláken.</span><span class="sxs-lookup"><span data-stu-id="cf8be-153">A managed server called by a COM client initialized in an MTA must ensure thread safety.</span></span>  
  
### <a name="managed-clients-and-com-servers"></a><span data-ttu-id="cf8be-154">Spravovaných klientů a serverů modelu COM</span><span class="sxs-lookup"><span data-stu-id="cf8be-154">Managed Clients and COM Servers</span></span>  
 <span data-ttu-id="cf8be-155">Výchozí nastavení pro objekty apartment spravovaného klienta je MTA; aplikace typu klient .NET však můžete změnit výchozí nastavení.</span><span class="sxs-lookup"><span data-stu-id="cf8be-155">The default setting for managed client apartments is MTA; however, the application type of the .NET client can change the default setting.</span></span> <span data-ttu-id="cf8be-156">Například [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] objektu apartment nastavení klienta je STA.</span><span class="sxs-lookup"><span data-stu-id="cf8be-156">For example, a [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] client apartment setting is STA.</span></span> <span data-ttu-id="cf8be-157">Můžete použít <xref:System.STAThreadAttribute?displayProperty=nameWithType>, <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> vlastnost, nebo <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> vlastnost sloužící ke zkoumání a změnit nastavení objektu apartment spravovaný klient.</span><span class="sxs-lookup"><span data-stu-id="cf8be-157">You can use the <xref:System.STAThreadAttribute?displayProperty=nameWithType>, the <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, the <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> property, or the <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> property to examine and change the apartment setting of a managed client.</span></span>  
  
 <span data-ttu-id="cf8be-158">Autor součásti nastaví spřažení vláken COM serveru.</span><span class="sxs-lookup"><span data-stu-id="cf8be-158">The author of the component sets the thread affinity of a COM server.</span></span> <span data-ttu-id="cf8be-159">V následující tabulce jsou uvedeny kombinace nastavení objektu apartment pro klienty .NET a serverů modelu COM.</span><span class="sxs-lookup"><span data-stu-id="cf8be-159">The following table shows the combinations of apartment settings for .NET clients and COM servers.</span></span> <span data-ttu-id="cf8be-160">Profil také ukazuje, výsledná zařazování požadavky pro všechny kombinace.</span><span class="sxs-lookup"><span data-stu-id="cf8be-160">It also shows the resulting marshaling requirements for the combinations.</span></span>  
  
|<span data-ttu-id="cf8be-161">Klient .NET</span><span class="sxs-lookup"><span data-stu-id="cf8be-161">.NET client</span></span>|<span data-ttu-id="cf8be-162">COM server</span><span class="sxs-lookup"><span data-stu-id="cf8be-162">COM server</span></span>|<span data-ttu-id="cf8be-163">Požadavky zařazování</span><span class="sxs-lookup"><span data-stu-id="cf8be-163">Marshaling requirements</span></span>|  
|-----------------|----------------|-----------------------------|  
|<span data-ttu-id="cf8be-164">MTA (výchozí)</span><span class="sxs-lookup"><span data-stu-id="cf8be-164">MTA (default)</span></span>|<span data-ttu-id="cf8be-165">MTA</span><span class="sxs-lookup"><span data-stu-id="cf8be-165">MTA</span></span><br /><br /> <span data-ttu-id="cf8be-166">STA</span><span class="sxs-lookup"><span data-stu-id="cf8be-166">STA</span></span>|<span data-ttu-id="cf8be-167">Zařazování spolupráce.</span><span class="sxs-lookup"><span data-stu-id="cf8be-167">Interop marshaling.</span></span><br /><br /> <span data-ttu-id="cf8be-168">Zprostředkovatel komunikace s objekty a modelu COM zařazování.</span><span class="sxs-lookup"><span data-stu-id="cf8be-168">Interop and COM marshaling.</span></span>|  
|<span data-ttu-id="cf8be-169">STA</span><span class="sxs-lookup"><span data-stu-id="cf8be-169">STA</span></span>|<span data-ttu-id="cf8be-170">MTA</span><span class="sxs-lookup"><span data-stu-id="cf8be-170">MTA</span></span><br /><br /> <span data-ttu-id="cf8be-171">STA</span><span class="sxs-lookup"><span data-stu-id="cf8be-171">STA</span></span>|<span data-ttu-id="cf8be-172">Zprostředkovatel komunikace s objekty a modelu COM zařazování.</span><span class="sxs-lookup"><span data-stu-id="cf8be-172">Interop and COM marshaling.</span></span><br /><br /> <span data-ttu-id="cf8be-173">Zařazování spolupráce.</span><span class="sxs-lookup"><span data-stu-id="cf8be-173">Interop marshaling.</span></span>|  
  
 <span data-ttu-id="cf8be-174">Když klienta spravovaného a nespravovaného serveru jsou ve stejném objektu apartment, zprostředkovatele komunikace s objekty zařazování služby zpracovává všechny zařazování dat.</span><span class="sxs-lookup"><span data-stu-id="cf8be-174">When a managed client and unmanaged server are in the same apartment, the interop marshaling service handles all data marshaling.</span></span> <span data-ttu-id="cf8be-175">Ale když klienta a serveru jsou inicializovány v jiné objekty apartment, zařazování COM je také nutný.</span><span class="sxs-lookup"><span data-stu-id="cf8be-175">However, when client and server are initialized in different apartments, COM marshaling is also required.</span></span> <span data-ttu-id="cf8be-176">Následující obrázek znázorňuje prvky volání mezi objektu apartment.</span><span class="sxs-lookup"><span data-stu-id="cf8be-176">The following illustration shows the elements of a cross-apartment call.</span></span>  
  
 <span data-ttu-id="cf8be-177">![Zařazování COM](./media/interop-marshaling/single-process-across-multi-apartment.gif "napříč apartment volání mezi klient .NET a objekt modelu COM")</span><span class="sxs-lookup"><span data-stu-id="cf8be-177">![COM marshaling](./media/interop-marshaling/single-process-across-multi-apartment.gif "Cross-apartment call between a .NET client and COM object")</span></span>  
  
 <span data-ttu-id="cf8be-178">Pro různé apartment zařazování, máte následující:</span><span class="sxs-lookup"><span data-stu-id="cf8be-178">For cross-apartment marshaling, you can do the following:</span></span>  
  
- <span data-ttu-id="cf8be-179">Přijměte režie zařazování mezi apartment, což je patrné pouze v případě, že existují mnoho volání přes hranice.</span><span class="sxs-lookup"><span data-stu-id="cf8be-179">Accept the overhead of the cross-apartment marshaling, which is noticeable only when there are many calls across the boundary.</span></span> <span data-ttu-id="cf8be-180">Je nutné zaregistrovat knihovnu typů komponenty modelu COM pro volání úspěšně překračují hranice objektu apartment.</span><span class="sxs-lookup"><span data-stu-id="cf8be-180">You must register the type library of the COM component for calls to successfully cross the apartment boundary.</span></span>  
  
- <span data-ttu-id="cf8be-181">Příkaz ALTER hlavního vlákna nastavením klienta vlákna STA nebo MTA.</span><span class="sxs-lookup"><span data-stu-id="cf8be-181">Alter the main thread by setting the client thread to STA or MTA.</span></span> <span data-ttu-id="cf8be-182">Například pokud vaše C# klient volá řada komponent STA COM, můžete vyhnout tak, že nastavíte hlavního vlákna STA. zařazování mezi objektu apartment</span><span class="sxs-lookup"><span data-stu-id="cf8be-182">For example, if your C# client calls many STA COM components, you can avoid cross-apartment marshaling by setting the main thread to STA.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="cf8be-183">Jednou vlákno C# klienta nastavena na STA, volání součásti MTA COM bude vyžadovat zařazování mezi objektu apartment.</span><span class="sxs-lookup"><span data-stu-id="cf8be-183">Once the thread of a C# client is set to STA, calls to MTA COM components will require cross-apartment marshaling.</span></span>  
  
 <span data-ttu-id="cf8be-184">Explicitně zvolíte modelu objektu apartment, v tématu [spravovaná a nespravovaná vlákna](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="cf8be-184">For instructions on explicitly selecting an apartment model, see [Managed and Unmanaged Threading](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100)).</span></span>  
  
 [<span data-ttu-id="cf8be-185">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="cf8be-185">Back to top</span></span>](#top)  
  
<a name="marshaling_remote_calls"></a>   
## <a name="marshaling-remote-calls"></a><span data-ttu-id="cf8be-186">Zařazování Vzdálená volání</span><span class="sxs-lookup"><span data-stu-id="cf8be-186">Marshaling Remote Calls</span></span>  
 <span data-ttu-id="cf8be-187">Stejně jako u zařazování mezi apartment modelu COM zařazování je zahrnuta v každé volání mezi spravovaný a nespravovaný kód pokaždé, když se objekty nacházejí v samostatných procesech.</span><span class="sxs-lookup"><span data-stu-id="cf8be-187">As with cross-apartment marshaling, COM marshaling is involved in each call between managed and unmanaged code whenever the objects reside in separate processes.</span></span> <span data-ttu-id="cf8be-188">Příklad:</span><span class="sxs-lookup"><span data-stu-id="cf8be-188">For example:</span></span>  
  
- <span data-ttu-id="cf8be-189">Klient modelu COM, která volá spravovaný server na vzdáleného hostitele používá distributed COM (DCOM).</span><span class="sxs-lookup"><span data-stu-id="cf8be-189">A COM client that invokes a managed server on a remote host uses distributed COM (DCOM).</span></span>  
  
- <span data-ttu-id="cf8be-190">Spravovaný klient, který volá server COM na vzdáleného hostitele používá model DCOM.</span><span class="sxs-lookup"><span data-stu-id="cf8be-190">A managed client that invokes a COM server on a remote host uses DCOM.</span></span>  
  
 <span data-ttu-id="cf8be-191">Následující obrázek znázorňuje, jak spolupráce zařazování a zařazování COM poskytují komunikační kanály přes hranice procesu a hostitele.</span><span class="sxs-lookup"><span data-stu-id="cf8be-191">The following illustration shows how interop marshaling and COM marshaling provide communications channels across process and host boundaries.</span></span>  
  
 <span data-ttu-id="cf8be-192">![Zařazování COM](./media/interop-marshaling/interop-and-com-marshaling.gif "zařazování mezi procesy")</span><span class="sxs-lookup"><span data-stu-id="cf8be-192">![COM marshaling](./media/interop-marshaling/interop-and-com-marshaling.gif "Cross-process marshaling")</span></span>  
  
### <a name="preserving-identity"></a><span data-ttu-id="cf8be-193">Zachování Identity</span><span class="sxs-lookup"><span data-stu-id="cf8be-193">Preserving Identity</span></span>  
 <span data-ttu-id="cf8be-194">Modul common language runtime uchovává identity spravovaných a nespravovaných odkazy.</span><span class="sxs-lookup"><span data-stu-id="cf8be-194">The common language runtime preserves the identity of managed and unmanaged references.</span></span> <span data-ttu-id="cf8be-195">Následující obrázek znázorňuje tok nespravované přímé odkazy (horní řádek) a s přímým přístupem spravované odkazy (dolní řádek) přes hranice procesu a hostitele.</span><span class="sxs-lookup"><span data-stu-id="cf8be-195">The following illustration shows the flow of direct unmanaged references (top row) and direct managed references (bottom row) across process and host boundaries.</span></span>  
  
 <span data-ttu-id="cf8be-196">![Obálka volatelná aplikacemi COM a obálka volatelná za běhu](./media/interop-marshaling/interop-direct-ref-across-process.gif "odkaz předávání přes hranice procesu a hostitele")</span><span class="sxs-lookup"><span data-stu-id="cf8be-196">![COM callable wrapper and runtime callable wrapper](./media/interop-marshaling/interop-direct-ref-across-process.gif "Reference passing across process and host boundaries")</span></span>  
  
 <span data-ttu-id="cf8be-197">Na tomto obrázku:</span><span class="sxs-lookup"><span data-stu-id="cf8be-197">In this illustration:</span></span>  
  
- <span data-ttu-id="cf8be-198">Nespravovaný klient získá odkaz na objekt modelu COM ze spravovaného objektu, který získá tento odkaz na vzdáleného hostitele.</span><span class="sxs-lookup"><span data-stu-id="cf8be-198">An unmanaged client gets a reference to a COM object from a managed object that gets this reference from a remote host.</span></span> <span data-ttu-id="cf8be-199">Je mechanismus vzdálenou komunikaci modelu DCOM.</span><span class="sxs-lookup"><span data-stu-id="cf8be-199">The remoting mechanism is DCOM.</span></span>  
  
- <span data-ttu-id="cf8be-200">Spravovaný klient získá odkaz na spravovaný objekt z objektu COM, který získá tento odkaz na vzdáleného hostitele.</span><span class="sxs-lookup"><span data-stu-id="cf8be-200">A managed client gets a reference to a managed object from a COM object that gets this reference from a remote host.</span></span> <span data-ttu-id="cf8be-201">Je mechanismus vzdálenou komunikaci modelu DCOM.</span><span class="sxs-lookup"><span data-stu-id="cf8be-201">The remoting mechanism is DCOM.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="cf8be-202">Exportované knihovny typů spravovaného serveru musí být zaregistrovaný.</span><span class="sxs-lookup"><span data-stu-id="cf8be-202">The exported type library of the managed server must be registered.</span></span>  
  
 <span data-ttu-id="cf8be-203">Počet hranice procesů mezi volajícím a volaným je bezvýznamná; stejné přímé odkazování vyvolá pro volání a mimo proces.</span><span class="sxs-lookup"><span data-stu-id="cf8be-203">The number of process boundaries between caller and callee is irrelevant; the same direct referencing occurs for in-process and out-of-process calls.</span></span>  
  
### <a name="managed-remoting"></a><span data-ttu-id="cf8be-204">Spravované vzdálené komunikace</span><span class="sxs-lookup"><span data-stu-id="cf8be-204">Managed Remoting</span></span>  
 <span data-ttu-id="cf8be-205">Modul runtime poskytuje také spravované vzdálené komunikace, které můžete použít k vytvoření komunikačního kanálu mezi spravovanými objekty přes hranice procesu a hostitele.</span><span class="sxs-lookup"><span data-stu-id="cf8be-205">The runtime also provides managed remoting, which you can use to establish a communications channel between managed objects across process and host boundaries.</span></span> <span data-ttu-id="cf8be-206">Spravované vzdálené komunikace zvládne brány firewall mezi komunikujícími komponenty, jako ukazuje následující obrázek.</span><span class="sxs-lookup"><span data-stu-id="cf8be-206">Managed remoting can accommodate a firewall between the communicating components, as the following illustration shows.</span></span>  
  
 <span data-ttu-id="cf8be-207">![Protokol SOAP nebo TcpChannel](./media/interop-marshaling/interop-remote-soap-or-tcp.gif "vzdálené volání přes brány firewall pomocí protokolu SOAP nebo TcpChannel třídy")</span><span class="sxs-lookup"><span data-stu-id="cf8be-207">![SOAP or TcpChannel](./media/interop-marshaling/interop-remote-soap-or-tcp.gif "Remote calls across firewalls using SOAP or the TcpChannel class")</span></span>  
<span data-ttu-id="cf8be-208">Vzdálená volání přes brány firewall pomocí protokolu SOAP nebo TcpChannel třídy</span><span class="sxs-lookup"><span data-stu-id="cf8be-208">Remote calls across firewalls using SOAP or the TcpChannel class</span></span>  
  
 <span data-ttu-id="cf8be-209">Některá volání nespravovaného můžete channeled prostřednictvím protokolu SOAP, jako je například volání mezi obsluhované komponenty a modelu COM.</span><span class="sxs-lookup"><span data-stu-id="cf8be-209">Some unmanaged calls can be channeled through SOAP, such as the calls between serviced components and COM.</span></span>  
  
 [<span data-ttu-id="cf8be-210">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="cf8be-210">Back to top</span></span>](#top)  
  
<a name="related_topics"></a>   
## <a name="related-topics"></a><span data-ttu-id="cf8be-211">Související témata</span><span class="sxs-lookup"><span data-stu-id="cf8be-211">Related Topics</span></span>  
  
|<span data-ttu-id="cf8be-212">Název</span><span class="sxs-lookup"><span data-stu-id="cf8be-212">Title</span></span>|<span data-ttu-id="cf8be-213">Popis</span><span class="sxs-lookup"><span data-stu-id="cf8be-213">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="cf8be-214">Výchozí chování zařazování</span><span class="sxs-lookup"><span data-stu-id="cf8be-214">Default Marshaling Behavior</span></span>](default-marshaling-behavior.md)|<span data-ttu-id="cf8be-215">Popisuje pravidla, která používá službu zařazování interop zařazování dat.</span><span class="sxs-lookup"><span data-stu-id="cf8be-215">Describes the rules that the interop marshaling service uses to marshal data.</span></span>|  
|[<span data-ttu-id="cf8be-216">Zařazování dat s voláním platformy</span><span class="sxs-lookup"><span data-stu-id="cf8be-216">Marshaling Data with Platform Invoke</span></span>](marshaling-data-with-platform-invoke.md)|<span data-ttu-id="cf8be-217">Popisuje, jak deklarovat parametry metody a předání argumentů funkcí exportovaných knihovnou nespravovaných knihoven.</span><span class="sxs-lookup"><span data-stu-id="cf8be-217">Describes how to declare method parameters and pass arguments to functions exported by unmanaged libraries.</span></span>|  
|[<span data-ttu-id="cf8be-218">Zařazování dat se spoluprací COM</span><span class="sxs-lookup"><span data-stu-id="cf8be-218">Marshaling Data with COM Interop</span></span>](marshaling-data-with-com-interop.md)|<span data-ttu-id="cf8be-219">Popisuje, jak přizpůsobit COM – obálky změnit chování zařazování.</span><span class="sxs-lookup"><span data-stu-id="cf8be-219">Describes how to customize COM wrappers to alter marshaling behavior.</span></span>|  
|[<span data-ttu-id="cf8be-220">Postupy: Migrace spravovaného kódu DCOM do WCF</span><span class="sxs-lookup"><span data-stu-id="cf8be-220">How to: Migrate Managed-Code DCOM to WCF</span></span>](how-to-migrate-managed-code-dcom-to-wcf.md)|<span data-ttu-id="cf8be-221">Popisuje postup migrace z modelu DCOM do WCF.</span><span class="sxs-lookup"><span data-stu-id="cf8be-221">Describes how to migrate from DCOM to WCF.</span></span>|  
|[<span data-ttu-id="cf8be-222">Postupy: Mapování výsledků HRESULT a výjimek</span><span class="sxs-lookup"><span data-stu-id="cf8be-222">How to: Map HRESULTs and Exceptions</span></span>](how-to-map-hresults-and-exceptions.md)|<span data-ttu-id="cf8be-223">Popisuje, jak namapovat vlastní výjimky výsledků HRESULT a poskytuje úplné mapování z každé HRESULT na jeho třída srovnatelné výjimek v rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cf8be-223">Describes how to map custom exceptions to HRESULTs and provides the complete mapping from each HRESULT to its comparable exception class in the .NET Framework.</span></span>|  
|<span data-ttu-id="cf8be-224">[Spolupráce pomocí obecných typů](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229590(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="cf8be-224">[Interoperating Using Generic Types](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229590(v=vs.100))</span></span>|<span data-ttu-id="cf8be-225">Popisuje akce, které jsou podporovány při použití obecných typů pro interoperabilitu COM.</span><span class="sxs-lookup"><span data-stu-id="cf8be-225">Describes which actions are supported when using generic types for COM interoperability.</span></span>|  
|[<span data-ttu-id="cf8be-226">Spolupráce s nespravovaným kódem</span><span class="sxs-lookup"><span data-stu-id="cf8be-226">Interoperating with Unmanaged Code</span></span>](index.md)|<span data-ttu-id="cf8be-227">Popisuje interoperability poskytované modulem common language runtime.</span><span class="sxs-lookup"><span data-stu-id="cf8be-227">Describes interoperability services provided by the common language runtime.</span></span>|  
|<span data-ttu-id="cf8be-228">[Rozšířená interoperabilita modelu COM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="cf8be-228">[Advanced COM Interoperability](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))</span></span>|<span data-ttu-id="cf8be-229">Obsahuje odkazy na další informace o začlenění komponenty modelu COM do vaší aplikace rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cf8be-229">Provides links to more information about incorporating COM components into your .NET Framework application.</span></span>|  
|<span data-ttu-id="cf8be-230">[Aspekty návrhu pro spolupráci](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/61aax4kh(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="cf8be-230">[Design Considerations for Interoperation](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/61aax4kh(v=vs.100))</span></span>|<span data-ttu-id="cf8be-231">Poskytuje tipy pro psaní integrované komponenty modelu COM.</span><span class="sxs-lookup"><span data-stu-id="cf8be-231">Provides tips for writing integrated COM components.</span></span>|  
  
 [<span data-ttu-id="cf8be-232">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="cf8be-232">Back to top</span></span>](#top)  
  
<a name="reference"></a>   
## <a name="reference"></a><span data-ttu-id="cf8be-233">Odkaz</span><span class="sxs-lookup"><span data-stu-id="cf8be-233">Reference</span></span>  
 <xref:System.Runtime.InteropServices?displayProperty=nameWithType>  
  
 [<span data-ttu-id="cf8be-234">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="cf8be-234">Back to top</span></span>](#top)
