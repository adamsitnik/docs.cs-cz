---
title: Ekvivalence typů a vestavěné typy spolupráce
ms.date: 03/30/2017
helpviewer_keywords:
- type equivalence
- embedded interop types
- primary interop assemblies,not necessary in CLR version 4
- NoPIA
ms.assetid: 78892eba-2a58-4165-b4b1-0250ee2f41dc
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 137aeaab4e63adbb81c0f3d90718def10f906e6a
ms.sourcegitcommit: 155012a8a826ee8ab6aa49b1b3a3b532e7b7d9bd
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/04/2019
ms.locfileid: "66489232"
---
# <a name="type-equivalence-and-embedded-interop-types"></a><span data-ttu-id="31f1c-102">Ekvivalence typů a vestavěné typy spolupráce</span><span class="sxs-lookup"><span data-stu-id="31f1c-102">Type equivalence and embedded interop types</span></span>

<span data-ttu-id="31f1c-103">Od verze rozhraní .NET Framework 4, modul common language runtime podporuje vkládání informací o typu pro typy modelu COM přímo do spravovaných sestavení, namísto nutnosti spravované sestavení, které chcete získat informace o typu pro typy modelu COM ze sestavení vzájemné spolupráce.</span><span class="sxs-lookup"><span data-stu-id="31f1c-103">Beginning with the .NET Framework 4, the common language runtime supports embedding type information for COM types directly into managed assemblies, instead of requiring the managed assemblies to obtain type information for COM types from interop assemblies.</span></span> <span data-ttu-id="31f1c-104">Informace o typu embedded zahrnuje pouze typy a členy, které jsou skutečně používané spravovaným sestavením, a proto může mít dvě spravovaná sestavení velmi různá zobrazení stejného modelu COM typu.</span><span class="sxs-lookup"><span data-stu-id="31f1c-104">Because the embedded type information includes only the types and members that are actually used by a managed assembly, two managed assemblies might have very different views of the same COM type.</span></span> <span data-ttu-id="31f1c-105">Každé spravované sestavení má jiné <xref:System.Type> objekt reprezentující jeho zobrazení modelu COM typu.</span><span class="sxs-lookup"><span data-stu-id="31f1c-105">Each managed assembly has a different <xref:System.Type> object to represent its view of the COM type.</span></span> <span data-ttu-id="31f1c-106">Modul common language runtime podporuje typu ekvivalence mezi tyto různá zobrazení pro rozhraní, struktury, výčty a delegáti.</span><span class="sxs-lookup"><span data-stu-id="31f1c-106">The common language runtime supports type equivalence between these different views for interfaces, structures, enumerations, and delegates.</span></span>

<span data-ttu-id="31f1c-107">Porovnávání znamená, že objekt modelu COM, který je předán z jednoho spravovaného sestavení do jiného lze převést na odpovídající typ v sestavení přijímající spravované.</span><span class="sxs-lookup"><span data-stu-id="31f1c-107">Type equivalence means that a COM object that is passed from one managed assembly to another can be cast to the appropriate managed type in the receiving assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="31f1c-108">Ekvivalence typů a vestavěné typy spolupráce Zjednodušte nasazování aplikací a doplňky, které používají model COM, protože to není nezbytné pro nasazení sestavení vzájemné spolupráce s aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="31f1c-108">Type equivalence and embedded interop types simplify the deployment of applications and add-ins that use COM components, because it is not necessary to deploy interop assemblies with the applications.</span></span> <span data-ttu-id="31f1c-109">Vývojáři sdílené komponenty modelu COM ještě k vytvoření sestavení primární spolupráce (PIA), pokud je to vyžadováno jejich součástí použitého v předchozích verzích rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="31f1c-109">Developers of shared COM components still have to create primary interop assemblies (PIAs) if they want their components to be used by earlier versions of the .NET Framework.</span></span>

## <a name="type-equivalence"></a><span data-ttu-id="31f1c-110">Ekvivalence typů</span><span class="sxs-lookup"><span data-stu-id="31f1c-110">Type equivalence</span></span>

 <span data-ttu-id="31f1c-111">Ekvivalence typů modelu COM je podporován pro rozhraní, struktury, výčty a delegáti.</span><span class="sxs-lookup"><span data-stu-id="31f1c-111">Equivalence of COM types is supported for interfaces, structures, enumerations, and delegates.</span></span> <span data-ttu-id="31f1c-112">Typy modelu COM kvalifikovat jako ekvivalentní, pokud jsou splněny všechny z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="31f1c-112">COM types qualify as equivalent if all of the following are true:</span></span>

- <span data-ttu-id="31f1c-113">Jak rozhraní, nebo jak struktury, nebo jak výčty nebo oba delegátů jsou tyto typy.</span><span class="sxs-lookup"><span data-stu-id="31f1c-113">The types are both interfaces, or both structures, or both enumerations, or both delegates.</span></span>

- <span data-ttu-id="31f1c-114">Typy mají stejnou identitu, jak je popsáno v další části.</span><span class="sxs-lookup"><span data-stu-id="31f1c-114">The types have the same identity, as described in the next section.</span></span>

- <span data-ttu-id="31f1c-115">Oba typy jsou způsobilý pro ekvivalenci typu, jak je popsáno v [typy označení modelu COM pro ekvivalenci typu](#marking-com-types-for-type-equivalence) oddílu.</span><span class="sxs-lookup"><span data-stu-id="31f1c-115">Both types are eligible for type equivalence, as described in the [Marking COM types for type equivalence](#marking-com-types-for-type-equivalence) section.</span></span>

### <a name="type-identity"></a><span data-ttu-id="31f1c-116">Typ identity</span><span class="sxs-lookup"><span data-stu-id="31f1c-116">Type identity</span></span>

<span data-ttu-id="31f1c-117">Dva typy, které jsou určeny k mít stejnou identitu při jejich obory a identity shodují, jinými slovy, pokud každý z nich <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> a dva atributy mají odpovídající <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="31f1c-117">Two types are determined to have the same identity when their scopes and identities match, in other words, if they each have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, and the two attributes have matching <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> and <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> properties.</span></span> <span data-ttu-id="31f1c-118">Porovnání pro <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> je velká a malá písmena.</span><span class="sxs-lookup"><span data-stu-id="31f1c-118">The comparison for <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> is case-insensitive.</span></span>

<span data-ttu-id="31f1c-119">Pokud typ nemá <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> atribut, nebo jestli bylo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> atribut, který není určen oboru a identifikátor, typ lze stále považovat za pro ekvivalenci následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="31f1c-119">If a type does not have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, or if it has a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute that does not specify scope and identifier, the type can still be considered for equivalence as follows:</span></span>

- <span data-ttu-id="31f1c-120">Pro rozhraní, hodnota <xref:System.Runtime.InteropServices.GuidAttribute> se použije namísto <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> vlastnost a <xref:System.Type.FullName%2A?displayProperty=nameWithType> vlastnosti (to znamená, název typu včetně oboru názvů) se použije namísto <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="31f1c-120">For interfaces, the value of the <xref:System.Runtime.InteropServices.GuidAttribute> is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property (that is, the type name, including the namespace) is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="31f1c-121">Struktury, výčty a delegáti <xref:System.Runtime.InteropServices.GuidAttribute> obsahující sestavení se použije namísto <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> vlastnost a <xref:System.Type.FullName%2A?displayProperty=nameWithType> vlastnost se používá namísto <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="31f1c-121">For structures, enumerations, and delegates, the <xref:System.Runtime.InteropServices.GuidAttribute> of the containing assembly is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> property.</span></span>

### <a name="marking-com-types-for-type-equivalence"></a><span data-ttu-id="31f1c-122">Označení typy modelu COM pro ekvivalenci typu</span><span class="sxs-lookup"><span data-stu-id="31f1c-122">Marking COM types for type equivalence</span></span>

 <span data-ttu-id="31f1c-123">Můžete označit typ jako způsobilý pro ekvivalenci typu dvěma způsoby:</span><span class="sxs-lookup"><span data-stu-id="31f1c-123">You can mark a type as eligible for type equivalence in two ways:</span></span>

- <span data-ttu-id="31f1c-124">Použít <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> atribut typu.</span><span class="sxs-lookup"><span data-stu-id="31f1c-124">Apply the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute to the type.</span></span>

- <span data-ttu-id="31f1c-125">Učiňte typ typu modelu COM importu.</span><span class="sxs-lookup"><span data-stu-id="31f1c-125">Make the type a COM import type.</span></span> <span data-ttu-id="31f1c-126">Rozhraní je typ importu modelu COM, pokud má <xref:System.Runtime.InteropServices.ComImportAttribute> atribut.</span><span class="sxs-lookup"><span data-stu-id="31f1c-126">An interface is a COM import type if it has the <xref:System.Runtime.InteropServices.ComImportAttribute> attribute.</span></span> <span data-ttu-id="31f1c-127">Rozhraní, strukturu, výčet nebo delegát je typ importu modelu COM, pokud má sestavení, ve kterém je definována <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> atribut.</span><span class="sxs-lookup"><span data-stu-id="31f1c-127">An interface, structure, enumeration, or delegate is a COM import type if the assembly in which it is defined has the <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> attribute.</span></span>

## <a name="see-also"></a><span data-ttu-id="31f1c-128">Viz také:</span><span class="sxs-lookup"><span data-stu-id="31f1c-128">See also</span></span>

- <xref:System.Type.IsEquivalentTo%2A>
- <span data-ttu-id="31f1c-129">[Používání typů modelu COM ve spravovaném kódu](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="31f1c-129">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="31f1c-130">Import knihovny typů ve formě sestavení</span><span class="sxs-lookup"><span data-stu-id="31f1c-130">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
