---
title: Konfigurace parametrů a datové typy parametrů
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
ms.openlocfilehash: e4414e33efb077e00e4b38e3e53d218ecd7343a7
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "62034551"
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="d22bb-102">Konfigurace parametrů a datové typy parametrů</span><span class="sxs-lookup"><span data-stu-id="d22bb-102">Configuring parameters and parameter data types</span></span>

<span data-ttu-id="d22bb-103">Objekty příkazů použít parametry k předání hodnoty příkazy SQL nebo úložné procedury, kontrolu typu a ověření.</span><span class="sxs-lookup"><span data-stu-id="d22bb-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="d22bb-104">Na rozdíl od text příkazu vstupní parametr je považován za hodnotu literálu, nikoli jako spustitelný kód.</span><span class="sxs-lookup"><span data-stu-id="d22bb-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="d22bb-105">To pomáhá chránit před útoky "Útok prostřednictvím injektáže SQL", ve kterých útočník vloží příkaz tohoto ohrožení zabezpečení na serveru do příkazu SQL.</span><span class="sxs-lookup"><span data-stu-id="d22bb-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>

<span data-ttu-id="d22bb-106">Příkazy s parametry může také zvýšit výkon spuštění dotazů, protože mohou pomoci přesně odpovídat příchozí příkaz s plánem správné dotazu z mezipaměti databázového serveru.</span><span class="sxs-lookup"><span data-stu-id="d22bb-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="d22bb-107">Další informace najdete v tématu [spuštění plánu ukládání do mezipaměti a opětovné používání](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) a [parametry a provádění plán znovu použít](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span><span class="sxs-lookup"><span data-stu-id="d22bb-107">For more information, see [Execution Plan Caching and Reuse](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) and [Parameters and Execution Plan Reuse](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span></span> <span data-ttu-id="d22bb-108">Kromě výhod zabezpečení a výkonu příkazy s parametry poskytují vhodnou metodu pro uspořádání hodnoty předané ke zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="d22bb-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>

<span data-ttu-id="d22bb-109">A <xref:System.Data.Common.DbParameter> objekt může být vytvořen pomocí konstruktoru, nebo jejím přidáním na <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> voláním `Add` metodu <xref:System.Data.Common.DbParameterCollection> kolekce.</span><span class="sxs-lookup"><span data-stu-id="d22bb-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="d22bb-110">`Add` Metoda vezme jako vstupní argumenty konstruktoru nebo existující objekt parametr, v závislosti na poskytovateli data.</span><span class="sxs-lookup"><span data-stu-id="d22bb-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>

## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="d22bb-111">Zadání vlastnosti ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="d22bb-111">Supplying the ParameterDirection property</span></span>

<span data-ttu-id="d22bb-112">Při přidávání parametrů, je nutné zadat <xref:System.Data.ParameterDirection> vlastnost pro parametry, než jsou vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="d22bb-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="d22bb-113">Následující tabulka ukazuje `ParameterDirection` hodnoty, které můžete používat <xref:System.Data.ParameterDirection> výčtu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>

|<span data-ttu-id="d22bb-114">Název členu</span><span class="sxs-lookup"><span data-stu-id="d22bb-114">Member name</span></span>|<span data-ttu-id="d22bb-115">Popis</span><span class="sxs-lookup"><span data-stu-id="d22bb-115">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="d22bb-116">Parametr je vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="d22bb-116">The parameter is an input parameter.</span></span> <span data-ttu-id="d22bb-117">Toto nastavení je výchozí.</span><span class="sxs-lookup"><span data-stu-id="d22bb-117">This is the default.</span></span>|
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="d22bb-118">Tento parametr můžete provádět vstup a výstup.</span><span class="sxs-lookup"><span data-stu-id="d22bb-118">The parameter can perform both input and output.</span></span>|
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="d22bb-119">Parametr je výstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="d22bb-119">The parameter is an output parameter.</span></span>|
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="d22bb-120">Parametr reprezentuje návratovou hodnotu z určité operace, například uložené procedury, integrovaná funkce nebo uživatelem definované funkce.</span><span class="sxs-lookup"><span data-stu-id="d22bb-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|

## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="d22bb-121">Práce se zástupnými symboly parametru</span><span class="sxs-lookup"><span data-stu-id="d22bb-121">Working with parameter placeholders</span></span>

<span data-ttu-id="d22bb-122">Syntaxe pro parametr zástupné symboly závisí na zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="d22bb-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="d22bb-123">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Zprostředkovatelé dat zpracování pojmenování a určení parametrů a proměnných parametrů odlišně.</span><span class="sxs-lookup"><span data-stu-id="d22bb-123">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="d22bb-124">Tato syntaxe upravit tak, aby konkrétnímu zdroji dat, jak je popsáno v následující tabulce.</span><span class="sxs-lookup"><span data-stu-id="d22bb-124">This syntax is customized to a specific data source, as described in the following table.</span></span>

|<span data-ttu-id="d22bb-125">Zprostředkovatel dat</span><span class="sxs-lookup"><span data-stu-id="d22bb-125">Data provider</span></span>|<span data-ttu-id="d22bb-126">Pojmenování syntaxe parametru</span><span class="sxs-lookup"><span data-stu-id="d22bb-126">Parameter naming syntax</span></span>|
|-------------------|-----------------------------|
|<xref:System.Data.SqlClient>|<span data-ttu-id="d22bb-127">Použití pojmenované parametry ve formátu `@` *parametername*.</span><span class="sxs-lookup"><span data-stu-id="d22bb-127">Uses named parameters in the format `@`*parametername*.</span></span>|
|<xref:System.Data.OleDb>|<span data-ttu-id="d22bb-128">Používá značky pozičních parametrů více dopředu označeny otazníkem (`?`).</span><span class="sxs-lookup"><span data-stu-id="d22bb-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.Odbc>|<span data-ttu-id="d22bb-129">Používá značky pozičních parametrů více dopředu označeny otazníkem (`?`).</span><span class="sxs-lookup"><span data-stu-id="d22bb-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.OracleClient>|<span data-ttu-id="d22bb-130">Použití pojmenované parametry ve formátu `:` *parmname* (nebo *parmname*).</span><span class="sxs-lookup"><span data-stu-id="d22bb-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|

## <a name="specifying-parameter-data-types"></a><span data-ttu-id="d22bb-131">Určení datové typy parametrů</span><span class="sxs-lookup"><span data-stu-id="d22bb-131">Specifying parameter data types</span></span>

<span data-ttu-id="d22bb-132">Datový typ parametru je specifické pro [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] poskytovatele dat služeb.</span><span class="sxs-lookup"><span data-stu-id="d22bb-132">The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider.</span></span> <span data-ttu-id="d22bb-133">Určení typu převede hodnotu `Parameter` k [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] typ zprostředkovatele dat před předáním této hodnoty ke zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="d22bb-133">Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source.</span></span> <span data-ttu-id="d22bb-134">Můžete také zadat typ `Parameter` obecný způsobem tak, že nastavíte `DbType` vlastnost `Parameter` objekt ke konkrétní <xref:System.Data.DbType>.</span><span class="sxs-lookup"><span data-stu-id="d22bb-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>

<span data-ttu-id="d22bb-135">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Datovým typem zprostředkovatele `Parameter` objekt je odvozen z [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] typ `Value` z `Parameter` objektu, nebo z `DbType` z `Parameter` objektu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-135">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="d22bb-136">V následující tabulce jsou uvedeny odvozené `Parameter` založený na objekt předaný jako typ `Parameter` hodnotu nebo zadaný `DbType`.</span><span class="sxs-lookup"><span data-stu-id="d22bb-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>

|<span data-ttu-id="d22bb-137">Typ rozhraní .NET Framework</span><span class="sxs-lookup"><span data-stu-id="d22bb-137">.NET Framework type</span></span>|<span data-ttu-id="d22bb-138">DbType</span><span class="sxs-lookup"><span data-stu-id="d22bb-138">DbType</span></span>|<span data-ttu-id="d22bb-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="d22bb-139">SqlDbType</span></span>|<span data-ttu-id="d22bb-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="d22bb-140">OleDbType</span></span>|<span data-ttu-id="d22bb-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="d22bb-141">OdbcType</span></span>|<span data-ttu-id="d22bb-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="d22bb-142">OracleType</span></span>|
|-------------------------|------------|---------------|---------------|--------------|----------------|
|<xref:System.Boolean>|<span data-ttu-id="d22bb-143">Boolean</span><span class="sxs-lookup"><span data-stu-id="d22bb-143">Boolean</span></span>|<span data-ttu-id="d22bb-144">bit</span><span class="sxs-lookup"><span data-stu-id="d22bb-144">Bit</span></span>|<span data-ttu-id="d22bb-145">Boolean</span><span class="sxs-lookup"><span data-stu-id="d22bb-145">Boolean</span></span>|<span data-ttu-id="d22bb-146">bit</span><span class="sxs-lookup"><span data-stu-id="d22bb-146">Bit</span></span>|<span data-ttu-id="d22bb-147">Byte</span><span class="sxs-lookup"><span data-stu-id="d22bb-147">Byte</span></span>|
|<xref:System.Byte>|<span data-ttu-id="d22bb-148">Byte</span><span class="sxs-lookup"><span data-stu-id="d22bb-148">Byte</span></span>|<span data-ttu-id="d22bb-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-149">TinyInt</span></span>|<span data-ttu-id="d22bb-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-150">UnsignedTinyInt</span></span>|<span data-ttu-id="d22bb-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-151">TinyInt</span></span>|<span data-ttu-id="d22bb-152">Byte</span><span class="sxs-lookup"><span data-stu-id="d22bb-152">Byte</span></span>|
|<span data-ttu-id="d22bb-153">Byte</span><span class="sxs-lookup"><span data-stu-id="d22bb-153">byte[]</span></span>|<span data-ttu-id="d22bb-154">binární</span><span class="sxs-lookup"><span data-stu-id="d22bb-154">Binary</span></span>|<span data-ttu-id="d22bb-155">VarBinary.</span><span class="sxs-lookup"><span data-stu-id="d22bb-155">VarBinary.</span></span> <span data-ttu-id="d22bb-156">Toto implicitní převod selže, pokud bajtové pole je větší než maximální velikost parametru VarBinary, což je 8 000 bajtů. Bajtová pole větší než 8 000 bajtů, explicitně nastavit <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="d22bb-156">This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="d22bb-157">VarBinary</span><span class="sxs-lookup"><span data-stu-id="d22bb-157">VarBinary</span></span>|<span data-ttu-id="d22bb-158">binární</span><span class="sxs-lookup"><span data-stu-id="d22bb-158">Binary</span></span>|<span data-ttu-id="d22bb-159">nezpracované</span><span class="sxs-lookup"><span data-stu-id="d22bb-159">Raw</span></span>|
|<xref:System.Char>| |<span data-ttu-id="d22bb-160">Odvození <xref:System.Data.SqlDbType> z char není podporován.</span><span class="sxs-lookup"><span data-stu-id="d22bb-160">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="d22bb-161">Char</span><span class="sxs-lookup"><span data-stu-id="d22bb-161">Char</span></span>|<span data-ttu-id="d22bb-162">Char</span><span class="sxs-lookup"><span data-stu-id="d22bb-162">Char</span></span>|<span data-ttu-id="d22bb-163">Byte</span><span class="sxs-lookup"><span data-stu-id="d22bb-163">Byte</span></span>|
|<xref:System.DateTime>|<span data-ttu-id="d22bb-164">DateTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-164">DateTime</span></span>|<span data-ttu-id="d22bb-165">DateTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-165">DateTime</span></span>|<span data-ttu-id="d22bb-166">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="d22bb-166">DBTimeStamp</span></span>|<span data-ttu-id="d22bb-167">DateTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-167">DateTime</span></span>|<span data-ttu-id="d22bb-168">DateTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-168">DateTime</span></span>|
|<xref:System.DateTimeOffset>|<span data-ttu-id="d22bb-169">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="d22bb-169">DateTimeOffset</span></span>|<span data-ttu-id="d22bb-170">DateTimeOffset v systému SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d22bb-170">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="d22bb-171">Odvození <xref:System.Data.SqlDbType> z DateTimeOffset není podporován ve verzích systému SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d22bb-171">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="d22bb-172">DateTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-172">DateTime</span></span>|
|<xref:System.Decimal>|<span data-ttu-id="d22bb-173">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="d22bb-173">Decimal</span></span>|<span data-ttu-id="d22bb-174">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="d22bb-174">Decimal</span></span>|<span data-ttu-id="d22bb-175">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="d22bb-175">Decimal</span></span>|<span data-ttu-id="d22bb-176">Numeric</span><span class="sxs-lookup"><span data-stu-id="d22bb-176">Numeric</span></span>|<span data-ttu-id="d22bb-177">Číslo</span><span class="sxs-lookup"><span data-stu-id="d22bb-177">Number</span></span>|
|<xref:System.Double>|<span data-ttu-id="d22bb-178">Double</span><span class="sxs-lookup"><span data-stu-id="d22bb-178">Double</span></span>|<span data-ttu-id="d22bb-179">Float</span><span class="sxs-lookup"><span data-stu-id="d22bb-179">Float</span></span>|<span data-ttu-id="d22bb-180">Double</span><span class="sxs-lookup"><span data-stu-id="d22bb-180">Double</span></span>|<span data-ttu-id="d22bb-181">Double</span><span class="sxs-lookup"><span data-stu-id="d22bb-181">Double</span></span>|<span data-ttu-id="d22bb-182">Double</span><span class="sxs-lookup"><span data-stu-id="d22bb-182">Double</span></span>|
|<xref:System.Single>|<span data-ttu-id="d22bb-183">Single</span><span class="sxs-lookup"><span data-stu-id="d22bb-183">Single</span></span>|<span data-ttu-id="d22bb-184">Skutečné</span><span class="sxs-lookup"><span data-stu-id="d22bb-184">Real</span></span>|<span data-ttu-id="d22bb-185">Single</span><span class="sxs-lookup"><span data-stu-id="d22bb-185">Single</span></span>|<span data-ttu-id="d22bb-186">Skutečné</span><span class="sxs-lookup"><span data-stu-id="d22bb-186">Real</span></span>|<span data-ttu-id="d22bb-187">Float</span><span class="sxs-lookup"><span data-stu-id="d22bb-187">Float</span></span>|
|<xref:System.Guid>|<span data-ttu-id="d22bb-188">Guid</span><span class="sxs-lookup"><span data-stu-id="d22bb-188">Guid</span></span>|<span data-ttu-id="d22bb-189">uniqueidentifier</span><span class="sxs-lookup"><span data-stu-id="d22bb-189">UniqueIdentifier</span></span>|<span data-ttu-id="d22bb-190">Guid</span><span class="sxs-lookup"><span data-stu-id="d22bb-190">Guid</span></span>|<span data-ttu-id="d22bb-191">uniqueidentifier</span><span class="sxs-lookup"><span data-stu-id="d22bb-191">UniqueIdentifier</span></span>|<span data-ttu-id="d22bb-192">nezpracované</span><span class="sxs-lookup"><span data-stu-id="d22bb-192">Raw</span></span>|
|<xref:System.Int16>|<span data-ttu-id="d22bb-193">Int16</span><span class="sxs-lookup"><span data-stu-id="d22bb-193">Int16</span></span>|<span data-ttu-id="d22bb-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-194">SmallInt</span></span>|<span data-ttu-id="d22bb-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-195">SmallInt</span></span>|<span data-ttu-id="d22bb-196">SmallInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-196">SmallInt</span></span>|<span data-ttu-id="d22bb-197">Int16</span><span class="sxs-lookup"><span data-stu-id="d22bb-197">Int16</span></span>|
|<xref:System.Int32>|<span data-ttu-id="d22bb-198">Int32</span><span class="sxs-lookup"><span data-stu-id="d22bb-198">Int32</span></span>|<span data-ttu-id="d22bb-199">Int</span><span class="sxs-lookup"><span data-stu-id="d22bb-199">Int</span></span>|<span data-ttu-id="d22bb-200">Int</span><span class="sxs-lookup"><span data-stu-id="d22bb-200">Int</span></span>|<span data-ttu-id="d22bb-201">Int</span><span class="sxs-lookup"><span data-stu-id="d22bb-201">Int</span></span>|<span data-ttu-id="d22bb-202">Int32</span><span class="sxs-lookup"><span data-stu-id="d22bb-202">Int32</span></span>|
|<xref:System.Int64>|<span data-ttu-id="d22bb-203">Int64</span><span class="sxs-lookup"><span data-stu-id="d22bb-203">Int64</span></span>|<span data-ttu-id="d22bb-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-204">BigInt</span></span>|<span data-ttu-id="d22bb-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-205">BigInt</span></span>|<span data-ttu-id="d22bb-206">BigInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-206">BigInt</span></span>|<span data-ttu-id="d22bb-207">Číslo</span><span class="sxs-lookup"><span data-stu-id="d22bb-207">Number</span></span>|
|<xref:System.Object>|<span data-ttu-id="d22bb-208">Objekt</span><span class="sxs-lookup"><span data-stu-id="d22bb-208">Object</span></span>|<span data-ttu-id="d22bb-209">Variant</span><span class="sxs-lookup"><span data-stu-id="d22bb-209">Variant</span></span>|<span data-ttu-id="d22bb-210">Variant</span><span class="sxs-lookup"><span data-stu-id="d22bb-210">Variant</span></span>|<span data-ttu-id="d22bb-211">Odvození OdbcType: z objektu se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-211">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="d22bb-212">Objekt blob</span><span class="sxs-lookup"><span data-stu-id="d22bb-212">Blob</span></span>|
|<xref:System.String>|<span data-ttu-id="d22bb-213">String</span><span class="sxs-lookup"><span data-stu-id="d22bb-213">String</span></span>|<span data-ttu-id="d22bb-214">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="d22bb-214">NVarChar.</span></span> <span data-ttu-id="d22bb-215">Toto implicitní převod se nezdaří, pokud řetězec je větší než maximální velikost NVarChar, což je 4000 znaků.</span><span class="sxs-lookup"><span data-stu-id="d22bb-215">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="d22bb-216">Pro řetězce je větší než 4000 znaků, explicitně nastavit <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="d22bb-216">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="d22bb-217">VarWChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-217">VarWChar</span></span>|<span data-ttu-id="d22bb-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-218">NVarChar</span></span>|<span data-ttu-id="d22bb-219">NVarChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-219">NVarChar</span></span>|
|<xref:System.TimeSpan>|<span data-ttu-id="d22bb-220">Čas</span><span class="sxs-lookup"><span data-stu-id="d22bb-220">Time</span></span>|<span data-ttu-id="d22bb-221">Čas v systému SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d22bb-221">Time in SQL Server 2008.</span></span> <span data-ttu-id="d22bb-222">Odvození <xref:System.Data.SqlDbType> z TimeSpan není podporován ve verzích systému SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d22bb-222">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="d22bb-223">DBTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-223">DBTime</span></span>|<span data-ttu-id="d22bb-224">Čas</span><span class="sxs-lookup"><span data-stu-id="d22bb-224">Time</span></span>|<span data-ttu-id="d22bb-225">DateTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-225">DateTime</span></span>|
|<xref:System.UInt16>|<span data-ttu-id="d22bb-226">UInt16</span><span class="sxs-lookup"><span data-stu-id="d22bb-226">UInt16</span></span>|<span data-ttu-id="d22bb-227">Odvození <xref:System.Data.SqlDbType> z UInt16 se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-227">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="d22bb-228">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-228">UnsignedSmallInt</span></span>|<span data-ttu-id="d22bb-229">Int</span><span class="sxs-lookup"><span data-stu-id="d22bb-229">Int</span></span>|<span data-ttu-id="d22bb-230">UInt16</span><span class="sxs-lookup"><span data-stu-id="d22bb-230">UInt16</span></span>|
|<xref:System.UInt32>|<span data-ttu-id="d22bb-231">UInt32</span><span class="sxs-lookup"><span data-stu-id="d22bb-231">UInt32</span></span>|<span data-ttu-id="d22bb-232">Odvození <xref:System.Data.SqlDbType> z UInt32 se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-232">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="d22bb-233">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-233">UnsignedInt</span></span>|<span data-ttu-id="d22bb-234">BigInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-234">BigInt</span></span>|<span data-ttu-id="d22bb-235">UInt32</span><span class="sxs-lookup"><span data-stu-id="d22bb-235">UInt32</span></span>|
|<xref:System.UInt64>|<span data-ttu-id="d22bb-236">UInt64</span><span class="sxs-lookup"><span data-stu-id="d22bb-236">UInt64</span></span>|<span data-ttu-id="d22bb-237">Odvození <xref:System.Data.SqlDbType> z UInt64 se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-237">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="d22bb-238">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-238">UnsignedBigInt</span></span>|<span data-ttu-id="d22bb-239">Numeric</span><span class="sxs-lookup"><span data-stu-id="d22bb-239">Numeric</span></span>|<span data-ttu-id="d22bb-240">Číslo</span><span class="sxs-lookup"><span data-stu-id="d22bb-240">Number</span></span>|
||<span data-ttu-id="d22bb-241">AnsiString</span><span class="sxs-lookup"><span data-stu-id="d22bb-241">AnsiString</span></span>|<span data-ttu-id="d22bb-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-242">VarChar</span></span>|<span data-ttu-id="d22bb-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-243">VarChar</span></span>|<span data-ttu-id="d22bb-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-244">VarChar</span></span>|<span data-ttu-id="d22bb-245">VarChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-245">VarChar</span></span>|
||<span data-ttu-id="d22bb-246">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="d22bb-246">AnsiStringFixedLength</span></span>|<span data-ttu-id="d22bb-247">Char</span><span class="sxs-lookup"><span data-stu-id="d22bb-247">Char</span></span>|<span data-ttu-id="d22bb-248">Char</span><span class="sxs-lookup"><span data-stu-id="d22bb-248">Char</span></span>|<span data-ttu-id="d22bb-249">Char</span><span class="sxs-lookup"><span data-stu-id="d22bb-249">Char</span></span>|<span data-ttu-id="d22bb-250">Char</span><span class="sxs-lookup"><span data-stu-id="d22bb-250">Char</span></span>|
||<span data-ttu-id="d22bb-251">Měna</span><span class="sxs-lookup"><span data-stu-id="d22bb-251">Currency</span></span>|<span data-ttu-id="d22bb-252">money</span><span class="sxs-lookup"><span data-stu-id="d22bb-252">Money</span></span>|<span data-ttu-id="d22bb-253">Měna</span><span class="sxs-lookup"><span data-stu-id="d22bb-253">Currency</span></span>|<span data-ttu-id="d22bb-254">Odvození `OdbcType` z `Currency` se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-254">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="d22bb-255">Číslo</span><span class="sxs-lookup"><span data-stu-id="d22bb-255">Number</span></span>|
||<span data-ttu-id="d22bb-256">Datum</span><span class="sxs-lookup"><span data-stu-id="d22bb-256">Date</span></span>|<span data-ttu-id="d22bb-257">Datum v systému SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d22bb-257">Date in SQL Server 2008.</span></span> <span data-ttu-id="d22bb-258">Odvození <xref:System.Data.SqlDbType> od data není podporováno ve verzích systému SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d22bb-258">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="d22bb-259">DBDate</span><span class="sxs-lookup"><span data-stu-id="d22bb-259">DBDate</span></span>|<span data-ttu-id="d22bb-260">Datum</span><span class="sxs-lookup"><span data-stu-id="d22bb-260">Date</span></span>|<span data-ttu-id="d22bb-261">DateTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-261">DateTime</span></span>|
||<span data-ttu-id="d22bb-262">SByte</span><span class="sxs-lookup"><span data-stu-id="d22bb-262">SByte</span></span>|<span data-ttu-id="d22bb-263">Odvození <xref:System.Data.SqlDbType> z SByte se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-263">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="d22bb-264">TinyInt</span><span class="sxs-lookup"><span data-stu-id="d22bb-264">TinyInt</span></span>|<span data-ttu-id="d22bb-265">Odvození `OdbcType` z SByte se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-265">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="d22bb-266">SByte</span><span class="sxs-lookup"><span data-stu-id="d22bb-266">SByte</span></span>|
||<span data-ttu-id="d22bb-267">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="d22bb-267">StringFixedLength</span></span>|<span data-ttu-id="d22bb-268">nChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-268">NChar</span></span>|<span data-ttu-id="d22bb-269">WChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-269">WChar</span></span>|<span data-ttu-id="d22bb-270">nChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-270">NChar</span></span>|<span data-ttu-id="d22bb-271">nChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-271">NChar</span></span>|
||<span data-ttu-id="d22bb-272">Čas</span><span class="sxs-lookup"><span data-stu-id="d22bb-272">Time</span></span>|<span data-ttu-id="d22bb-273">Čas v systému SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d22bb-273">Time in SQL Server 2008.</span></span> <span data-ttu-id="d22bb-274">Odvození <xref:System.Data.SqlDbType> od času není podporováno ve verzích systému SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d22bb-274">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="d22bb-275">DBTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-275">DBTime</span></span>|<span data-ttu-id="d22bb-276">Čas</span><span class="sxs-lookup"><span data-stu-id="d22bb-276">Time</span></span>|<span data-ttu-id="d22bb-277">DateTime</span><span class="sxs-lookup"><span data-stu-id="d22bb-277">DateTime</span></span>|
||<span data-ttu-id="d22bb-278">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="d22bb-278">VarNumeric</span></span>|<span data-ttu-id="d22bb-279">Odvození <xref:System.Data.SqlDbType> z VarNumeric se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-279">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="d22bb-280">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="d22bb-280">VarNumeric</span></span>|<span data-ttu-id="d22bb-281">Odvození `OdbcType` z VarNumeric se nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="d22bb-281">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="d22bb-282">Číslo</span><span class="sxs-lookup"><span data-stu-id="d22bb-282">Number</span></span>|
|<span data-ttu-id="d22bb-283">uživatelem definovaný typ (objekt s <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="d22bb-283">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="d22bb-284">Objekt nebo řetězec, v závislosti poskytovatele (SqlClient vždy vrátí objekt, Odbc vždy vrátí hodnotu typu String a zprostředkovatele služeb OleDb spravovaných dat můžete zobrazit buď</span><span class="sxs-lookup"><span data-stu-id="d22bb-284">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="d22bb-285">SqlDbType.Udt Pokud <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> je k dispozici, jinak Variant</span><span class="sxs-lookup"><span data-stu-id="d22bb-285">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="d22bb-286">OleDbType.VarWChar (Pokud je hodnota null) OleDbType.Variant jinak.</span><span class="sxs-lookup"><span data-stu-id="d22bb-286">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="d22bb-287">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="d22bb-287">OdbcType.NVarChar</span></span>|<span data-ttu-id="d22bb-288">Nepodporuje se</span><span class="sxs-lookup"><span data-stu-id="d22bb-288">not supported</span></span>|

> [!NOTE]
> <span data-ttu-id="d22bb-289">Převody z desítkové na jiné typy jsou zužující převody, které zaokrouhlit desítkovou hodnotu směrem k nule na nejbližší celočíselnou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-289">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="d22bb-290">Pokud není výsledek převodu reprezentovat typem cílové <xref:System.OverflowException> je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="d22bb-290">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>

> [!NOTE]
> <span data-ttu-id="d22bb-291">Pokud je hodnota null parametru posíláte na server, je třeba zadat <xref:System.DBNull>, nikoli `null` (`Nothing` v jazyce Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="d22bb-291">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="d22bb-292">Hodnota null v systému je prázdný objekt, který nemá žádnou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-292">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="d22bb-293"><xref:System.DBNull> slouží k reprezentaci hodnoty null.</span><span class="sxs-lookup"><span data-stu-id="d22bb-293"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="d22bb-294">Další informace o databázi hodnoty Null, naleznete v tématu [zpracování hodnot Null](./sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="d22bb-294">For more information about database nulls, see [Handling Null Values](./sql/handling-null-values.md).</span></span>

## <a name="deriving-parameter-information"></a><span data-ttu-id="d22bb-295">Odvozené informace o parametrech</span><span class="sxs-lookup"><span data-stu-id="d22bb-295">Deriving parameter information</span></span>

<span data-ttu-id="d22bb-296">Parametry lze také odvodit z uložené procedury pomocí `DbCommandBuilder` třídy.</span><span class="sxs-lookup"><span data-stu-id="d22bb-296">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="d22bb-297">Jak `SqlCommandBuilder` a `OleDbCommandBuilder` třídy poskytují statické metody `DeriveParameters`, který automaticky naplní kolekci parametrů příkazový objekt, který používá informace o parametrech z uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="d22bb-297">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="d22bb-298">Všimněte si, že `DeriveParameters` přepíše všechny stávající informace o parametrech pro příkaz.</span><span class="sxs-lookup"><span data-stu-id="d22bb-298">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>

> [!NOTE]
> <span data-ttu-id="d22bb-299">Odvozené informace o parametrech způsobuje snížení výkonu, protože vyžaduje další výměnu zpráv pro zdroj dat pro načtení informací.</span><span class="sxs-lookup"><span data-stu-id="d22bb-299">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="d22bb-300">Pokud informace o parametrech je znám v době návrhu, můžete zvýšit výkon vaší aplikace tak, že nastavíte parametry explicitně.</span><span class="sxs-lookup"><span data-stu-id="d22bb-300">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>

<span data-ttu-id="d22bb-301">Další informace najdete v tématu [generování příkazů s CommandBuilders](generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="d22bb-301">For more information, see [Generating Commands with CommandBuilders](generating-commands-with-commandbuilders.md).</span></span>

## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="d22bb-302">Pomocí parametrů s SqlCommand a uložené procedury</span><span class="sxs-lookup"><span data-stu-id="d22bb-302">Using parameters with a SqlCommand and a stored procedure</span></span>

<span data-ttu-id="d22bb-303">Uložené procedury nabízí celou řadu výhod v aplikace řízené daty.</span><span class="sxs-lookup"><span data-stu-id="d22bb-303">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="d22bb-304">Pomocí uložených procedur databázových operací můžete být zapouzdřen v rámci jediného příkazu, optimalizované pro výkon a vylepšené o zvýšení zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="d22bb-304">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="d22bb-305">I když uložené procedury lze volat předáním názvu uložené procedury následuje argumenty jako příkaz jazyka SQL s použitím <xref:System.Data.Common.DbCommand.Parameters%2A> kolekce [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> objektu umožňuje více explicitně definovat uložené parametry procedury a pro přístup k výstupní parametry a návratové hodnoty.</span><span class="sxs-lookup"><span data-stu-id="d22bb-305">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>

> [!NOTE]
> <span data-ttu-id="d22bb-306">Parametrizované příkazy jsou spouštěny na serveru s použitím `sp_executesql,` tomu pro opakované použití plánu dotazu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-306">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="d22bb-307">Kurzory místní nebo v proměnné `sp_executesql` batch nejsou viditelné na službu batch, která volá `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="d22bb-307">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="d22bb-308">Poslední změny v kontextu databáze pouze na konec objektu `sp_executesql` příkazu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-308">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="d22bb-309">Další informace najdete v tématu [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d22bb-309">For more information, see [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span></span>

<span data-ttu-id="d22bb-310">Při použití s parametry <xref:System.Data.SqlClient.SqlCommand> ke spuštění systému SQL Server uložené procedury, názvy parametrů přidaných do <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> kolekce musí shodovat s názvy značek parametr v uložené proceduře.</span><span class="sxs-lookup"><span data-stu-id="d22bb-310">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="d22bb-311">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider pro SQL Server nepodporuje otazník (?) zástupný symbol pro předání parametrů do příkazu SQL nebo uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="d22bb-311">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="d22bb-312">Považuje za parametry v uložené proceduře pojmenované parametry a hledá odpovídající parametr značek.</span><span class="sxs-lookup"><span data-stu-id="d22bb-312">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="d22bb-313">Například `CustOrderHist` uloženou proceduru se definuje pomocí parametr s názvem `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="d22bb-313">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="d22bb-314">Pokud váš kód spustí uloženou proceduru, musíte taky použít parametr s názvem `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="d22bb-314">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>

```sql
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)
```

### <a name="example"></a><span data-ttu-id="d22bb-315">Příklad</span><span class="sxs-lookup"><span data-stu-id="d22bb-315">Example</span></span>

<span data-ttu-id="d22bb-316">Tento příklad ukazuje, jak se volání procedury SQL serveru, které jsou uloženy `Northwind` ukázkovou databázi.</span><span class="sxs-lookup"><span data-stu-id="d22bb-316">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="d22bb-317">Název uložené procedury je `dbo.SalesByCategory` a má vstupní parametr s názvem `@CategoryName` s datovým typem `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="d22bb-317">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="d22bb-318">Kód vytvoří novou <xref:System.Data.SqlClient.SqlConnection> uvnitř using blokovat tak, že připojení je uvolněna při ukončení procesu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-318">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="d22bb-319"><xref:System.Data.SqlClient.SqlCommand> a <xref:System.Data.SqlClient.SqlParameter> objekty jsou vytvořeny a nastavte jejich vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="d22bb-319">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="d22bb-320">A <xref:System.Data.SqlClient.SqlDataReader> provede `SqlCommand` a vrátí sadu z uložené procedury, v okně konzoly zobrazí výstup výsledků.</span><span class="sxs-lookup"><span data-stu-id="d22bb-320">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>

> [!NOTE]
> <span data-ttu-id="d22bb-321">Místo vytváření `SqlCommand` a `SqlParameter` objekty a upravením vlastnosti v samostatných příkazů, můžete místo toho se rozhodnout využít jednu z přetížených konstruktorů pro nastavení více vlastností v jediném příkazu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-321">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>

[!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
[!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]

## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="d22bb-322">Pomocí parametrů s OleDbCommand nebo OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="d22bb-322">Using parameters with an OleDbCommand or OdbcCommand</span></span>

<span data-ttu-id="d22bb-323">Při použití parametrů pomocí <xref:System.Data.OleDb.OleDbCommand> nebo <xref:System.Data.Odbc.OdbcCommand>, pořadí parametrů přidaných do `Parameters` kolekce musí odpovídat pořadí parametrů definovaných v uložené proceduře.</span><span class="sxs-lookup"><span data-stu-id="d22bb-323">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="d22bb-324">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Zprostředkovatele dat pro OLE DB a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] zprostředkovatele dat pro ODBC považovat za parametry v uložené proceduře zástupné symboly a použít hodnoty parametrů v pořadí.</span><span class="sxs-lookup"><span data-stu-id="d22bb-324">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="d22bb-325">Kromě toho vrátí parametry s hodnotou musí být první parametrů přidaných do `Parameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="d22bb-325">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>

<span data-ttu-id="d22bb-326">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Zprostředkovatele dat pro OLE DB a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] zprostředkovatele dat pro ODBC nepodporují pojmenované parametry pro předání parametrů do příkazu SQL nebo uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="d22bb-326">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="d22bb-327">V takovém případě musíte použít zástupný znak otazníku (?), jako v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="d22bb-327">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>

```sql
SELECT * FROM Customers WHERE CustomerID = ?
```

<span data-ttu-id="d22bb-328">V důsledku toho pořadí, ve kterém `Parameter` objekty jsou přidány do `Parameters` kolekce musí odpovídat přímo do polohy?</span><span class="sxs-lookup"><span data-stu-id="d22bb-328">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="d22bb-329">Zástupný symbol pro parametr.</span><span class="sxs-lookup"><span data-stu-id="d22bb-329">placeholder for the parameter.</span></span>

### <a name="oledb-example"></a><span data-ttu-id="d22bb-330">Příklad OleDb</span><span class="sxs-lookup"><span data-stu-id="d22bb-330">OleDb Example</span></span>

```vb
Dim command As OleDbCommand = New OleDbCommand( _
  "SampleProc", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OleDbParameter = command.Parameters.Add( _
  "RETURN_VALUE", OleDbType.Integer)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OleDbType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OleDbType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OleDbCommand command = new OleDbCommand("SampleProc", connection);
command.CommandType = CommandType.StoredProcedure;

OleDbParameter parameter = command.Parameters.Add(
  "RETURN_VALUE", OleDbType.Integer);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add(
  "@InputParm", OleDbType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add(
  "@OutputParm", OleDbType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="odbc-example"></a><span data-ttu-id="d22bb-331">Příklad rozhraní ODBC</span><span class="sxs-lookup"><span data-stu-id="d22bb-331">Odbc Example</span></span>

```vb
Dim command As OdbcCommand = New OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OdbcCommand command = new OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection);
command.CommandType = CommandType.StoredProcedure;

OdbcParameter parameter = command.Parameters.Add( _
  "RETURN_VALUE", OdbcType.Int);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="see-also"></a><span data-ttu-id="d22bb-332">Viz také:</span><span class="sxs-lookup"><span data-stu-id="d22bb-332">See also</span></span>

- [<span data-ttu-id="d22bb-333">Příkazy a parametry</span><span class="sxs-lookup"><span data-stu-id="d22bb-333">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="d22bb-334">Parametry adaptéru dat</span><span class="sxs-lookup"><span data-stu-id="d22bb-334">DataAdapter Parameters</span></span>](dataadapter-parameters.md)
- [<span data-ttu-id="d22bb-335">Mapování datového typu v ADO.NET</span><span class="sxs-lookup"><span data-stu-id="d22bb-335">Data Type Mappings in ADO.NET</span></span>](data-type-mappings-in-ado-net.md)
- [<span data-ttu-id="d22bb-336">Přehled ADO.NET</span><span class="sxs-lookup"><span data-stu-id="d22bb-336">ADO.NET Overview</span></span>](ado-net-overview.md)
