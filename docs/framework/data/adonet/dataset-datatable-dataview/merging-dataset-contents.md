---
title: Slučování obsahu datové sady
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: e5e9309a-3ebb-4a9c-9d78-21c4e2bafc5b
ms.openlocfilehash: e5a8040a803fbc9b098fc1b56e0f5d837c4cdb94
ms.sourcegitcommit: 2d792961ed48f235cf413d6031576373c3050918
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/31/2019
ms.locfileid: "70203359"
---
# <a name="merging-dataset-contents"></a><span data-ttu-id="1d1a7-102">Slučování obsahu datové sady</span><span class="sxs-lookup"><span data-stu-id="1d1a7-102">Merging DataSet Contents</span></span>

<span data-ttu-id="1d1a7-103">Můžete použít <xref:System.Data.DataSet.Merge%2A> metodu pro sloučení obsahu <xref:System.Data.DataSet>, <xref:System.Data.DataTable>nebo <xref:System.Data.DataRow> pole do existující `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-103">You can use the <xref:System.Data.DataSet.Merge%2A> method to merge the contents of a <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, or <xref:System.Data.DataRow> array into an existing `DataSet`.</span></span> <span data-ttu-id="1d1a7-104">Několik faktorů a možností má vliv na to, jak se nová data `DataSet`sloučí do existující.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-104">Several factors and options affect how new data is merged into an existing `DataSet`.</span></span>

## <a name="primary-keys"></a><span data-ttu-id="1d1a7-105">Primární klíče</span><span class="sxs-lookup"><span data-stu-id="1d1a7-105">Primary Keys</span></span>

<span data-ttu-id="1d1a7-106">Pokud tabulka přijímající nová data a schéma ze sloučení má primární klíč, budou nové řádky z příchozích dat spárovány se stávajícími řádky, které mají stejné <xref:System.Data.DataRowVersion.Original> hodnoty primárního klíče jako v příchozích datech.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-106">If the table receiving new data and schema from a merge has a primary key, new rows from the incoming data are matched with existing rows that have the same <xref:System.Data.DataRowVersion.Original> primary key values as those in the incoming data.</span></span> <span data-ttu-id="1d1a7-107">Pokud se sloupce z příchozího schématu shodují s hodnotami stávajícího schématu, data ve stávajících řádcích se upraví.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-107">If the columns from the incoming schema match those of the existing schema, the data in the existing rows is modified.</span></span> <span data-ttu-id="1d1a7-108">Sloupce, které neodpovídají existujícímu schématu, se buď ignorují, nebo přidají na základě <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> parametru.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-108">Columns that do not match the existing schema are either ignored or added based on the <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> parameter.</span></span> <span data-ttu-id="1d1a7-109">Nové řádky s hodnotami primárního klíče, které se neshodují s žádnými existujícími řádky, se připojí k existující tabulce.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-109">New rows with primary key values that do not match any existing rows are appended to the existing table.</span></span>

<span data-ttu-id="1d1a7-110">Pokud příchozí nebo existující řádky mají <xref:System.Data.DataRowState.Added>stav řádku, jsou jejich primární hodnoty porovnány <xref:System.Data.DataRowVersion.Current> pomocí hodnoty `Added` primárního klíče řádku, protože neexistuje žádná `Original` verze řádku.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-110">If incoming or existing rows have a row state of <xref:System.Data.DataRowState.Added>, their primary key values are matched using the <xref:System.Data.DataRowVersion.Current> primary key value of the `Added` row because no `Original` row version exists.</span></span>

<span data-ttu-id="1d1a7-111">Pokud příchozí tabulka a stávající tabulka obsahují sloupec se stejným názvem, ale s různými datovými typy, je vyvolána výjimka a <xref:System.Data.DataSet.MergeFailed> událost `DataSet` je vyvolána.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-111">If an incoming table and an existing table contain a column with the same name but different data types, an exception is thrown and the <xref:System.Data.DataSet.MergeFailed> event of the `DataSet` is raised.</span></span> <span data-ttu-id="1d1a7-112">Pokud má v příchozí tabulce a existující tabulce definované klíče, ale primární klíče jsou pro různé sloupce, je vyvolána výjimka a `MergeFailed` událost `DataSet` je vyvolána.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-112">If an incoming table and an existing table both have defined keys, but the primary keys are for different columns, an exception is thrown and the `MergeFailed` event of the `DataSet` is raised.</span></span>

<span data-ttu-id="1d1a7-113">Pokud tabulka přijímající nová data ze sloučení nemá primární klíč, nové řádky z příchozích dat nelze spárovat s existujícími řádky v tabulce a jsou místo toho připojeny k existující tabulce.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-113">If the table receiving new data from a merge does not have a primary key, new rows from the incoming data cannot be matched to existing rows in the table and are instead appended to the existing table.</span></span>

## <a name="table-names-and-namespaces"></a><span data-ttu-id="1d1a7-114">Názvy tabulek a obory názvů</span><span class="sxs-lookup"><span data-stu-id="1d1a7-114">Table Names and Namespaces</span></span>

<span data-ttu-id="1d1a7-115"><xref:System.Data.DataTable>objektům lze volitelně přiřadit <xref:System.Data.DataTable.Namespace%2A> hodnotu vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-115"><xref:System.Data.DataTable> objects can optionally be assigned a <xref:System.Data.DataTable.Namespace%2A> property value.</span></span> <span data-ttu-id="1d1a7-116">Při <xref:System.Data.DataTable.Namespace%2A> přiřazení <xref:System.Data.DataTable> <xref:System.Data.DataTable.TableName%2A> hodnot může obsahovat více objektů se stejnou hodnotou. <xref:System.Data.DataSet></span><span class="sxs-lookup"><span data-stu-id="1d1a7-116">When <xref:System.Data.DataTable.Namespace%2A> values are assigned, a <xref:System.Data.DataSet> can contain multiple <xref:System.Data.DataTable> objects with the same <xref:System.Data.DataTable.TableName%2A> value.</span></span> <span data-ttu-id="1d1a7-117">Během slučovacích operací <xref:System.Data.DataTable.TableName%2A> a <xref:System.Data.DataTable.Namespace%2A> slouží k identifikaci cíle sloučení.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-117">During merge operations, both <xref:System.Data.DataTable.TableName%2A> and <xref:System.Data.DataTable.Namespace%2A> are used to identify the target of a merge.</span></span> <span data-ttu-id="1d1a7-118">Pokud není přiřazeno, použije se k <xref:System.Data.DataTable.TableName%2A> identifikaci cíle sloučení jenom. <xref:System.Data.DataTable.Namespace%2A></span><span class="sxs-lookup"><span data-stu-id="1d1a7-118">If no <xref:System.Data.DataTable.Namespace%2A> has been assigned, only the <xref:System.Data.DataTable.TableName%2A> is used to identify the target of a merge.</span></span>

> [!NOTE]
> <span data-ttu-id="1d1a7-119">Toto chování se změnilo ve verzi 2,0 .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-119">This behavior changed in version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="1d1a7-120">Ve verzi 1,1 byly podporovány obory názvů, ale byly ignorovány během slučovacích operací.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-120">In version 1.1, namespaces were supported but were ignored during merge operations.</span></span> <span data-ttu-id="1d1a7-121">Z <xref:System.Data.DataSet> tohoto důvodu bude mít použití <xref:System.Data.DataTable.Namespace%2A> hodnot vlastností různé chování v závislosti na tom, kterou verzi .NET Framework používáte.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-121">For this reason, a <xref:System.Data.DataSet> that uses <xref:System.Data.DataTable.Namespace%2A> property values will have different behaviors depending on which version of the .NET Framework you are running.</span></span> <span data-ttu-id="1d1a7-122">Předpokládejme například, že máte `DataSets` dvě obsahující `DataTables` stejné <xref:System.Data.DataTable.TableName%2A> hodnoty vlastností, ale jiné <xref:System.Data.DataTable.Namespace%2A> hodnoty vlastností.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-122">For example, suppose you have two `DataSets` containing `DataTables` with the same <xref:System.Data.DataTable.TableName%2A> property values but different <xref:System.Data.DataTable.Namespace%2A> property values.</span></span> <span data-ttu-id="1d1a7-123">Ve verzi 1,1 .NET Framework budou při slučování těchto dvou <xref:System.Data.DataTable.Namespace%2A> <xref:System.Data.DataSet> objektů ignorovány různé názvy.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-123">In version 1.1 of the .NET Framework, the different <xref:System.Data.DataTable.Namespace%2A> names will be ignored when merging the two <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="1d1a7-124">Počínaje verzí 2,0 ale sloučení způsobí, že se v cíli `DataTables` <xref:System.Data.DataSet>vytvoří dva nové.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-124">However, starting with version 2.0, merging causes two new `DataTables` to be created in the target <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="1d1a7-125">Původní `DataTables` akce sloučení nebude ovlivněna.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-125">The original `DataTables` will be unaffected by the merge.</span></span>

## <a name="preservechanges"></a><span data-ttu-id="1d1a7-126">PreserveChanges</span><span class="sxs-lookup"><span data-stu-id="1d1a7-126">PreserveChanges</span></span>

<span data-ttu-id="1d1a7-127">Pokud předáte `DataSet`do `DataTable` metodypole`Merge` , `DataRow` nebo, můžete zahrnout volitelné parametry, které určují, zda se mají zachovat změny v existujících `DataSet`a jak zpracovat nové prvky schématu, které byly nalezeny v příchozích datech.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-127">When you pass a `DataSet`, `DataTable`, or `DataRow` array to the `Merge` method, you can include optional parameters that specify whether or not to preserve changes in the existing `DataSet`, and how to handle new schema elements found in the incoming data.</span></span> <span data-ttu-id="1d1a7-128">První z těchto parametrů po příchozích datech je logický příznak, <xref:System.Data.LoadOption.PreserveChanges>který určuje, jestli se mají změny v existujícím `DataSet`případě zachovat.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-128">The first of these parameters after the incoming data is a Boolean flag, <xref:System.Data.LoadOption.PreserveChanges>, which specifies whether or not to preserve the changes in the existing `DataSet`.</span></span> <span data-ttu-id="1d1a7-129">Pokud je `true`příznak nastaven na hodnotu, příchozí hodnoty `Current` nepřepisují existující hodnoty v existujícím řádku ve verzi. `PreserveChanges`</span><span class="sxs-lookup"><span data-stu-id="1d1a7-129">If the `PreserveChanges` flag is set to `true`, incoming values do not overwrite existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="1d1a7-130">Pokud je `false`příznak nastaven na hodnotu, příchozí hodnoty přepíší existující hodnoty v existujícím `Current` řádku ve verzi. `PreserveChanges`</span><span class="sxs-lookup"><span data-stu-id="1d1a7-130">If the `PreserveChanges` flag is set to `false`, incoming values do overwrite the existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="1d1a7-131">Pokud příznak není zadán, je `false` nastaven jako výchozí. `PreserveChanges`</span><span class="sxs-lookup"><span data-stu-id="1d1a7-131">If the `PreserveChanges` flag is not specified, it is set to `false` by default.</span></span> <span data-ttu-id="1d1a7-132">Další informace o verzích řádků najdete v tématu [stavy řádků a verze řádků](row-states-and-row-versions.md).</span><span class="sxs-lookup"><span data-stu-id="1d1a7-132">For more information about row versions, see [Row States and Row Versions](row-states-and-row-versions.md).</span></span>

<span data-ttu-id="1d1a7-133">`PreserveChanges` <xref:System.Data.DataRowVersion.Current> <xref:System.Data.DataRowVersion.Original> `Original` V takovém případě jsou data z existujícího řádku udržována ve verzi řádku stávajícího řádku, zatímco data z verze stávajícího řádku jsou přepsána daty z řádku `true` verze příchozího řádku</span><span class="sxs-lookup"><span data-stu-id="1d1a7-133">When `PreserveChanges` is `true`, the data from the existing row is maintained in the <xref:System.Data.DataRowVersion.Current> row version of the existing row, while the data from the <xref:System.Data.DataRowVersion.Original> row version of the existing row is overwritten with the data from the `Original` row version of the incoming row.</span></span> <span data-ttu-id="1d1a7-134">Existující řádek je nastaven na <xref:System.Data.DataRowState.Modified>hodnotu. <xref:System.Data.DataRow.RowState%2A></span><span class="sxs-lookup"><span data-stu-id="1d1a7-134">The <xref:System.Data.DataRow.RowState%2A> of the existing row is set to <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="1d1a7-135">Platí následující výjimky:</span><span class="sxs-lookup"><span data-stu-id="1d1a7-135">The following exceptions apply:</span></span>

- <span data-ttu-id="1d1a7-136">Pokud existující `RowState` řádek má `Deleted`, `RowState` `Modified`zůstává `Deleted` a není nastaven na.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-136">If the existing row has a `RowState` of `Deleted`, this `RowState` remains `Deleted` and is not set to `Modified`.</span></span> <span data-ttu-id="1d1a7-137">V takovém případě se data z příchozího řádku budou `Original` ukládat i ve verzi řádku existujícího řádku, `Original` která přepíše verzi stávajícího řádku (Pokud `Added`vstupní řádek neobsahuje `RowState` ).</span><span class="sxs-lookup"><span data-stu-id="1d1a7-137">In this case, the data from the incoming row will still be stored in the `Original` row version of the existing row, overwriting the `Original` row version of the existing row (unless the incoming row has a `RowState` of `Added`).</span></span>

- <span data-ttu-id="1d1a7-138">Pokud `RowState` má vstupní řádek hodnotu `Added` `Original` , data z verze stávajícího řádku nebudou přepsána daty z příchozího řádku, `Original` protože příchozí řádek neobsahuje verzi řádku.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-138">If the incoming row has a `RowState` of `Added`, the data from the `Original` row version of the existing row will not be overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>

<span data-ttu-id="1d1a7-139">`PreserveChanges` `RowState` V případě `RowState` , verze řádku a`Original`ve stávajícím řádku jsou přepsány daty z příchozího řádku a stávající řádek je nastaven na vstupní řádek. `Current` `false`</span><span class="sxs-lookup"><span data-stu-id="1d1a7-139">When `PreserveChanges` is `false`, both the `Current` and `Original` row versions in the existing row are overwritten with the data from the incoming row, and the `RowState` of the existing row is set to the `RowState` of the incoming row.</span></span> <span data-ttu-id="1d1a7-140">Platí následující výjimky:</span><span class="sxs-lookup"><span data-stu-id="1d1a7-140">The following exceptions apply:</span></span>

- <span data-ttu-id="1d1a7-141">Pokud `RowState` má vstupní řádek `Unchanged` a a `Deleted` `Added` `Modified`stávající řádek má `RowState` , nebo ,`RowState` je existující řádek nastaven na hodnotu. `Modified`</span><span class="sxs-lookup"><span data-stu-id="1d1a7-141">If the incoming row has a `RowState` of `Unchanged` and the existing row has a `RowState` of `Modified`, `Deleted`, or `Added`, the `RowState` of the existing row is set to `Modified`.</span></span>

- <span data-ttu-id="1d1a7-142">`RowState` Pokud má `Modified` `RowState` `RowState` `Modified`vstupní řádek a a `Deleted`stávající řádek má ,,nebo,jeexistujícířádeknastavennahodnotu.`Unchanged` `Added`</span><span class="sxs-lookup"><span data-stu-id="1d1a7-142">If the incoming row has a `RowState` of `Added`, and the existing row has a `RowState` of `Unchanged`, `Modified`, or `Deleted`, the `RowState` of the existing row is set to `Modified`.</span></span> <span data-ttu-id="1d1a7-143">Také data z `Original` verze stávajícího řádku nejsou přepsána daty z příchozího řádku, protože příchozí řádek `Original` neobsahuje verzi řádku.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-143">Also, the data from the `Original` row version of the existing row is not overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>

## <a name="missingschemaaction"></a><span data-ttu-id="1d1a7-144">MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="1d1a7-144">MissingSchemaAction</span></span>

<span data-ttu-id="1d1a7-145">Můžete použít volitelný <xref:System.Data.MissingSchemaAction> parametr `Merge` metody k určení, jak `Merge` bude zpracovávat prvky schématu v příchozích datech, které nejsou součástí existující `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-145">You can use the optional <xref:System.Data.MissingSchemaAction> parameter of the `Merge` method to specify how `Merge` will handle schema elements in the incoming data that are not part of the existing `DataSet`.</span></span>

<span data-ttu-id="1d1a7-146">Následující tabulka popisuje možnosti pro `MissingSchemaAction`.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-146">The following table describes the options for `MissingSchemaAction`.</span></span>

|<span data-ttu-id="1d1a7-147">MissingSchemaAction – možnost</span><span class="sxs-lookup"><span data-stu-id="1d1a7-147">MissingSchemaAction option</span></span>|<span data-ttu-id="1d1a7-148">Popis</span><span class="sxs-lookup"><span data-stu-id="1d1a7-148">Description</span></span>|
|--------------------------------|-----------------|
|<xref:System.Data.MissingSchemaAction.Add>|<span data-ttu-id="1d1a7-149">Přidejte nové informace o schématu do `DataSet` a naplňte nové sloupce vstupními hodnotami.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-149">Add the new schema information to the `DataSet` and populate the new columns with the incoming values.</span></span> <span data-ttu-id="1d1a7-150">Toto nastavení je výchozí.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-150">This is the default.</span></span>|
|<xref:System.Data.MissingSchemaAction.AddWithKey>|<span data-ttu-id="1d1a7-151">Přidejte informace o novém schématu a primárním klíči do `DataSet` a naplňte nové sloupce vstupními hodnotami.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-151">Add the new schema and primary key information to the `DataSet` and populate the new columns with the incoming values.</span></span>|
|<xref:System.Data.MissingSchemaAction.Error>|<span data-ttu-id="1d1a7-152">Vyvolejte výjimku, pokud se zjistily neshodné informace o schématu.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-152">Throw an exception if mismatched schema information is encountered.</span></span>|
|<xref:System.Data.MissingSchemaAction.Ignore>|<span data-ttu-id="1d1a7-153">Ignorujte nové informace o schématu.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-153">Ignore the new schema information.</span></span>|

## <a name="constraints"></a><span data-ttu-id="1d1a7-154">Omezení</span><span class="sxs-lookup"><span data-stu-id="1d1a7-154">Constraints</span></span>

<span data-ttu-id="1d1a7-155">U metody nejsou kontrolována omezení, dokud nebudou do stávajících `DataSet`dat přidána všechna nová data. `Merge`</span><span class="sxs-lookup"><span data-stu-id="1d1a7-155">With the `Merge` method, constraints are not checked until all new data has been added to the existing `DataSet`.</span></span> <span data-ttu-id="1d1a7-156">Po přidání dat jsou omezení uplatněna na aktuální hodnoty v `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-156">Once the data has been added, constraints are enforced on the current values in the `DataSet`.</span></span> <span data-ttu-id="1d1a7-157">Je nutné zajistit, že váš kód zpracovává všechny výjimky, které mohou být vyvolány z důvodu porušení omezení.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-157">You must ensure that your code handles any exceptions that might be thrown due to constraint violations.</span></span>

<span data-ttu-id="1d1a7-158">Vezměte v úvahu případ, kdy existující řádek v `DataSet` `Unchanged` je řádek s hodnotou primárního klíče 1.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-158">Consider a case where an existing row in a `DataSet` is an `Unchanged` row with a primary key value of 1.</span></span> <span data-ttu-id="1d1a7-159">Během `Modified` operace sloučení se vstupním řádkem `Original` s `Current` hodnotou primárního klíče na hodnotě 2 a hodnotou primárního klíče 1 se existující řádek a `Original` vstupní řádek nepovažují za shodu, protože hodnoty primárního klíče jednotlivých.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-159">During a merge operation with a `Modified` incoming row with an `Original` primary key value of 2 and a `Current` primary key value of 1, the existing row and the incoming row are not considered matching because the `Original` primary key values differ.</span></span> <span data-ttu-id="1d1a7-160">Když je však dokončeno sloučení a jsou kontrolována omezení, bude vyvolána výjimka, protože `Current` hodnoty primárního klíče narušují omezení UNIQUE pro sloupec primárního klíče.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-160">However, when the merge is completed and constraints are checked, an exception will be thrown because the `Current` primary key values violate the unique constraint for the primary key column.</span></span>

> [!NOTE]
> <span data-ttu-id="1d1a7-161">Když jsou řádky vloženy do tabulky databáze obsahující automatické zvyšování sloupce, jako je například sloupec identity, hodnota sloupce identity vrácená vložením nesmí odpovídat hodnotě v `DataSet`objektu, což způsobí, že vracené řádky budou namísto sloučení sloučeny.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-161">When rows are inserted into a database table containing an auto incrementing column such as an identity column, the identity column value returned by the insert may not match the value in the `DataSet`, causing the returned rows to be appended instead of merged.</span></span> <span data-ttu-id="1d1a7-162">Další informace najdete v tématu [načtení hodnot identity nebo hodnot typu AutoNumber](../retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="1d1a7-162">For more information, see [Retrieving Identity or Autonumber Values](../retrieving-identity-or-autonumber-values.md).</span></span>

<span data-ttu-id="1d1a7-163">Následující příklad kódu sloučí dva `DataSet` objekty s různými schématy do jednoho `DataSet` s kombinovanými schématy dvou příchozích `DataSet` objektů.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-163">The following code example merges two `DataSet` objects with different schemas into one `DataSet` with the combined schemas of the two incoming `DataSet` objects.</span></span>

[!code-csharp[DataWorks DataSet.Merge#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/CS/source.cs#1)]
[!code-vb[DataWorks DataSet.Merge#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/VB/source.vb#1)]

<span data-ttu-id="1d1a7-164">Následující příklad kódu používá existující `DataSet` s aktualizacemi a předá tyto aktualizace `DataAdapter` ke zpracování ve zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-164">The following code example takes an existing `DataSet` with updates and passes those updates to a `DataAdapter` to be processed at the data source.</span></span> <span data-ttu-id="1d1a7-165">Výsledky se pak sloučí do původní `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-165">The results are then merged into the original `DataSet`.</span></span> <span data-ttu-id="1d1a7-166">Po zamítnutí změn, které vedly k chybě, se sloučené změny potvrdí pomocí `AcceptChanges`.</span><span class="sxs-lookup"><span data-stu-id="1d1a7-166">After rejecting changes that resulted in an error, the merged changes are committed with `AcceptChanges`.</span></span>

[!code-csharp[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#1)]
[!code-vb[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#1)]

[!code-csharp[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#2)]
[!code-vb[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#2)]

## <a name="see-also"></a><span data-ttu-id="1d1a7-167">Viz také:</span><span class="sxs-lookup"><span data-stu-id="1d1a7-167">See also</span></span>

- [<span data-ttu-id="1d1a7-168">Datové sady, datové tabulky a datová zobrazení</span><span class="sxs-lookup"><span data-stu-id="1d1a7-168">DataSets, DataTables, and DataViews</span></span>](index.md)
- [<span data-ttu-id="1d1a7-169">Stavy řádků a verze řádků</span><span class="sxs-lookup"><span data-stu-id="1d1a7-169">Row States and Row Versions</span></span>](row-states-and-row-versions.md)
- [<span data-ttu-id="1d1a7-170">Adaptéry a čtečky dat</span><span class="sxs-lookup"><span data-stu-id="1d1a7-170">DataAdapters and DataReaders</span></span>](../dataadapters-and-datareaders.md)
- [<span data-ttu-id="1d1a7-171">Načítání a úpravy dat v ADO.NET</span><span class="sxs-lookup"><span data-stu-id="1d1a7-171">Retrieving and Modifying Data in ADO.NET</span></span>](../retrieving-and-modifying-data.md)
- [<span data-ttu-id="1d1a7-172">Načítání hodnot identity nebo automatického číslování</span><span class="sxs-lookup"><span data-stu-id="1d1a7-172">Retrieving Identity or Autonumber Values</span></span>](../retrieving-identity-or-autonumber-values.md)
- [<span data-ttu-id="1d1a7-173">ADO.NET spravované zprostředkovatele a sady dat – středisko pro vývojáře</span><span class="sxs-lookup"><span data-stu-id="1d1a7-173">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
