---
title: Dotazy na jednu tabulku (LINQ to DataSet)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212
ms.openlocfilehash: 87a2f6853136b4b3e622968327bde01c9862bfdf
ms.sourcegitcommit: b1cfd260928d464d91e20121f9bdba7611c94d71
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/02/2019
ms.locfileid: "67504628"
---
# <a name="single-table-queries-linq-to-dataset"></a><span data-ttu-id="bdc5c-102">Dotazy na jednu tabulku (LINQ to DataSet)</span><span class="sxs-lookup"><span data-stu-id="bdc5c-102">Single-Table Queries (LINQ to DataSet)</span></span>
[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] <span data-ttu-id="bdc5c-103">dotazy fungují u zdrojů dat, které implementují <xref:System.Collections.Generic.IEnumerable%601> rozhraní nebo <xref:System.Linq.IQueryable%601> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-103">queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="bdc5c-104"><xref:System.Data.DataTable> Třída neimplementuje buď rozhraní, takže je třeba zavolat <xref:System.Data.DataTableExtensions.AsEnumerable%2A> metodu, pokud chcete použít <xref:System.Data.DataTable> jako zdroj v `From` klauzuli [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] dotazu.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-104">The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] query.</span></span>  
  
 <span data-ttu-id="bdc5c-105">Následující příklad získá online objednávky z tabulky SalesOrderHeader a vypíše ID objednávky, data objednávky a pořadové číslo do konzoly.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-105">The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]  
 [!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)] 
  
 <span data-ttu-id="bdc5c-106">Místní proměnná dotazu je inicializován pomocí výrazu dotazu, které působí na jeden nebo více zdrojů informace s použitím jednoho nebo více operátorů dotazu, buď z operátory standardního dotazu, nebo v případě LINQ k datové sadě, operátory, které jsou specifické pro <xref:System.Data.DataSet>třídy.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-106">The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of LINQ to DataSet, operators specific to the <xref:System.Data.DataSet> class.</span></span> <span data-ttu-id="bdc5c-107">Výraz dotazu v předchozím příkladu používá dva operátory standardního dotazu: `Where` a `Select`.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-107">The query expression in the previous example uses two of the standard query operators: `Where` and `Select`.</span></span>  
  
 <span data-ttu-id="bdc5c-108">`Where` Klauzule filtry pořadí na základě podmínky, v tomto případě, že `OnlineOrderFlag` je nastavena na `true`.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-108">The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`.</span></span> <span data-ttu-id="bdc5c-109">`Select` Operátor přiděluje a vrací vyčíslitelný objekt, který zachycuje argumentů předaný operátoru.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-109">The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator.</span></span> <span data-ttu-id="bdc5c-110">V tomto nad příkladu se vytvoří anonymního typu s tři vlastnosti: `SalesOrderID`, `OrderDate`, a `SalesOrderNumber`.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-110">In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`.</span></span> <span data-ttu-id="bdc5c-111">Hodnoty tyto tři vlastnosti jsou nastaveny na hodnoty `SalesOrderID`, `OrderDate`, a `SalesOrderNumber` sloupce z `SalesOrderHeader` tabulky.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-111">The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table.</span></span>  
  
 <span data-ttu-id="bdc5c-112">`foreach` Smyčky pak vytvoří výčet vyčíslitelný objekt vrácený rutinou `Select` a vrací výsledky dotazu.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-112">The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results.</span></span> <span data-ttu-id="bdc5c-113">Vzhledem k tomu, že dotaz je <xref:System.Linq.Enumerable> zadejte, která implementuje <xref:System.Collections.Generic.IEnumerable%601>, vyhodnocení dotazu je odloženo, dokud není procházen proměnné dotazu pomocí `foreach` smyčky.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-113">Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop.</span></span> <span data-ttu-id="bdc5c-114">Odložený dotaz hodnocení umožňuje vytvářet dotazy průběžně podle hodnoty, které mohou být vyhodnoceny několikrát, pokaždé, když získávání potenciálně odlišné výsledky.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-114">Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.</span></span>  
  
 <span data-ttu-id="bdc5c-115"><xref:System.Data.DataRowExtensions.Field%2A> Metoda poskytuje přístup k hodnoty sloupce <xref:System.Data.DataRow> a <xref:System.Data.DataRowExtensions.SetField%2A> (není vidět v předchozím příkladu) nastaví hodnoty ve sloupcích v <xref:System.Data.DataRow>.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-115">The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="bdc5c-116">Oba <xref:System.Data.DataRowExtensions.Field%2A> metoda a <xref:System.Data.DataRowExtensions.SetField%2A> metoda zpracování typy připouštějící hodnotu Null, takže není potřeba explicitně kontrola hodnot null.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-116">Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable types, so you do not have to explicitly check for null values.</span></span> <span data-ttu-id="bdc5c-117">Obě metody jsou obecné metody, také, což znamená, že není nutné přetypovat návratový typ.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-117">Both methods are generic methods, also, which means you do not have to cast the return type.</span></span> <span data-ttu-id="bdc5c-118">Můžete použít už existující přistupující objekt sloupce v <xref:System.Data.DataRow> (například `o["OrderDate"]`), ale to uděláte tak by vyžadovalo přetypovat vrácený objekt do příslušného typu.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-118">You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o["OrderDate"]`), but doing so would require you to cast the return object to the appropriate type.</span></span>  <span data-ttu-id="bdc5c-119">Pokud je sloupec s možnou hodnotou Null, budete muset zkontrolovat, zda je hodnota null pomocí <xref:System.Data.DataRow.IsNull%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-119">If the column is nullable you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method.</span></span> <span data-ttu-id="bdc5c-120">Další informace najdete v tématu [obecné pole a metody SetField](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md).</span><span class="sxs-lookup"><span data-stu-id="bdc5c-120">For more information, see [Generic Field and SetField Methods](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="bdc5c-121">Všimněte si, že datový typ zadaný v parametru obecného `T` z <xref:System.Data.DataRowExtensions.Field%2A> metoda a <xref:System.Data.DataRowExtensions.SetField%2A> metoda musí odpovídat typu základní hodnotu nebo <xref:System.InvalidCastException> bude vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-121">Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown.</span></span> <span data-ttu-id="bdc5c-122">Zadaný název sloupce musí taky shodovat s názvem sloupce v <xref:System.Data.DataSet> nebo <xref:System.ArgumentException> bude vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-122">The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown.</span></span> <span data-ttu-id="bdc5c-123">V obou případech je vyvolána výjimka za běhu výčet dat při spuštění dotazu.</span><span class="sxs-lookup"><span data-stu-id="bdc5c-123">In both cases, the exception is thrown at run time data enumeration when the query is executed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bdc5c-124">Viz také:</span><span class="sxs-lookup"><span data-stu-id="bdc5c-124">See also</span></span>

- [<span data-ttu-id="bdc5c-125">Dotazy na křížovou tabulku</span><span class="sxs-lookup"><span data-stu-id="bdc5c-125">Cross-Table Queries</span></span>](../../../../docs/framework/data/adonet/cross-table-queries-linq-to-dataset.md)
- [<span data-ttu-id="bdc5c-126">Dotazy na typové datové sady</span><span class="sxs-lookup"><span data-stu-id="bdc5c-126">Querying Typed DataSets</span></span>](../../../../docs/framework/data/adonet/querying-typed-datasets.md)
- [<span data-ttu-id="bdc5c-127">Obecné pole a metody SetField</span><span class="sxs-lookup"><span data-stu-id="bdc5c-127">Generic Field and SetField Methods</span></span>](../../../../docs/framework/data/adonet/generic-field-and-setfield-methods-linq-to-dataset.md)
