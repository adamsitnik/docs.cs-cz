---
title: 'Postupy: Store a opakované použití dotazů'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: a913839ab8e6048b18270061a75ca632e2797fb8
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/23/2019
ms.locfileid: "54630763"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="cf216-102">Postupy: Store a opakované použití dotazů</span><span class="sxs-lookup"><span data-stu-id="cf216-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="cf216-103">Až budete mít aplikaci, která se spustí v mnoha případech strukturálně podobné dotazy, můžete často zvýšit výkon kompilaci dotazu jednou a spustíte ji několikrát s různými parametry.</span><span class="sxs-lookup"><span data-stu-id="cf216-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="cf216-104">Například aplikace může mít k načtení všech zákazníků, kteří jsou v konkrétní Město, ve kterém Město je uživatel zadá za běhu ve formuláři.</span><span class="sxs-lookup"><span data-stu-id="cf216-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="cf216-105">podporuje použití *kompilaci dotazů* pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="cf216-105">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="cf216-106">Tento vzor využití představuje nejběžnějším využitím kompilované dotazy.</span><span class="sxs-lookup"><span data-stu-id="cf216-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="cf216-107">Další postupy jsou možné.</span><span class="sxs-lookup"><span data-stu-id="cf216-107">Other approaches are possible.</span></span> <span data-ttu-id="cf216-108">Například kompilované dotazy mohou být uloženy jako statické členy na částečné třídy, která rozšiřuje kód generovaný návrhářem.</span><span class="sxs-lookup"><span data-stu-id="cf216-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="cf216-109">Příklad</span><span class="sxs-lookup"><span data-stu-id="cf216-109">Example</span></span>  
 <span data-ttu-id="cf216-110">V mnoha případech můžete chtít znovu použít dotazy napříč hranicemi vlákna.</span><span class="sxs-lookup"><span data-stu-id="cf216-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="cf216-111">V takovém případě je zvláště efektivní ukládání kompilované dotazy ve statické proměnné.</span><span class="sxs-lookup"><span data-stu-id="cf216-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="cf216-112">Následující příklad kódu předpokládá `Queries` třída určená k ukládání zkompilován dotazy a předpokládá Northwind třídu, která představuje silného typu <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="cf216-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="cf216-113">Příklad</span><span class="sxs-lookup"><span data-stu-id="cf216-113">Example</span></span>  
 <span data-ttu-id="cf216-114">Nemůžete momentálně úložiště (v statické proměnné) dotazy, které vracejí *anonymního typu*, protože typ nemá žádný název poskytnout jako obecný argument.</span><span class="sxs-lookup"><span data-stu-id="cf216-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="cf216-115">Následující příklad ukazuje, jak můžete tento problém obejít tím, že vytvoříte typ, který představuje výsledek a pak použít jako obecný argument.</span><span class="sxs-lookup"><span data-stu-id="cf216-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="cf216-116">Viz také:</span><span class="sxs-lookup"><span data-stu-id="cf216-116">See also</span></span>
- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="cf216-117">Koncepty dotazů</span><span class="sxs-lookup"><span data-stu-id="cf216-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)
- [<span data-ttu-id="cf216-118">Dotazování na databázi</span><span class="sxs-lookup"><span data-stu-id="cf216-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
