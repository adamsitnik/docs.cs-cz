---
title: 'Postupy: Uložení a opakované použití dotazů'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: f8400b214bc9ba3a28eeec05f6171953b42bc6f5
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/22/2019
ms.locfileid: "69938748"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="1b68c-102">Postupy: Uložení a opakované použití dotazů</span><span class="sxs-lookup"><span data-stu-id="1b68c-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="1b68c-103">V případě, že máte aplikaci, která spouští strukturální podobné dotazy mnohokrát, můžete často zvýšit výkon kompilováním dotazu jednou a jeho spuštěním několikrát s různými parametry.</span><span class="sxs-lookup"><span data-stu-id="1b68c-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="1b68c-104">Aplikace může například potřebovat načíst všechny zákazníky, kteří jsou v určitém městě, kde město je určeno za běhu uživatelem ve formuláři.</span><span class="sxs-lookup"><span data-stu-id="1b68c-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="1b68c-105">podporuje použití zkompilovaných *dotazů* pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="1b68c-105">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1b68c-106">Tento vzor použití představuje nejběžnější použití kompilovaných dotazů.</span><span class="sxs-lookup"><span data-stu-id="1b68c-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="1b68c-107">Další přístupy jsou možné.</span><span class="sxs-lookup"><span data-stu-id="1b68c-107">Other approaches are possible.</span></span> <span data-ttu-id="1b68c-108">Například zkompilované dotazy mohou být uloženy jako statické členy v částečné třídě, která rozšiřuje kód generovaný návrhářem.</span><span class="sxs-lookup"><span data-stu-id="1b68c-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="1b68c-109">Příklad</span><span class="sxs-lookup"><span data-stu-id="1b68c-109">Example</span></span>  
 <span data-ttu-id="1b68c-110">V mnoha scénářích možná budete chtít znovu použít dotazy napříč hranicemi vlákna.</span><span class="sxs-lookup"><span data-stu-id="1b68c-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="1b68c-111">V takových případech je ukládání kompilovaných dotazů do statických proměnných obzvláště efektivní.</span><span class="sxs-lookup"><span data-stu-id="1b68c-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="1b68c-112">Následující příklad kódu předpokládá `Queries` třídu navrženou pro ukládání kompilovaných dotazů a předpokládá třídu Northwind, která představuje silného typu. <xref:System.Data.Linq.DataContext></span><span class="sxs-lookup"><span data-stu-id="1b68c-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="1b68c-113">Příklad</span><span class="sxs-lookup"><span data-stu-id="1b68c-113">Example</span></span>  
 <span data-ttu-id="1b68c-114">Aktuálně nemůžete ukládat (v statických proměnných) dotazy, které vracejí *anonymní typ*, protože typ nemá žádný název, který by měl poskytnout jako obecný argument.</span><span class="sxs-lookup"><span data-stu-id="1b68c-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="1b68c-115">Následující příklad ukazuje, jak lze problém obejít vytvořením typu, který může představovat výsledek, a poté jej použít jako obecný argument.</span><span class="sxs-lookup"><span data-stu-id="1b68c-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="1b68c-116">Viz také:</span><span class="sxs-lookup"><span data-stu-id="1b68c-116">See also</span></span>

- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="1b68c-117">Koncepty dotazů</span><span class="sxs-lookup"><span data-stu-id="1b68c-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)
- [<span data-ttu-id="1b68c-118">Dotazování na databázi</span><span class="sxs-lookup"><span data-stu-id="1b68c-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
