---
title: For Each...Next – příkaz (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.ForEach
- vb.ForEachNext
- vb.Each
- ForEachNext
helpviewer_keywords:
- infinite loops
- Next statement [Visual Basic], For Each...Next
- endless loops
- loop structures [Visual Basic], For Each...Next
- loops, endless
- Each keyword [Visual Basic]
- instructions, repeating
- For Each statement [Visual Basic]
- collections, instruction repetition
- loops, infinite
- For Each...Next statements
- For keyword [Visual Basic], For Each...Next statements
- Exit statement [Visual Basic], For Each...Next statements
- iteration
ms.assetid: ebce3120-95c3-42b1-b70b-fa7da40c75e2
ms.openlocfilehash: 269d905ad59a162af4e790e29d3753f090f511bd
ms.sourcegitcommit: 40364ded04fa6cdcb2b6beca7f68412e2e12f633
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 02/28/2019
ms.locfileid: "56975001"
---
# <a name="for-eachnext-statement-visual-basic"></a><span data-ttu-id="4d6d8-102">For Each...Next – příkaz (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="4d6d8-102">For Each...Next Statement (Visual Basic)</span></span>
<span data-ttu-id="4d6d8-103">Opakuje skupinu příkazů pro každý prvek v kolekci.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-103">Repeats a group of statements for each element in a collection.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="4d6d8-104">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="4d6d8-104">Syntax</span></span>  
  
```  
For Each element [ As datatype ] In group  
    [ statements ]  
    [ Continue For ]  
    [ statements ]  
    [ Exit For ]  
    [ statements ]  
Next [ element ]  
```  
  
## <a name="parts"></a><span data-ttu-id="4d6d8-105">Součásti</span><span class="sxs-lookup"><span data-stu-id="4d6d8-105">Parts</span></span>  
  
|<span data-ttu-id="4d6d8-106">Termín</span><span class="sxs-lookup"><span data-stu-id="4d6d8-106">Term</span></span>|<span data-ttu-id="4d6d8-107">Definice</span><span class="sxs-lookup"><span data-stu-id="4d6d8-107">Definition</span></span>|  
|---|---|  
|`element`|<span data-ttu-id="4d6d8-108">Vyžaduje `For Each` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-108">Required in the `For Each` statement.</span></span> <span data-ttu-id="4d6d8-109">Volitelné v `Next` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-109">Optional in the `Next` statement.</span></span> <span data-ttu-id="4d6d8-110">Proměnná.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-110">Variable.</span></span> <span data-ttu-id="4d6d8-111">Použít k iteraci prvků kolekce.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-111">Used to iterate through the elements of the collection.</span></span>|  
|`datatype`|<span data-ttu-id="4d6d8-112">Požadováno pokud `element` již není deklarován.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-112">Required if `element` isn't already declared.</span></span> <span data-ttu-id="4d6d8-113">Datový typ `element`.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-113">Data type of `element`.</span></span>|  
|`group`|<span data-ttu-id="4d6d8-114">Povinný parametr.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-114">Required.</span></span> <span data-ttu-id="4d6d8-115">Proměnná typu, který je typ kolekce nebo objekt.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-115">A variable with a type that's a collection type or Object.</span></span> <span data-ttu-id="4d6d8-116">Odkazuje na kolekci, nad niž `statements` se bude opakovat.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-116">Refers to the collection over which the `statements` are to be repeated.</span></span>|  
|`statements`|<span data-ttu-id="4d6d8-117">Volitelné.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-117">Optional.</span></span> <span data-ttu-id="4d6d8-118">Jeden nebo více příkazů mezi `For Each` a `Next` , která spustí pro každou položku v `group`.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-118">One or more statements between `For Each` and `Next` that run on each item in `group`.</span></span>|  
|`Continue For`|<span data-ttu-id="4d6d8-119">Volitelné.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-119">Optional.</span></span> <span data-ttu-id="4d6d8-120">Přenese ovládací prvek na začátku `For Each` smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-120">Transfers control to the start of the `For Each` loop.</span></span>|  
|`Exit For`|<span data-ttu-id="4d6d8-121">Volitelné.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-121">Optional.</span></span> <span data-ttu-id="4d6d8-122">Přenese ovládací prvek z celkového počtu `For Each` smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-122">Transfers control out of the `For Each` loop.</span></span>|  
|`Next`|<span data-ttu-id="4d6d8-123">Povinný parametr.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-123">Required.</span></span> <span data-ttu-id="4d6d8-124">Ukončí definici `For Each` smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-124">Terminates the definition of the `For Each` loop.</span></span>|  
  
## <a name="simple-example"></a><span data-ttu-id="4d6d8-125">Jednoduchý příklad</span><span class="sxs-lookup"><span data-stu-id="4d6d8-125">Simple Example</span></span>  
 <span data-ttu-id="4d6d8-126">Použití `For Each`... `Next` smyčky, pokud má být opakován sadu příkazů pro každý prvek kolekce nebo pole.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-126">Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="4d6d8-127">A [pro... Další příkaz](../../../visual-basic/language-reference/statements/for-next-statement.md) dobře funguje i při každé iteraci smyčky přidružit řídicí proměnná a určit tuto proměnnou počáteční a konečné hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-127">A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values.</span></span> <span data-ttu-id="4d6d8-128">Ale při jednání s kolekcí koncept počáteční a konečné hodnoty není smysluplné a neznáte nutně počet prvků kolekci.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-128">However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has.</span></span> <span data-ttu-id="4d6d8-129">V takovémto případě `For Each`... `Next` smyčky je často vhodnější použít.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-129">In this kind of case, a `For Each`...`Next` loop is often a better choice.</span></span>  
  
 <span data-ttu-id="4d6d8-130">V následujícím příkladu `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="4d6d8-130">In the following example, the `For Each`…`Next`</span></span> <span data-ttu-id="4d6d8-131">příkaz Iteruje přes všechny prvky ze seznamu kolekce.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-131">statement iterates through all the elements of a List collection.</span></span>  
  
 [!code-vb[VbVbalrStatements#121](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#121)]  
  
 <span data-ttu-id="4d6d8-132">Další příklady najdete v tématu [kolekce](../../../standard/collections/index.md) a [pole](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="4d6d8-132">For more examples, see [Collections](../../../standard/collections/index.md) and [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span>  
  
## <a name="nested-loops"></a><span data-ttu-id="4d6d8-133">Vnořené smyčky</span><span class="sxs-lookup"><span data-stu-id="4d6d8-133">Nested Loops</span></span>  
 <span data-ttu-id="4d6d8-134">Je možné vnořovat `For Each` smyčky vložením v jednom průchodu v rámci jiného.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-134">You can nest `For Each` loops by putting one loop within another.</span></span>  
  
 <span data-ttu-id="4d6d8-135">Následující příklad ukazuje vnořené `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="4d6d8-135">The following example demonstrates nested `For Each`…`Next`</span></span> <span data-ttu-id="4d6d8-136">struktury.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-136">structures.</span></span>  
  
 [!code-vb[VbVbalrStatements#122](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#122)]  
  
 <span data-ttu-id="4d6d8-137">Pokud byste vnořit smyčky, každé smyčce musí mít jedinečný `element` proměnné.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-137">When you nest loops, each loop must have a unique `element` variable.</span></span>  
  
 <span data-ttu-id="4d6d8-138">Lze také vnořit různé druhy řídicích struktur v sobě navzájem.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-138">You can also nest different kinds of control structures within each other.</span></span> <span data-ttu-id="4d6d8-139">Další informace najdete v tématu [vnořené řídicí struktury](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span><span class="sxs-lookup"><span data-stu-id="4d6d8-139">For more information, see [Nested Control Structures](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span></span>  
  
## <a name="exit-for-and-continue-for"></a><span data-ttu-id="4d6d8-140">Pro ukončení a pokračovat pro</span><span class="sxs-lookup"><span data-stu-id="4d6d8-140">Exit For and Continue For</span></span>  
 <span data-ttu-id="4d6d8-141">[Ukončení pro](../../../visual-basic/language-reference/statements/exit-statement.md) příkaz způsobí spuštění do ukončení `For`...`Next`</span><span class="sxs-lookup"><span data-stu-id="4d6d8-141">The [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) statement causes execution to exit the `For`…`Next`</span></span> <span data-ttu-id="4d6d8-142">řízení smyčky a přenosy příkazu, který následuje `Next` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-142">loop and transfers control to the statement that follows the `Next` statement.</span></span>  
  
 <span data-ttu-id="4d6d8-143">`Continue For` Ovládací prvek příkaz okamžitě přenese na další iteraci smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-143">The `Continue For` statement transfers control immediately to the next iteration of the loop.</span></span> <span data-ttu-id="4d6d8-144">Další informace najdete v tématu [pokračovat příkaz](../../../visual-basic/language-reference/statements/continue-statement.md).</span><span class="sxs-lookup"><span data-stu-id="4d6d8-144">For more information, see [Continue Statement](../../../visual-basic/language-reference/statements/continue-statement.md).</span></span>  
  
 <span data-ttu-id="4d6d8-145">Následující příklad ukazuje způsob použití `Continue For` a `Exit For` příkazy.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-145">The following example shows how to use the `Continue For` and `Exit For` statements.</span></span>  
  
 [!code-vb[VbVbalrStatements#123](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#123)]  
  
 <span data-ttu-id="4d6d8-146">Můžete vložit libovolný počet `Exit For` příkazů v `For Each` smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-146">You can put any number of `Exit For` statements in a `For Each` loop.</span></span> <span data-ttu-id="4d6d8-147">Při použití v rámci vnořené `For Each` smyčky, `Exit For` způsobí spuštění do ukončení vnitřní smyčky a přenosy ovládacího prvku na další vyšší úroveň vnoření.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-147">When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting.</span></span>  
  
 <span data-ttu-id="4d6d8-148">`Exit For` často se používá po vyhodnocení některé podmínky, třeba v `If`... `Then`... `Else` struktury.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-148">`Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure.</span></span> <span data-ttu-id="4d6d8-149">Můžete chtít použít `Exit For` byly splněny následující podmínky:</span><span class="sxs-lookup"><span data-stu-id="4d6d8-149">You might want to use `Exit For` for the following conditions:</span></span>  
  
-   <span data-ttu-id="4d6d8-150">Pokračování k iteraci je zbytečné nebo nemožné.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-150">Continuing to iterate is unnecessary or impossible.</span></span> <span data-ttu-id="4d6d8-151">Příčinou může být chybná hodnota nebo žádost o ukončení.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-151">This might be caused by an erroneous value or a termination request.</span></span>  
  
-   <span data-ttu-id="4d6d8-152">Výjimka zachycena v `Try`... `Catch`... `Finally`. Můžete použít `Exit For` na konci `Finally` bloku.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-152">An exception is caught in a `Try`...`Catch`...`Finally`. You might use `Exit For` at the end of the `Finally` block.</span></span>  
  
-   <span data-ttu-id="4d6d8-153">Zde nekonečné smyčky, což je smyčku, která může běžet velká, nebo dokonce neomezený počet pokusů.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-153">There an endless loop, which is a loop that could run a large or even infinite number of times.</span></span> <span data-ttu-id="4d6d8-154">Pokud zjistíte takové podmínky, můžete použít `Exit For` dostala mimo smyčku.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-154">If you detect such a condition, you can use `Exit For` to escape the loop.</span></span> <span data-ttu-id="4d6d8-155">Další informace najdete v tématu [udělat... Smyčky příkaz](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span><span class="sxs-lookup"><span data-stu-id="4d6d8-155">For more information, see [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span></span>  
  
## <a name="iterators"></a><span data-ttu-id="4d6d8-156">Iterátory</span><span class="sxs-lookup"><span data-stu-id="4d6d8-156">Iterators</span></span>  
 <span data-ttu-id="4d6d8-157">Můžete použít *iterátoru* k provedení vlastní iterace nad kolekcí.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-157">You use an *iterator* to perform a custom iteration over a collection.</span></span> <span data-ttu-id="4d6d8-158">Iterátor může být způsobená nebo `Get` přistupujícího objektu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-158">An iterator can be a function or a `Get` accessor.</span></span> <span data-ttu-id="4d6d8-159">Použije `Yield` příkaz k vrácení každého prvku kolekce jeden po druhém.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-159">It uses a `Yield` statement to return each element of the collection one at a time.</span></span>  
  
 <span data-ttu-id="4d6d8-160">Můžete volat iterátor pomocí `For Each...Next` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-160">You call an iterator by using a `For Each...Next` statement.</span></span> <span data-ttu-id="4d6d8-161">Každá iterace `For Each` smyčky volá iterátor.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-161">Each iteration of the `For Each` loop calls the iterator.</span></span> <span data-ttu-id="4d6d8-162">Když `Yield` je dosažen příkaz v iterátoru, výraz v `Yield` příkazu se vrátí, a je zachováno aktuální umístění v kódu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-162">When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained.</span></span> <span data-ttu-id="4d6d8-163">Provádění je restartováno z tohoto umístění při příštím volání iterátoru.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-163">Execution is restarted from that location the next time that the iterator is called.</span></span>  
  
 <span data-ttu-id="4d6d8-164">Následující příklad používá funkce iterátoru.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-164">The following example uses an iterator function.</span></span> <span data-ttu-id="4d6d8-165">Má funkce iterátoru `Yield` , který se nachází uvnitř [pro... Další](../../../visual-basic/language-reference/statements/for-next-statement.md) smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-165">The iterator function has a `Yield` statement that's inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop.</span></span> <span data-ttu-id="4d6d8-166">V `ListEvenNumbers` metodě, každé iterace `For Each` tělo s příkazy vytvoří volání funkce iterátoru, který pokračuje k dalšímu `Yield` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-166">In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement.</span></span>  
  
 [!code-vb[VbVbalrStatements#127](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#127)]  
  
 <span data-ttu-id="4d6d8-167">Další informace najdete v tématu [iterátory](../../programming-guide/concepts/iterators.md), [příkazu Yield](../../../visual-basic/language-reference/statements/yield-statement.md), a [iterátoru](../../../visual-basic/language-reference/modifiers/iterator.md).</span><span class="sxs-lookup"><span data-stu-id="4d6d8-167">For more information, see [Iterators](../../programming-guide/concepts/iterators.md), [Yield Statement](../../../visual-basic/language-reference/statements/yield-statement.md), and [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md).</span></span>  
  
## <a name="technical-implementation"></a><span data-ttu-id="4d6d8-168">Technická implementace</span><span class="sxs-lookup"><span data-stu-id="4d6d8-168">Technical Implementation</span></span>  
 <span data-ttu-id="4d6d8-169">Když `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="4d6d8-169">When a `For Each`…`Next`</span></span> <span data-ttu-id="4d6d8-170">příkaz spustí, Visual Basic vyhodnocuje kolekce pouze jednou, než na začátku cyklu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-170">statement runs, Visual Basic evaluates the collection only one time, before the loop starts.</span></span> <span data-ttu-id="4d6d8-171">Pokud se změní vaše blok příkazů `element` nebo `group`, tyto změny nemají vliv na iteraci smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-171">If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop.</span></span>  
  
 <span data-ttu-id="4d6d8-172">Pokud všechny prvky v kolekci se postupně přiřadily `element`, `For Each` smyčky zastaví a řídit předá následující příkaz `Next` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-172">When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span>  
  
 <span data-ttu-id="4d6d8-173">Pokud `element` nebyla deklarována mimo tuto smyčku, musíte ji deklarovat v `For Each` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-173">If `element` hasn't been declared outside this loop, you must declare it in the `For Each` statement.</span></span> <span data-ttu-id="4d6d8-174">Je možné deklarovat typ `element` explicitně pomocí `As` příkazu, nebo se můžete spolehnout na odvození typu na typ přiřadit.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-174">You can declare the type of `element` explicitly by using an `As` statement, or you can rely on type inference to assign the type.</span></span> <span data-ttu-id="4d6d8-175">V obou případech se rozsah `element` tělo smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-175">In either case, the scope of `element` is the body of the loop.</span></span> <span data-ttu-id="4d6d8-176">Nelze však deklarovat `element` mimo a uvnitř smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-176">However, you cannot declare `element` both outside and inside the loop.</span></span>  
  
 <span data-ttu-id="4d6d8-177">Volitelně můžete zadat `element` v `Next` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-177">You can optionally specify `element` in the `Next` statement.</span></span> <span data-ttu-id="4d6d8-178">To zlepšuje čitelnost programu, zejména v případě, že budete mít člověk vnořené `For Each` smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-178">This improves the readability of your program, especially if you have nested `For Each` loops.</span></span> <span data-ttu-id="4d6d8-179">Musíte zadat stejnou proměnnou jako ten, který se zobrazí v odpovídající `For Each` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-179">You must specify the same variable as the one that appears in the corresponding `For Each` statement.</span></span>  
  
 <span data-ttu-id="4d6d8-180">Můžete chtít vyhnout změnou hodnoty `element` uvnitř smyčka.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-180">You might want to avoid changing the value of `element` inside a loop.</span></span> <span data-ttu-id="4d6d8-181">To může to ztížit čtení a ladění kódu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-181">Doing this can make it more difficult to read and debug your code.</span></span> <span data-ttu-id="4d6d8-182">Změna hodnoty `group` nemá vliv na kolekce nebo jeho prvky, které byly určeny při prvním zadání smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-182">Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered.</span></span>  
  
 <span data-ttu-id="4d6d8-183">Pokud jste vnoření smyčky, pokud `Next` příkazu vnější úroveň vnoření dochází před `Next` vnitřní úrovně signály kompilátor chybu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-183">When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error.</span></span> <span data-ttu-id="4d6d8-184">Však kompilátor to zjistit překrývající se chyby pouze v případě, že zadáte `element` v každé `Next` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-184">However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement.</span></span>  
  
 <span data-ttu-id="4d6d8-185">Pokud váš kód závisí na kolekci v určitém pořadí, procházení `For Each`... `Next` smyčky není nejlepší volbou, pokud si nejste jisti charakteristiky objekt enumerator poskytuje kolekci.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-185">If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes.</span></span> <span data-ttu-id="4d6d8-186">Pořadí procházení není určeno jazyka Visual Basic, ale podle <xref:System.Collections.IEnumerator.MoveNext%2A> metodu objektu enumerátor.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-186">The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object.</span></span> <span data-ttu-id="4d6d8-187">Proto nebude možné předpovědět, které elementu kolekce, je první má být vrácen v `element`, nebo které je kdy má být vrácen po daného elementu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-187">Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element.</span></span> <span data-ttu-id="4d6d8-188">Můžete dosáhnout pomocí různých smyčce struktura, například spolehlivější výsledky `For`... `Next` nebo `Do`... `Loop`.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-188">You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`.</span></span>  
  
 <span data-ttu-id="4d6d8-189">Datový typ `element` musí být takový, datový typ prvků `group` lze převést na ni.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-189">The data type of `element` must be such that the data type of the elements of `group` can be converted to it.</span></span>  
  
 <span data-ttu-id="4d6d8-190">Datový typ `group` musí být typ odkazu, který odkazuje na kolekci nebo pole, která je vyčíslitelná.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-190">The data type of `group` must be a reference type that refers to a collection or an array that's enumerable.</span></span> <span data-ttu-id="4d6d8-191">Nejčastěji to znamená, že `group` odkazuje na objekt, který implementuje <xref:System.Collections.IEnumerable> rozhraní `System.Collections` oboru názvů nebo <xref:System.Collections.Generic.IEnumerable%601> rozhraní `System.Collections.Generic` oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-191">Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace.</span></span> <span data-ttu-id="4d6d8-192">`System.Collections.IEnumerable` definuje <xref:System.Collections.IEnumerable.GetEnumerator%2A> metodu, která vrací objekt enumerátoru pro kolekci.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-192">`System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection.</span></span> <span data-ttu-id="4d6d8-193">Implementuje objekt enumerator `System.Collections.IEnumerator` rozhraní `System.Collections` obor názvů a zpřístupňuje <xref:System.Collections.IEnumerator.Current%2A> vlastnost a <xref:System.Collections.IEnumerator.Reset%2A> a <xref:System.Collections.IEnumerator.MoveNext%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-193">The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods.</span></span> <span data-ttu-id="4d6d8-194">Jazyk Visual Basic používá tyto k procházení kolekce.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-194">Visual Basic uses these to traverse the collection.</span></span>  
  
### <a name="narrowing-conversions"></a><span data-ttu-id="4d6d8-195">Zužující převody</span><span class="sxs-lookup"><span data-stu-id="4d6d8-195">Narrowing Conversions</span></span>  
 <span data-ttu-id="4d6d8-196">Když `Option Strict` je nastavena na `On`, zužující převody obvykle způsobí chyby kompilátoru.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-196">When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors.</span></span> <span data-ttu-id="4d6d8-197">V `For Each` příkazu, ale převody z prvků v `group` k `element` jsou vyhodnoceny a provést v době běhu a jsou potlačeny chyby kompilátoru způsobené zužujících převodů.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-197">In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.</span></span>  
  
 <span data-ttu-id="4d6d8-198">V následujícím příkladu se přiřazení `m` jako počáteční hodnota pro `n` není při kompilaci `Option Strict` je zapnutý, protože převod `Long` k `Integer` je zužující převod.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-198">In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion.</span></span> <span data-ttu-id="4d6d8-199">V `For Each` příkazu, ale žádná chyba kompilátoru je hlášeny, i když přiřazení `number` vyžaduje stejný převod z `Long` k `Integer`.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-199">In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`.</span></span> <span data-ttu-id="4d6d8-200">V `For Each` příkazu, který obsahuje velký počet chyb za běhu dochází při <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> se použije na velké množství.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-200">In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number.</span></span>  
  
 [!code-vb[VbVbalrStatements#89](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class3.vb#89)]  
  
### <a name="ienumerator-calls"></a><span data-ttu-id="4d6d8-201">IEnumerator volání</span><span class="sxs-lookup"><span data-stu-id="4d6d8-201">IEnumerator Calls</span></span>  
 <span data-ttu-id="4d6d8-202">Při provádění `For Each`... `Next` spuštění cyklu, Visual Basic ověřuje, že `group` odkazuje na objekt platné kolekce.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-202">When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object.</span></span> <span data-ttu-id="4d6d8-203">V opačném případě dojde k výjimce.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-203">If not, it throws an exception.</span></span> <span data-ttu-id="4d6d8-204">V opačném případě volá <xref:System.Collections.IEnumerator.MoveNext%2A> metoda a <xref:System.Collections.IEnumerator.Current%2A> vlastnost objekt enumerátoru pro vrácení prvního prvku.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-204">Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element.</span></span> <span data-ttu-id="4d6d8-205">Pokud `MoveNext` označuje, že neexistuje žádná další prvek, to znamená, pokud kolekce je prázdná, `For Each` smyčky zastaví a řídit předá následující příkaz `Next` příkazu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-205">If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span> <span data-ttu-id="4d6d8-206">Jinak, nastaví jazyka Visual Basic `element` na první element a spuštění tohoto bloku příkazů.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-206">Otherwise, Visual Basic sets `element` to the first element and runs the statement block.</span></span>  
  
 <span data-ttu-id="4d6d8-207">Pokaždé, když zjistí jazyka Visual Basic `Next` prohlášení, vrátí `For Each` příkaz.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-207">Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement.</span></span> <span data-ttu-id="4d6d8-208">Znovu volá `MoveNext` a `Current` vrátit další prvek a znovu ho buď blok spustí nebo zastaví smyčky na základě výsledku.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-208">Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result.</span></span> <span data-ttu-id="4d6d8-209">Tento proces pokračuje, dokud `MoveNext` označuje, že neexistuje žádná další prvek nebo `Exit For` příkaz dochází.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-209">This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered.</span></span>  
  
 <span data-ttu-id="4d6d8-210">**Úprava kolekce.**</span><span class="sxs-lookup"><span data-stu-id="4d6d8-210">**Modifying the Collection.**</span></span> <span data-ttu-id="4d6d8-211">Enumerátor objekt vrácený rutinou <xref:System.Collections.IEnumerable.GetEnumerator%2A> obvykle neumožňuje změnu kolekce pomocí přidání, odstranění, nahrazení nebo změna pořadí žádné elementy.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-211">The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements.</span></span> <span data-ttu-id="4d6d8-212">Pokud se změní kolekce po spuštění `For Each`... `Next` smyčky, objekt enumerator stává neplatným a další pokus o přístup k prvku způsobí, že <xref:System.InvalidOperationException> výjimky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-212">If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="4d6d8-213">Nicméně toto blokování úpravy nelze určit jazyka Visual Basic, ale místo toho provádění <xref:System.Collections.IEnumerable> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-213">However, this blocking of modification isn't determined by Visual Basic, but rather by the implementation of the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="4d6d8-214">Je možné implementovat `IEnumerable` způsobem, který umožňuje úpravy během iterace.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-214">It is possible to implement `IEnumerable` in a way that allows for modification during iteration.</span></span> <span data-ttu-id="4d6d8-215">Pokud uvažujete o provádění takových dynamické úpravy, ujistěte se, že se můžete seznámit s charakteristikou z `IEnumerable` implementaci na kolekce, který používáte.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-215">If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using.</span></span>  
  
 <span data-ttu-id="4d6d8-216">**Úprava elementy z kolekce.**</span><span class="sxs-lookup"><span data-stu-id="4d6d8-216">**Modifying Collection Elements.**</span></span> <span data-ttu-id="4d6d8-217"><xref:System.Collections.IEnumerator.Current%2A> Vlastností objektu enumerátor je [jen pro čtení](../../../visual-basic/language-reference/modifiers/readonly.md), a vrátí místní kopii každého prvku kolekce.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-217">The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), and it returns a local copy of each collection element.</span></span> <span data-ttu-id="4d6d8-218">To znamená, že nelze upravit samotné prvky v `For Each`... `Next` smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-218">This means that you cannot modify the elements themselves in a `For Each`...`Next` loop.</span></span> <span data-ttu-id="4d6d8-219">Všechny změny provedené ovlivňuje pouze místní kopie z `Current` a nereflektují se zpátky do zdrojové kolekce.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-219">Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection.</span></span> <span data-ttu-id="4d6d8-220">Ale pokud elementu je typem odkazu, můžete upravit členy instance, na kterou odkazuje.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-220">However, if an element is a reference type, you can modify the members of the instance to which it points.</span></span> <span data-ttu-id="4d6d8-221">Následující příklad upravuje `BackColor` členem všech `thisControl` elementu.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-221">The following example modifies the `BackColor` member of each `thisControl` element.</span></span> <span data-ttu-id="4d6d8-222">Nelze však změnit `thisControl` samotný.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-222">You cannot, however, modify `thisControl` itself.</span></span>  
  
```vb  
Sub lightBlueBackground(ByVal thisForm As System.Windows.Forms.Form)  
    For Each thisControl As System.Windows.Forms.Control In thisForm.Controls  
        thisControl.BackColor = System.Drawing.Color.LightBlue  
    Next thisControl  
End Sub  
```  
  
 <span data-ttu-id="4d6d8-223">V předchozím příkladu můžete změnit `BackColor` členem všech `thisControl` elementu, i když ho nelze změnit `thisControl` samotný.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-223">The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself.</span></span>  
  
 <span data-ttu-id="4d6d8-224">**Procházení pole.**</span><span class="sxs-lookup"><span data-stu-id="4d6d8-224">**Traversing Arrays.**</span></span> <span data-ttu-id="4d6d8-225">Protože <xref:System.Array> implementuje třída <xref:System.Collections.IEnumerable> vystavit rozhraní, všechna pole <xref:System.Array.GetEnumerator%2A> metoda.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-225">Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method.</span></span> <span data-ttu-id="4d6d8-226">To znamená, že můžete iterovat pole `For Each`... `Next` smyčky.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-226">This means that you can iterate through an array with a `For Each`...`Next` loop.</span></span> <span data-ttu-id="4d6d8-227">Prvky pole však můžete pouze číst.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-227">However, you can only read the array elements.</span></span> <span data-ttu-id="4d6d8-228">Nelze je změnit.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-228">You cannot change them.</span></span>  
  
## <a name="example"></a><span data-ttu-id="4d6d8-229">Příklad</span><span class="sxs-lookup"><span data-stu-id="4d6d8-229">Example</span></span>  
 <span data-ttu-id="4d6d8-230">Následující příklad vypíše všechny složky v adresáři C:\ s použitím <xref:System.IO.DirectoryInfo> třídy.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-230">The following example lists all the folders in the C:\ directory by using the <xref:System.IO.DirectoryInfo> class.</span></span>  
  
 [!code-vb[VbVbalrStatements#124](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#124)]  
  
## <a name="example"></a><span data-ttu-id="4d6d8-231">Příklad</span><span class="sxs-lookup"><span data-stu-id="4d6d8-231">Example</span></span>  
 <span data-ttu-id="4d6d8-232">Následující příklad ukazuje postup při řazení kolekce.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-232">The following example illustrates a procedure for sorting a collection.</span></span> <span data-ttu-id="4d6d8-233">Příklad řadí instance třídy `Car` třídy, které jsou uložené v <xref:System.Collections.Generic.List%601>.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-233">The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>.</span></span> <span data-ttu-id="4d6d8-234">`Car` Implementuje třída <xref:System.IComparable%601> rozhraní, které vyžaduje, aby <xref:System.IComparable%601.CompareTo%2A> implementaci metody.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-234">The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented.</span></span>  
  
 <span data-ttu-id="4d6d8-235">Každé volání <xref:System.IComparable%601.CompareTo%2A> metoda provádí jedno porovnání, který se používá pro řazení.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-235">Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting.</span></span> <span data-ttu-id="4d6d8-236">Uživatelem zapsaný kód v `CompareTo` metoda vrátí hodnotu pro všechna porovnání aktuálního objektu s jiným objektem.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-236">User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object.</span></span> <span data-ttu-id="4d6d8-237">Vrácená hodnota je menší než nula, pokud se aktuální objekt menší než druhý objekt, větší než nula, pokud je aktuální objekt větší než druhý objekt a nula jestli jsou shodné.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-237">The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal.</span></span> <span data-ttu-id="4d6d8-238">To umožňuje v kódu definovat kritéria pro větší, menší než a rovná.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-238">This enables you to define in code the criteria for greater than, less than, and equal.</span></span>  
  
 <span data-ttu-id="4d6d8-239">V `ListCars` metody, `cars.Sort()` příkaz Seřadí seznam.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-239">In the `ListCars` method, the `cars.Sort()` statement sorts the list.</span></span> <span data-ttu-id="4d6d8-240">Toto volání <xref:System.Collections.Generic.List%601.Sort%2A> metodu <xref:System.Collections.Generic.List%601> způsobí, že `CompareTo` metoda bude automaticky volána pro `Car` objekty v `List`.</span><span class="sxs-lookup"><span data-stu-id="4d6d8-240">This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`.</span></span>  
  
 [!code-vb[VbVbalrStatements#125](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#125)]  
  
## <a name="see-also"></a><span data-ttu-id="4d6d8-241">Viz také:</span><span class="sxs-lookup"><span data-stu-id="4d6d8-241">See also</span></span>
- [<span data-ttu-id="4d6d8-242">Kolekce</span><span class="sxs-lookup"><span data-stu-id="4d6d8-242">Collections</span></span>](../../../standard/collections/index.md)
- [<span data-ttu-id="4d6d8-243">Příkaz For...Next</span><span class="sxs-lookup"><span data-stu-id="4d6d8-243">For...Next Statement</span></span>](../../../visual-basic/language-reference/statements/for-next-statement.md)
- [<span data-ttu-id="4d6d8-244">Struktury smyčky</span><span class="sxs-lookup"><span data-stu-id="4d6d8-244">Loop Structures</span></span>](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)
- [<span data-ttu-id="4d6d8-245">Příkaz While...End While</span><span class="sxs-lookup"><span data-stu-id="4d6d8-245">While...End While Statement</span></span>](../../../visual-basic/language-reference/statements/while-end-while-statement.md)
- [<span data-ttu-id="4d6d8-246">Příkaz Do...Loop</span><span class="sxs-lookup"><span data-stu-id="4d6d8-246">Do...Loop Statement</span></span>](../../../visual-basic/language-reference/statements/do-loop-statement.md)
- [<span data-ttu-id="4d6d8-247">Rozšíření a zúžení převodů</span><span class="sxs-lookup"><span data-stu-id="4d6d8-247">Widening and Narrowing Conversions</span></span>](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)
- [<span data-ttu-id="4d6d8-248">Inicializátory objektů: Pojmenované a anonymní typy</span><span class="sxs-lookup"><span data-stu-id="4d6d8-248">Object Initializers: Named and Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="4d6d8-249">Inicializátory kolekcí</span><span class="sxs-lookup"><span data-stu-id="4d6d8-249">Collection Initializers</span></span>](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)
- [<span data-ttu-id="4d6d8-250">Pole</span><span class="sxs-lookup"><span data-stu-id="4d6d8-250">Arrays</span></span>](../../../visual-basic/programming-guide/language-features/arrays/index.md)
