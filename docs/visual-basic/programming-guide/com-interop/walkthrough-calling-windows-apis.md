---
title: 'Návod: Volání rozhraní API Windows (Visual Basic)'
ms.date: 07/20/2015
helpviewer_keywords:
- DLLs, calling
- Windows API, walkthroughs
- platform invoke, walkthroughs
- API calls [Visual Basic], walkthroughs [Visual Basic]
- Windows API, calling
- walkthroughs [Visual Basic], API calls
- DllImport attribute, calling Windows API
- Declare statement [Visual Basic], declaring DLL functions
ms.assetid: 9280ca96-7a93-47a3-8d01-6d01be0657cb
ms.openlocfilehash: 8fd63c2abedcd416937e2c281486bdc1716a275f
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "62022399"
---
# <a name="walkthrough-calling-windows-apis-visual-basic"></a><span data-ttu-id="b4c1e-102">Návod: Volání rozhraní API Windows (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="b4c1e-102">Walkthrough: Calling Windows APIs (Visual Basic)</span></span>
<span data-ttu-id="b4c1e-103">Rozhraní API Windows jsou dynamické knihovny (DLL), které jsou součástí operačního systému Windows.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-103">Windows APIs are dynamic-link libraries (DLLs) that are part of the Windows operating system.</span></span> <span data-ttu-id="b4c1e-104">Můžete využít k provádění úkolů, když je obtížné je napsat ekvivalentní postupy.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-104">You use them to perform tasks when it is difficult to write equivalent procedures of your own.</span></span> <span data-ttu-id="b4c1e-105">Například Windows poskytuje funkci s názvem `FlashWindowEx` , který umožňuje provádět alternativní mezi světlé a tmavé odstínů v záhlaví okna aplikace.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-105">For example, Windows provides a function named `FlashWindowEx` that lets you make the title bar for an application alternate between light and dark shades.</span></span>  
  
 <span data-ttu-id="b4c1e-106">Výhodou použití rozhraní API Windows ve vašem kódu je, že se dají ušetřit dobu vývoje, protože obsahují řadě užitečných funkcí, které již byly napsány a čekáním, který se má použít.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-106">The advantage of using Windows APIs in your code is that they can save development time because they contain dozens of useful functions that are already written and waiting to be used.</span></span> <span data-ttu-id="b4c1e-107">Nevýhodou je, že rozhraní API Windows může být obtížné pro práci s a nepřijímá, když něco selže.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-107">The disadvantage is that Windows APIs can be difficult to work with and unforgiving when things go wrong.</span></span>  
  
 <span data-ttu-id="b4c1e-108">Rozhraní Windows API představují zvláštní druh vzájemná funkční spolupráce.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-108">Windows APIs represent a special category of interoperability.</span></span> <span data-ttu-id="b4c1e-109">Rozhraní API Windows nepoužívejte spravovaného kódu, nemají integrovanou knihoven typů a používat datové typy, které se liší od používaným v sadě Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-109">Windows APIs do not use managed code, do not have built-in type libraries, and use data types that are different than those used with Visual Studio.</span></span> <span data-ttu-id="b4c1e-110">Kvůli těmto rozdílům a protože rozhraní API Windows nejsou objekty modelu COM, vzájemná funkční spolupráce s rozhraními API pro Windows a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] se provádí pomocí platformy volání, PInvoke.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-110">Because of these differences, and because Windows APIs are not COM objects, interoperability with Windows APIs and the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] is performed using platform invoke, or PInvoke.</span></span> <span data-ttu-id="b4c1e-111">Vyvolání platformy je služba, umožňuje spravovaným kódu volat nespravované funkce implementované v knihovnách DLL.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-111">Platform invoke is a service that enables managed code to call unmanaged functions implemented in DLLs.</span></span> <span data-ttu-id="b4c1e-112">Další informace najdete v tématu [používání nespravovaných funkcí DLL](../../../framework/interop/consuming-unmanaged-dll-functions.md).</span><span class="sxs-lookup"><span data-stu-id="b4c1e-112">For more information, see [Consuming Unmanaged DLL Functions](../../../framework/interop/consuming-unmanaged-dll-functions.md).</span></span> <span data-ttu-id="b4c1e-113">PInvoke v jazyce Visual Basic můžete použít buď pomocí `Declare` příkazu nebo použití `DllImport` atribut prázdné procedury.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-113">You can use PInvoke in Visual Basic by using either the `Declare` statement or applying the `DllImport` attribute to an empty procedure.</span></span>  
  
 <span data-ttu-id="b4c1e-114">Volání rozhraní API Windows byly důležitou součástí jazyka Visual Basic programování v minulosti, ale jsou zřídka nezbytné v jazyce Visual Basic .NET.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-114">Windows API calls were an important part of Visual Basic programming in the past, but are seldom necessary with Visual Basic .NET.</span></span> <span data-ttu-id="b4c1e-115">Kdykoli je to možné, používejte spravovanému kódu [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] k provádění úloh, namísto volání rozhraní API Windows.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-115">Whenever possible, you should use managed code from the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] to perform tasks, instead of Windows API calls.</span></span> <span data-ttu-id="b4c1e-116">Tento názorný postup obsahuje informace pro tyto situace, ve které pomocí rozhraní Windows API je nezbytné.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-116">This walkthrough provides information for those situations in which using Windows APIs is necessary.</span></span>  
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="api-calls-using-declare"></a><span data-ttu-id="b4c1e-117">Volání rozhraní API pomocí deklarace</span><span class="sxs-lookup"><span data-stu-id="b4c1e-117">API Calls Using Declare</span></span>  
 <span data-ttu-id="b4c1e-118">Nejběžnější způsob volání rozhraní API Windows je použití `Declare` příkazu.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-118">The most common way to call Windows APIs is by using the `Declare` statement.</span></span>  
  
#### <a name="to-declare-a-dll-procedure"></a><span data-ttu-id="b4c1e-119">Chcete-li deklarovat proceduru knihovny DLL</span><span class="sxs-lookup"><span data-stu-id="b4c1e-119">To declare a DLL procedure</span></span>  
  
1. <span data-ttu-id="b4c1e-120">Určení názvu funkce, do které chcete volat, a navíc jeho argumenty, typy argumentů a vrátí hodnotu, jakož i název a umístění knihovny DLL, která ji obsahuje.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-120">Determine the name of the function you want to call, plus its arguments, argument types, and return value, as well as the name and location of the DLL that contains it.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b4c1e-121">Podrobnější informace o rozhraní API pro Windows naleznete v dokumentaci sady SDK Win32 v rozhraní API sady SDK Windows Platform.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-121">For complete information about the Windows APIs, see the Win32 SDK documentation in the Platform SDK Windows API.</span></span> <span data-ttu-id="b4c1e-122">Další informace o konstanty, které používají rozhraní API pro Windows zkontrolujte soubory hlaviček, jako Windows.h, které jsou součástí sady SDK platformy.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-122">For more information about the constants that Windows APIs use, examine the header files such as Windows.h included with the Platform SDK.</span></span>  
  
2. <span data-ttu-id="b4c1e-123">Kliknutím otevřete nový projekt aplikace Windows **nový** na **souboru** nabídky a pak levým na **projektu**.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-123">Open a new Windows Application project by clicking **New** on the **File** menu, and then clicking **Project**.</span></span> <span data-ttu-id="b4c1e-124">Zobrazí se dialogové okno **Nový projekt**.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-124">The **New Project** dialog box appears.</span></span>  
  
3. <span data-ttu-id="b4c1e-125">Vyberte **aplikace Windows** ze seznamu šablon projektů jazyka Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-125">Select **Windows Application** from the list of Visual Basic project templates.</span></span> <span data-ttu-id="b4c1e-126">Zobrazí se nový projekt.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-126">The new project is displayed.</span></span>  
  
4. <span data-ttu-id="b4c1e-127">Přidejte následující `Declare` pracovat buď pro třídu nebo modul, ve které chcete použít knihovnu DLL:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-127">Add the following `Declare` function either to the class or module in which you want to use the DLL:</span></span>  
  
     [!code-vb[VbVbalrInterop#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#9)]  
  
### <a name="parts-of-the-declare-statement"></a><span data-ttu-id="b4c1e-128">Součástí Declare – příkaz</span><span class="sxs-lookup"><span data-stu-id="b4c1e-128">Parts of the Declare Statement</span></span>  
 <span data-ttu-id="b4c1e-129">`Declare` Výpis obsahuje následující prvky.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-129">The `Declare` statement includes the following elements.</span></span>  
  
#### <a name="auto-modifier"></a><span data-ttu-id="b4c1e-130">Modifikátor Auto</span><span class="sxs-lookup"><span data-stu-id="b4c1e-130">Auto modifier</span></span>  
 <span data-ttu-id="b4c1e-131">`Auto` Modifikátor dá pokyn modulu runtime pro převod řetězce na základě názvu metody podle toho, common language runtime pravidla (nebo název aliasu-li zadán).</span><span class="sxs-lookup"><span data-stu-id="b4c1e-131">The `Auto` modifier instructs the runtime to convert the string based on the method name according to common language runtime rules (or alias name if specified).</span></span>  
  
#### <a name="lib-and-alias-keywords"></a><span data-ttu-id="b4c1e-132">Klíčová slova LIB a Alias</span><span class="sxs-lookup"><span data-stu-id="b4c1e-132">Lib and Alias keywords</span></span>  
 <span data-ttu-id="b4c1e-133">Tento název `Function` – klíčové slovo je název, který program používá pro přístup k importované funkce.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-133">The name following the `Function` keyword is the name your program uses to access the imported function.</span></span> <span data-ttu-id="b4c1e-134">Může být stejný jako skutečný název funkce, která se volá, nebo můžete použít libovolný název platný procedury a potom využívají `Alias` – klíčové slovo k určení skutečným názvem funkce, která je volá.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-134">It can be the same as the real name of the function you are calling, or you can use any valid procedure name and then employ the `Alias` keyword to specify the real name of the function you are calling.</span></span>  
  
 <span data-ttu-id="b4c1e-135">Zadejte `Lib` – klíčové slovo, za nímž následuje název a umístění knihovny DLL, která obsahuje funkce, která je volá.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-135">Specify the `Lib` keyword, followed by the name and location of the DLL that contains the function you are calling.</span></span> <span data-ttu-id="b4c1e-136">Nemusíte určit cestu pro soubory jsou umístěné v adresáři systému Windows.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-136">You do not need to specify the path for files located in the Windows system directories.</span></span>  
  
 <span data-ttu-id="b4c1e-137">Použití `Alias` – klíčové slovo název funkce při volání není platný název procedury jazyka Visual Basic, nebo je v konfliktu s názvem ostatní položky ve vaší aplikaci.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-137">Use the `Alias` keyword if the name of the function you are calling is not a valid Visual Basic procedure name, or conflicts with the name of other items in your application.</span></span> <span data-ttu-id="b4c1e-138">`Alias` označuje true název volané funkce.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-138">`Alias` indicates the true name of the function being called.</span></span>  
  
#### <a name="argument-and-data-type-declarations"></a><span data-ttu-id="b4c1e-139">Argument a typ deklarace dat.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-139">Argument and Data Type Declarations</span></span>  
 <span data-ttu-id="b4c1e-140">Deklarujte argumenty a jejich datové typy.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-140">Declare the arguments and their data types.</span></span> <span data-ttu-id="b4c1e-141">Tuto část může být náročné, protože datové typy, které používá Windows nemusí odpovídat do sady Visual Studio, datových typů.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-141">This part can be challenging because the data types that Windows uses do not correspond to Visual Studio data types.</span></span> <span data-ttu-id="b4c1e-142">Visual Basic nepodporuje spoustu práce za vás převedením argumenty kompatibilní datové typy, proces s názvem *zařazování*.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-142">Visual Basic does a lot of the work for you by converting arguments to compatible data types, a process called *marshaling*.</span></span> <span data-ttu-id="b4c1e-143">Můžete explicitně řídit, jak jsou argumenty zařadit pomocí <xref:System.Runtime.InteropServices.MarshalAsAttribute> atributu definovanému v <xref:System.Runtime.InteropServices> oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-143">You can explicitly control how arguments are marshaled by using the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute defined in the <xref:System.Runtime.InteropServices> namespace.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b4c1e-144">Předchozí verzí jazyka Visual Basic umožňují deklarovat parametry `As Any`, což znamená dat jakýchkoli dat typ může použít.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-144">Previous versions of Visual Basic allowed you to declare parameters `As Any`, meaning that data of any data type could be used.</span></span> <span data-ttu-id="b4c1e-145">Visual Basic vyžaduje použití konkrétní datový typ pro všechny `Declare` příkazy.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-145">Visual Basic requires that you use a specific data type for all `Declare` statements.</span></span>  
  
#### <a name="windows-api-constants"></a><span data-ttu-id="b4c1e-146">Konstanty Windows API</span><span class="sxs-lookup"><span data-stu-id="b4c1e-146">Windows API Constants</span></span>  
 <span data-ttu-id="b4c1e-147">Některé argumenty jsou kombinací konstanty.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-147">Some arguments are combinations of constants.</span></span> <span data-ttu-id="b4c1e-148">Například `MessageBox` přebírá celočíselný argument volat rozhraní API v tomto návodu `Typ` , která určuje, jak se zobrazí okno se zprávou.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-148">For example, the `MessageBox` API shown in this walkthrough accepts an integer argument called `Typ` that controls how the message box is displayed.</span></span> <span data-ttu-id="b4c1e-149">Můžete určit číselnou hodnotu z následujících konstant prozkoumáním `#define` příkazy v souboru WINUSER.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-149">You can determine the numeric value of these constants by examining the `#define` statements in the file WinUser.h.</span></span> <span data-ttu-id="b4c1e-150">Číselné hodnoty obecně zobrazují v šestnáctkovém formátu, takže můžete chtít použití kalkulačky a přidejte je převod na desetinnou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-150">The numeric values are generally shown in hexadecimal, so you may want to use a calculator to add them and convert to decimal.</span></span> <span data-ttu-id="b4c1e-151">Například, pokud je potřeba sloučit konstanty pro styl vykřičník `MB_ICONEXCLAMATION` 0x00000030 a Ano/žádný styl `MB_YESNO` 0x00000004, můžete přidat čísla a získat výsledek 0x00000034 nebo 52 decimal.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-151">For example, if you want to combine the constants for the exclamation style `MB_ICONEXCLAMATION` 0x00000030 and the Yes/No style `MB_YESNO` 0x00000004, you can add the numbers and get a result of 0x00000034, or 52 decimal.</span></span> <span data-ttu-id="b4c1e-152">I když používáte desítkové výsledek přímo, je lepší deklarovat tyto hodnoty jako konstanty ve vaší aplikaci a jejich kombinací pomocí `Or` operátor.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-152">Although you can use the decimal result directly, it is better to declare these values as constants in your application and combine them using the `Or` operator.</span></span>  
  
###### <a name="to-declare-constants-for-windows-api-calls"></a><span data-ttu-id="b4c1e-153">Chcete-li deklarovat konstanty pro volání Windows API</span><span class="sxs-lookup"><span data-stu-id="b4c1e-153">To declare constants for Windows API calls</span></span>  
  
1. <span data-ttu-id="b4c1e-154">V dokumentaci pro funkci Windows, ke kterému se připojujete.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-154">Consult the documentation for the Windows function you are calling.</span></span> <span data-ttu-id="b4c1e-155">Určuje název konstanty, které používá a název souboru .h, který obsahuje číselné hodnoty pro tyto konstanty.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-155">Determine the name of the constants it uses and the name of the .h file that contains the numeric values for these constants.</span></span>  
  
2. <span data-ttu-id="b4c1e-156">Pomocí textového editoru, jako je například Poznámkový blok, chcete-li zobrazit obsah souboru hlaviček (.h) a najděte hodnot spojené s konstanty, které používáte.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-156">Use a text editor, such as Notepad, to view the contents of the header (.h) file, and find the values associated with the constants you are using.</span></span> <span data-ttu-id="b4c1e-157">Například `MessageBox` rozhraní API používá konstanta `MB_ICONQUESTION` zobrazíte otazník v okně se zprávou.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-157">For example, the `MessageBox` API uses the constant `MB_ICONQUESTION` to show a question mark in the message box.</span></span> <span data-ttu-id="b4c1e-158">Definice `MB_ICONQUESTION` je v winuser a zobrazí se takto:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-158">The definition for `MB_ICONQUESTION` is in WinUser.h and appears as follows:</span></span>  
  
     `#define MB_ICONQUESTION             0x00000020L`  
  
3. <span data-ttu-id="b4c1e-159">Přidat ekvivalent `Const` příkazy na třídu nebo modul pro zpřístupnění tyto konstanty pro vaše aplikace.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-159">Add equivalent `Const` statements to your class or module to make these constants available to your application.</span></span> <span data-ttu-id="b4c1e-160">Příklad:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-160">For example:</span></span>  
  
     [!code-vb[VbVbalrInterop#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#11)]  
  
###### <a name="to-call-the-dll-procedure"></a><span data-ttu-id="b4c1e-161">K volání procedury knihovny DLL</span><span class="sxs-lookup"><span data-stu-id="b4c1e-161">To call the DLL procedure</span></span>  
  
1. <span data-ttu-id="b4c1e-162">Přidejte tlačítko s názvem `Button1` na počáteční formulář pro váš projekt a pak dvojím kliknutím ho zobrazte jeho kód.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-162">Add a button named `Button1` to the startup form for your project, and then double-click it to view its code.</span></span> <span data-ttu-id="b4c1e-163">Zobrazí se obslužná rutina události pro tlačítko.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-163">The event handler for the button is displayed.</span></span>  
  
2. <span data-ttu-id="b4c1e-164">Přidejte kód, který `Click` obslužné rutiny události pro tlačítko, které jste přidali, zavolejte proceduru a poskytovat příslušnými argumenty:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-164">Add code to the `Click` event handler for the button you added, to call the procedure and provide the appropriate arguments:</span></span>  
  
     [!code-vb[VbVbalrInterop#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#12)]  
  
3. <span data-ttu-id="b4c1e-165">Stisknutím klávesy F5 spusťte projekt.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-165">Run the project by pressing F5.</span></span> <span data-ttu-id="b4c1e-166">Zobrazí se okno se zprávou s oběma **Ano** a **ne** tlačítka odpovědi.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-166">The message box is displayed with both **Yes** and **No** response buttons.</span></span> <span data-ttu-id="b4c1e-167">Klikněte na jednu.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-167">Click either one.</span></span>  
  
#### <a name="data-marshaling"></a><span data-ttu-id="b4c1e-168">Zařazování dat</span><span class="sxs-lookup"><span data-stu-id="b4c1e-168">Data Marshaling</span></span>  
 <span data-ttu-id="b4c1e-169">Visual Basic automaticky převede datové typy parametrů a návratové hodnoty pro volání Windows API, ale můžete použít `MarshalAs` atribut s ohledem na nespravované datové typy, které se očekává, že rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-169">Visual Basic automatically converts the data types of parameters and return values for Windows API calls, but you can use the `MarshalAs` attribute to explicitly specify unmanaged data types that an API expects.</span></span> <span data-ttu-id="b4c1e-170">Další informace o zařazování spolupráce naleznete v tématu [zařazování Interop](../../../framework/interop/interop-marshaling.md).</span><span class="sxs-lookup"><span data-stu-id="b4c1e-170">For more information about interop marshaling, see [Interop Marshaling](../../../framework/interop/interop-marshaling.md).</span></span>  
  
###### <a name="to-use-declare-and-marshalas-in-an-api-call"></a><span data-ttu-id="b4c1e-171">Používání Declare a MarshalAs ve volání rozhraní API</span><span class="sxs-lookup"><span data-stu-id="b4c1e-171">To use Declare and MarshalAs in an API call</span></span>  
  
1. <span data-ttu-id="b4c1e-172">Určení názvu funkce, kterou chcete k volání a argumenty, datové typy a návratovou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-172">Determine the name of the function you want to call, plus its arguments, data types, and return value.</span></span>  
  
2. <span data-ttu-id="b4c1e-173">Pro zjednodušení přístupu k `MarshalAs` atribut, přidejte `Imports` příkaz do horní části kódu pro třídu nebo modul, jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-173">To simplify access to the `MarshalAs` attribute, add an `Imports` statement to the top of the code for the class or module, as in the following example:</span></span>  
  
     [!code-vb[VbVbalrInterop#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#13)]  
  
3. <span data-ttu-id="b4c1e-174">Přidat prototyp funkce pro importované funkce pro třídu nebo modul a použít `MarshalAs` atribut parametry nebo návratovou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-174">Add a function prototype for the imported function to the class or module you are using, and apply the `MarshalAs` attribute to the parameters or return value.</span></span> <span data-ttu-id="b4c1e-175">V následujícím příkladu volání rozhraní API, která očekává typ `void*` zařazena jako `AsAny`:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-175">In the following example, an API call that expects the type `void*` is marshaled as `AsAny`:</span></span>  
  
     [!code-vb[VbVbalrInterop#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#14)]  
  
## <a name="api-calls-using-dllimport"></a><span data-ttu-id="b4c1e-176">Volání rozhraní API pomocí DllImport</span><span class="sxs-lookup"><span data-stu-id="b4c1e-176">API Calls Using DllImport</span></span>  
 <span data-ttu-id="b4c1e-177">`DllImport` Atribut obsahuje druhý způsob, jak volat funkce v knihovnách DLL bez knihovny typů.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-177">The `DllImport` attribute provides a second way to call functions in DLLs without type libraries.</span></span> <span data-ttu-id="b4c1e-178">`DllImport` je zhruba ekvivalentní k použití `Declare` příkaz ale poskytuje větší kontrolu nad jakým jsou funkce volány.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-178">`DllImport` is roughly equivalent to using a `Declare` statement but provides more control over how functions are called.</span></span>  
  
 <span data-ttu-id="b4c1e-179">Můžete použít `DllImport` s rozhraním API Windows pro většinu volání jako volání odkazuje na sdílený (říká se jim *statické*) metody.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-179">You can use `DllImport` with most Windows API calls as long as the call refers to a shared (sometimes called *static*) method.</span></span> <span data-ttu-id="b4c1e-180">Nelze použít metody, které vyžadují instance třídy.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-180">You cannot use methods that require an instance of a class.</span></span> <span data-ttu-id="b4c1e-181">Na rozdíl od `Declare` příkazů `DllImport` volání nelze použít `MarshalAs` atribut.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-181">Unlike `Declare` statements, `DllImport` calls cannot use the `MarshalAs` attribute.</span></span>  
  
#### <a name="to-call-a-windows-api-using-the-dllimport-attribute"></a><span data-ttu-id="b4c1e-182">Pro volání Windows API pomocí atributu DllImport</span><span class="sxs-lookup"><span data-stu-id="b4c1e-182">To call a Windows API using the DllImport attribute</span></span>  
  
1. <span data-ttu-id="b4c1e-183">Kliknutím otevřete nový projekt aplikace Windows **nový** na **souboru** nabídky a pak levým na **projektu**.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-183">Open a new Windows Application project by clicking **New** on the **File** menu, and then clicking **Project**.</span></span> <span data-ttu-id="b4c1e-184">Zobrazí se dialogové okno **Nový projekt**.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-184">The **New Project** dialog box appears.</span></span>  
  
2. <span data-ttu-id="b4c1e-185">Vyberte **aplikace Windows** ze seznamu šablon projektů jazyka Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-185">Select **Windows Application** from the list of Visual Basic project templates.</span></span> <span data-ttu-id="b4c1e-186">Zobrazí se nový projekt.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-186">The new project is displayed.</span></span>  
  
3. <span data-ttu-id="b4c1e-187">Přidejte tlačítko s názvem `Button2` do formuláře při spuštění.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-187">Add a button named `Button2` to the startup form.</span></span>  
  
4. <span data-ttu-id="b4c1e-188">Dvakrát klikněte na panel `Button2` otevřete zobrazení kódu pro formulář.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-188">Double-click `Button2` to open the code view for the form.</span></span>  
  
5. <span data-ttu-id="b4c1e-189">Pro zjednodušení přístupu k `DllImport`, přidejte `Imports` příkaz do horní části kódu pro třídu formuláře po spuštění:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-189">To simplify access to `DllImport`, add an `Imports` statement to the top of the code for the startup form class:</span></span>  
  
     [!code-vb[VbVbalrInterop#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#13)]  
  
6. <span data-ttu-id="b4c1e-190">Prázdná funkce předchozí deklaraci `End Class` příkaz pro formulář a název funkce `MoveFile`.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-190">Declare an empty function preceding the `End Class` statement for the form, and name the function `MoveFile`.</span></span>  
  
7. <span data-ttu-id="b4c1e-191">Použít `Public` a `Shared` modifikátory deklarace funkce a nastavit parametry pro `MoveFile` na základě argumentů funkce rozhraní Windows API používá:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-191">Apply the `Public` and `Shared` modifiers to the function declaration and set parameters for `MoveFile` based on the arguments the Windows API function uses:</span></span>  
  
     [!code-vb[VbVbalrInterop#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#16)]  
  
     <span data-ttu-id="b4c1e-192">Funkce může mít libovolný název platný postupu; `DllImport` atribut určuje název v knihovně DLL.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-192">Your function can have any valid procedure name; the `DllImport` attribute specifies the name in the DLL.</span></span> <span data-ttu-id="b4c1e-193">Také obstará interoperability zařazování pro parametry a návratové hodnoty, proto můžete použít Visual Studio datové typy, které jsou podobně jako typy používá rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-193">It also handles interoperability marshaling for the parameters and return values, so you can choose Visual Studio data types that are similar to the data types the API uses.</span></span>  
  
8. <span data-ttu-id="b4c1e-194">Použít `DllImport` atribut funkce empty.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-194">Apply the `DllImport` attribute to the empty function.</span></span> <span data-ttu-id="b4c1e-195">První parametr je název a umístění souboru DLL obsahujícímu funkce, který voláte.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-195">The first parameter is the name and location of the DLL containing the function you are calling.</span></span> <span data-ttu-id="b4c1e-196">Nemusíte určit cestu pro soubory jsou umístěné v adresáři systému Windows.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-196">You do not need to specify the path for files located in the Windows system directories.</span></span> <span data-ttu-id="b4c1e-197">Druhý parametr je pojmenovaný argument, který určuje název funkce v rozhraní Windows API.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-197">The second parameter is a named argument that specifies the name of the function in the Windows API.</span></span> <span data-ttu-id="b4c1e-198">V tomto příkladu `DllImport` atribut vynutí volání `MoveFile` mají být předány `MoveFileW` v KERNEL32. KNIHOVNY DLL.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-198">In this example, the `DllImport` attribute forces calls to `MoveFile` to be forwarded to `MoveFileW` in KERNEL32.DLL.</span></span> <span data-ttu-id="b4c1e-199">`MoveFileW` Metoda zkopíruje soubor z cesty `src` k cestě `dst`.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-199">The `MoveFileW` method copies a file from the path `src` to the path `dst`.</span></span>  
  
     [!code-vb[VbVbalrInterop#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#17)]  
  
9. <span data-ttu-id="b4c1e-200">Přidejte kód, který `Button2_Click` obslužná rutina události volaná funkce:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-200">Add code to the `Button2_Click` event handler to call the function:</span></span>  
  
     [!code-vb[VbVbalrInterop#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#18)]  
  
10. <span data-ttu-id="b4c1e-201">Vytvořte soubor s názvem Test.txt a umístěte ho do C:\Tmp adresáře na pevném disku.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-201">Create a file named Test.txt and place it in the C:\Tmp directory on your hard drive.</span></span> <span data-ttu-id="b4c1e-202">Vytvořte adresář Tmp, v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-202">Create the Tmp directory if necessary.</span></span>  
  
11. <span data-ttu-id="b4c1e-203">Stisknutím klávesy F5 spusťte aplikaci.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-203">Press F5 to start the application.</span></span> <span data-ttu-id="b4c1e-204">Zobrazí se hlavní formulář.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-204">The main form appears.</span></span>  
  
12. <span data-ttu-id="b4c1e-205">Klikněte na tlačítko **Button2**.</span><span class="sxs-lookup"><span data-stu-id="b4c1e-205">Click **Button2**.</span></span> <span data-ttu-id="b4c1e-206">Pokud soubor lze přesunout, zobrazí se zpráva "soubor byl úspěšně přesunut.".</span><span class="sxs-lookup"><span data-stu-id="b4c1e-206">The message "The file was moved successfully" is displayed if the file can be moved.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b4c1e-207">Viz také:</span><span class="sxs-lookup"><span data-stu-id="b4c1e-207">See also</span></span>

- <xref:System.Runtime.InteropServices.DllImportAttribute>
- <xref:System.Runtime.InteropServices.MarshalAsAttribute>
- [<span data-ttu-id="b4c1e-208">Příkaz Declare</span><span class="sxs-lookup"><span data-stu-id="b4c1e-208">Declare Statement</span></span>](../../../visual-basic/language-reference/statements/declare-statement.md)
- [<span data-ttu-id="b4c1e-209">Auto</span><span class="sxs-lookup"><span data-stu-id="b4c1e-209">Auto</span></span>](../../../visual-basic/language-reference/modifiers/auto.md)
- [<span data-ttu-id="b4c1e-210">Alias</span><span class="sxs-lookup"><span data-stu-id="b4c1e-210">Alias</span></span>](../../../visual-basic/language-reference/statements/alias-clause.md)
- [<span data-ttu-id="b4c1e-211">Zprostředkovatel komunikace s objekty COM</span><span class="sxs-lookup"><span data-stu-id="b4c1e-211">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="b4c1e-212">Vytváření prototypů ve spravovaném kódu</span><span class="sxs-lookup"><span data-stu-id="b4c1e-212">Creating Prototypes in Managed Code</span></span>](../../../framework/interop/creating-prototypes-in-managed-code.md)
- [<span data-ttu-id="b4c1e-213">Zařazování delegáta jako metody zpětného volání</span><span class="sxs-lookup"><span data-stu-id="b4c1e-213">Marshaling a Delegate as a Callback Method</span></span>](../../../framework/interop/marshaling-a-delegate-as-a-callback-method.md)
