---
title: Architektura nástrojů příkazového řádku .NET Core
description: Přečtěte si o vrstvách nástrojů .NET Core a o tom, co se změnilo v posledních verzích.
ms.date: 03/06/2017
ms.openlocfilehash: 05183a9edc26615e00d6383043fd10d8bec06f2b
ms.sourcegitcommit: 4f4a32a5c16a75724920fa9627c59985c41e173c
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/17/2019
ms.locfileid: "72521308"
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="36426-103">Podrobný přehled změn v nástrojích .NET Core</span><span class="sxs-lookup"><span data-stu-id="36426-103">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="36426-104">Tento dokument popisuje změny spojené s přesunutím z *Project. JSON* na MSBuild a systém projektu *csproj* s informacemi o změnách vrstev nástrojů .NET Core a implementaci příkazů CLI.</span><span class="sxs-lookup"><span data-stu-id="36426-104">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="36426-105">K těmto změnám došlo s vydáním .NET Core SDK 1,0 a sady Visual Studio 2017 7. března 2017 (viz [oznámení](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)), ale byly původně implementovány s vydáním .NET Core SDK Preview 3.</span><span class="sxs-lookup"><span data-stu-id="36426-105">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="36426-106">Přesun mimo Project. JSON</span><span class="sxs-lookup"><span data-stu-id="36426-106">Moving away from project.json</span></span>

<span data-ttu-id="36426-107">Největší změna v nástrojích pro .NET Core je určitě [z Project. JSON přejít na csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) jako systém projektu.</span><span class="sxs-lookup"><span data-stu-id="36426-107">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="36426-108">Nejnovější verze nástrojů příkazového řádku nepodporují soubory *Project. JSON* .</span><span class="sxs-lookup"><span data-stu-id="36426-108">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="36426-109">To znamená, že se nedá použít k sestavení, spuštění nebo publikování aplikací a knihoven založených na Project. JSON.</span><span class="sxs-lookup"><span data-stu-id="36426-109">That means that it cannot be used to build, run or publish project.json based applications and libraries.</span></span> <span data-ttu-id="36426-110">Aby bylo možné používat tuto verzi nástrojů, budete muset migrovat existující projekty nebo začít novými.</span><span class="sxs-lookup"><span data-stu-id="36426-110">In order to use this version of the tools, you will need to migrate your existing projects or start new ones.</span></span> 

<span data-ttu-id="36426-111">V rámci tohoto přesunu byl vlastní modul sestavení vyvinutý pro sestavení projektů Project. JSON nahrazen vyspělým a plně schopným sestavovacím modulem s názvem [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="36426-111">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="36426-112">MSBuild je známý modul v komunitě .NET, protože se od první verze platformy stal klíčovou technologií.</span><span class="sxs-lookup"><span data-stu-id="36426-112">MSBuild is a well-known engine in the .NET community, since it has been a key technology since the platform's first release.</span></span> <span data-ttu-id="36426-113">Samozřejmě, protože potřebuje sestavovat aplikace .NET Core, MSBuild byl předaný do .NET Core a lze ho použít na libovolné platformě, na které běží .NET Core.</span><span class="sxs-lookup"><span data-stu-id="36426-113">Of course, because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="36426-114">Jednou z hlavních příslibů .NET Core je sada pro vývoj pro různé platformy a zajistili jsme, že tento přesun neruší tento příslib.</span><span class="sxs-lookup"><span data-stu-id="36426-114">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!NOTE]
> <span data-ttu-id="36426-115">Pokud s nástrojem MSBuild začínáte a chcete získat další informace o této službě, můžete začít načtením článku [koncepty nástroje MSBuild](/visualstudio/msbuild/msbuild-concepts) .</span><span class="sxs-lookup"><span data-stu-id="36426-115">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild Concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span> 

## <a name="the-tooling-layers"></a><span data-ttu-id="36426-116">Vrstvy nástrojů</span><span class="sxs-lookup"><span data-stu-id="36426-116">The tooling layers</span></span>

<span data-ttu-id="36426-117">Když se přesunete z existujícího projektového systému i s přepínači pro sestavování strojového stroje, otázka, kterou přirozeně následuje, provede některé z těchto změn. celkové "vrstvení" celého ekosystému nástrojů .NET Core?</span><span class="sxs-lookup"><span data-stu-id="36426-117">With the move away from the existing project system as well as with building engine switches, the question that naturally follows is do any of these changes change the overall "layering" of the whole .NET Core tooling ecosystem?</span></span> <span data-ttu-id="36426-118">Existují nové bity a součásti?</span><span class="sxs-lookup"><span data-stu-id="36426-118">Are there new bits and components?</span></span>

<span data-ttu-id="36426-119">Pojďme začít s rychlým aktualizačním rozhraním ve verzi Preview 2, jak je znázorněno na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="36426-119">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Preview 2 – architektura vysoké úrovně nástrojů](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="36426-121">Vrstvení nástrojů je poměrně jednoduché.</span><span class="sxs-lookup"><span data-stu-id="36426-121">The layering of the tools is quite simple.</span></span> <span data-ttu-id="36426-122">V dolní části máme jako základ nástroje příkazového řádku .NET Core.</span><span class="sxs-lookup"><span data-stu-id="36426-122">At the bottom we have the .NET Core Command Line tools as a foundation.</span></span> <span data-ttu-id="36426-123">Všechny ostatní nástroje vyšší úrovně, jako je například Visual Studio nebo Visual Studio Code, závisí a spoléhají na rozhraní příkazového řádku pro sestavování projektů, obnovování závislostí a tak dále.</span><span class="sxs-lookup"><span data-stu-id="36426-123">All other, higher-level tools such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies and so on.</span></span> <span data-ttu-id="36426-124">To znamená, že například pokud aplikace Visual Studio chtěla provést operaci obnovení, měla by zavolat do `dotnet restore` ([Viz poznámku](#dotnet-restore-note)) v rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="36426-124">This meant that, for example, if Visual Studio wanted to perform a restore operation, it would call into `dotnet restore` ([see note](#dotnet-restore-note)) command in the CLI.</span></span> 

<span data-ttu-id="36426-125">Při přesunu na nový systém projektu se změní předchozí diagram:</span><span class="sxs-lookup"><span data-stu-id="36426-125">With the move to the new project system, the previous diagram changes:</span></span> 

![Architektura vysoké úrovně .NET Core SDK 1.0.0](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="36426-127">Hlavním rozdílem je, že rozhraní příkazového řádku již není základní vrstva; Tato role je nyní vyplněna "sdílenou komponentou sady SDK".</span><span class="sxs-lookup"><span data-stu-id="36426-127">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="36426-128">Tato sdílená součást sady SDK je sada cílů a přidružených úloh, které jsou zodpovědné za kompilování kódu, publikování a balení balíčků NuGet atd. Samotný SDK je open source a je k dispozici na GitHubu v [úložišti SDK](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="36426-128">This shared SDK component is a set of targets and associated tasks that are responsible for compiling your code, publishing it, packing NuGet packages etc. The SDK itself is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span> 

> [!NOTE]
> <span data-ttu-id="36426-129">"Target" je výraz MSBuild, který označuje pojmenovanou operaci, kterou může nástroj MSBuild vyvolat.</span><span class="sxs-lookup"><span data-stu-id="36426-129">A "target" is a MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="36426-130">Obvykle je spojen s jednou nebo více úlohami, které spouštějí určitou logiku, kterou by měl cíl provádět.</span><span class="sxs-lookup"><span data-stu-id="36426-130">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="36426-131">Nástroj MSBuild podporuje mnoho předem připravených cílů, jako `Copy` nebo `Execute`; umožňuje také uživatelům psát vlastní úkoly pomocí spravovaného kódu a definovat cíle pro provádění těchto úkolů.</span><span class="sxs-lookup"><span data-stu-id="36426-131">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="36426-132">Další informace najdete v tématu [úlohy nástroje MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="36426-132">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span> 

<span data-ttu-id="36426-133">Všechny sady nástrojů teď využívají sdílenou součást sady SDK a její cíle, včetně rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="36426-133">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="36426-134">Například další verze sady Visual Studio nebude volat příkaz `dotnet restore` ([Viz poznámku](#dotnet-restore-note)) pro obnovení závislostí pro projekty .NET Core, bude používat cíl "obnovit" přímo.</span><span class="sxs-lookup"><span data-stu-id="36426-134">For example, the next version of Visual Studio will not call into `dotnet restore` ([see note](#dotnet-restore-note)) command to restore dependencies for .NET Core projects, it will use the "Restore" target directly.</span></span> <span data-ttu-id="36426-135">Vzhledem k tomu, že se jedná o cíle nástroje MSBuild, můžete pomocí příkazu [dotnet MSBuild](dotnet-msbuild.md) spustit také nezpracovaný nástroj MSBuild.</span><span class="sxs-lookup"><span data-stu-id="36426-135">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span> 

### <a name="cli-commands"></a><span data-ttu-id="36426-136">Příkazy rozhraní příkazového řádku</span><span class="sxs-lookup"><span data-stu-id="36426-136">CLI commands</span></span>
<span data-ttu-id="36426-137">Sdílená součást sady SDK znamená, že většina existujících příkazů rozhraní příkazového řádku byla znovu implementována jako úlohy a cíle nástroje MSBuild.</span><span class="sxs-lookup"><span data-stu-id="36426-137">The shared SDK component means that the majority of existing CLI commands have been re-implemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="36426-138">Co to znamená pro příkazy rozhraní příkazového řádku a vaše využití sady nástrojů?</span><span class="sxs-lookup"><span data-stu-id="36426-138">What does this mean for the CLI commands and your usage of the toolset?</span></span> 

<span data-ttu-id="36426-139">Z perspektivy využití se nezmění způsob, jakým rozhraní příkazového řádku používáte.</span><span class="sxs-lookup"><span data-stu-id="36426-139">From an usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="36426-140">Rozhraní příkazového řádku má stále základní příkazy, které existují ve verzi Preview 2:</span><span class="sxs-lookup"><span data-stu-id="36426-140">The CLI still has the core commands that exist in Preview 2 release:</span></span>

- `new`
- `restore`
- `run` 
- `build`
- `publish`
- `test`
- `pack` 

<span data-ttu-id="36426-141">Tyto příkazy pořád dělají, co očekáváte (nový projekt, sestavte ho, publikujte ho, probalíte a tak dále).</span><span class="sxs-lookup"><span data-stu-id="36426-141">These commands still do what you expect them to do (new up a project, build it, publish it, pack it and so on).</span></span> <span data-ttu-id="36426-142">Většina možností se nezměnila a stále existují a můžete se obrátit na obrazovky s nápovědami (pomocí `dotnet <command> --help`) nebo v dokumentaci k tomuto webu, abyste se seznámili se změnami.</span><span class="sxs-lookup"><span data-stu-id="36426-142">Majority of the options are not changed, and are still there, and you can consult either the commands' help screens (using `dotnet <command> --help`) or documentation on this site to get familiar with any changes.</span></span> 

<span data-ttu-id="36426-143">Z perspektivy provádění budou příkazy rozhraní příkazového řádku přebírat své parametry a sestavit volání "raw" MSBuild, které nastaví požadované vlastnosti a spustí požadovaný cíl.</span><span class="sxs-lookup"><span data-stu-id="36426-143">From an execution perspective, the CLI commands will take their parameters and construct a call to "raw" MSBuild that will set the needed properties and run the desired target.</span></span> <span data-ttu-id="36426-144">K lepší ilustraci byste měli vzít v úvahu následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="36426-144">To better illustrate this, consider the following command:</span></span> 

   ```dotnetcli
   dotnet publish -o pub -c Release
   ```
    
<span data-ttu-id="36426-145">Tento příkaz publikuje aplikaci do složky `pub` s použitím konfigurace Release.</span><span class="sxs-lookup"><span data-stu-id="36426-145">This command is publishing an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="36426-146">Interně se tento příkaz převede do následujícího vyvolání MSBuild:</span><span class="sxs-lookup"><span data-stu-id="36426-146">Internally, this command gets translated into the following MSBuild invocation:</span></span> 

   ```dotnetcli
   dotnet msbuild -t:Publish -p:OutputPath=pub -p:Configuration=Release
   ```

<span data-ttu-id="36426-147">Významnou výjimkou z tohoto pravidla jsou příkazy `new` a `run`, protože nebyly implementovány jako cíle nástroje MSBuild.</span><span class="sxs-lookup"><span data-stu-id="36426-147">The notable exception to this rule are `new` and `run` commands, as they have not been implemented as MSBuild targets.</span></span>

<a name="dotnet-restore-note"></a>  
[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]
