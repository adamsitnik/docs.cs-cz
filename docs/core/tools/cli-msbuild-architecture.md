---
title: Architektura nástroje příkazového řádku .NET core
description: Další informace o .NET Core, nástroje vrstvy a co se změnilo v nejnovější verze.
ms.date: 03/06/2017
ms.openlocfilehash: e9226a314932eb73c6474c0fd17c77c87683e6db
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/23/2019
ms.locfileid: "61665503"
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="aad06-103">Podrobný přehled změn v nástrojích pro .NET Core</span><span class="sxs-lookup"><span data-stu-id="aad06-103">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="aad06-104">Tento dokument popisuje změny spojené s přesunem z *project.json* nástroji MSBuild a *csproj* projektu systému s informacemi o změnách u rozvrstvení nástrojů .NET Core a provádění příkazů rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="aad06-104">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="aad06-105">Tyto změny došlo k .NET Core SDK 1.0 a Visual Studio 2017 verze 7. března 2017 (viz [oznámení](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)), ale byly původně implementované ve verzi rozhraní .NET Core SDK ve verzi Preview 3.</span><span class="sxs-lookup"><span data-stu-id="aad06-105">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://devblogs.microsoft.com/dotnet/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="aad06-106">Přesun směrem od project.json</span><span class="sxs-lookup"><span data-stu-id="aad06-106">Moving away from project.json</span></span>
<span data-ttu-id="aad06-107">Největší změnou v nástroje pro .NET Core je určitě [přesunout mimo project.json na csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) jako systém projektu.</span><span class="sxs-lookup"><span data-stu-id="aad06-107">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://devblogs.microsoft.com/dotnet/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="aad06-108">Nejnovější verze nástroje příkazového řádku nepodporují *project.json* soubory.</span><span class="sxs-lookup"><span data-stu-id="aad06-108">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="aad06-109">To znamená, že nelze použít k vytvoření, spuštění nebo publikovat project.json na základě aplikací a knihoven.</span><span class="sxs-lookup"><span data-stu-id="aad06-109">That means that it cannot be used to build, run or publish project.json based applications and libraries.</span></span> <span data-ttu-id="aad06-110">Pokud chcete používat tuto verzi nástrojů, je potřeba migrovat existující projekty nebo spuštění nové značky.</span><span class="sxs-lookup"><span data-stu-id="aad06-110">In order to use this version of the tools, you will need to migrate your existing projects or start new ones.</span></span> 

<span data-ttu-id="aad06-111">Jako součást tento přesun, modul vlastní sestavení, který byl vyvinut vytvářet projekty project.json byl nahrazen sestavení až po zralé a plně podporuje modul volá [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="aad06-111">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="aad06-112">Nástroj MSBuild je dobře známé modul v komunitě .NET, protože jejím klíčových technologií od první verze platformy.</span><span class="sxs-lookup"><span data-stu-id="aad06-112">MSBuild is a well-known engine in the .NET community, since it has been a key technology since the platform's first release.</span></span> <span data-ttu-id="aad06-113">Samozřejmě protože je nutné k vytváření aplikací .NET Core, nástroj MSBuild byla přenést až po .NET Core a lze použít na libovolné platformě, na kterém běží .NET Core na.</span><span class="sxs-lookup"><span data-stu-id="aad06-113">Of course, because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="aad06-114">Jeden z hlavních příslibů .NET Core je, že zásobníku vývoj pro různé platformy a jste zkontrolovali jsme, že tento přesun nedojde k poškození tento příslib.</span><span class="sxs-lookup"><span data-stu-id="aad06-114">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!NOTE]
> <span data-ttu-id="aad06-115">Pokud teprve začínáte MSBuild a chcete další informace o tom, můžete začít čtením [koncepty nástroje MSBuild](/visualstudio/msbuild/msbuild-concepts) článku.</span><span class="sxs-lookup"><span data-stu-id="aad06-115">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild Concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span> 

## <a name="the-tooling-layers"></a><span data-ttu-id="aad06-116">Nástroje vrstvy</span><span class="sxs-lookup"><span data-stu-id="aad06-116">The tooling layers</span></span>
<span data-ttu-id="aad06-117">S přechodem na od existující systém projektu i k vytváření aplikací modul přepínače je dotaz, který následuje přirozeně, tyto změny Změna celkové "rozvrstvení" celý ekosystém nástrojů .NET Core?</span><span class="sxs-lookup"><span data-stu-id="aad06-117">With the move away from the existing project system as well as with building engine switches, the question that naturally follows is do any of these changes change the overall "layering" of the whole .NET Core tooling ecosystem?</span></span> <span data-ttu-id="aad06-118">Existují nové bity a komponenty?</span><span class="sxs-lookup"><span data-stu-id="aad06-118">Are there new bits and components?</span></span>

<span data-ttu-id="aad06-119">Začněme s si můžete rychle znovu projít vrstvení ve verzi Preview 2, jak je znázorněno na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="aad06-119">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Základní architektura služby nástroje ve verzi Preview 2](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="aad06-121">Vrstvení nástroje je poměrně jednoduché.</span><span class="sxs-lookup"><span data-stu-id="aad06-121">The layering of the tools is quite simple.</span></span> <span data-ttu-id="aad06-122">V dolní části máme jako základ nástrojů příkazového řádku .NET Core.</span><span class="sxs-lookup"><span data-stu-id="aad06-122">At the bottom we have the .NET Core Command Line tools as a foundation.</span></span> <span data-ttu-id="aad06-123">Všechny nástroje, které vyšší úrovně, jako jsou Visual Studio nebo Visual Studio Code, závislé a Spolehněte se na rozhraní příkazového řádku k sestavení projektů, obnovte závislosti a tak dále.</span><span class="sxs-lookup"><span data-stu-id="aad06-123">All other, higher-level tools such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies and so on.</span></span> <span data-ttu-id="aad06-124">To znamená, že například pokud aplikace Visual Studio k provedení operace obnovení, zavolali jsme do `dotnet restore` ([viz Poznámka](#dotnet-restore-note)) v rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="aad06-124">This meant that, for example, if Visual Studio wanted to perform a restore operation, it would call into `dotnet restore` ([see note](#dotnet-restore-note)) command in the CLI.</span></span> 

<span data-ttu-id="aad06-125">S přechodem na nový systém projektů se změní na předchozím obrázku:</span><span class="sxs-lookup"><span data-stu-id="aad06-125">With the move to the new project system, the previous diagram changes:</span></span> 

![Základní architektura služby sady SDK .NET core 1.0.0](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="aad06-127">Hlavní rozdíl je, že rozhraní příkazového řádku základní vrstvě už není; Tato role je nyní vyplněny "sdílené komponenty sady SDK".</span><span class="sxs-lookup"><span data-stu-id="aad06-127">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="aad06-128">Tato sdílená komponenta SDK je sada cílů a přidružených úkolů, které jsou zodpovědné za kompilace kódu, jeho publikování, balení balíčky NuGet atd. Samotné sady SDK je open source a je k dispozici na Githubu na [úložišti SDK](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="aad06-128">This shared SDK component is a set of targets and associated tasks that are responsible for compiling your code, publishing it, packing NuGet packages etc. The SDK itself is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span> 

> [!NOTE]
> <span data-ttu-id="aad06-129">"Cíl" je MSBuild termín, který určuje operaci s názvem, který může vyvolat MSBuild.</span><span class="sxs-lookup"><span data-stu-id="aad06-129">A "target" is a MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="aad06-130">To je obvykle párována s jednu nebo více úloh, které jsou spouštěny některé logiku, která cíl by měl provést.</span><span class="sxs-lookup"><span data-stu-id="aad06-130">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="aad06-131">Nástroj MSBuild podporuje mnoho předdefinovaných cílů, jako `Copy` nebo `Execute`; také umožňuje psát vlastní úlohy pomocí spravovaného kódu a definování cílů ke spuštění těchto úloh.</span><span class="sxs-lookup"><span data-stu-id="aad06-131">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="aad06-132">Další informace najdete v tématu [úlohy nástroje MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="aad06-132">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span> 

<span data-ttu-id="aad06-133">Všechny sady nástrojů nyní využívat sdílené komponenty sady SDK a cíle, rozhraní příkazového řádku zahrnutý.</span><span class="sxs-lookup"><span data-stu-id="aad06-133">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="aad06-134">Například nebude volat další verze sady Visual Studio `dotnet restore` ([viz Poznámka](#dotnet-restore-note)) příkaz pro obnovení závislostí pro projekty .NET Core, cíl "Obnovení" se bude používat přímo.</span><span class="sxs-lookup"><span data-stu-id="aad06-134">For example, the next version of Visual Studio will not call into `dotnet restore` ([see note](#dotnet-restore-note)) command to restore dependencies for .NET Core projects, it will use the "Restore" target directly.</span></span> <span data-ttu-id="aad06-135">Protože se jedná o cíle nástroje MSBuild, můžete také pomocí nezpracované nástroje MSBuild je spouštět pomocí [dotnet msbuild](dotnet-msbuild.md) příkazu.</span><span class="sxs-lookup"><span data-stu-id="aad06-135">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span> 

### <a name="cli-commands"></a><span data-ttu-id="aad06-136">Příkazy rozhraní příkazového řádku</span><span class="sxs-lookup"><span data-stu-id="aad06-136">CLI commands</span></span>
<span data-ttu-id="aad06-137">Sdílené komponenty SDK znamená, že, většinou existující příkazy rozhraní příkazového řádku byly znovu implementovaná jako úlohy MSBuild a cíle.</span><span class="sxs-lookup"><span data-stu-id="aad06-137">The shared SDK component means that the majority of existing CLI commands have been re-implemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="aad06-138">Co to znamená pro vaše využití sady nástrojů a příkazů rozhraní příkazového řádku?</span><span class="sxs-lookup"><span data-stu-id="aad06-138">What does this mean for the CLI commands and your usage of the toolset?</span></span> 

<span data-ttu-id="aad06-139">Z hlediska využití neprojeví tak, jak používat rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="aad06-139">From an usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="aad06-140">Rozhraní příkazového řádku stále obsahuje základní příkazy, které existují ve verzi Preview 2:</span><span class="sxs-lookup"><span data-stu-id="aad06-140">The CLI still has the core commands that exist in Preview 2 release:</span></span>

* `new`
* `restore`
* `run` 
* `build`
* `publish`
* `test`
* `pack` 

<span data-ttu-id="aad06-141">Tyto příkazy stále to, co očekáváte, že jim (nový projekt, sestavte ho, publikujte ho, pack a tak dále).</span><span class="sxs-lookup"><span data-stu-id="aad06-141">These commands still do what you expect them to do (new up a project, build it, publish it, pack it and so on).</span></span> <span data-ttu-id="aad06-142">Většinu možností se nezmění a stále existují, a můžete konzultovat obrazovky nápovědy příkazy, buď (pomocí `dotnet <command> --help`) nebo v dokumentaci na tomto webu a seznamte se se změnami.</span><span class="sxs-lookup"><span data-stu-id="aad06-142">Majority of the options are not changed, and are still there, and you can consult either the commands' help screens (using `dotnet <command> --help`) or documentation on this site to get familiar with any changes.</span></span> 

<span data-ttu-id="aad06-143">Z hlediska provádění příkazů rozhraní příkazového řádku se jejich parametry a vytvořit volání "neupravené" MSBuild, který bude potřebné vlastnosti nastavit a spustit na požadovaný cíl.</span><span class="sxs-lookup"><span data-stu-id="aad06-143">From an execution perspective, the CLI commands will take their parameters and construct a call to "raw" MSBuild that will set the needed properties and run the desired target.</span></span> <span data-ttu-id="aad06-144">Pro lepší znázornění, vezměte v úvahu následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="aad06-144">To better illustrate this, consider the following command:</span></span> 

   `dotnet publish -o pub -c Release`
    
<span data-ttu-id="aad06-145">Tento příkaz je publikování aplikace do `pub` složky pomocí konfigurace "Verze".</span><span class="sxs-lookup"><span data-stu-id="aad06-145">This command is publishing an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="aad06-146">Tento příkaz načte interně přeloženy do následující vyvolání MSBuild:</span><span class="sxs-lookup"><span data-stu-id="aad06-146">Internally, this command gets translated into the following MSBuild invocation:</span></span> 

   `dotnet msbuild -t:Publish -p:OutputPath=pub -p:Configuration=Release`

<span data-ttu-id="aad06-147">Významné výjimka tohoto pravidla jsou `new` a `run` příkazy, protože nejsou implementované jako cílů MSBuild.</span><span class="sxs-lookup"><span data-stu-id="aad06-147">The notable exception to this rule are `new` and `run` commands, as they have not been implemented as MSBuild targets.</span></span>

<a name="dotnet-restore-note"></a>  
[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]
